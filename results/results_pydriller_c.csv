,Function,Original Comment,Predicted comment
0,void arguments addobjectref const std string name accesstype access type object refs name std move descriptor ptr void arguments addobject const std string name accesstype access type object gpuobjectdescriptorptr descriptor ptr descriptor ptr access type objects name std move object std move descriptor ptr void arguments addobject const std string name gpuobjectdescriptorptr descriptor ptr descriptor ptr accesstype read ,clarified interface of arguments piperorigin revid change id , fix a bug in the parser test piperorigin revid
1,class test testcase key 2 constant op constant 1 5 2 5 length 2 padded seq padding sequences 2 with self assertraisesoperror all sequence lengths must match but received lengths padded seq key 1 eval if ops use c api with self assertraisesregexp valueerror fill dimensions must be 0 padded seq padding sequences 2 else padded seq padding sequences 2 with self assertraisesoperror all sequence lengths must match but received lengths padded seq key 1 eval def self with ops graph as default as g self test session graph g ,make batch sequences with states test py work with the c api enabled the c api improves static shape inference making more errors caught at graph construction time instead of runtime piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2,from tensorflow python ops import array ops from tensorflow python ops import math ops from tensorflow python ops import variables from tensorflow python platform import tf logging as logging from tensorflow python training import distribution strategy context from tensorflow python training mode keys import modekeys from tensorflow python util import nest def validate not in strategy scope if distribution strategy context has distribution strategy if distribution strategy context in cross replica context raise runtimeerror eval predict should not be run inside the distribution strategy ' 'scope only model creation and compilation should be in ' 'distribution strategy scope ' def set weights distribution strategy dist model weights sets the weights of the replicated models ,throw an error when running loop inside scope piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3,class indexedslices internal nativeobject composite tensor compositetensor return indexedslices indices s values s s self indices self values dense shape s self dense shape if self dense shape is not none else self dense shape if self dense shape is not none else def neg self return indexedslices self values self indices self dense shape ,fixed error from printing out of indexedslices objects piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
4,llvm ir elementgenerator elementaliremitter makeelementgenerator case hloopcode kcopy return hlo operand to generator const irarray index target index statusor llvm value irarray index source index target index source index irarray index source index target index multidim hlo operand 0 shape target index gettype tf assign or return llvm value operand value operand to generator at hlo operand 0 source index ,remove method from irarray index this method was originally added to allow to force using the multi dimensional index to allow so allow to specify in the methods whether to allow using the linear index piperorigin revid , xla gpu support for xla hlo ir piperorigin revid change id idadedfddaccd
5,class tf test benchmark if name ' main ' tf test main no newline at end of file ,add common tags and update benchmarks to keep consistency , tf data vectorization test for tf data dataset piperorigin revid
6,default cuda path ' usr local cuda' default cuda path linux ' opt cuda' default cuda path win 'c program files nvidia gpu computing ' cuda v s' default cuda version default tensorrt path linux ' usr lib x86 64 linux gnu' default tensorrt path linux ' usr lib s linux gnu' platform machine tf opencl version '1 2' default computecpp toolkit path ' usr local computecpp' default trisycl include dir ' usr local trisycl include' ,add support for other cpu aarch for tensorrt , fix a bug in the test case piperorigin revid
7,class mirroredextended distribute lib strategyextendedv1 input contexts self container strategy def experimental distribute values from function self value fn per replica values for replica id in range self num replicas in sync per replica values append value fn distribute lib valuecontext replica id self num replicas in sync return values regroup per replica values always wrap true todo priyag deal with outofrange errors once b 111349762 is fixed def experimental run steps on iterator self fn iterator iterations initial loop values none ,add experimental make distributed values from function method to distribution strategy piperorigin revid change id , fix a bug in the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
8,void trtcalibop compute tensorflow opkernelcontext ctx stream implementation cudastreammemberhack calib res calibrator setbatch input data stream calib res calibrator setbatch input data stream vlog 2 passed calibration data todo aaroey make sure we wait for the completion of calibration on the last batch in future pr ,fix c and python formatting , add a test for the new op api piperorigin revid
9,from tensorflow python util import tf contextlib from tensorflow python util tf export import tf export temporary global switch determining if we should enable the work in progress calls to the c api currently disabled by default but can be manually enabled in code or via the environment variable this will be removed once all functionality is supported and there's no performance penalty with it enabled use c api os getenv tf c api graph construction 1 is not 0 temporary global switches determining if we should enable the work in progress calls to the c api these will be removed once all functionality is supported use c api true use c shapes os getenv tf c api graph construction shapes 0 is not 0 ,remove environment variable to disable c api this is staging for removing the use c api toggle altogether piperorigin revid , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
10,static char features static int included patches add new patch number below this line 1612 1611 ,patch need to close terminal after shell stopped problem need to close terminal after shell stopped solution make terminal without argument close the window by default , patch problem when using a channel to be a bit a bit slow solution add a test for the test
11,def map structure func structure kwargs structure i all structures in structure must have the same arity and the return value will contain results with the same structure layout examples 1 a single python dict a hello 24 world 76 tf nest map structure lambda p p 2 a 'hello' 48 152 2 multiple python dictionaries d1 hello 24 world 76 d2 hello 36 world 14 tf nest map structure lambda p1 p2 p1 p2 d1 d2 'hello' 60 90 args func a callable that accepts as many arguments as there are structures structure scalar or tuple or dict or list of constructed scalars and or ,nfc add examples to tf nest map structure documentation piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring of the docstring change
12,global void const int nthreads max 0 int pool size gradient top diff slice ph pooled width pw channels pool size top diff slice ph pooled width pw channels dtype pool size bottom diff index gradient ,get rid of ambiguous operator and enable for gpu builds on windows , xla python fix a bug in the hlo client client piperorigin revid
13,tfliteregistration micro register average pool 2d return register average pool 2d tfliteregistration register max pool tfliteregistration micro register max pool return register max pool tfliteregistration register max pool 2d tfliteregistration micro register max pool 2d return register max pool 2d allopsresolver allopsresolver allopsresolver allopsresolver addbuiltin builtinoperator fully connected micro register fully connected min version 1 max version 2 addbuiltin builtinoperator max pool 2d micro register max pool addbuiltin builtinoperator max pool 2d micro register max pool 2d addbuiltin builtinoperator softmax micro register softmax addbuiltin builtinoperator average pool 2d micro register average pool 2d ,fix review comments rename max pool to max pool d in order to be consistent use for printing input type in error message , add support for int int piperorigin revid
14,register op textlinedataset output handle variant setisstateful todo b 65524810 source dataset ops must be marked stateful to inhibit constant folding setshapefn shape inference scalarshape todo mrry validate that filenames is a scalar or a vector setshapefn shape inference inferencecontext c shape inference shapehandle unused filenames must be a scalar or a vector tf return if error c withrankatmost c input 0 1 unused return shape inference scalarshape c register op sqldataset input driver name string ,add shape check to textlinedataset op , fix a bug in the test case piperorigin revid
15,int main int argc char argv usage 65536 65536 void 65536 65536 for i 1 i 512 i struct sigaction sa sigset t ss ,re add the priv dropping in case we get run as root , fix a bug in the watchdog process
16,void export the standard tensorflow lite runtime if you have a custom implementation for them you can disable this error with allow custom ops or by setting allow custom ops true when calling tf contrib lite toco convert here is a list when calling tf contrib lite tococonverter here is a list of operators for which you will need custom implementations absl strjoin error summary final ,documentation fixes piperorigin revid , fix a bug in the file in the file piperorigin revid
17,make tooltip beval text pt delete tooltip beval ballooneval beval postmessage beval balloon wm close 0 0 postmessage beval balloon wm destroy 0 0 postmessage beval balloon wm ncdestroy 0 0 ,patch problem tooltip window stays open solution send a wm close message jurgen kramer , patch problem when using a popup window with a terminal window solution add the cursor to the current buffer when the cursor is set
18,class decodejpegbenchmark test benchmark start time time time for in xrange num iters sess run r return time time start time end time time time return end time start time def self ,don't wait for session close to finish when calculating benchmark timing piperorigin revid , tf data service support for tf data dataset piperorigin revid
19,class foresthparams object def init self kwargs for name value in kwargs iteritems for name value in kwargs items setattr self name value def values self ,fixing tensor forest for python compatibility , fix a bug in the docstring of the test piperorigin revid
20,class raggedtensor composite tensor compositetensor new shape dim size ragged rank 1 input shape ragged rank else dim size math ops cumprod input shape new shape array ops concat dim size ragged rank new shape array ops concat dim size ragged rank 1 input shape ragged rank axis 0 flattened array ops reshape tensor new shape ,bug fix for raggedtensor from tensor t piperorigin revid change id , tf data optimizer to use the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
21,class literal other temp new literal of a given rank to minimize ambiguity for users creates a new literal of a given rank to minimize ambiguity for users and the compiler these 0 2 methods should explicitly specify the native type for example ,fix typo in comment nfc piperorigin revid , xla python fix for the build piperorigin revid
22,get errorlist properties win t wp dict t what dict t retdict use the specified quickfix location list if di di tv v type var number qf idx di di tv vval v number 1 if qf idx 0 qf idx qi qf listcount return fail for zero use the current list if di di tv vval v number 0 qf idx di di tv vval v number 1 if qf idx 0 qf idx qi qf listcount return fail flags qf nr else ,patch problem cannot get the number of the current quickfix or location list solution use the current list if nr in what is zero yegappan lakshmanan remove debug command from test , patch problem when using a terminal window is a bit slow solution add a test for the gui
23,static char features static int included patches add new patch number below this line 477 476 ,patch vim error messages not tested problem vim error messages not tested solution add more tests , patch problem when using a channel to be a bit a bit slow solution add a test for the test
24,nv screengo oap dir dist intwidth2 test width for wrapped screen line oap motion type mchar oap inclusive false oap inclusive curwin w curswant maxcol col off1 curwin col off col off2 col off1 curwin col off2 ,updated for version a problem using does not delete the last character zyx solution set the inclusive flag properly , patch problem when using a popup window with a terminal window solution add the option to the current line
25,class gpuobject gpuobject const gpuobject delete gpuobject operator const gpuobject delete virtual gpuobject default virtual const gpuobjectdescriptor getgpudescriptor const 0 virtual gpuresourceswithvalue getgpuresources accesstype access type const 0 ,removed virtual method gpuobjectdescriptor for gpuobject piperorigin revid change id , fix a bug in the test piperorigin revid
26,static char features static int included patches add new patch number below this line 2089 2088 ,patch problem color handling of x guis is too complicated solution simplify the code use rgba where appropriate kazunobu kuriyama , patch problem when using a channel to be a bit a bit slow solution add a test for the test
27,namespace data static constexpr const char const prefetchdatasetop koutputshapes static constexpr const char const prefetchdatasetop kslackperiod static constexpr const char const prefetchdatasetop klegacyautotune static constexpr const char const prefetchdatasetop kbuffersizemin determines the fraction of slack time by which to delay prefetching of data constexpr double ksleepfactor 0 2 ,tf data add the to cc file to solve some bug piperorigin revid change id , fix a bug in the new delegate piperorigin revid change id ibebfcffdcbdbdafeb
28,import numpy as np from tensorflow python import keras from tensorflow python data experimental ops import cardinality from tensorflow python data experimental ops import distribute options from tensorflow python data experimental ops import writers from tensorflow python data experimental ops distribute options import autoshardpolicy from tensorflow python data ops import dataset ops from tensorflow python data ops import readers from tensorflow python distribute import central storage strategy class test testcase dataset dataset filter dummy op batch 8 drop remainder true options dataset ops options options experimental distribute auto shard policy autoshardpolicy file options experimental distribute auto shard policy distribute options autoshardpolicy file dataset dataset with options options model predict dataset steps 1 ,update how we import data experimental ops distribute options autoshardpolicy piperorigin revid change id , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
29,static logicalresult oppassmanager pm keep return emiterror a crash has been detected while processing the mlir module a a failure has been detected while processing the mlir module a has been generated in ' ' ,make diagnostic a bit clearer this prints out in case of any pass failure not just a crash piperorigin revid change id , fix a bug in the new op api piperorigin revid change id iaaeaebbe
30,static int add fd unsigned int chance char b int flags int fd 1 if unsigned int rand 100 chance if unsigned int rand 5000 chance fd open b flags o nonblock if fd 0 return 1 openit void open files more open fds sys kernel debug open fds dev open fds proc open fds sys if fds left to create 0 goto more void close files ,some random files tweaks add files to the mix decrease the likelyhood of a file being added keep scanning for files until we have enough , fix a bug in the watchdog process
31,class precalculatedprimetable public primetable std fill is prime is prime is prime size true is prime 0 is prime 1 false for int i 2 i max i checks every candidate for prime number we know that 2 is the only even prime for int i 2 i i max i i 2 1 if is prime i continue marks all multiples of i except i itself as non prime for int j 2 i j max j i we are starting here from i th multiplier because all smaller complex numbers were already marked for int j i i j max j i is prime j false ,oss sync cl , fix a bug in the file file in the file
32,class reshape public nodeshader auto output ctx graph findoutputs ctx node id 0 if input tensor shape dimensionsproduct output tensor shape dimensionsproduct return invalidargumenterror dimensions product is reshape don't match return invalidargumenterror number of elements in input output tensors don't match auto attr absl any cast reshapeattributes ctx node operation attributes if input tensor shape dimensionsproduct output tensor shape dimensionsproduct return invalidargumenterror dimensions product is reshape don't match if attr new shape output tensor shape return invalidargumenterror dimensions for output does not match new shape attribute ,remove duplicate error check in reshape piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id id ibaaeabeded
33,class resource variable ops baseresourcevariable else return self handle property def packed handle self return self handle def read variable op self if context executing eagerly return self get var on current device value ,introduce a savecontext to detect whether we are building a graph for a savedmodel and don't use packed variables under a savecontext piperorigin revid change id , fix a bug in the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
34,from tensorflow contrib learn python learn experiment import experiment from tensorflow python platform import flags from tensorflow python platform import tf logging as logging flags define string 'output dir' '' 'base output directory made ' 'available to the experiment builder function passed ' 'to run all files written by the experiment are ' flags flags flags ,move output dir flag definition to runner flags py and add an sh test for runner flags to test whether the flags are being processed correctly by learn runner change , tf data fix a bug in the graph piperorigin revid
35,test use tuple args true compilation result expect eq s code tensorflow errors code invalid argument expect eq s tostring invalid argument could not parse mlir module stdin error invalid argument could not parse mlir module 1 1 error custom op is unknown n ,update debug info tests after upstream mlir change piperorigin revid change id , xla python fix a bug in the hlo evaluator piperorigin revid change id idbeeaeaafcaeeaafafffe
36,std vector string hloinstruction extraattributestostring const if extra push back strcat dimensions join dimensions if window nullptr if window nullptr window dimensions size 0 extra push back strcat window window util tostring window if padding config nullptr ,hlo parser allow empty convolution window window is not required for a convolution on a d shape piperorigin revid , xla gpu support for the xla client piperorigin revid
37,typename distribution resulttype tail processing if any put the tail condition out of above loop to improve performance it will be executed only once and save time on cpu if offset kresultelementcount sample gen for int i 0 offset kresultelementcount i offset ,add comment to explain why need to put condition out of loop , fix a bug in the new delegate test piperorigin revid
38,class word2vec object initial epoch initial words self session run self epoch self words summary op tf contrib deprecated merge all summaries summary op tf summary merge all summary writer tf summary filewriter opts save path self session graph workers for in xrange opts concurrent steps ,replace using of tf contrib deprecated merge all summaries with tf summary merge all the implementations are identical tf summary merge all is the canonical location change , fix a bug in the documentation of the documentation of the documentation of the new class change
39,register op register op modeldataset input input dataset variant output handle variant attr cpu budget int 0 attr output types list type 1 attr output shapes list shape 1 setshapefn shape inference scalarshape ,tf data exposing an option for specifying the cpu budget for autotuning parallelism and nesting the autotuning related options under experimental optimization piperorigin revid , tf data dataset support for tf data dataset piperorigin revid
40,class layoutassignment public hlopassinterface case we have to undo operations due to the multiple passes over the computations instructions channellayoutconstraints channel constraints the set of hlo instructions which any layout constraint thus receiving propagated default layouts tensorflow gtl flatset const hloinstruction unconstrained layout instructions namespace xla ,modifies layoutassignment to keep a record of the hlo instructions having layout at the last layout pass piperorigin revid , xla gpu support for xla cpu piperorigin revid change id iffcbbabfbaeecaeaa
41,static voidex popup args exarg t eap define ex pyfileex ni endif ifndef feat python3 define ex script ni define ex script ni define ex py3fileex ni endif ifndef feat tcl do one cmd cmdlinep sourcing case cmd perl case cmd psearch case cmd python case cmd python3 case cmd py3 case cmd return case cmd rightbelow case cmd ruby find command eap full while ascii isalpha p p for python 3 x support py3 python3 for python 3 x support py3 and if eap cmd 0 'p' eap cmd 1 'y' p skipdigits p ,rename some python symbols to py as the command name documentation updates , patch problem when using a terminal window is a bit slow solution add a test for the gui
42,limitations under the license include tensorflow lite delegates gpu cl kernels resize h include tensorflow lite delegates gpu cl kernels softmax h include tensorflow lite delegates gpu cl kernels softmax1x1 h include tensorflow lite delegates gpu cl kernels space to depth h include tensorflow lite delegates gpu cl kernels strided slice h include tensorflow lite delegates gpu cl kernels transpose h include tensorflow lite delegates gpu common status h void int src channels int dst channels void const attr const operationdef op def std unique ptr gpuoperation ptr spacetodepth operation op def attr ptr absl make unique spacetodepth std move operation void const padattributes attr const operationdef op def std unique ptr gpuoperation ptr padding operation op def attr ,tflite gpu implement space to depth piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
43,class distributedvariabletest test testcase parameterized testcase distribution experimental local results distribution run assign def testpackedvariable self distribution synchronization aggregation if context num gpus 1 self skiptest b 158767088 with distribution scope v0 variables lib variable 0 synchronization synchronization aggregation aggregation ,temporarily disable testpackedvariable since it breaks piperorigin revid change id , fix a bug in the docstring of the docstring of the test case piperorigin revid
44,mch print init psettings jobname forceit props enc canon props p encoding if props enc 8bit p nul props enc unicode int cmap first int cmap first 0 p first null for cmap 0 cmap int num elements prt ps cmap ,patch problem compiler warning for using uninitialized variable yasuhiro matsumoto solution initialize it , patch problem when using a terminal window doesn't work solution add a test for the cursor
45,const ortho camera frustum half extent 1 2 const shift key 16 const ctrl key 17 const start camera pos 3d new three vector3 1 5 1 5 1 5 const start camera pos 3d new three vector3 0 6 1 0 1 85 const start camera target 3d new three vector3 0 0 0 const start camera pos 2d new three vector3 0 0 1 const start camera target 2d new three vector3 0 0 0 ,set the initial position of the d camera a little closer to the origin and not at x y z for a slightly more perspective change , fix a bug in the docstring of the test piperorigin revid
46,static char features static int included patches add new patch number below this line 382 ,updated for version problem ime characters are inserted twice solution do not call if the event was handled yasuhiro matsumoto , patch problem when using a channel to be a bit a bit slow solution add a test for the test
47,instantiate typed test case p my footest mytypes typedef testing internal templates va args type gtest alltests static const char const gtest registered test names casename gtest attribute unused gtest attribute unused gtest typed test case p state casename verifyregisteredtestnames file line va args ,fix typo gtest attribute unused gtest attribute unused , fix a bug in the parser test piperorigin revid
48,const absl string view khostthreads host threads const int knumstattypes static cast int stattype khlomodule 1 static absl string view kstattypestrmap knumstattypes static const absl string view kstattypestrmap knumstattypes unknown id parent step id function step id device ordinal chip ordinal ,restore constness of piperorigin revid change id , xla python add a test for the xla client piperorigin revid
49,class optimizerv2 optimizer v1 optimizer raise valueerror no gradients provided for any variable s str v for v in grads and vars return distribute lib get tower context merge call self distributed apply filtered global step global step name name self distributed apply filtered global step global step name name def get or create state self var list none apply gradients for use with a distributionstrategy reduced grads distribution batch reduce sum grads and vars var list v for v in grads and vars ,rename distributed apply to distributed apply in optimizerv to match the optimizer base class piperorigin revid , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
50,void tfl tensordata const tfl tensor tensor const char tfl tensorname const tfl tensor tensor return tensor name tfl quantizationparams tfl const tfl tensor tensor return tensor params tfl status tfl tensorcopyfrombuffer tfl tensor tensor const void input data size t input data size if tensor bytes input data size ,adds a function that returns quantization params for a given tfl tensor piperorigin revid , add support for int ops piperorigin revid
51,class layercollection object approx approx kronecker name if approx approx kronecker name self register block params fb self params inputs outputs strides padding block fb self params strides padding block register additional minibatch inputs outputs self register block params block elif approx approx diagonal name block fb convdiagonalfb self params strides padding block register additional minibatch inputs outputs ,k fac multi tower support for piperorigin revid , fix a bug in the docstring of the docstring of the new api change
52,limitations under the license include string include vector include tensorflow core framework device attributes pb h include tensorflow core framework graph pb h include tensorflow core public env h include tensorflow core public session options h ,drop reference to unused proto header change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
53,static void log main started void mainmsg num children max children mainmsg shm begin shm mainmsg shm end shm shm size 1 mainmsg initial seed shm seed sendudp char mainmsg sizeof mainmsg ,log seed reseed events , fix a bug in the watchdog process
54,struct roll gpudevice t const t input t output const gtl arrayslice int32 threshold const gtl arrayslice int64 dim range const int64 if num elements return const gpudevice d context eigen device gpudevice auto dim bytes sizeof int32 dim size size ,support empty input shapes to tf roll on gpu piperorigin revid change id , fix a bug in the new delegate piperorigin revid change id idacdededdbdcfbcdb
55,class batchdatasetop dataset public datasetbase overload that supports zero copy and might make sense in an optimization pass const size t num tuple components batch elements 0 size out tensors reserve num tuple components const int64 num batch elements batch elements size for size t component index 0 component index num tuple components component index ,tf data add missing std vector reserve calls piperorigin revid change id , fix a bug in the test case piperorigin revid
56,button press event gtkwidget widget switch event button case 1 button mouse left break case 2 button mouse middle break case 3 button mouse right break default return false unknown button keep in sync with gui x11 c buttons 4 7 are handled in scroll event case 1 button mouse left break case 2 button mouse middle break case 3 button mouse right break case 8 button mouse x1 break case 9 button mouse x2 break default return false unknown button ifdef feat xim ,patch problem x and gtk have mouse buttons than vim supports solution recognize more mouse buttons benoit pierre closes , fix a bug in the new code in the new code
57,def softmax cross entropy args onehot labels batch size num classes target one hot encoded labels logits batch size num classes logits outputs of the network logits batch size num classes logits outputs of the network weights optional tensor whose rank is either 0 or rank 1 and is broadcastable to the loss which is a tensor of shape batch size label smoothing if greater than 0 then smooth the labels ,softmax cross entropy improve docstring improve docstring of softmax cross entropy , fix documentation of the docstring of the docstring change
58,def make identity tests options chose a set of parameters test parameters input shape 1 3 3 use snapshot false true op to use identity identity n snapshot def build graph parameters def make identity tests options shape this conversion still fails todo b 129197312 remove the walk around code once the bug is fixed input doubled input tensor 2 0 if parameters use snapshot identity output array ops snapshot input doubled else if parameters op to use identity identity output tf identity input doubled elif parameters op to use identity n testing identityn with a single tensor identity output tf identity n input doubled 0 elif parameters op to use snapshot identity output array ops snapshot input doubled return input tensor identity output def build inputs parameters sess inputs outputs ,handle identityn with input in toco piperorigin revid , tf data dataset dataset to be a single device to be used by default piperorigin revid
59,class breaktransformer converter base orelse guarded orelse new for node node 1 anno setanno new for node 'extra test' extra test anno setanno new for node anno basic extra loop test extra test anno copyanno original node new for node anno basic directives return node ,account more thoroughly for the hidden extra test code in activity analysis this avoids related referenced before assigned errors should fix but that's most practical to verify after the nightly build piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
60,required packages 'numpy 1 16 0 2 0' 'opt einsum 2 3 2' 'protobuf 3 9 2' 'tensorboard 2 1 0 2 2 0' 'tensorboard 2 2 0 2 3 0' 'tensorflow estimator 2 1 0 2 2 0' 'termcolor 1 1 0' 'wrapt 1 11 1' ,update tensorboard dependency to x tensorboard release https pypi org project tensorboard piperorigin revid change id , update the documentation of the docstring of the docstring of the docstring of the example to the new api change
61,static char features static int included patches add new patch number below this line 1932 ,patch cannot sort using locale ordering problem cannot sort using locale ordering solution add a flag for sort and sort to use the locale dominique pell√© closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
62,from future import division from future import print function from tensorflow python data experimental ops import optimization from tensorflow python data experimental ops optimization options import optimizationoptions from tensorflow python data kernel tests import test base from tensorflow python data ops import dataset ops from tensorflow python framework import test util class test base datasettestbase dataset dataset ops dataset range 10 apply optimization assert next mapandbatch map lambda x x x batch 10 options dataset ops options options experimental optimization optimizationoptions options experimental optimization map and batch fusion true dataset dataset with options options self assertdatasetproduces dataset expected output x x for x in range 10 ,tf data enable map and batch fusion optimization piperorigin revid , tf data service support for tf data dataset piperorigin revid
63,static void sanitise mmap struct syscallrecord rec don't actually set a hint right now rec a1 0 rec a2 rand array mapping sizes this over the arg op in the syscall struct rec a4 get rand mmap flags if rec a4 map anonymous rec a2 rand array mapping sizes do anon rec else rec a5 get random fd static void sanitise mmap struct syscallrecord rec page align non anonymous mappings rec a6 page mask rec a2 page size ,mmap sanitize can use simplified 'size' setting , make the syscall page we can be a bit more than the syscall process
64,getvcol wp pos start cursor end vcol 0 ptr ml get buf wp w buffer pos lnum false ptr pos col if pos col maxcol null continue until the nul else ptr pos col this function is used very often do some speed optimizations getvcol wp pos start cursor end incr charsize c if ptr character at pos col if null ptr character at pos col break vcol incr getvcol wp pos start cursor end break if ptr character at pos col if null ptr character at pos col break vcol incr ,updated for version problem internal alloc error when doing ctrl v c solution fix computations in getvcol partly by lech lorens , patch problem when using a terminal window is a bit slow solution add a test for the gui
65,static pyobject cxoconnection getversion cxoconnection conn void unused dpiversioninfo versioninfo char buffer 25 int status int status len if cxoconnection isconnected conn 0 return null static pyobject cxoconnection getversion cxoconnection conn void unused py end allow threads if status 0 return cxoerror raiseandreturnnull snprintf buffer sizeof buffer d d d d d versioninfo versionnum versioninfo releasenum versioninfo updatenum versioninfo portreleasenum versioninfo portupdatenum return pyunicode buffer strlen buffer null len snprintf buffer sizeof buffer d d d d d versioninfo versionnum versioninfo releasenum versioninfo updatenum versioninfo portreleasenum versioninfo portupdatenum return pyunicode buffer len null ,use return value of snprintf instead of calling strlen unnecessarily signed off by alex henrie alexhenrie gmail com , fix a bug in the documentation of the client client client
66,def parse saved model export dir reads the savedmodel pb or savedmodel pbtxt file containing savedmodel args export dir string or pathlike path to the directory containing the savedmodel file export dir directory containing the savedmodel file returns a savedmodel protocol buffer ,revert modify docstring this reverts commit , fix a bug in the docstring of the docstring of the new api change
67,class network base layer layer if not nest is sequence ref inputs ref inputs self nested inputs flatten in the order the input s were passed during model construction return tensors inp keras history layer name for inp in ref inputs try flatten in the order input s were passed during model construction return tensors inp keras history layer name for inp in ref inputs except keyerror todo b return nest flatten tensors otherwise both self inputs and tensors will already be in same order return nest flatten tensors ,allow keyerror when mapping tensors to inputs in functional api dict to list mapping piperorigin revid change id , update keras layers to keras piperorigin revid
68,class imageconversions buffer shape hide the constructor as the class is static hide the constructor as the class is static private imageconversions ,improve javadoc and annotations for tflite support classes and methods piperorigin revid change id , xla python fix a bug in the hlo evaluator piperorigin revid change id icccbcbdbcfaadbee
69,static char features static int included patches add new patch number below this line 2108 ,patch vim no test to check for let error problem vim no test to check for let error solution add a test rename tests from let to var , patch problem when using a channel to be a bit a bit slow solution add a test for the test
70,class estimator object assets extra none as text false checkpoint path none pylint disable line too long pylint enable line too long if serving input receiver fn is none raise valueerror 'serving input receiver fn must be defined ' ,add a link to the guide on using savedmodel with estimators to the documentation for export savedmodel piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
71,void expected results largest type test type s large arguments test data group 400 200 test function add expected result compiler stdlib platform largest type test type s negative test data group 1400 500 test function add expected result compiler stdlib ,polygamma extend derivatives of cot method to larger orders extend test cases for negative x fix missing return statement on error condition , fix a bug in the parser test that the test fails on the same case of the same type of the same value of the same value of the same value of the same value piperorigin revid
72,int main int argc char argv tensorflow string usage tensorflow tfcompile kusageheader usage tensorflow flags usage argv 0 flag list if argc 1 absl string view argv 1 help std cerr usage n return 0 bool parsed flags ok tensorflow flags parse argc argv flag list qcheck parsed flags ok n usage ,xla aot add check for help command line option , fix a bug in the watchdog process
73,class public opkernel const device device ctx template eigen device device functor applydelaycompensatedgradientdescent device t device var flat t alpha scalar t delta flat t lambda scalar t shadow flat t lambda scalar t shadow flat t ctx 0 0 class public opkernel register kernel builder name applydelaycompensatedgradientdescent device device d hostmemory var hostmemory shadow typeconstraint t t d device t define register cpu kernels t register kernels cpu t ,change interface to resource , fix a bug in the graph piperorigin revid
74,def bfloat16 scope this enables variables to be read as bfloat16 type when using get variable with variable scope variable scope 'bfloat16' custom getter get custom getter as varscope '' custom getter get custom getter as varscope yield varscope ,internal change piperorigin revid change id , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
75,boost auto test case unsigned i 44 56 76 88 boost check equal boost math gcd range i i 4 first 4 boost check equal boost math gcd range i i 4 second i 4 boost check equal boost math gcd i 0 i 1 i 2 i 3 4 boost check equal boost math lcm range i i 4 first boost check equal boost math lcm range i i 4 second i 4 ifndef boost no cxx11 variadic templates boost check equal boost math gcd i 0 i 1 i 2 i 3 4 boost check equal boost math lcm i 0 i 1 i 2 i 3 endif test case from boost rational need to make sure we don't break the rational lib ,gcd don't enable unless the compiler supports them update docs escape from variadic gcd early when the result hits unity , fix a bug in the previous commit piperorigin revid
76,class the name of a pack that aggregates this node flattened self flatten nodes if len flattened 1 if self aggregation ophint aggregate first or self aggregation ophint aggregate last assert len flattened 1 if len flattened 1 and self aggregation ophint aggregate stack temp op flattened 0 return temp op aggregate and return name for output fused op name output index out graphdef ,fix unidirectional sequence lstm rnn output shapes piperorigin revid , fix a bug in the test case piperorigin revid
77,class collectiveallreduceextended mirrored strategy mirroredextended split batch by self num replicas in sync input context input context def experimental distribute datasets from function self dataset fn input context self make input context return input lib get distributed datasets from function dataset fn dataset fn input workers self input workers input contexts input context strategy self container strategy def make dataset iterator self dataset input context self make input context ,implement experimental distribute dataset from function for multiworkermirroredstrategy piperorigin revid change id , tf data optimizer to use the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
78,aucmd abort if buf b nwindows 0 buf b nwindows ifdef feat diff if diffopt unload buf buf b nwindows 0 diff buf delete buf clear 'diff' for hidden buffer endif return when a window is displaying the buffer or when it's not unloaded if buf b nwindows 0 unload buf ,patch some users don't want to diff with hidden buffers problem some users don't want to diff with hidden buffers solution add the item to 'diffopt' closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
79,flags define integer task index none initialization flags define integer num gpus 1 total number of gpus for each machine if you don't gpu please set it to '0' if you don't use gpu please set it to '0' flags define integer replicas to aggregate none number of replicas to aggregate before parameter update is applied for sync replicas mode only default ,fix a miss word in the comment , fix a bug in the test case piperorigin revid
80,class streamingaccuracystats object def print accuracy stats self if self how many gt 0 tf logging info 'no ground truth yet false positives' format tf compat v1 logging info 'no ground truth yet false positives' format self how many fp else any match percentage self how many gt matched self how many gt 100 correct match percentage self how many c self how many gt 100 wrong match percentage self how many w self how many gt 100 false positive percentage self how many fp self how many gt 100 tf logging info ' 1f matched 1f correct 1f wrong ' tf compat v1 logging info ' 1f matched 1f correct 1f wrong ' ' 1f false format any match percentage correct match percentage wrong match percentage false positive percentage ,update accuracy utils py fix v compatibility , fix a bug in the docstring of the docstring of the docstring change
81,absl optional int64 const hlosharding sharding return absl nullopt int64 dim 1 for int64 i 0 i sharding tile assignment num dimensions i int64 rank sharding replicateonlasttiledim sharding tile assignment num dimensions 1 sharding tile assignment num dimensions for int64 i 0 i rank i if sharding tile assignment dim i 1 if dim 1 return absl nullopt ,xla spmd support partial sharding with reshape using halo exchange piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
82,class livevalueresolver transformer base if not hasattr parent object node attr raise attributeerror ' s has no attribute s' parent object node attr anno setanno node 'parent type' type parent object anno setanno node 'live val' getattr parent object node attr anno setanno node 'fqn' anno getanno node value 'fqn' node attr todo mdan investigate the role built in annotations can here class livevalueresolver transformer base this would not hold for dynamic members like function attributes for the dynamic case we simply leave the node without an annotation and let downstream consumers figure out what to do anno setanno node 'parent type' parent type anno setanno node 'live val' getattr parent type node attr anno setanno node 'fqn' anno getanno node value 'type fqn' node attr ,annotate attribute nodes with the value or type of their parent this helps with resolving function owners since using reflection to do it is unreliable piperorigin revid , fix a bug in the test case piperorigin revid
83,class tensorhandle public core refcounted tensorflow device device tensorflow device op device status copytodevice eagercontext ctx tensorflow device dstd tensorhandle output dtype for the handle it must be the same as t dtype once the handle is ready const datatype dtype ,moves tensorhandlecopytodevice to tensorhandle piperorigin revid , tf data service support for tf data experimental piperorigin revid change id idaceccfcbacfece
84,class graphpropertiestest public testing test tf check ok cluster provision void teardown override cluster reset void teardown override tf check ok cluster shutdown cluster reset protected returns a string form of p suitable for comparing type and shape ,make sure we serialize the creation and deletion of clusters from python to avoid race conditions added a cluster context manager only check that we have a unique singlemachine running during the phase piperorigin revid , fix a bug in the new delegate piperorigin revid change id ibebfcffdcbdbdafeb
85,limitations under the license include vector include tensorflow core framework graph pb text h include tensorflow core framework node def pb text h include tensorflow core framework tensor h include tensorflow core framework types pb h include tensorflow core lib core error codes pb h ,split nodedef out of graph proto into node def proto needed so we can use nodedef in functiondef change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
86,popup adjust position win t wp wp w width 1 for lnum wp w topline lnum wp w buffer b ml ml line count lnum count tabs for what they are worth int len win linetabsize wp ml get buf wp w buffer lnum false int len int w width wp w width count tabs for what they are worth and compute the length based on the maximum width matters when 'showbreak' is set if wp w width maxwidth wp w width maxwidth len win linetabsize wp ml get buf wp w buffer lnum false colnr t maxcol wp w width w width if wp w p wrap ,patch popup too wide when 'showbreak' is set problem popup too wide when 'showbreak' is set solution set window width when computing line length closes , patch problem when using a popup window with a popup window solution add a test for the mouse command
87,bool supportsquantization const operator op type operatortype kargmax type operatortype krelu type operatortype krelu1 type operatortype krelu6 type operatortype kshape type operatortype kexpanddims type operatortype kpack type operatortype kpack type operatortype ktopk v2 the quantized op allows output arrays of type float using ,enable quantization support for topk piperorigin revid , add support for int int piperorigin revid
88,arg all void ifndef backslash in filename p ' ' endif p ' ' insert a backslash if retval null ,patch expanding fails to escape backtick problem expanding fails to escape backtick solution escape a backtick in a file name closes , fix a bug in the client client client client piperorigin revid
89,class estimator object export dir base a string containing a directory in which to create timestamped subdirectories containing exported savedmodels serving input receiver fn a function that takes no argument and returns a servinginputreceiver returns a servinginputreceiver or tensorservinginputreceiver assets extra a dict specifying how to populate the assets extra directory within the exported savedmodel or none if no extra assets are needed as text whether to write the savedmodel proto in text format ,adds a that allows export savedmodel to pass raw tensors to model functions addresses piperorigin revid , update docstring for tf nn rnn py
90,class unaryopstest xla test xlatestcase rtol 1e 6 atol 1e 6 for real part close to zero or imaginary part close to a multiple of pi self assertopoutputmatchesexpected math ops expm1 np array 1e 11 1j 1e 11 1j 1 1e 1 1e 1e 1e dtype dtype todo srvasude use numpy as the source of truth after we depend on latest numpy with this pull request https github com numpy numpy pull the numbers below were generated by scipy special expm1 expected np array 4 01 8 4 01 8 1 00 2 6 01 3 2 00000000e 26 2 00000000e dtype dtype rtol 1e 09 atol 1e 20 self assertopoutputmatchesexpected math ops reciprocal np array 1 2j 2 3j dtype dtype ,add test for expm for small parameter of complex numbers piperorigin revid change id , xla gpu support for the xla client piperorigin revid
91,static void close sockets void for i 0 i nr sockets i fd shm socket fds i shm socket fds i 0 if close fd 0 nr sockets else if close fd 0 printf failed to close socket s n strerror errno nr sockets 0 void open sockets void ,socket close all the sockets as in close files close all the sockets not half signed off by kees cook keescook chromium org reported by brad net , make the watchdog process to the syscall process
92,static char features static int included patches add new patch number below this line 1576 ,patch command line redrawn for arabic without arabic characters problem command line redrawn for arabic without arabic characters dominique pelle solution check if there actually are any arabic characters do redraw after displaying incsearch closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
93,class modelfnwrapper object if tensor tracer tensortracer is enabled tt tensor tracer tensortracer loss tracing ops tt trace tpu ops get default graph loss self ctx num replicas self ctx num replicas fetches loss train op we must run train op to update the variables prior to running the outfeed ,convergence tools tracing the subset of the ops that are in the execution path piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
94,void do setsockopt struct sockopt so struct socket triplet triplet so optname 0 sometimes just do generic options if one in 10 socket setsockopt so triplet return get a page for the optval to live in todo push this down into the per proto func calls ,sometimes just do generic socket options instead of the per proto ones , fix a bug in the syscall page
95,class public categoricalop register xla op name statelessmultinomial compiletimeconstantinput num samples typeconstraint t dt float dt bfloat16 typeconstraint t dt double dt float dt bfloat16 typeconstraint tseed dt int32 ,adds double support for which is really a categorical relevant to https github com tensorflow probability issues piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id id ibaaeabeded
96,class base transformer base arg values for def in defs if directive not in def directives or arg not in arg not in def directives directive arg not in def directives directive continue arg value def directives directive arg for prev value in arg values ,fix for unspecified arguments in autograph directives piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
97,mkllayoutrewritepass checkfornodefusion node a const all succ has been visited false break all successor nodes of current node has been visited no match found pop the stack and mark current node as visited if all succ has been visited visited nodes insert current node work stack pop node checker all successor nodes of current node has been visited no match found pop the stack and mark current node as visited if all succ has been visited visited nodes insert current node work stack pop node checker else current node doesn't match just break and stack will help us roll back break current node doesn't match pop stack to roll back visited nodes insert current node work stack pop node checker ,fix bugs in the else case for node checker fails are not handled properly should pop the stack rather then break the while loop entirely the nested level of stack op when node check succeed is wrong , add support for int and max types piperorigin revid
98,class gradienttape object vectorization in such cases returns a list or nested structure of tensors or indexedslices or none one for each element in sources returned structure is the same as the structure of sources a list or nested structure of tensors or none one for each element in sources returned structure is the same as the structure of sources note if any gradient is sparse indexedslices jacobian function currently makes it dense and returns a tensor instead this may change in the future raises runtimeerror if called on a non persistent tape with eager execution ,support indexedslices as jacobian and vectorization output enable jacobian for embedding lookup piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the docstring change
99,rewind retry for p ptr p ptr size p reset the carriage return counter if try mac try mac 1 if p nl if try unix rewind retry fileformat eol unix break else if p car try mac try mac don't give in to eol unix if eol mac is more likely rewind retry fileformat eol mac else if fileformat eol unknown try mac 1 looking for cr but found no end of line markers at all use the default format fileformat default fileformat no nl found may use mac format ,updated for version problem if no nl or cr is found in the first block of a file then the 'fileformat' may be set to mac issue solution check if a cr was found , patch problem when using a terminal window is a bit slow solution add a test for the gui
100,def add gradients summaries grads and vars else grad values grad summaries append summary histogram summary var op name ' gradient' grad values summary histogram var op name ' gradient' grad values summaries append summary histogram summary var op name ' gradient norm' clip ops global norm grad values summary histogram var op name ' gradient norm' clip ops global norm grad values else logging info 'var s has no gradient' var op name ,fix breakage by recent changes in tf summary rename gradients in the summary s tf summary histogram summary tf summary histogram change , fix a bug in the docstring of the docstring of the test case piperorigin revid
101,test p unifiedcapi tf deleteoutputlist func outputs tf deleteexecutioncontext eager execution ctx tf deleteexecutioncontext graph ctx tf deleteexecutioncontext graph ctx tf func ,call to free graph ctx , fix a bug in the test case piperorigin revid
102,class eagerexecutionfunction object if value is none raise valueerror 'you must feed a value for placeholder s' tensor converted inputs append ops convert to tensor value dtype tensor dtype value ops convert to tensor value dtype tensor dtype if value dtype tensor dtype temporary workaround due to convert to tensor not casting floats see b value math ops cast value tensor dtype converted inputs append value outputs self graph fn converted inputs return x numpy for x in outputs ,enable use of keras graph functions with iterators and datasets during eager execution this is done by routing fit etc to the methods fit generator etc when passed an eager dataset or eager iterator piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
103,from future import absolute import from future import division from future import print function import os path import time from six moves import xrange pylint disable redefined builtin def run training save a checkpoint and evaluate the model periodically if step 1 1000 0 or step 1 flags max steps saver save sess flags train dir global step step checkpoint file os path join flags train dir 'checkpoint' saver save sess checkpoint file global step step evaluate against the training set print 'training data eval ' do eval sess ,fixed bug in fully connected feed py in which checkpoints were being saved to the directory below the desired output directory change , fix a bug in the test case piperorigin revid
104,struct hoistinneropssingleislandgraph public oprewritepattern graphop if hassingleopinblock islandop block return matchfailure fetchop fetch op op getfetch check if graph has no target nodes control rets on fetch operation operand range fetches fetch op fetches if fetches empty std prev fetches end gettype isa controltype return matchfailure auto island op llvm cast islandop block front yieldop yield op island op getyield map graph results to inner ops results of single island llvm smallvector value 8 new rets for value operand fetch op fetches control results should not be propagated out if operand gettype isa controltype break for value operand fetches if operand getdefiningop island op operand is not from island simply propagate it out new rets push back operand ,restrict single island graph canonicalization to only canonicalize if there are no target nodes control rets piperorigin revid change id , xla gpu support for the hlo ir piperorigin revid change id iebdeaedebeebedaa
105,class trackableresource base trackable def create resource self raise notimplementederror trackableresource create resource not raise notimplementederror trackableresource create resource not implemented this method will be removed soon def create resource self return self create resource def initialize self pass this method will be removed soon def initialize self return self initialize property def resource handle self ,making sure the tensorflow estimator transition works out fine with the renaming we alias create resource with create resource so that old new estimator code can work with old new tf code piperorigin revid , fix a bug in the docstring of the test piperorigin revid
106,class test testcase def self with self test session use gpu false tensor tf placeholder tf float32 shape none 12 tensor array ops placeholder dtypes float32 shape none 12 size splits 3 7 2 outputs tf split tensor size splits 1 outputs array ops split tensor size splits 1 for i output in enumerate outputs self assertequal output get shape as list none size splits i ,fix split ops test for new import convention fixes bad merge earlier , fix a bug in the docstring of the test case piperorigin revid
107,class inputoptions attributes experimental prefetch to device boolean currently only applies to tpustrategy defaults to true if true dataset elements will be prefetched to accelerator device memory when false dataset elements are prefetched to host device memory must be false when using tpuembedding api experimental prefetch to device boolean defaults to true if true dataset elements will be prefetched to accelerator device memory when false dataset elements are prefetched to host device memory must be false when using tpuembedding api def new cls experimental prefetch to device true ,add support to all remaining strategies piperorigin revid change id , fix a bug in the new delegate test piperorigin revid
108,class huberlosstest test testcase actual loss sample weight np sum self expected losses self batch size self assertalmostequal self evaluate loss actual loss 3 def test all correct self test case for github issue 39004 def test loss with non default dtype self test case for github issue https github com tensorflow tensorflow issues 39004 self setup h obj losses huber try ,address review comment change test name and add url signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the test case piperorigin revid
109,class remotefusedgraphexecuteop public opkernel tf check ok ctx allocate output i shape output return output else for compatibility purpose returns an empty tensor with specified data type as output if no executor is used tensor output nullptr tensorshape ts tf check ok ctx allocate output i ts output ,add python support of remote fused graph ops to contrib piperorigin revid , fix a bug in the test case piperorigin revid
110,class ternaryopstest xla test xlatestcase parameterized testcase 1e 6 1e 6 1e 4 30 class ternaryopstest xla test xlatestcase parameterized testcase 1e 8 5e 4 3e 6 3e 4 1e 16 ,add a cpu bfloat kernel for mulnonan fixes a test whose randomness was affected by this piperorigin revid change id , fix a bug in the test case piperorigin revid
111,status const node node inferencecontext c status shaperefiner shape refiner const node node bool relax std queue const node new shapes auto enter ctx shape refiner getcontext node check ne enter ctx nullptr for int i 0 i enter ctx num outputs i tf return if error shape refiner setshape node i enter ctx input 0 status shaperefiner shape refiner const node node bool relax continue inferencecontext merge ctx shape refiner getcontext dst dcheck ne merge ctx nullptr check ne merge ctx nullptr tf return if error dst merge ctx new shapes push dst ,add a null check on enter ctx and update the null check on merge ctx piperorigin revid , add a test for the cost of the graph piperorigin revid
112,class einsumtest test testcase fbc 'ij jk ik' 'ij ki jk' 'ijk jklm jk' 'ijk jklm jk' 'ij jk kl 'a ab abc 'ab ab cd cd ef ef ' class einsumtest test testcase dim mismatch cases 'ijk jkl 2 3 4 3 5 6 def disabled test simple self def test simple self for case in self simple cases self run test case ,re enable tests for tf einsum these tests check that tf einsum is equivalent to np einsum at one point some of them were failing because of a bug in np einsum in an old version of numpy this bug has been fixed so we can re enable the tests now piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
113,class attentioncellwrapper rnn cell impl rnncell if input size is none input size inputs get shape as list 1 inputs linear inputs input size true lstm output new state self cell inputs state cell output new state self cell inputs state if self state is tuple new state cat array ops concat nest flatten new state 1 else new state cat new state new new attn states self attention new state cat attn states with vs variable scope attn output projection output linear lstm output new self attn size true output linear cell output new self attn size true new attn states array ops concat new attn states array ops expand dims output 1 1 new attn states array ops reshape ,variable name change and documentation clarification , fix a bug in the docstring of the docstring of the docstring change
114,xlaop xlaop input xlaop index int64 dim xlaop torchindexselect xlaop input xlaop index int64 dim xlabuilder builder input builder return builder reporterrororreturn statusor xlaop tf assign or return shape input shape builder getshape input tf assign or return shape index shape builder getshape index std vector int64 slice sizes input shape dimensions slice sizes dim 1 gatherdimensionnumbers gather dnums for int64 i 0 i input shape rank i if i dim gather dnums add offset dims i gather dnums set index vector dim index shape rank gather dnums add collapsed slice dims dim gather dnums add start index map dim return gather input index gather dnums slice sizes namespace xla ,xla client implement index select piperorigin revid , xla gpu support for the layout of the layout is a bit piperorigin revid
115,get x11 void alarm 0 signal sigalrm retsigtype sig save if p verbose 0 sig alarm called verb msg char u opening the x display timed out verb msg opening the x display timed out endif if x11 display null ,patch a few compiler warnings on vms problem a few compiler warnings on vms solution remove type cast adjust ifdef zoltan arpadffy , patch problem when using a terminal window is a bit slow solution add a test for the gui
116,const nnapi loadnnapi load function rename cutils handle asharedmemory create create region else nnapi log nnapi error unable to open neither libraries s and d nnapi log nnapi error unable to open neither libraries s and s libandroid so so ,corrected log format to s removes build warning , fix a bug in the new delegate piperorigin revid
117,void int flat size const int depth multiplier the tolerance that we apply to means is tight but we allow for a rounding difference in one pixel and by another 1 for float comparison float mean tolerance std max 1e 5f 1 01f flat size std sqrt 1 f depth multiplier mean tolerance 500 f const float mean tolerance std max 1e 2f 1 01f flat size std sqrt 1 f depth multiplier const int diff mean tolerance 256 const int diff median tolerance 225 void trytestonedepthwiseconv3x3filter test for int i 0 i 30 i for int i 0 i 60 i trytestonedepthwiseconv3x3filter ,update depthwise conv x test setup piperorigin revid change id , xla python add a test for the xla client backend piperorigin revid
118,statusor bool algebraicsimplifiervisitor swapconvoperands if reverse dimensions empty tf assign or return kernel kernel reverse dimensions tf assign or return hloinstruction new convolution kernel input feature group count 1 swapped window swapped dnums precision config tf assign or return hloinstruction new convolution kernel input feature group count 1 batch group count 1 swapped window swapped dnums precision config convolution setupderivedinstruction new convolution tf return if error replaceinstruction convolution new convolution ,hlo creation utils api change to allow passing batch group count piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
119,current search curwin w cursor end pos if lt pos visual end pos forward dec cursor else if visual active lt pos curwin w cursor visual else if visual active lt pos curwin w cursor visual forward curwin w cursor pos put the cursor on the start of the match visual active true visual mode 'v' ,patch gn does not select the matched string problem gn does not select the matched string solution move the cursor to the start of the match , patch problem when using a terminal window is a bit slow solution add a test for the gui
120,from future import print function import time from tensorflow contrib framework python ops import variables from tensorflow core protobuf import saver pb2 from tensorflow python import summary from tensorflow python framework import ops from tensorflow python platform import tf logging as logging def evaluate once master global step variables get or create global step saver tf saver saver variables to restore or variables get variables to restore write version saver pb2 saverdef v1 saver tf saver saver variables to restore or variables get variables to restore summary writer summary io summarywriter logdir ,tf slim the latest version has write version saver pb saverdef v as default the latest tf has write version tf train saverdef v as default setting and v is more efficient than v update evaluation py update evaluation py , fix a bug in the test case piperorigin revid
121,class optimizerv2 trackable trackable return slot dict slot name def prepare self var list if var list pre build the decayed learning rate only if learning rate exists if var list and learning rate in self hyper var dtypes set var dtype base dtype for var in var list self decayed lr t for var dtype in var dtypes ,only build lr if lr exists piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
122,const char progname static row description context null static row description buf static const char username null static void fuzzer exit if username pfree void username static const char username username int fuzzerinitialize char dbname char argv 5 int fuzzerinitialize char dbname progname get progname argv 0 memorycontextinit username strdup get user name or exit progname argv 0 int fuzzerinitialize char dbname log destination 0 atexit fuzzer exit return 0 ,remove get , fix a bug in the new delegate test piperorigin revid
123,static funcentry t global functions add 2 2 fearg 1 ret first arg f add and 2 2 fearg 1 ret number f and append 2 2 fearg 2 ret number f append appendbufline 3 3 fearg 2 ret number f appendbufline appendbufline 3 3 fearg 3 ret number f appendbufline argc 0 1 0 ret number f argc argidx 0 0 0 ret number f argidx arglistid 0 2 0 ret number f arglistid ,patch wrong method argument for appendbufline problem wrong method argument for appendbufline solution use fearg , patch problem when using a terminal window is a bit slow solution add a test for the test
124,class the input is a scalar i e this is a scalar broadcast op inputmap affinemap get nloops symbolcount 0 b getcontext else inputmap affinemap get nloops symbolcount 0 inputmap affinemap get nloops symbolcount 0 b getcontext return b getaffinemaparrayattr class b getaffinedimexpr permutation index return b getaffinemaparrayattr affinemap get nloops symbolcount 0 affinemap get nloops symbolcount 0 b getcontext b getmultidimidentitymap nloops class return nullptr resize size b getaffineconstantexpr 0 return b getaffinemaparrayattr affinemap get nloops symbolcount 0 affinemap get nloops symbolcount 0 b getcontext b getmultidimidentitymap nloops ,integrate llvm at https github com llvm llvm project commit piperorigin revid change id , fix a bug in the test case piperorigin revid
125,void allocateandparseflags flag tf xla always defer compilation ops flags tf xla always defer compilation flag tf xla noresolve compile time constants ops flags tf xla noresolve compile time constants do not perform constant folding in xlacompiler compilegraph flag tf introduce floating point jitter to tensors setter for jitter tensor names ,xla bridge provide a flag not to resolve compile time constants for some models resolving constant expressions in the bridge leads to non linear slowdown piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
126,f term dumpwrite typval t argvars typval t rettv unused if buf null return term buf b term if term tl vterm null emsg job already finished return if argvars 2 v type var unknown ,patch crash when using term dumpwrite after the job finished problem crash when using term dumpwrite after the job finished solution check for a finished job and give an error message , patch problem when using a terminal window is a bit slow solution add a test for the gui
127,class test testcase parameterized testcase 'other' init ops random uniform initializer 5 0 test util run in graph and eager modes def test different params similar approximation self initializer scale layers initialized using different randomness seed random seed set random seed 12345 kernel layers randomfourierfeatures output dim 3000 kernel initializer initializer class test testcase parameterized testcase layer x t layer y k x y up to a normalization factor approx utils inner product output x1 output y1 approx utils inner product output x2 output y2 self assert all close approx approx atol 0 05 self assert all close approx approx atol 0 08 parameterized named parameters 5 0 exact gaussian stddev 5 0 ,flaky test fix for kernelized layers piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
128,def getqualifiedname namespace object max depth 2 todo mdan use breadth first search and avoid visiting modules twice if max depth for name value in namespace items iterating over a copy prevents changed size due to iteration errors it's unclear why those occur new modules may load during iteration for name value in namespace copy items if tf inspect ismodule value name in module getqualifiedname value dict object max depth 1 ,modify getqualifiedname to iterate over a copy of the namespace to avoid dictionary changed size during iteration errors piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
129,class public nullfilesystem std unique ptr readonlymemoryregion result override float val 0 stringpiece scheme host path parseuri fname scheme host path io parseuri fname scheme host path for the tests create in memory regions with float values equal to the region name if path 2 ,change path functions to operate on uris rather than paths move the uri parsing and creation functions to path h so that we don't depend on core platform from core lib io fixes https github com tensorflow tensorflow issues change , xla gpu support for the layout interface piperorigin revid change id idacdededdbdcfbcdb
130,def make concatenation tests zip path test parameters base shape 1 3 4 3 3 4 num tensors 1 2 3 4 5 6 axis 0 1 2 3 axis 0 1 2 3 3 2 1 def get shape parameters delta axis parameters axis shape parameters base shape if axis 0 axis len shape if axis len shape shape axis delta return shape ,support negative axis in concatenation piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
131,class gmm estimator estimator results self evaluate input fn input fn batch size batch size steps steps return np sum results gmm scores def weights self return checkpoint utils load variable self model dir gmm ops gmmalgorithm clusters weight def clusters self clusters checkpoint utils load variable ,use tensorflow log sum exp function which is numerically stable add some random test data that a bug change , update docstring for tf nn rnn py
132,package flatbuffers flatbufferscodec implements grpc go codec which is used to encode and decode messages var codec string flatbuffers codec implements grpc go codec which is used to encode and decode messages var codec flatbuffers type flatbufferscodec struct ,go related style fixes change id , fix a bug in the parser test for the new parser change id tested
133,std pair mlir value unsigned linalg value view if auto rangeop indexing getdefiningop cast rangeop if i sliced with a range and i sliced at this dim then i'm it if dim return make pair rangeop getresult dim return std make pair rangeop getresult dim otherwise i did not change the rank just go look for dim into my parent ,fix build for the linalg example dialect with macos piperorigin revid , xla gpu support for the hlo hlo instruction piperorigin revid change id idadedfddaccd
134,static int socket fd test int fd const struct stat st attribute unused unsigned i struct list head globallist node for i 0 i nr sockets i if shm sockets i fd fd globallist shm global objects obj fd socket list list for each node globallist struct object obj struct socketinfo si obj struct object node si obj sockinfo if si fd fd return 0 return 1 ,convert code to object cache , make the syscall page we can be a child process
135,enginecontext trtengineop getengine log warning engine creation for batch size batch size failed status store an empty engine here so we don't try to build the same engine again cache emplace engine input shapes empty context return empty context vlog 1 conversion is done ,store an empty engine in the case that dynamic engine creation fails the next time the same input shape appears we will retrieve the empty engine which tells us to not rebuild the same failing engine again , fix a bug in the test case piperorigin revid
136,static unsigned int handle sigreturn int childno static unsigned int count 0 static unsigned int last 1 if count 0 output 1 timed out n flush out the previous syscall output output 1 timed out n flush out the previous syscall output check if we're making any progress at all if shm child syscall count childno last ,restore the unconditional timed out message , make the syscall page we can be a child process
137,class object self optimization parameters get tpu embedding optimization parameters self embedding config spec self mode to tpu embedding dict self dummy table variables none def has embedding tables self return bool self table to config dict ,register gradient for in one place factor dummy variable out of tpu embedding py piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the tf nn rnn api piperorigin revid
138,class savedmodelbuilder object to build a savedmodel the first meta graph must be saved with variables subsequent meta graphs will simply be saved with their graph definitions if assets need to be saved and written or copied to disk they must be provided as part of the first meta graph to be saved subsequent meta graphs can provide a subset of the initial assets to be added to the savedmodel definition assets need to be saved and written or copied to disk they can be provided when the meta graph def is added if multiple meta graph defs are associated an asset of the same name only the first version is retained each meta graph added to the savedmodel must be annotated with tags the tags provide a means to identify the specific meta graph to load and restore along ,update comment related to assets in savedmodel change , fix a bug in the docstring of the docstring of the new api change
139,bool const hloinstruction operation on slices return false if candidate opcode operation on slices opcode if candidate opcode operation on slices opcode operation on slices shape element type candidate shape element type return false ,xla fix type mismatch of operations on slices in slice sinker pass , xla gpu support for the xla client piperorigin revid
140,import base images import project sync import request build import request coverage build import update build status def build project event context def build base images event context def coverage build event context request coverage build request coverage build event context def builds status event context update build status update status event context ,initial integration of builds status , fix a bug in the docstring of the test case piperorigin revid
141,private template typename first struct baseverifier first static bool verifytrait const instruction op return first verifytrait op template struct baseverifier template typename struct baseverifier static bool verifytrait const instruction op return false private template typename first struct first static abstractoperation operationproperties return first template struct template typename struct static abstractoperation operationproperties return 0 ,change trait verification to support older clang gcc this was resulting in an error explicit specialization of in class scope pre clang c piperorigin revid , fix a bug in the parser test piperorigin revid
142,class dense tf core layers dense layer self constraints self kernel self kernel constraint if self use bias and self bias constraint self constraints self bias self bias constraint self built true def get config self config ,tf layers delay marking a layer as built until the end of its first apply this allows the layer's call method to call add variable making it much easier to create variables while building the layer's logic change , fix a bug in the docstring of the keras model piperorigin revid
143,from future import division from future import print function import copy import re import six from tensorflow core framework import attr value pb2 from tensorflow core framework import graph pb2 def extract sub graph graph def dest nodes if not isinstance graph def graph pb2 graphdef raise typeerror graph def must be a graph pb2 graphdef proto if isinstance dest nodes six string types raise typeerror dest nodes must be a list edges keyed by the dest node name name to node map keyed by node name ,check invalid string type for dest nodes in extract sub graph bug check str type tst add unit test cln remove list check cln use warning cln indent cln raise typeerror if not list cln check string only , tf data service support for tf data dataset piperorigin revid
144,class csharpgenerator public basegenerator json formatting indented n code n if parser root struct def struct def code public static class name byte n code return struct def name getrootas struct def name new bytebuffer unpack n code n code public byte serializetobinary n code var fbb new flatbufferbuilder 0x10000 n code fbb finish struct def name pack fbb this value n code return fbb databuffer tosizedarray n code n code n n ,c add objectapi serialization utility c add objectapi serialization utility set to k rename to , fix a bug in the parser test piperorigin revid
145,class rnntest test testcase cell set weights tf weights tf out tf state sess run tf out tf state inputs x train self assertallclose tf out k out self assertallclose tf state k state self assertallclose tf out k out atol 1e 5 self assertallclose tf state k state atol 1e 5 def self with self session graph ops lib graph as sess ,part of the update of tf keras to the keras api piperorigin revid , tf data vectorization test for tf data dataset piperorigin revid
146,recursive regmatch state pim prog submatch m listids int listids char u save reginput reginput char u save regline regline intsave reglnum reglnum intsave nfa match nfa match intsave nfa listid nfa listid recursive regmatch state pim prog submatch m listids restore position in input text reginput save reginput regline save regline reglnum save reglnum if reg multi regline reg getline reglnum nfa match save nfa match nfa endp save nfa endp nfa listid save nfa listid ,updated for version problem highlighting is sometimes wrong axel bender solution fetch again when returning from recursive , patch problem when using a terminal window is a bit slow solution add a test for the gui
147,from tensorflow python framework import ops from tensorflow python framework import random seed from tensorflow python framework import sparse tensor from tensorflow python framework import tensor shape from tensorflow python framework import tensor util from tensorflow python framework import versions from tensorflow python ops import array ops from tensorflow python ops import control flow util class tensorflowtestcase googletest testcase self asserttrue self ndarraynear ndarray1 ndarray2 err msg msg def getndarray self a if a is a tensor then convert it to ndarray if isinstance a ops tensor if a is tensor like then convert it to ndarray if tensor util is tensor a if isinstance a ops eagertensorbase a a numpy else ,allow tensor like objects in otherwise tensor like objects that are not instances of tf tensor e g tf variable can't be used in array assertions piperorigin revid change id , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
148,bool recursivecompilabilitychecker iscompilablenode return false else if hasxlakernel node log error unsupported op node node debugstring absl string view uncompilable reason unsupported op maybemarkuncompilablenode uncompilable reason stack trace encapsulating function uncompilable nodes ,remove unnecessary log statements in checker piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id ibaaeabeded
149,def rename oldname newname overwrite false def delete recursively dirname with errors raise exception on not ok status as status return pywrap tensorflow deleterecursively compat as bytes dirname status def is directory dirname with errors raise exception on not ok status as status return pywrap tensorflow isdirectory compat as bytes dirname status ,adding a swig wrapper for isdirectory change , fix a bug in the docstring of the docstring of the documentation of the example
150,absl status bufferdescriptor performgetptrselector return absl okstatus absl status bufferdescriptor clcontext context result const buffer gpu buffer return if error gpu buffer this context result absl make unique buffer std move gpu buffer return absl okstatus buffer buffer cl mem buffer size t size in bytes buffer buffer size size in bytes ,removed virtual method that uses opencl api element cl context from gpuobjectdescriptor piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id idaceccfcbacfece
151,static char features static int included patches add new patch number below this line 1083 1082 ,patch problem building gvimext with vs may fail solution adjust the makefile mike williams , patch problem when using a channel to be a bit a bit slow solution add a test for the test
152,def global step sess global step tensor args sess a brain session object sess a tensorflow session object global step tensor tensor or the name of the operation that contains the global step ,fix minor typo in documentation in training util py change , fix a bug in the docstring of the docstring of the tf contrib image ops piperorigin revid
153,status loadsessionbundleorsavedmodelbundle return loadsavedmodelfromlegacysessionbundlepath session options run options export dir saved model bundle return status error code not found session bundle or savedmodel bundle not found at specified export location return status error code not found strings strcat specified file path does not appear to contain a n session bundle should have a file called export meta n or savedmodel bundle should have a file called saved model pb n specified file path export dir namespace serving ,expand error message when a valid export is not found at the specified export location in bundle shim piperorigin revid , xla python fix a bug in the graph piperorigin revid
154,bool transposer const utils mutablenodeview node if tensor fromproto value attr tensor return false int dims size dims size const int dims size dims size if tensor dims dims size return false ,update tensorflow core grappler optimizers generic layout optimizer transposer cc co authored by mihai maruseac mihai maruseac gmail com , xla gpu support for the layout inference piperorigin revid change id id idadabbfadafcd
155,status algebraicsimplifiervisitor handlemultiply hloinstruction multiply return status ok hloinstruction convert operand operand mul convert pred operand select pred operand 0 if match multiply m multiplyanyorder m op operand m convert m op convert operand withshape m shape withelementtype pred hloinstruction zero like multiply broadcastzeros computation multiply shape element type multiply shape dimensions return replacewithnewinstruction multiply hloinstruction multiply shape hloopcode kselect convert operand operand zero like multiply vlog 10 trying transform a c1 c2 a c1 c2 hloinstruction a c1 c2 if match multiply ,implement mul convert pred operand select pred operand optimization piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id iffcbbabfbaeecaeaa
156,struct converttfstridedslice public rewritepattern insert a new reshape op value original input strided slice op input rankedtensortype original input type original input gettype cast rankedtensortype original input gettype dyn cast rankedtensortype if original input type return failure const arrayref int64 t original input shape original input type getshape smallvector int64 t 4 revised shape ,fixed a bug where converttfstridedslice rewritenewaxismask assumed the strided slice input had rankedtensortype piperorigin revid change id , fix a bug in the parser api piperorigin revid change id icfcccdcbedbaacf
157,static char features static int included patches add new patch number below this line 746 745 ,patch popup clear hangs when a popup can't be closed problem popup clear hangs when a popup can't be closed solution bail out when a popup can't be closed , patch problem when using a channel to be a bit a bit slow solution add a test for the test
158,void geneagerpythonop strings strappend result p inputs var n strings strappend result var name var name as datatype enum n else if attr type list type note we ignore default values for these attrs since it is unclear how you would use it and the one use case is void geneagerpythonop strings strappend result var name inputs var conversion inputs var ctx n strings strappend result var name t as datatype enum for t in var name n ,do not create dtype objects in the eager hot path for execution use enums piperorigin revid , fix a bug in the test case piperorigin revid
159,template class class typename methodptr class public class obj ptr methodptr method ptr obj ptr obj ptr method ptr method ptr method ptr method ptr obj ptr obj ptr template typename result typename argumenttuple result perform const argumenttuple args const class private class const obj ptr the order of these members matters reversing the order can trigger warning in msvc see http computer programming forum com 7 vc net htm const methodptr method ptr class const obj ptr gtest disallow assign ,makes doublenear print the diff between the actual and the expected value when the match fails also fix bogus msvc warning about alignment of a member was sensitive to packing also bring in gtest , fix a bug in the new delegate piperorigin revid change id idacdededdbdcfbcdb
160,from six moves import xrange pylint disable redefined builtin from tensorflow contrib tpu python tpu topology import topology single core assignment 0 0 0 def compute task and cores to replicas core assignment topology task and cores to replicas ,device assignment support in tpustrategy for piperorigin revid , fix a bug in the docstring of the test piperorigin revid
161,inline void const int32 value const int32 scale 10 scaled value value scale 10 lower bound std max scaled value 1 10 0 upper bound std min scaled value 1 10 1 input size 1 upper bound std min scaled value 1 10 1 1 10 input size 1 same as above but takes int8 as input and output inline void resizebilinear const tflite resizebilinearparams op params input y 1 10 y0 input x 1 10 x0 const int64 t output 20 output 20 ll output 20 lu output 20 rl output 20 ru const int64 t round output 20 0 1 19 1 19 const int8 t interpolation static cast int8 t output 20 1 19 1 20 static cast int8 t output 20 round 1 20 output data offset output shape b y x c interpolation ,fix negative value rounding for integer resizebilinear kernel piperorigin revid change id , fix a bug in the toy tutorial piperorigin revid
162,class network base layer layer updates might contain irrelevant updates so it needs to be filtered with respect to inputs the model has been called on relevant inputs self inputs or if self inputs relevant inputs self inputs else relevant inputs for i in range 1 len self inbound nodes inputs self get input at i if isinstance inputs list class network base layer layer if context in eager mode return losses relevant inputs self inputs or if self inputs relevant inputs self inputs else relevant inputs for i in range 1 len self inbound nodes inputs self get input at i if isinstance inputs list ,fix bug with multi gpu model model inputs piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
163,google mock a framework for writing c mock classes this file implements some matchers that depend on gmock generated matchers h this file implements some matchers that depend on gmock matchers h note that tests are implemented in gmock matchers test cc rather than gmock more matchers test cc ifndef gmock include gmock more matchers h define gmock include gmock more matchers h include gmock gmock generated matchers h include gmock gmock matchers h namespace testing ,googletest export get rid of gmock generated matchers h and gmock generated matchers h pump stop using pump for matcher macroses generation piperorigin revid , fix a bug in the new delegate test piperorigin revid
164,int cxotransform frompython cxotransformnum transformnum switch transformnum case cxo transform boolean dbvalue asboolean pyobject istrue pyvalue if pyerr occurred return 1 return 0 case cxo transform binary case cxo transform fixed char ,tweaks to boolean variable improvements patch supplied by alex henrie https github com oracle python cx oracle pull , fix a bug in the documentation of the client client client
165,typedef true define bm parseexample type b k static void bm parseexample type b k int iters int64 items per iter static cast int64 b k testing userealtime testing itemsprocessed static cast int64 iters items per iter test benchmark cpu parseexample type b k run iters ,use so that we measure against wall time change , fix a bug in the new delegate piperorigin revid change id icfcccdcbedbaacf
166,class parser public parserstate opts options uses flexbuffers false source nullptr anonymous counter 0 anonymous counter 0 recurse protection counter 0 start out with the empty namespace being current empty namespace new namespace namespaces push back empty namespace class parser public parserstate bool supportsvectorofunions const namespace uniquenamespace namespace ns enum kmaxparsingdepth 64 flatbuffers checked error recurseerror template typename f checkederror recurse f f if recurse protection counter kmaxparsingdepth return recurseerror auto ce f recurse protection counter return ce public symboltable type types symboltable structdef structs class parser public parserstate std vector std pair value fielddef field stack int anonymous counter int recurse protection counter utility functions for multiple generators ,protected parser against infinite recursion will error out after e g levels of nested json tables change id tested on linux , fix a bug in the parser test that the test fails on the same case of the same value of the same value of the same value of the same value of the same value of the same value piperorigin revid
167,limitations under the license include tensorflow core framework cancellation h include tensorflow core framework dataset h include tensorflow core framework function h include tensorflow core framework function pb h include tensorflow core framework function handle cache h include tensorflow core framework function testlib h include tensorflow core framework node def pb h include tensorflow core framework op kernel h include tensorflow core framework resource mgr h include tensorflow core framework tensor h include tensorflow core framework tensor shape h include tensorflow core framework tensor testutil h include tensorflow core framework types h include tensorflow core framework types pb h include tensorflow core graph graph constructor h include tensorflow core kernels data name utils h include tensorflow core lib core status test util h ,dataset test base h remove proto h includes piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
168,vim tempname extra char keep if defined backslash in filename defined proto convert all backslashes in fname to forward slashes in place convert all backslashes in fname to forward slashes in place unless when it looks like a url void forward slash fname forward slash fname char u p if path with url fname return for p fname p nul p ifdef feat mbyte the encoding can have ' ' in the trail byte ,patch problem editing a url which netrw should handle doesn't work solution avoid changing slashes to backslashes yasuhiro matsumoto , patch problem when using a terminal window is a bit slow solution add a test for the gui
169,static char features static int included patches add new patch number below this line 1613 ,patch make tags doesn't include libvterm problem make tags doesn't include libvterm solution add the libvterm sources to the tags command , patch problem when using a channel to be a bit a bit slow solution add a test for the test
170,invalid count emsg argument required for addr return fail if parse addr type arg val int vallen addr type arg fail if parse addr type arg val int vallen addr type arg fail return fail if addr type arg addr lines argt if addr type arg addr lines argt else ,patch comparing with pointer instead of value problem comparing with pointer instead of value solution add a ken takata closes , patch problem when using a terminal window is a bit solution add a test for the test
171,class adadeltaoptimizer optimizer optimizer see m d zeiler http arxiv org abs 1212 5701 pdf http arxiv org pdf 1212 pdf init def init self learning rate 0 001 rho 0 95 epsilon 1e 8 ,remove init from docstrings change , update keras layers to the keras api piperorigin revid change id iecadcdbe
172,class datasetv2 collections abc iterable tracking base trackable next raises stopiteration when there are no more elements remaining to be generated values next generator state get iterator iterator id numpy try values structure normalize element values output signature except typeerror valueerror ,fix another issue with trailing whitespace , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
173,class xlatestcase self assertallclose expected input gradient vals flatten actual flatten rtol 1e 5 rtol 1e 4 atol 1e 6 self assertshapeequal actual inputs ,tf xla relax numeric tolerances of some tests piperorigin revid , add support for int ops piperorigin revid
174,static const unsigned int caif opts caifso link select caifso req param void caif setsockopt struct sockopt so static void caif setsockopt struct sockopt so so level sol caif so optname rand array caif opts struct netproto proto caif name caif socket caif rand socket setsockopt caif setsockopt else stub if we are built on something without caif headers void caif setsockopt struct sockopt so endif ,convert pf caif to use struct netproto for setsockopt , fix a bug in the syscall page
175,function main fuzztest1 assert testunicode assert assert echo 'flatbuffers php test completed successfully' php eol function assert assert function assert assert php needs double quote for now use fred directly js json decode file get contents 'monsterdata test json' true data file get contents 'monsterdata test mon' bb google flatbuffers bytebuffer wrap data mons mygame example monster getrootasmonster bb indirect monster new mygame example monster assert equal mons mygame example any monster mons indirect monster assert equal fred indirect monster getname class assert public function ok result message if result ,php remove duplicate test , fix a bug in the new delegate class piperorigin revid change id icfcccdcbedbaacf
176,expandfromcontext flags ew keepall if options wild silent flags ew silent if options wild noerror flags ew noerror if options wild alllinks flags ew alllinks ,patch error for bad regexp even though regexp is not used problem error for bad regexp even though regexp is not used when writing a file arseny nasokin solution ignore regexp errors closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
177,class nnapidelegatekernel std vector int nnapi to tflite op mapping void adddequantizeoperatorswhereneeded const tflitecontext context int builtin code const tflitenode node int tflite node index nnapiopbuilder builder int nnapi errno void adddequantizeoperatorswhereneeded const tflitecontext context int builtin code const tflitenode node nnapiopbuilder builder int nnapi errno tflitestatus addopsandtensors tflitecontext context int nnapi errno ,internal change piperorigin revid change id , fix a bug in the delegate of the delegate piperorigin revid
178,except from distutils extension import extension define build constants build version 8 0 0 build version 8 1 0 dev setup extra link and compile args extralinkargs ,update odpi c to development version to include patch for issue bump version to for further development , patch problem when using a terminal window is a bit solution add a test for the file
179,namespace mlir blocks each of which includes instructions class cfgfunction public function public cfgfunction location location stringref name functiontype type cfgfunction location location stringref name functiontype type arrayref namedattribute attrs cfgfunction ,add function attributes for cfgfunction and mlfunction piperorigin revid , xla gpu support for the hlo hlo instruction piperorigin revid change id idadedfddaccd
180,clear wininfo buf t buf if defined feat listcmds defined proto if defined feat listcmds defined feat terminal defined proto go to another buffer handles the result of the attention dialog ,patch job in terminal can't communicate with vim problem job in terminal can't communicate with vim solution add the terminal api , patch problem when using a terminal window is a bit slow solution add a test for the gui
181,status mlirfunction getfunctiondef tensorflow functiondef f return status ok passmanager pm func getcontext tensorflow setcrashreproducer pm tensorflow applytensorflowandcloptions pm pm addnestedpass funcop createfunctionaltoexecutordialectconversionpass pm addpass createbreakupislandspass ,add to handle pass manager setup this handles tensorflow wide configurations along with calling mlir's command line parsing and setup piperorigin revid change id , xla python fix a bug in the graph piperorigin revid
182,class controlflowtest test testcase constant op constant 5 self assertequal 0 sess run loop def testwhilecondwithcontrol 1 self with self test session v variable scope get variable v initializer init ops constant initializer 2 i0 constant op constant 0 with ops control dependencies i0 def loop condition i return i 4 def loop body i some cond control flow ops cond constant op constant true lambda state ops assign v math ops square v lambda v with ops control dependencies some cond return i 1 r control flow ops while loop loop condition loop body i0 variables global variables initializer run self assertequal 4 r eval self assertallclose 65536 0 v eval def self with self test session v variables variable 1 ,fix a bug that an erroneous control edge can be introduced when loops are nested in control dependency context piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
183,class dataset public datasetbase vlog 1 failed to get element from worker task to process address s task to process in use false status s status status s code absl strcat failed to get element from worker task to process address s error message get next cv notify all return ,tf data service include worker address in failed to get element error message piperorigin revid change id , fix a bug in the test case piperorigin revid
184,public auto loadop cast op op auto elementtype loadop getviewtype template cast linalg viewtype getelementtype auto linalg convertlinalgtype elementtype template cast llvm llvmtype getunderlyingtype getpointerto elementtype rewriter gettype llvm llvmtype elementtype linalg convertlinalgtype elementtype template cast llvm llvmtype getpointerto auto int64ty linalg convertlinalgtype rewriter getintegertype 64 auto pos rewriter arrayref int values ,add thread safe utilities to to allow constructing llvm types in a multi threaded environment the is not thread safe and directly constructing a raw llvm type can create situations where the is modified by multiple threads at the same time piperorigin revid , fix a bug in the parser parser test piperorigin revid
185,void resolvemodelflags const modelflags model flags model model this model does not define output arrays so a output arrays flag must be given on the command line for const auto input array proto model flags input arrays for auto input array proto model flags mutable input arrays auto input array model getorcreatearray input array proto name if input array proto has data type const arraydatatype specified type void resolvemodelflags const modelflags model flags model model for int i 0 i input array dims size i check eq input array dims i input array proto shape dims i else for int i 0 i input array shape dimensions count i input array proto mutable shape add dims input array shape dims i ,during late import update model flags from the input arrays shape information that was read from the graph e g shape attribute in placeholder nodes piperorigin revid , add a test for the tf data optimizer piperorigin revid
186,class topologyconstructiontest keras parameterized testcase fn outputs fn input a np input b np self assertlistequal x shape for x in fn outputs 10 64 10 5 def test multi output layer output names self inp keras layers input name shape none dtype dtypes float32 class multioutput keras layers layer def call self x return x 1 x 2 out multioutput name 'out' inp model keras models model inp out self assertequal 'out' 'out 1' model output names self assertallclose 2 3 model 1 test util run deprecated v1 def test recursion self with self cached session ,make network output names and model output names unique previously layers with multiple outputs would each use the same layer name which threw off the savedmodel code when it tried to put them in a dictionary fixes piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
187,static char features static int included patches add new patch number below this line 242 ,updated for version problem cannot use setreg to add text that includes a nul solution make setreg accept a list , patch problem when using a channel to be a bit a bit slow solution add a test for the test
188,gen expand wildcards vim free p when returning fail the array must be freed here if retval fail ga clear ga num file ga ga len file ga ga data null char u ga ga data char u file ga ga data null char u ga ga data char u no matches recursive false ,patch possible memory leak when file expansion fails problem possible memory leak when file expansion fails solution clear the grow array when returning fail use an error message instead of an empty string , patch problem when using a terminal window is a bit slow solution add a test for the gui
189,def conv2d shape op if stride b 1 or stride d 1 raise valueerror current implementation does not yet support strides in the batch and depth dimensions if stride r stride c todo add support for this raise valueerror current implementation only supports equal length strides in the row and column dimensions todo mrry raise an error if the stride would cause information in the input to be ignored this will require a change in the kernel implementation stride stride r padding op get attr padding out rows out cols get2d conv output size in rows in cols filter rows filter cols stride stride padding in rows in cols filter rows filter cols stride r stride c padding output shape batch size out rows out cols depth out if data format nchw ,allow non rectangular strides for convd change , tf data dataset dataset to tf data dataset piperorigin revid
190,do map maptype arg mode abbrev if did it retval 2 no match else if keys ctrl c if ctrl c has been unmapped reuse it for interrupting mapped ctrl c false if map table curbuf b maphash curbuf b mapped ctrl c mode else mapped ctrl c mode goto theend do map maptype arg mode abbrev if ctrl c has been mapped don't always use it for interrupting if keys ctrl c mapped ctrl c true if map table curbuf b maphash curbuf b mapped ctrl c mode else mapped ctrl c mode mp m keys vim strsave keys mp m str vim strsave rhs ,updated for version problem having ctrl c interrupt or not does not check the mode of the mapping ingo karkat solution use a bitmask with the map mode christian brabandt , patch problem when using a terminal window doesn't work solution add a test for the command line
191,ex function eap exarg t eap char u theline inti intj intc intsaved did emsg ex function eap arg vim strsave arg if arg null goto erret check for duplicate argument name for i 0 i newargs ga len i if strcmp char u newargs ga data i arg 0 emsg2 e853 duplicate argument name s arg goto erret char u newargs ga data newargs ga len arg p c newargs ga len ,updated for version problem a duplicated function argument gives an internal error solution give a proper error message based on patch by tyru , patch problem when using a terminal window is a bit slow solution add a test for the command line
192,using absl strcat namespace status buildnodemap const graph graph std unordered map string node node map for auto node graph op nodes ,trt minor improvements , xla gpu support for the hlo computation piperorigin revid change id iebdeaedebeebedaa
193,set one cmd context xp buff xp xp pattern arg break case cmd setfiletype case cmd ownsyntax xp xp context expand ownsyntax xp xp pattern arg break case cmd setfiletype xp xp context expand filetype xp xp pattern arg break ,add completion for ownsyntax and improve completion for filetype dominique pelle , patch problem when using a terminal window is a bit slow solution add a test for the command line
194,class tensorflowestimator baseestimator y vector or matrix n samples or n samples n outputs can be iterator that returns array of targets the training target values class label in classification real numbers in regression returns returns self return self fit x y ,added returns comment to partial fit , fix a bug in the docstring of the docstring of the documentation of the example to the new api change
195,class batchnormalizationbase layer self axis axis else raise typeerror 'axis must be int or list type given s' type self axis type axis self momentum momentum self epsilon epsilon self center center ,exposing the correct exception in batchnormalization init piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
196,ins bs revins on endif curwin w cursor col mincol curwin w cursor lnum insstart orig lnum curwin w cursor col insstart orig col can bs bs curwin w cursor lnum insstart orig lnum curwin w cursor col insstart orig col did backspace true ,patch no 'backspace' value allows ignoring the insertion point problem no 'backspace' value allows ignoring the insertion point solution add the and values christian brabandt closes , patch problem when using a popup window with a terminal window solution add the cursor to the current buffer when the cursor is set
197,limitations under the license include mlir dialect scf passes h from llvm project include mlir dialect scf transforms h from llvm project include mlir ir builders h from llvm project include mlir ir dialect h from llvm project include mlir pass pass h from llvm project include mlir pass passmanager h from llvm project include mlir transforms h from llvm project namespace class lowertonvvmpass public mlir passwrapper lowertonvvmpass mlir operationpass mlir gpu gpumoduleop void getdependentdialects mlir dialectregistry registry const override registry insert mlir nvvm nvvmdialect mlir llvm llvmdialect public void runonoperation override mlir gpu gpumoduleop m getoperation ,refactor kernel gen opt cc and remove dependency on global dialect registration nfc piperorigin revid change id , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
198,limitations under the license include tensorflow lite micro test helpers h include tensorflow lite micro testing micro test h if defined xtensa todo b per b at this time all the test cases fail for the hifimini tf lite micro tests begin tf lite micro tests end else namespace tflite namespace testing namespace tf lite micro test tflite testing tolerance int16 tf lite micro tests end endif ,have make test pass for xtensa hifimini with this change the following command succeeds make f tensorflow lite micro tools make makefile target xtensa optimized kernel dir xtensa target arch hifimini xtensa core rg test related bugs http b http b comment , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
199,class tpubackend xla client backend options self client compile options device assignment def get default device assignment self num replicas return self client num replicas def serialize self executable return self client serializeexecutable executable ,xla python expose getdefaultdeviceassignment python binding this is necessary to replicate values that will eventually be passed to a compiled executable without doing compilation piperorigin revid change id , xla python fix a bug in the test piperorigin revid
200,void mergehostplanes xspace space mergeplanes python tracer plane host plane sortxlinesby host plane xlinescomparatorbyname note removeplanewithname might invalidate plane pointers so do these at the last step if cupti driver api plane removeplanewithname space kcuptidriverapiplanename ,remove outdated comments piperorigin revid change id , tf data service support for tf data service piperorigin revid change id idaceccfcbacfece
201,class gpukerneltoblobpass mlir stringattr get blob string getcontext return forward the error by attaching the message to the gpu module gpu module emiterror blob or status error message return signalpassfailure ,retire the use of same shape annotations in kernel generator piperorigin revid change id , xla gpu support for the hlo hlo client piperorigin revid change id idadedfddaccd
202,tensorflow status updatetfe contextwithserverdef std move server grpc server worker env worker session std move remote eager workers std move remote device mgr remote workers context id r device mgr keep alive secs worker session cluster flr std move remote mgr worker session cluster flr get std move remote mgr note we start the server after all other initialization because the grpcserver cannot be destroyed after it is started ,automated rollback of commit piperorigin revid , xla python add a test for the xla client client piperorigin revid
203,if sys platform in win32 cygwin define the list of files to be included as documentation for bdist rpm docfiles readme txt license txt samples test note on hp ux itanium with oracle 10g you need to add the library ttsh10 to the list of libraries along with clntsh since i am unable to test i'll leave this as a comment until someone can verify when this is required without making other cases where sys platform hp stop working setup extra link and compile args extralinkargs extracompileargs dbuild version s build version ,remove obsolete comment , fix a bug in the file
204,tflitestatus prepare tflitecontext context tflitenode node data type ktfliteint8 tf lite ensure eq context output type data type tf lite ensure eq context filter type data type filter in depthwiseconv is expected to be 1 h w o tf lite ensure eq context sizeofdimension filter 0 1 if hasbias bias getinput context node kbiastensor ,add a check on the th dimension of filter for depthwiseconv piperorigin revid , add support for int int piperorigin revid
205,attribute parser parseattribute type type auto type getelementtype auto values parsedenseelementsattr type isa vectortype if values return nullptr sanity check auto indices gettype ,fix omitted return post failed parse piperorigin revid , add a new method to the dialect to the dialect of the dialect piperorigin revid change id ifcabdcdffbdfaaf
206,ifndef gmock include gmock gmock generated actions h define gmock include gmock gmock generated actions h include memory include utility include gmock gmock actions h class callback get args private const linked ptr callback const std shared ptr callback an internal macro for extracting the type of a tuple field it's ,googletest export remove linked ptr and use std shared ptr instead piperorigin revid , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
207,status runrestore const runoptions run options const string export dir const string variables index path io joinpath variables directory metafilename ksavedmodelvariablesfilename if env default fileexists variables index path ok return errors notfound checkpoint index file not found in savedmodel directory log info the specified savedmodel has no variables no checkpoints were restored return status ok const string variables path io joinpath variables directory ksavedmodelvariablesfilename ,update savedmodel c loader to allow graphs without variables change , fix a bug in the test case piperorigin revid
208,absl flat hash set string getknownxlawhitelistop statelessrandomnormal statelessrandomuniform statelessrandomuniformint statelessrandomuniformfullint statelesstruncatednormal statelesswhile svd ,modifies tf random stateless uniform to support unbounded int sampling when minval maxval none adds a op to support this piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id idaceccfcbacfece
209,class ganestimator estimator estimator model fn model fn model dir model dir config config def use check shapes real data return isinstance real data ops tensor def gan model fn features labels def make gan model generator fn discriminator fn real data real data generator inputs generator scope generator scope check shapes use check shapes real data check shapes false if add summaries if not isinstance add summaries tuple list add summaries add summaries ,remove real data shape check in ganestimator fixes github issue piperorigin revid , update docstring for tf nn rnn softmax py
210,void appendtomessage tensorflow status status args args for propagating errors when calling a function define tf return if error do const tensorflow status status va args tensorflow status status va args if tf predict false status ok return status while 0 ,update the tf return if error macro to let the compiler move the result piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id ieffeabbcfbfbfadcee
211,statusor mlir operation hlofunctionimporter importinstruction if dimensions are non default the xla builder it as a separate transpose noattributecase kreshape reshapeop noattributecase krsqrt rsqrtop noattributecase kselect selectop noattributecase ksubtract subop noattributecase ktanh tanhop ,add xla hlo rsqrt operator and import support piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
212,bool environment issupported calculationsprecision precision const std vector tensorstoragetype environment getsupportedtexturestorages const std vector tensorstoragetype storage types tensorstoragetype texture 2d if device supportstexturearray storage types push back tensorstoragetype texture array if device isadreno device supportsimagebuffer storage types push back tensorstoragetype image buffer return storage types std vector tensorstoragetype environment getsupportedstorages const std vector tensorstoragetype storage types tensorstoragetype texture 2d tensorstoragetype buffer ,using convtexture for buffer intermediate tensors piperorigin revid , fix a bug in the parser delegate piperorigin revid
213,def get dnn model hidden units target predictor fn return dnn estimator def get rnn model rnn size target predictor fn cell type 'gru' def get rnn model rnn size cell type target predictor fn def rnn estimator x y if cell type 'rnn' cell fn rnn cell basicrnncell ,and , fix a bug in the docstring of the docstring of the docstring change
214,checkforcmd for i 0 cmd i nul i if char u cmd i pp i break if i len isalpha pp i if i len isalpha pp i pp i ' ' pp skipwhite pp i return true ,patch to f is recognized at modifier problem to f is recognized at modifier solution do not recognize when follows closes , fix a bug in the new delegate test piperorigin revid
215,from tensorflow python framework import ops from tensorflow python framework import test util from tensorflow python ops import gen math ops from tensorflow python ops import math ops from tensorflow python ops proto ops import decode proto from tensorflow python platform import googletest from tensorflow python platform import test from tensorflow python platform import tf logging class test util tensorflowtestcase str trace math reduce sum math add name none x math abs x y y axis 3 proto val tensortracer proto trace decode proto proto val message type field float32 self assertin io decode proto bytes proto str trace finally clean up dispatch global dispatchers original global dispatchers ,fix the exporting of tf io decode proto and tf io encode proto so that they correctly trigger dispatching note although this changes the api def pbtxt files to change how exporting happens the actual exported apis should not changed piperorigin revid change id , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
216,def moments x axes shift none name none keep dims false shift shift keep dims keep dims name name return normalize moments counts m ss v ss shift name name with ops control dependencies counts m ss v ss return normalize moments counts m ss v ss shift name name def batch normalization x ,fixing bug in which negative were produced due to order of operations change , fix a bug in the docstring of the test case piperorigin revid
217,test gpumultistream basics options untuple result true tf assert ok and assign auto out buffers executable execute in buffer0 get in buffer1 get options executable execute in buffer0 get in buffer1 get options tf assert ok and assign auto out literal out buffers 0 toliteral tf assert ok and assign auto out literal out buffers 0 0 toliteral literaltestutil expectr1equal int32 expected outputs out literal tf assert ok and assign out literal out buffers 1 toliteral tf assert ok and assign out literal out buffers 0 1 toliteral literaltestutil expectr1equal int32 expected outputs out literal ,cleanup pjrtexecutable api regroup execute api into distinct execute methods rename local devices to addressable devices introduce struct to name replica and partition to replace std pair return span instead of const vector piperorigin revid change id , fix a bug in the delegate piperorigin revid
218,class public linearalgebraop scalar bool fast register linalg op matrixsolvels float float register linalg op matrixsolvels double double register linalg op float float register linalg op double double namespace tensorflow ,add support for complex in matrix solve ls op split into separate files for each data type to speed up build piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id ifeacdbedbfaeef
219,pybind11 module xla extension m py module ops m def submodule ops xla operations ops def afterall afterall ops def allreduce static cast xlaop xlaop const xlacomputation absl span const replicagroup const absl optional channelhandle allreduce ops def allreduce static cast xlaop xlaop const xlacomputation absl span const replicagroup const absl optional channelhandle const absl optional shape allreduce ops def alltoall alltoall ops def collectivepermute collectivepermute ops def createtoken createtoken ,add optional layout constraints for allreduce piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id iefecfafdafabefecbd
220,py object tfe py executecancelable wrapper static py object tf listphysicaldevices tensorflow safe tf statusptr status tensorflow make safe tf newstatus std vector string devices tensorflow status s tensorflow devicefactory listallphysicaldevices devices mayberaiseregisteredfromstatus s tensorflow set tf status from status status get s if s ok return py none pyobject result pylist new devices size int i 0 for auto dev devices ,throw error when tf listphysicaldevices fails piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring of the test py
221,from tensorflow python framework import ops from tensorflow python framework import test util from tensorflow python ops import array ops from tensorflow python ops import init ops from tensorflow python ops import math ops from tensorflow python ops import resource variable ops from tensorflow python ops import variable scope from tensorflow python ops import variables class resourcevariableopstest test util tensorflowtestcase v assign 2 0 eval self assertequal 2 0 v value eval def testtofromproto self with self test session v resource variable ops resourcevariable 1 0 variables global variables initializer run w resource variable ops resourcevariable from proto v to proto self assertequals 2 math ops add w 1 eval def self with self test session v resource variable ops resourcevariable 1 0 ,fix bug in resource variable to from proto change , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
222,class tensorutiltest tf test testcase self assertequals np int64 a dtype self assertallclose np array 10 20 30 dtype np int64 a def self for dtype in tf qint32 tf quint8 tf qint8 test with array t tensor util make tensor proto 10 20 30 dtype dtype self assertequals dtype t dtype self assertprotoequals dim size 3 t tensor shape self assertequals 10 t int val 0 self assertequals 20 t int val 1 self assertequals 30 t int val 2 def teststring self t tensor util make tensor proto foo self assertprotoequals ,added quantized type testing to tensor creation change , fix a bug in the test case piperorigin revid
223,typedef eigen gpudevice gpudevice template typename t struct biasgpu static void compute const gpudevice d const t input const t bias t output int32 batch int32 height int32 width int32 depth int32 channel tensorformat data format t output int32 batch int32 height int32 width int32 depth int32 channel tensorformat data format template typename t ,fix experimental clang format check failure signed off by yong tang yong tang github outlook com , fix a bug in the test case piperorigin revid
224,struct rtl critical section define has exceptions 1 endif has exceptions define gtest has exceptions has exceptions elif defined clang exceptions determines if are enabled in obj c files there can be for objc exceptions but c exceptions might still be disabled so use a has feature check for c exceptions instead define gtest has exceptions has feature cxx exceptions elif defined gnuc exceptions gcc defines exceptions to 1 iff exceptions are enabled define gtest has exceptions 1 ,fix build of objective c files with new clang versions , fix a bug in the parser test piperorigin revid
225,from future import division from future import print function import textwrap import threading import gast from tensorflow python autograph pyct import inspect utils from tensorflow python util import tf inspect parse lock threading lock prevents linecache concurrency errors standard preamble textwrap dedent try with parse lock source tf inspect getsource no unwrap entity source inspect utils entity except ioerror oserror as e raise valueerror 'unable to locate the source code of note that functions defined' ,patch the use of inspect with an accompanying update which seems to resolve the issue of incorrect source code being resolved when running from a compressed file piperorigin revid , tf data service support for tf data dataset piperorigin revid
226,class scalarcomputationstest public clientlibrarytestbase xla test f scalarcomputationstest computationbuilder builder client testname builder constantr0 float 2 1f computeandcomparer0 float builder 2 1f error spec xla test f scalarcomputationstest computationbuilder builder client testname builder neg builder constantr0 float 2 1f ,xla add some scalar tests piperorigin revid , xla python fix a bug in the test piperorigin revid
227,see the license for the specific language governing permissions and limitations under the license include client h include tensorflow contrib kernels client h namespace tensorflow std string host int port std string fs name std string user name const string host int port const string fs name const string user name fs name fs name user name user name client extendedtcpclient host port true ,update after review of , add a test for the new op op piperorigin revid
228,static void error const std string err bool usage bool show exe name defaults json output fields whose value is the default when n writing json n no prefix don 't prefix enum values with the enum type in c n gen includes deprecated instead use n gen includes deprecated this is the default behavior n if the original behavior is required no include n statements use no includes n no includes don 't generate include statements for included n schemas the generated file depends on c n gen mutable generate accessors that can mutate buffers in place n ,clarified the use of the deprecated flatc gen includes flag also removed the flag from the android makefile tested verified flatc builds successfully on linux and regenerated the docs change id , fix a bug in the new code
229,list equal l1 l2 ic return item1 null item2 null if defined feat python defined feat mzscheme defined proto if defined feat ruby defined feat python defined feat mzscheme defined proto return the dictitem that an entry in a hashtable points to ,updated for version problem ruby eval doesn't understand vim types solution add the vim to ruby function george , patch problem when using a terminal window is a bit solution add a test for the current buffer
230,static struct pymethoddef append 1 append data to vim buffer mark 1 return row col representing position of named mark range 1 return a range object which represents the part of the given buffer between line numbers s and e if py version hex dir bufferdir 4 list its attributes endif null null 0 null ,updated for version problem python does not have members solution add name and number in another way lilydjwg , patch problem when using a terminal window is a bit slow solution add a test for the gui
231,def build sequence input features a tensor of dtype float32 and shape batch size padded length this will be used as input to an rnn features features copy features update layers transform features features list sequence feature columns list context feature columns or sequence input layers sequence input from feature columns columns to tensors features feature columns sequence feature columns ,do not update given dictionary in feature column public utils change , fix a bug in the docstring of the docstring of the docstring change
232,void intraprocessrendezvous sameworkerrecvdone statuscallback done do a quick copy sharing the underlying buffer if both tensors are on host memory const bool src host send args alloc attrs on host parsed src type cpu const bool dst host recv args alloc attrs on host parsed dst type cpu const bool src host send args alloc attrs on host parsed src type cpu const bool dst host recv args alloc attrs on host parsed dst type cpu if src host dst host out in done status ok ,improved code formatting , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
233,bool const windowdimension window dimension window dimension base dilation 1 bool const window window for const auto dim window dimensions if dim size dim stride return true return false int64 dilatedbound int64 bound int64 dilation check ge bound 0 check ge dilation 1 ,add an utility function , add a new method to the new delegate piperorigin revid
234,static void phonet rand socket struct socket triplet st st type sock seqpacket static void phonet setsockopt struct sockopt so so level sol pnpipe struct netproto proto phonet name phonet socket phonet rand socket setsockopt phonet setsockopt ,convert pf phonet to use struct netproto for setsockopt , make the syscall page we can be a child process
235,class cannotduplicate public traitbase concretetype cannotduplicate coefficient wise binary operation with implicit broadcasting support for example tf sub operation template typename concretetype class cwisebinary public traitbase concretetype cwisebinary namespace tf namespace optrait namespace mlir ,mlir tf hoist cwise binary op out of concat piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id icccbcbdbcfaadbee
236,add termcap entry char u name int force if termp bt string null found it key termcap2key name 0 name 1 termp while termp bt entry int ks name if int termp bt entry key ,patch virtual replace test fails on ms windows problem virtual replace test fails on ms windows solution make adding a termcap entry work for a builtin terminal restore terminal keys in a better way , patch problem when using a terminal window is a bit slow solution add a test for the gui
237,limitations under the license include tensorflow lite allocation h include tensorflow lite c common h include tensorflow lite core api profiler h include tensorflow lite core macros h include tensorflow lite delegates nnapi nnapi delegate h include tensorflow lite experimental resource resource base h include tensorflow lite memory planner h ,bring back overflow detection with dummy expect implementation for windows automated g rollback of changelist piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
238,include linux phonet h include stdlib h include net h include random h void gen phonet unsigned long addr unsigned long addrlen void gen phonet unsigned long addr unsigned long addrlen addr unsigned long pn addrlen sizeof struct sockaddr pn void phonet rand socket struct proto type pt pt protocol 0 if rand bool pt type sock dgram else pt type sock seqpacket ,phonet move random socket generation into per protocol files , proto zmalloc conversion
239,author 'oracle' version '2 0' the full version including alpha beta rc tags release '2 0 0 rc 2' release '2 0' the theme to use for html pages html theme 'oracle' ,added initial page to document debugging levels , fix a bug in the new module of the new module of the new module and the new module is not used in the new class class and the new class class and the new class is not used in the same class piperorigin revid
240,std string const sliceattributes attr code r int linear index gid z params dst size y int gid y params dst size x int gid x int linear index gid z params dst size y int gid y params dst size x int gid x 2 dst buffer linear index value ,ios metal delegate fixed slice operation and tests piperorigin revid , fix a bug in the graph piperorigin revid
241,status layoutassignment hlocomputation computation and the computation result the latter two are specified in computation layout so we only need to keep the existing layouts for infeeds clearing the layouts here avoids hiding potential bugs in the layout assignment pass that may use the existing layout layout assignment pass that may accidentally use the existing layout for hloinstruction instruction computation instructions if instruction opcode hloopcode kbitcast bitcasts are inherently layout sensitive and so a bitcast instruction ,fix typo accidently accidentally , xla gpu support for xla hlo client piperorigin revid change id idaceccfcbacfece
242,namespace boost static cast t rhs r component 2 static cast t rhs r component 3 static cast t rhs r component 4 ,spurious semicolon removed to quiet warnings svn r , fix a bug in the parser test for the new code svn r
243,limitations under the license include tensorflow compiler xla service hlo verifier h include tensorflow compiler xla service indexed array analysis h include tensorflow compiler xla service llvm ir llvm util h include tensorflow compiler xla service logistic expander h include tensorflow compiler xla service map inliner h include tensorflow compiler xla service reshape mover h include tensorflow compiler xla service rng bit generator expander h status cpucompiler runhlopassesthroughlayoutassn rewrite training op true rewrite inference op true rewrite grad op true pipeline addpass logisticexpander expansion type logisticexpansiontype kexp pipeline addpass dynamicpadder pipeline addpass scatterexpander pipeline addpass hlogetdimensionsizerewriter ,xla add to cpu and gpu xla pipelines piperorigin revid change id , xla gpu support for the xla client client piperorigin revid change id icbbdbfafcdfcae
244,const std unordered map string node nodeclass node new std unordered map string node nodeclass keep in same order as nodeclass values ref class switch nc switch ref class switchn nc switch ref class merge nc merge ref class enter nc enter ref class exit nc exit ,adds a lowering from case to switchn merge introduces a new n way switchn op kernel i usages of the grappler and graph variants of and and believe the corrections in this cl are correct piperorigin revid , add a test for the graph and the graph piperorigin revid
245,template unsigned n typename real real cardinal b spline double prime real x static assert std is integral real value cardinal b splines do not work with integer types static assert n 3 static assert n 3 n 3 for second derivatives of cardinal b splines is required if x 0 ,fix static assert with no message on c , fix a bug in the parser test piperorigin revid
246,setattr np arrays ndarray ' sub ' wrap subtract setattr np arrays ndarray ' ' wrap subtract true setattr np arrays ndarray ' mul ' wrap multiply setattr np arrays ndarray ' rmul ' wrap multiply true setattr np arrays ndarray ' matmul ' wrap matmul setattr np arrays ndarray ' ' wrap matmul true setattr np arrays ndarray ' pow ' wrap power setattr np arrays ndarray ' rpow ' wrap power true setattr np arrays ndarray ' truediv ' wrap true divide setattr np arrays ndarray ' rtruediv ' wrap true divide true setattr np arrays ndarray ' matmul ' wrap matmul def comparison tf fun x1 x2 cast bool to int false ,tf numpy adds method to ndarray piperorigin revid change id , tf data service support for tf data experimental piperorigin revid
247,limitations under the license include tensorflow core framework api def pb h include tensorflow core framework attr value pb h include tensorflow core framework op h include tensorflow core framework op def pb text h include tensorflow core framework op def pb h include tensorflow core framework op def pb text h include tensorflow core framework op def util h include tensorflow core framework op gen lib h include tensorflow core framework tensor pb text h include tensorflow core framework tensor pb h include tensorflow core framework tensor pb text h include tensorflow core framework tensor shape pb h include tensorflow core framework types h include tensorflow core framework types pb h ,update include order of the header files in python op gen internal cc to conform to experimental clang format check signed off by yong tang yong tang github outlook com , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
248,insert sign if buf b signlist null redraw buf later buf not valid changed cline bef curs changed line abv curs first sign in signlist buf if buf b signlist null redraw buf later buf not valid changed cline bef curs changed line abv curs return lnum buf delete signs buf t buf char u group if buf b signlist null curwin null redraw buf later buf not valid changed cline bef curs changed line abv curs lastp buf b signlist ,patch cursor position is wrong after sign column changes problem cursor position is wrong after sign column appears or disappears yegappan lakshmanan solution call changed line instead of changed bef , patch problem when using a terminal window is a bit solution add a few more tests to the new code
249,limitations under the license include tensorflow core lib math math util h include tensorflow core lib random simple philox h if defined tensorflow use custom contraction kernel include tensorflow core kernels eigen contraction kernel h endif namespace tensorflow namespace sdca ,enable tensorflow custom contraction kernels support piperorigin revid , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
250,class resourcevariableopstest test util tensorflowtestcase true print sess run abc def self constraint lambda x x v resource variable ops resourcevariable initial value lambda 1 constraint constraint self assertequal v constraint constraint constraint 0 with self assertraises valueerror v resource variable ops resourcevariable initial value lambda 1 constraint constraint def testinitfn self with self test session v resource variable ops resourcevariable initial value lambda 1 ,add constraint argument post update projection function to all variable constructors piperorigin revid , fix a bug in the test case piperorigin revid
251,class rmsprop optimizer v2 optimizerv2 mean square t rho mean square t 1 1 rho gradient 2 mom t momentum mom t 1 learning rate gradient sqrt mean square t epsilon variable t variable t 1 mom t variable t variable t 1 mom t this implementation of rmsprop uses plain momentum not nesterov momentum class rmsprop optimizer v2 optimizerv2 mean square t rho mean square t 1 1 rho gradient 2 mom t momentum mom t 1 learning rate gradient sqrt mean square t mean grad t 2 epsilon variable t variable t 1 mom t variable t variable t 1 mom t references see pdf ,add trailing add trailing , fix a bug in the docstring of the keras model piperorigin revid
252,limitations under the license include absl memory memory h include absl types any h include absl types optional h include tensorflow lite delegates gpu common data type h include tensorflow lite delegates gpu common shape h include tensorflow lite delegates gpu common status h using valueid uint32 t using uint32 t used to emulate quantized behavior struct quantizationparams float min 0 float max 0 float scale 0 connects tensor's producer and operation that depends on this tensor template typename tensort struct value struct value const valueid id tensortype tensor absl optional quantizationparams quant params struct operation ,adds to add quantizeanddequantize nodes in gpu graph piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
253,void tfe deleteprofiler tfe profiler profiler delete profiler void tfe profilerserializetostring tfe context ctx tfe profiler profiler tf buffer buf tf status status tfe contextasyncwait ctx status if status status ok return if tf getcode status tf ok return string content status status profiler profiler serializetostring content void data tensorflow port malloc content length ,tf getcode instead of status status ok this removes some uses of internal fields of tf status once these are all removed tf status can be forward declared by the c api and we can split out the tf status into its own header and make it opaque to all users piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id icffcefaccdfceeb
254,include stdlib h include sys socket h old irda h is broken include linux irda h include net h include maps h page rand ,fix broken includes in we get errors like usr include linux netlink h error expected specifier qualifier list before family t' , move the dtrace proto to the dtrace process to the dtrace process to the dtrace process to be used in the dtrace process and dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
255,class categoryencoding base preprocessing layer combinerpreprocessinglayer max value math ops reduce max inputs min value math ops reduce min inputs condition math ops logical and math ops greater equal math ops greater math ops cast out depth max value dtype max value math ops greater equal min value math ops cast 0 min value dtype ,make sure categoryencoding raises an error with input values equal or greater to max tokens piperorigin revid change id , fix a bug in the test case piperorigin revid
256,static int dpivar setfrombytes dpivar var uint32 t pos const char value bytes length valuelength if valuelength 0 memcpy bytes ptr value valuelength if var actuallength32 var actuallength32 pos valuelength else if var actuallength16 var actuallength16 pos uint16 t valuelength if var type sizeinbytes 0 if var actuallength32 var actuallength32 pos valuelength else if var actuallength16 var actuallength16 pos uint16 t valuelength if var returncode var returncode pos 0 ,do not change the actual length for fixed length types or error ora invalid length inside variable character string can occur , fix a bug in the new version of the client client client
257,class tfapichangespec ast edits apichangespec tf compat v1 debugging assert rank at least tf debugging assert rank in tf compat v1 debugging assert rank in tf errors exception type from error code tf compat v1 errors exception type from error code tf errors error code from exception type tf compat v1 errors error code from exception type tf errors raise exception on not ok status tf compat v1 errors raise exception on not ok status tf assert rank tf compat v1 assert rank tf nn max pool ,remove deprecated error handling symbols from v also remove most uses of raise exception on not ok status piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
258,tflitestatus parseopdata const operator op builtinoperator op type case builtinoperator transpose case builtinoperator pow case builtinoperator logical or case builtinoperator logical and case builtinoperator logical not break return ktfliteok ,add logical and and logical not to schema piperorigin revid , add support for int int piperorigin revid
259,class hlomoduleconfig return fusion config const std vector std vector int64 dot config const return dot config std vector std vector int64 mutable dot config return dot config private if you add new members be sure to update compilation cache key class hlomoduleconfig fusionconfigcollection koff std vector std vector bool fusion config std vector std vector int64 dot config namespace xla ,add dot configuration as part of module configuration piperorigin revid change id , xla gpu support for the xla client piperorigin revid change id idaceccfcbacfece
260,void optimizedatasetop makedataset opkernelcontext ctx datasetbase input string job name port jobname the map that stores the experiment names and for how much percentage of the jobs the experiments will be randomly turned on this is currently empty we have no live experiments yet clang format off absl flat hash map string uint64 live experiments disable intra op parallelism 1 disable intra op parallelism 0 clang format on auto hash func const string str return hash64 str optimizations selectoptimizations job name live experiments optimizations enabled ,tf data temporarily disabling experiment pending issue investigation piperorigin revid change id , tf data vectorization optimization to use the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
261,to avoid conditional compilation everywhere we make it gmock port responsibility to include the header implementing tr1 tuple if defined gnuc gcc implements tr1 tuple in the tr1 tuple header this does not conform to the tr1 spec which requires the header to be tuple if defined gnuc gtest gcc ver 40000 gtest gcc ver is defined in gtest port h and 40000 corresponds to version 4 0 0 gcc 4 0 implements tr1 tuple in the tr1 tuple header this does not conform to the tr1 spec which requires the header to be tuple include tr1 tuple else if the compiler is not gcc we assume the user is using a if the compiler is not gcc 4 0 we assume the user is using a spec conforming tr1 implementation include tuple endif gnuc ,fixes tr path when compiled with gcc version by zhanyong wan , patch problem when using a terminal window is a bit solution add a test for the file
262,osstacktracegetterinterface unittestimpl os stack trace getter returns the most specific testresult currently running testresult unittestimpl current test result if current test info nullptr if current test info null return current test info result if current test case nullptr if current test case null return current test case ad hoc test result return ad hoc test result ,use null instead of nullptr for pre c builds , fix a bug in the new parser test piperorigin revid
263,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2019 11 1 forward compatibility horizon datetime date 2019 11 2 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
264,status tensorslicereader gettensor default return errors unimplemented data type not supported undef reader copy if success return errors notfound name not found in checkpoint file ,code cleanup add a missing undef in tensor slice reader change , tf data vectorization to use tf data dataset piperorigin revid
265,class model network network batch size none validation split 0 shuffle false repeat true repeat false allow partial batch false runs validation checks on input and target data passed by the user ,don't repeat the dataset in keras ds evaluate switch repeat to false by default in distribution standardize user data function as this may be confusing to users piperorigin revid , update keras layers to keras piperorigin revid
266,blacklist tensorflow contrib framework checkpoint ops testdata tensorflow contrib bayesflow reinforce simple example tensorflow contrib bayesflow examples reinforce simple reinforce simple example py pylint disable line too long tensorflow contrib signal test util tensorflow contrib timeseries examples predict tensorflow contrib timeseries examples multivariate tensorflow contrib timeseries examples known anomaly ,tf signal fix pip tests by including test util in signal py piperorigin revid , tf data service support for tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
267,void dump pid slots void printf slot d d n i shm pids i int pid is valid pid t pid static pid t pidmax int read pid max void pid t pidmax unsigned long result char end buf 32 file fp int rc fp fopen proc sys kernel pid max r if fp perror fopen return 1 rc 1 if fgets buf sizeof buf fp goto out result buf end 10 if end buf goto out pidmax result rc 0 out fclose fp return rc fixme read this from proc sys kernel pid max on startup void pids init void if read pid max ifdef x86 64 pidmax 4194304 pidmax 4194304 else pidmax 32768 pidmax 32768 endif printf couldn't read pid max from proc n printf using pid max d n pidmax int pid is valid pid t pid if pid pidmax pid 1 output 0 sanity check failed found pid d n pid return false ,read pid max from proc i was hitting this on my system where it's so fix the todo and read it from proc i left a fallback to the hardcoded values in case proc is not mounted or something else goes wrong , make the syscall page we can be a child process
268,class inverseprovidingfactor instantiate args tensors list of tensors of shape batch size n represents either a layer's inputs or its output's gradients has bias bool if true assume this factor is for the layer's inputs and append '1' to each row the tensor argument is either a tensor of input activations or a tensor of output pre activation gradients self has bias has bias ,multi support for tf contrib kfac fisher blocks piperorigin revid , xla python fix a bug in the test piperorigin revid
269,def confusion matrix predictions labels num classes none name scope name returns a l x l matrix the confusion matrix where l in the number of a k x k matrix the confusion matrix where k is the number of possible labels in the classification task raises ,fix small typo in contrib metrics confusion matrix docs and use fix small typo in contrib metrics confusion matrix docs and use less confusing variable fix small typo in contrib metrics confusion matrix docs and use less confusing variable , fix a bug in the docstring of the keras model piperorigin revid
270,struct fusedbatchnorm cpudevice t x rest by depth mean reshape one by depth broadcast bcast spec if is training variance x centered square sum reduce dims rest size inv variance device d x centered square sum reduce dims rest size inv batch var device d variance rest size adjust saved var device d variance else ,make the evaluation of variance multithreaded in fusedbatchnorm change , fix a bug in the toy tutorial piperorigin revid
271,limitations under the license include tensorflow lite c common h include tensorflow lite micro all ops resolver h include tensorflow lite micro kernels kernel runner h include tensorflow lite micro kernels micro ops h include tensorflow lite micro micro utils h include tensorflow lite micro test helpers h include tensorflow lite micro testing micro test h ,removed unused header that was failing internal checks , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
272,class public xlaopkernel void compile xlaopkernelcontext ctx ctx setoutput 0 xla replicaid ctx builder ctx setoutput 0 xla convertelementtype xla replicaid ctx builder xla s32 register xla op name xlareplicaid ,tfxla convert the result of xla replicaid to s piperorigin revid change id , xla gpu support for xla cpu piperorigin revid change id iffcbbabfbaeecaeaa
273,class factorykeycreator static inline memory format get desired format int channel bool is 2d true memory format fmt desired memory format any if port testcpufeature port cpufeature fmt desired is 2d memory format memory format else if port testcpufeature port cpufeature avx2 channel 8 0 fmt desired is 2d memory format nchw8c memory format ncdhw no avx2 support for 3d yet else fmt desired is 2d memory format nchw memory format ncdhw return fmt desired class public mklprimitive public explicit const memory from const memory to ,removed an unoptimized code in mkl util h , fix a bug in the file in the file
274,void generate const char name bool use regular nms int main printf s n license printf this file is generated see n printf tensorflow lite micro kernels detection postprocess test readme printf tensorflow lite micro kernels detection postprocess test printf readme md n printf n printf include ,tflu correct name of readme file change readme to readme md , fix a bug in the new code of the new code
275,def subscribe new tensor side effects control cache consumer op update input index out pylint disable protected access for consumer op in update control input consumer op control inputs remove tensor op pylint disable protected access consumer op control inputs append out op pylint disable protected access consumer op recompute node def pylint disable protected access if an op has more than one output and two or more of its output tensors are at the same time we remove the control dependency from the original op only once and we add the dependencies to all the new pylint disable protected access if tensor op in consumer op control inputs consumer op control inputs remove tensor op consumer op control inputs append out op consumer op recompute node def pylint enable protected access return out ,correctly handle subscriptions of multiple outputs of the same op piperorigin revid , fix a bug in the documentation of the test case piperorigin revid
276,class mkldnndata set function for data buffer of user memory primitive inline void setusrmemdatahandle void data buffer inline void setusrmemdatahandle void data buffer check notnull user memory check notnull data buffer return user memory set data handle data buffer user memory set data handle data buffer set function for data buffer of user memory primitive ,should return void , fix a bug in the new delegate piperorigin revid change id icccbcbdbcfaadbee
277,struct bool dump snapshots string filenamefor const hlomodule module string view suffix return strformat module s module unique id suffix void string view filename string view contents const opts if opts dumping to stdout static auto module id to step number guarded by mu namespace string filenamefor const hlomodule module string view suffix return strformat module s module unique id suffix void const hlomodule module string view suffix string view contents filenamefor module suffix contents ,add the xla flags xla gpu ptx code to allow specifing the ptx code to use , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
278,static funcentry t global functions ifdef feat gui test scrollbar 3 3 fearg 2 f test scrollbar endif ifdef feat mouse test setmouse 2 2 0 f test setmouse endif test settime 1 1 fearg 1 f test settime ifdef feat timers timer info 0 1 fearg 1 f timer info f has typval t argvars typval t rettv mksession endif modify fname ifdef feat mouse mouse endif ifdef feat mouseshape mouseshape endif ,patch mouse support not always available problem mouse support not always available solution enable mouse support also in tiny version do not define feat mouse xterm on ms windows didn't really work , patch problem when using a terminal window is a bit slow solution add a test for the test
279,limitations under the license namespace tflite namespace impl namespace struct tflitequantizationdeleter tflitestatus subgraph modifygraphwithdelegate tflitedelegate delegate return status namespace impl namespace tflite ,moves interpreter interpreterbuilder and subgraph to tflite impl namespace piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
280,define ad endif ifndef offsetof define offsetof type member size t type 0 member endif define syscall nr offsetof struct seccomp data nr define arch nr offsetof struct seccomp data arch ,minor move offsetof into trinity h move it there since it's of generic use somewhere in future else as well signed off by daniel borkmann dborkman redhat com , fix a bug in the new module of the new module piperorigin revid change id iaaeaebbe
281,def replica device setter ps tasks 0 ps device job ps than overriding them cluster clusterdef proto or clusterspec ps ops list of strings representing operation types that need to be placed on ps devices if none defaults to variable variablev2 varhandleop placed on ps devices if none defaults to standard ps ops ps strategy a callable invoked for every ps operation i e matched by ps ops that takes the operation and returns the ps task index to use if none defaults to a round robin strategy across all ps def replica device setter ps tasks 0 ps device job ps if ps ops is none todo sherrym variables in the local variables collection should not be placed in the parameter server ps ops variable variablev2 varhandleop ps ops list standard ps ops if not merge devices logging warning ,change the default ps ops to standard ps ops piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
282,from future import absolute import from future import division from future import print function import six pylint disable unused import from tensorflow core framework import device attributes pb2 from tensorflow python import pywrap tensorflow ,remove unnecessary imports in some python files change , fix a bug in the test case piperorigin revid
283,bool recursivecompilabilitychecker iscompilablecall functionlibraryruntime handle handle status status call def lib runtime handle status status call def lib runtime handle if status ok vlog 2 rejecting call def debugstring could not instantiate status ,fix a few c lint errors piperorigin revid , xla gpu support for xla cpu piperorigin revid
284,class grapplertest public testing test return tensor creates a random tensor with given shape using setrandom template datatype dtype tensor const tensorshape shape const typedef typename enumtodatatype dtype type t tensor tensor dtype shape tensor flat t setrandom return tensor get a constant tensor with given shape template datatype dtype tensor ,update tf fusedmatmul to support bf element type updated fusedmatmul op definition in tensorflow op registry to always support bf regardless of build piperorigin revid change id , xla python fix a bug in the graph piperorigin revid
285,free buffer buf t buf b changedtick uses an item in buf t remove it now dictitem remove buf b vars dictitem t buf b ct di unref var dict buf b vars remove listeners buf endif ifdef feat lua lua buffer free buf free buffer buf t buf ifdef feat job channel vim free buf b prompt text free callback buf b prompt callback free callback buf b prompt interrupt endif buf hashtab remove buf ,patch various memory leaks reported by asan problem various memory leaks reported by asan solution free the memory ozaki kiichi closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
286,static unsigned long get interesting value int i i rand 10 i rand 20 switch i 32 bit ,increase the random range so we use all the switch cases , make the syscall page we can be a child process
287,test f constantfoldingtest output a ops const s withopname a 1 0f 1 output b ops const s withopname b 2 0f 1 output c ops addn s withopname c a b output c ops addn s withopname c withdevice cpu 0 a b output d ops addn s withopname d b c grappleritem item test f constantfoldingtest const nodedef new c output node 0 expect eq constantfolding c new c name expect eq const new c op expect eq cpu 0 new c device const nodedef new a output node 1 expect eq a new a name test f constantfoldingtest const nodedef new d output node 4 expect eq d new d name expect eq constantfolding c new d input 1 expect eq new d device std vector string fetch a b c d auto tensors expected evaluatenodes item graph fetch ,preserve node placement when folding constants piperorigin revid , fix a bug in the test case piperorigin revid
288,status algebraicsimplifiervisitor handleadd hloinstruction add match lhs m multiply m op c m op a match rhs m multiplyanyorder m op is c m op b shapeutil elementisintegral add shape c options enable floats are real c return replacewithnewinstruction add hloinstruction createbinary add shape hloopcode kmultiply status algebraicsimplifiervisitor handlemultiply hloinstruction multiply return status ok hloinstruction abs operand if lhs rhs match lhs m abs m op abs operand shapeutil elementiscomplex abs operand shape tf return if error multiply replaceoperandwith 0 abs operand tf return if error multiply replaceoperandwith 1 abs operand changed true return status ok hloinstruction convert operand operand mul convert pred operand select pred operand 0 ,xla convert abs a abs a to a a and add an option to allow for numerically unsafe algebraic simplifications piperorigin revid change id , xla gpu support for xla cpu piperorigin revid
289,try except nameerror pass try del python except nameerror pass try del compiler except nameerror ,automated rollback of commit piperorigin revid , fix a bug in the docstring of the docstring of the new api change
290,class placed on each underlying device class paralleldevice public explicit paralleldevice const std vector std string devices eager async execution is only supported when remote eager is not in use b explicit paralleldevice const std vector std string devices const bool is async false paralleldevice ,support async execution in when remote eager is not in use piperorigin revid change id , xla python python gpu support to be enabled piperorigin revid change id idedeaebfbbdabebae
291,get func tv return ret define flen fixed 40 return true if p starts with sid or s only works if eval fname script returned non zero for p eval fname sid char u p use fname buf flen fixed 1 when it fits otherwise allocate memory slow static char u char u fname trans sid char u name char u fname buf char u tofree int error ,patch some instructions not yet tested problem some instructions not yet tested solution disassemble more instructions move tests to a new file compile call to s function , patch problem when using a terminal window is a bit solution add a test for the file
292,get job options typval t tv jobopt t opt int supported int supported2 break opt jo cwd get tv string buf chk item opt jo cwd buf if opt jo cwd null mch isdir opt jo cwd mch access char opt jo cwd x ok 0 ifndef win32 win32 directories don't have the concept of executable mch access char opt jo cwd x ok 0 endif emsg2 e invargval cwd return fail ,patch can't build in ms windows problem can't build in ms windows solution put mch access call inside ifdef , patch problem when using a channel to be a bit a bit slow solution add a test for the test
293,trtengineop trtengineop opkernelconstruction context errors invalidargument failed to parse segment graphdef return serialized segment resize 0 vlog 1 size of serialized graphdef serialized segment capacity string tmp swap with temporary empty string to deallocate the cpu memory serialized segment swap tmp vlog 1 constructing name string precision string enginecontext trtengineop getengine trtuniqueptrtype nvinfer1 raw static engine runtime is safe to delete after engine creation serialized segment clear vlog 1 size of serialized trt engine serialized segment capacity string tmp swap with temporary empty string to deallocate the cpu memory serialized segment swap tmp if max batch size batch size return empty context ,really cleanup the serialized graphdef engine when it's content is consumed a simple test show that this saves mb memory for a trt converted model piperorigin revid , add support for int int piperorigin revid
294,from future import division from future import print function from collections import namedtuple import types import gast class calltreetransformer transformer base def function is compilable self target entity todo mdan this is just a placeholder implement return not isinstance target entity types builtinfunctiontype return not inspect utils isbuiltin target entity def should compile self node fqn ,adding autograph built in function checker piperorigin revid , tf data service support for tf data dataset piperorigin revid
295,export class demodataprovider implements dataprovider getdefaulttensor run string callback tensorname string void return the first tensor as the default tensor callback this projectorconfig embeddings 0 tensorname retrievetensor run string tensorname string callback ds dataset void let embedding this getembeddinginfo tensorname ,error gracefully when a read from a checkpoint fails e g due to missing tensor slices also let the user continue working e g selecting another tensor prefer tensors that are not auto generated by tf e g adagrad change , fix a bug in the documentation of the new version of the default of the default value of the default value of the same value of the same value piperorigin revid
296,int get random fd void unsigned int i unsigned int fd 0 retry i rand 2 if i 0 fd fds rand fd idx if i 1 switch i case 0 retry fd fds rand fd idx retry if we hit stdin stdout logfile if fd fds 0 goto retry break case 1 fd socket fds rand socks retry if we hit stdin stdout logfile if fd fds 0 goto retry break return fd ,only do fd avoiding for file fd's not sockets , make the syscall page we can be a child process
297,tf library header dir tf library library dir returns preprocessor defines in c header file for line in open path r readlines for line in io open path r encoding utf 8 readlines match re match define s d name line if match return match group 1 ,read header files as utf the latest version of tensorrt for x has unicode characters in the h header file which is used to determine the tensorrt version , fix a bug in the test case piperorigin revid
298,class tpurunconfigtest test testcase 'computation shape elements can only be' tpu config lib tpuconfig computation shape 1 3 1 def test fail with invalid shards self with self assertraisesregexp valueerror 'shards can not be evenly distributed across' tpu config lib tpuconfig num shards 6 computation shape 1 1 2 class tpurunconfigmastertest test testcase ,tpuestimator automatically detect the tpu system information including topology for model parallelism piperorigin revid , tf data saveable shape inference for tf data dataset piperorigin revid
299,class public opkernel context parseprotounlimited learner config learner config str errors invalidargument unable to parse learner config config prediction vector size learner config multi class strategy learnerconfig tree per class num classes 1 num classes bool reduce dim op requires ok context context getattr reduce dim reduce dim prediction vector size reduce dim num classes 1 num classes only finalized trees learner config growing mode learner config whole tree ,adding tree per class multiclass strategy handling piperorigin revid , fix a bug in the new delegate piperorigin revid
300,from future import division from future import print function from tensorflow python eager import backprop from tensorflow python eager import context from tensorflow python eager import def function from tensorflow python framework import constant op from tensorflow python framework import dtypes from tensorflow python platform import test class deffunctiontest test testcase def self def function function experimental compile false def outer a b c return a inner b c c def function function experimental compile true def inner b c return b c b i1 constant op constant 1 0 2 0 3 0 4 0 5 0 i2 constant op constant 1 0 2 0 3 0 4 0 5 0 i3 constant op constant 1 0 2 0 3 0 4 0 5 0 with context collect graphs optimized true as graphs outer i1 i2 i3 self assertin ' n op for n in graphs 0 node def testbasic self def fn x a ,tf xla auto cluster tf function experimental compile true all nodes inside are known to be compilable piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
301,limitations under the license include tensorflow c eager parallel device parallel device h include array include tensorflow c c api h include tensorflow c c api experimental h include tensorflow c eager c api h ,fix compile error due to std array const char by including appropriate header piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
302,class inlinebijectortest test testcase forward fn math ops exp inverse fn math ops log inverse log det jacobian fn lambda y math ops reduce sum math ops log y reduction indices 1 lambda y math ops reduce sum pylint disable g long lambda math ops log y reduction indices 1 forward log det jacobian fn lambda x math ops reduce sum x reduction indices 1 name exp class affinebijectortest test testcase return itertools chain from iterable itertools combinations s r for r in range len s 1 with self test session for args in scale params items for args in scale params items with self test session args dict args scale args dict x x args ,distributions move behavior into subclasses change , fix a bug in the docstring of the test case piperorigin revid
303,stdmethodimp cshellext invokesinglegvim hwnd hparent closehandle pi hprocess closehandle pi theend free cmdstrw return noerror ,patch a few compiler warnings problem a few compiler warnings solution add type casts mike williams , patch problem when using a terminal window is a bit slow solution add a test for the gui
304,executablebuildoptions executablebuildoptions set num replicas return this executablebuildoptions executablebuildoptions set num partitions int num partitions num partitions num partitions return this string executablebuildoptions tostring const string result layout nullopt if result layout set ,add num partitions to various xla configurations and pipe everything through piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
305,int child process void int ret 0 unsigned int syscallnr unsigned int cpu unsigned int childno find pid slot pid disable coredumps retry if syscalls syscallnr entry flags ni syscall goto retry if we get here syscallnr is finally valid shm syscallno childno syscallnr if syscallcount if shm execcount syscallcount shm exit now true printf d reached maximum syscall count ld n getpid shm execcount printf d reached maximum syscall count ld n pid shm execcount ret mkcall syscallnr ret mkcall childno reenable coredumps ,move the syscall number arguments into per child structs in the shm this is necessary for future work where one sanitise routine depends on the result from another , make the watchdog process to the syscall process
306,class matmulop public xlaopkernel op requires ctx a shape dim size first index b shape dim size second index errors invalidargument matrix size compatible in 0 a shape debugstring in 1 b shape debugstring errors invalidargument matrix size incompatible in 0 a shape debugstring in 1 b shape debugstring xla xlaop a ctx input 0 xla xlaop b ctx input 1 ,tf xla enable more tf python tests for xla gpu additionally increase tolerances in the flaky multi worker callback test py assertions fix typo in matmul assertions piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id ibaaeabeded
307,limitations under the license include tensorflow compiler xla service gpu amdgpu compiler h include tensorflow compiler xla service algebraic simplifier h include tensorflow compiler xla service gpu cudnn conv padding legalization h include tensorflow compiler xla service gpu cudnn conv rewriter h include tensorflow compiler xla service gpu gpu conv padding legalization h todo gmail com add gpu conv algorithm picker after its pr merged include tensorflow compiler xla service gpu gpu layout assignment h include tensorflow compiler xla service gpu llvm gpu backend gpu backend lib h ,rename from cudnn conv padding legalization to gpu conv padding legalization , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
308,static boost math cstdfloat detail float t max boost noexcept return boost cstdfloat float128 max static boost math cstdfloat detail float t lowest boost noexcept return max boost static constexpr int digits 113 boost static constexpr int digits10 34 boost static constexpr int digits10 33 boost static constexpr int max digits10 36 boost static constexpr bool is signed true boost static constexpr bool is integer false ,fix digit count for bit types as per discussion here http www com bits are not enough for digit accuracy comment page comment , patch problem when using a popup window with a popup window solution add the cursor to the cursor when the cursor is set
309,static char features static int included patches add new patch number below this line 1189 ,patch vim line continuation in lambda doesn't always work problem vim line continuation in lambda doesn't always work solution do not use a local evalarg unless there isn't one closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
310,class layer trackable trackable self layers layer clear losses property def metrics self return self metrics self gather children attribute 'metrics' doc controls for subclass implementers def add metric self value aggregation none name none adds metric tensor to the layer class layer trackable trackable def gather children attribute self attribute assert attribute in 'weights' 'trainable weights' 'non trainable weights' 'losses' 'losses' 'metrics' if hasattr self ' layers' nested layers trackable layer utils filter empty layer containers ,fix get layer nested layer metrics piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
311,copyright 2015 google inc all rights reserved licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license you may obtain a copy of the license at http www apache org licenses license 2 0 unless required by applicable law or agreed to in writing software distributed under the license is distributed on an as is basis without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license import random from sklearn import datasets cross validation metrics import tensorflow as tf ,added license header to examples , fix a bug in the new module of the dtrace hdl is not used in the dtrace hdl piperorigin revid change id ibcaccabdeabcbbeae
312,void populatehlotolhloconversionpattern hlotolhloopconverter mhlo absop hlotolhloopconverter mhlo addop hlotolhloopconverter mhlo andop hlotolhloopconverter mhlo atan2op hlotolhloopconverter mhlo broadcastindimop hlotolhloopconverter mhlo ceilop hlotolhloopconverter mhlo compareop ,mlir kernelgen lower tf acos to lmhlo add ranked code generation for mhlo compare select add bufferization for tensor cast add lowerings for atanop piperorigin revid change id , xla gpu support for the hlo ir piperorigin revid change id iebdeaedebeebedaa
313,class featurecolumn collections namedtuple input tensor self normalized input tensor columns to tensors self name columns to tensors self math ops to float input tensor pylint disable unused argument def to dnn input layer self input tensor weight collections none trainable true output rank 2 return reshape real valued tensor self to dense tensor input tensor output rank self name def to dense tensor self input tensor if not self is sparse return input tensor ,add support for to sequence input from feature columns piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
314,f getcompletion typval t argvars typval t rettv type tv get string argvars 1 if argvars 2 v type var unknown filtered tv get number chk argvars 2 null filtered tv get bool chk argvars 2 null if p wic options wild icase ,patch vim cannot use true with getcompletion problem vim cannot use true with getcompletion solution use tv get bool chk closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
315,static void check children void memset fdstr 0 sizeof fdstr if check if fd callno i true sprintf fdstr fd ld shm a1 i if int callno 1 output 0 watchdog callno was 1 wtf n shm exit reason exit reached count else if check if fd callno i true sprintf fdstr fd ld shm a1 i output 0 watchdog pid d hasn't made progress in 30 seconds last ld now ld diff d stuck in syscall d s s s sending sigkill n ,sanity check to catch a rare segv , fix a bug in the watchdog process
316,llvm ir elementgenerator elementaliremitter makeelementgenerator operand to generator const irarray index target index return operand to generator at hlo operand 0 target index sourceindexoftranspose hlo shape hlo operand 0 shape hlo dimensions b hlo shape hlo operand 0 shape hlo dimensions case hloopcode kpad return this hlo operand to generator ,handle bitcast indexing better we may not need to recompute the linear index if we already have one also do some code cleanup in ir array cc piperorigin revid change id , xla gpu support for xla hlo ir piperorigin revid change id idadedfddaccd
317,class multilabelhead head lib head pylint disable protected access train op train op fn regularized training loss else raise valueerror 'train op fn and optimizer cannot both be none ' train op head lib append update ops train op pylint disable protected access only summarize mean loss for sum reduction to preserve backwards compatibility otherwise skip it to avoid unnecessary computation if self loss reduction losses reduction sum ,adds update ops to train op for all heads piperorigin revid , fix a bug in the docstring of the docstring of the keras model piperorigin revid
318,static char features static int included patches add new patch number below this line 1713 1712 ,patch terminal debugger doesn't handle arguments problem terminal debugger doesn't handle arguments solution use f args and pass all the arguments to gdb e g the core file or process number suggested by christian brabandt disallow starting the debugger twice , patch problem when using a channel to be a bit a bit slow solution add a test for the test
319,status env recursivelycreatedir const string dirname tf return if error getfilesystemforfile dirname fs std vector stringpiece sub dirs stringpiece remaining dir dirname while fs fileexists remaining dir tostring while fs fileexists remaining dir tostring remaining dir empty basename returns for ending dirs if remaining dir ends with sub dirs push back io basename remaining dir ,fixes the issue when recursivelycreatedir hangs when the input is the empty string change , fix a bug in the test piperorigin revid
320,if name main dtypes np float32 np float64 np complex64 np complex128 not compute uv for dtype in dtypes mat shapes 10 11 11 10 11 11 mat shapes 10 11 11 10 11 11 2 2 2 3 if not full matrices or not compute uv mat shapes 5 11 11 5 for mat shape in mat shapes ,fix svd gradient bug on batches of matrices fix a newly introduced bug in dealing with a gradient of svd applied to a batch of matrices s is a batch of vectors not matrices so we should use shape to get the batch shape piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
321,barycentric rational imp real barycentric rational imp start x template class real barycentric rational imp real barycentric rational imp std vector real x std vector real y size t approximation order m x std move x m y std move y barycentric rational imp real barycentric rational imp std vector real x std vector real y size t approximation order m x std move x m y std move y boost assert msg m x size m y size there must be the same number of abscissas and ordinates boost assert msg approximation order m x size approximation order must be data length ,use m x std move x rather than m x std move x , fix a bug in the new parser test svn r
322,tflitestatus parseopdata const operator op builtinoperator op type case builtinoperator topk v2 case builtinoperator transpose case builtinoperator pow case builtinoperator logical or break return ktfliteok ,add logical or to schema piperorigin revid , add support for int int piperorigin revid
323,void set tf status from status tf status tf status returns a status from tf status tensorflow status statusfromtf status const tf status tf status namespace internal struct tf void operator tf status tf status const tf deletestatus tf status namespace internal using tf statusptr std unique ptr tf status internal tf namespace tensorflow endif tensorflow c tf status helper h ,export tfe tensorhandletonumpy in pywrap tensor h so that in case be used in python binding for unified api piperorigin revid change id , fix a bug in the graph piperorigin revid
324,namespace optimize operations in functions struct optimize public passwrapper optimize functionpass void getdependentdialects dialectregistry registry const final registry insert void runonfunction override ,introduce opt test utility and remove static registration this is part of an effort to remove entirely the global constructor registration in favor of explicit registry in order to get more build dependencies piperorigin revid change id , fix a bug in the graph piperorigin revid
325,class test testcase result output eval self assertallequal 0 1 1 result exported keys tensor exported values tensor table export self assertitemsequal b brain b salad b surgery exported keys tensor eval self assertitemsequal 0 1 2 exported values tensor eval def self with self test session default val 1 ,implement exporting the keys values in a hash table piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
326,class fusionmerger public hlomodulepass absl string view name const override return fusion merger statusor bool run hlomodule module override static double return 1 0 namespace gpu ,automated rollback of commit piperorigin revid , xla gpu support for the hlo client piperorigin revid change id id iaaeabfdfedfeacedf
327,host name port service name server type instance name commonly just the host name and service name are needed e g localhost orclpdb or localhost xe e g localhost orclpdb1 or localhost xe if using a tnsnames ora file the file can be in a default location such as oracle home network admin tnsnames ora or except nameerror default main user pythondemo default edition user pythoneditions default edition name python e1 default connect string localhost orclpdb default connect string localhost orclpdb1 dictionary containing all parameters these are acquired as needed by the methods below which should be used instead of consulting this dictionary ,use most recent default connect string in tutorial , fix a bug in the docstring of the test case piperorigin revid
328,def as indexed slices list inputs optimize true def add n inputs name none adds all input tensors element wise converts indexedslices objects into dense tensors prior to adding args inputs a list of tensor or indexedslices objects each with same shape and type def add n inputs name none if len inputs 1 if isinstance inputs 0 ops indexedslices values inputs 0 values values ops convert to tensor inputs 0 else values inputs 0 if name ,make add n handle a single indexedslices argument properly , fix a bug in the docstring of the test case piperorigin revid
329,def checkoraclehome directorytocheck return false try to determine the oracle home oraclehome os environ get oracle home if oraclehome is not none if not checkoraclehome oraclehome os environ get oracle home if is not none if not checkoraclehome oracle home s does not refer to an 9i 10g or 11g installation raise distutilssetuperror oraclehome raise distutilssetuperror else for path in os environ path split os pathsep if checkoraclehome path ,avoid overwriting the oracle home value with none by the method that determines if a valid oracle home has been specified , update the version of the version of the version of the version of the client client
330,while dpy event dpy event 1 server parse messages if endcond 0 break ,patch problem remote expr hangs ramel solution check for messages in the waiting loop , patch problem when using a terminal window doesn't work solution add a test for the job
331,class optimizedatasettest test base datasettestbase parameterized testcase options dataset ops options expected optimizations map and batch fusion map parallelization noop elimination shuffle and repeat fusion ,tf data turning map off by default until an performance regression is resolved piperorigin revid , fix a bug in the graph piperorigin revid
332,register addn cpu variant if google cuda define register addn gpu type register addn type gpu tf call gpu number types register addn gpu tf call int64 register addn gpu tf call complex64 register addn gpu tf call complex128 register addn gpu tf call variant register addn gpu ,register int version of addn on gpu piperorigin revid , xla gpu support for the layout of the layout piperorigin revid
333,class hloevaluator public dfshlovisitorwithdefault const auto shape instruction shape const auto operand instruction operand 0 todo b b add dcheck back once implicit broadcast is removed if shapeutil samedimensions shape operand shape return unimplemented implicit broadcasting is currently unsupported in hlo evaluator shape mismatch s vs s shapeutil humanstring shape shapeutil humanstring operand shape return unimplemented shape mismatch s vs s shapeutil humanstring shape shapeutil humanstring operand shape literal result shape ,xla fix todos in hlo evaluator remove todos that say add dcheck back because we've moved away from d check in xla piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id iffcbbabfbaeecaeaa
334,status directsession run const namedtensorlist inputs args rendezvous run state rendez args cancellation manager cancellation manager args runner this executor args closure c schedclosure c log info step args step id is for handle run state args handle vlog 1 step args step id is for handle run state args handle for const auto item executors and keys items item executor runasync args barrier get ,reduce log output for each step in direct session added previously from log info to vlog change , tf data service support for tf data experimental piperorigin revid
335,win line if cul screenline cul attr hl attr hlf cul line attr cul attr ifdef feat signs combine the and sign highlighting depending on the sign priority if sign present sattr sat linehl 0 if sattr sat priority 100 line attr hl combine attr cul attr line attr else line attr hl combine attr line attr cul attr else endif line attr cul attr wp w last cursorline wp w cursor lnum else ,patch cursorline highlighting always sign highlighting problem cursorline highlighting always sign highlighting solution combine the highlighting use the priority to decide how closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
336,static char features static int included patches add new patch number below this line 2390 ,patch test is old style fix not tested problem test is old style fix not tested solution turn test into a new style test add tests for the fix in patch yegappan lakshmanan closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
337,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 11 27 forward compatibility horizon datetime date 2020 11 28 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
338,halfpage int flag linenr t prenum if curwin w topfill 0 i 1 n curwin w topfill else ,patch removed more than dead code problem removed more than dead code solution put back the decrement , patch problem when using a terminal window is a bit slow solution add a test for the gui
339,int child process void cpu set t set pid t pid getpid int ret 0 int ret unsigned int syscallnr unsigned int cpu unsigned int childno find pid slot pid int child process void if extrafork false init child sigsetjmp ret jump 1 ret 0 while shm exit now false while shm regenerating true ,try the 'jump back to the child handler when the alarm goes thing again a number of things have changed since i disabled this so things may be good enough to reenable this feature which should speed things up a little , fix a bug in the watchdog page
340,op insert oap count1 the user may have moved the cursor before inserting something try to adjust the block for that if oap start lnum curbuf b op start lnum if oap start lnum curbuf b op start lnum bd is max if oap op type op insert oap start col curbuf b op start col ,updated for version problem append in visual mode with is wrong solution after don't use the code that checks if the cursor was moved hirohito higashi ken takata , fix a bug in the parser delegate piperorigin revid
341,uint32 const device cap n fp32 cores 64 n tc cores 8 break case 8 if device cap compute capability minor 6 n fp32 cores 128 else n fp32 cores 64 n tc cores 4 break default log error invalid gpu compute capability break ,add cuda compute capability to profiler hardware type utils , fix a bug in the new delegate piperorigin revid
342,static char features static int included patches add new patch number below this line 1793 1792 ,patch not consistently giving the is a directory warning problem not consistently giving the is a directory warning solution adjust check for illegal file name and directory yasuhiro matsumoto closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
343,class cudnnconvolutionalgorithmpicker public hlopassinterface statusor std tuple int64 bool int64 pickbestalgorithm cudnnconvkind kind const shape input shape const shape filter shape const shape output shape const window window const convolutiondimensionnumbers dnums hloinstruction instr const convolutiondimensionnumbers dnums int64 feature group count hloinstruction instr se streamexecutor stream exec never null devicememoryallocator allocator may be null ,call cudnn also for grouped convolutions cudnn supports grouped convolutions so we don't need the pass and can instead set the group count parameter on the cudnn custom calls piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id id icfecdffaddccbded
344,struct gpudevice scalar output' rhs' matrix' ' stands for transpose upper lower needs to be swapped for this lower fill upper fill upper lower fill upper fill lower trans adjoint operation conjugate transpose operation none auto solver absl make unique context ,rocm fix for a bug in the rocm implementation for matrix triangular solve op , fix a bug in the graph piperorigin revid
345,args done if ret 0 red sptr sprintf sptr d ret if errno saved 0 if errno saved 0 sptr sprintf sptr s strerror errno saved white shm failures ,only decode errno for negative , fix a bug in the watchdog process
346,from future import absolute import from future import division from future import print function import tensorflow as tf import tensorflow compat v1 as tf from tensorflow python framework import test util from tensorflow python platform import test as test lib ,makes converter script test explicitly use compat v piperorigin revid change id , fix a bug in the test case piperorigin revid
347,std vector tblgen appliedconstraint tblgen pattern getconstraints const std vector std string entities entities reserve daginit arg size for auto argname daginit for auto argname daginit if argname printfatalerror def getloc operands to additional constraints can only be symbol references entities push back argname getvalue ret emplace back cast llvm definit daginit getdef daginit std move entities ,fix segfault when no symbol is given to an constraint operand this fixed the segfault when we see the following pattern pat piperorigin revid , xla gpu support for the hlo evaluator piperorigin revid change id icabdabcccecababba
348,public final class tensor implements autocloseable private static int datatype datatype switch datatype case uint8 return 1 case float case int32 return 4 ,java bugfix handle uint correctly in change , fix a bug in the parser test piperorigin revid
349,main loop cmdwin noexmode oparg toa operator arguments volatile int previous got int false got int was true ifdef feat conceal linenr tconceal old cursor line 0 linenr tconceal new cursor line 0 update lines false these are static to avoid a compiler warning static linenr tconceal old cursor line 0 static linenr tconceal new cursor line 0 static update lines false endif if defined feat x11 defined feat xclipboard ,patch problem compiler complains about uninitialized variable and clobbered variables solution add initialization make variables static , patch problem when using a terminal window is a bit slow solution add a test for the gui
350,class tensorboardwsgiapp object try graph self multiplexer graph run except valueerror return http util respond request not found' code 404 return http util respond request not found' 'text plain charset utf 8' code 404 limit attr size request args get attr size' none if limit attr size is not none class tensorboardwsgiapp object try run metadata self multiplexer runmetadata run tag except valueerror return http util respond request not found' code 404 return http util respond request not found' 'text plain charset utf 8' code 404 return http util respond request str run metadata 'text x protobuf' pbtxt ,set content type in application py when responding with change , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid change id iffafdbbcddfebbeac
351,gui mch draw string use to make characters fit as we expect even when the font uses different widths e g bold character is wider clen gui char width if c 0x10000 wlen 2 gui char width wlen 1 0 else wlen 1 gui char width cells i utfc ptr2len len text i len i ,patch problem on ms windows when not use type directx drawing emoji will be broken solution fix usage of yasuhiro matsumoto , patch problem when using a terminal window is a bit slow solution add a test for the gui
352,statusor std unique ptr shapedbuffer executable executeonstreamwrapper statusor std unique ptr shapedbuffer return value executeonstream run options arguments profile ptr get tf return if error return value status if profile nullptr vlog 1 enqueueing 'stop and blocking host until done ,check for errors returned by executeonstream before calling blockhostuntildone if executeonstream fails blockhostuntildone will also fail in a way that makes debugging much harder relnotes n a piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
353,export interface scatterplot highlightpoints pointindexes number highlightstroke index number string favorlabels index number boolean void toggle between day and night modes setdaynightmode isnight boolean void show hide tick labels showticklabels show boolean void whether to show axes or not ,bring back night mode in the projector via filter invert css rules change , fix a bug in the docstring of the new module piperorigin revid
354,cpubackendcontext cpubackendcontext ruy context new ruy context gemmlowp context new gemmlowp gemmcontext setmaxnumthreads kdefaultnumthreadpoolthreads ifdef tflite with ruy gemv ruy context set cache policy ruy cachepolicy kcachelhsonnarrowmul endif cpubackendcontext cpubackendcontext ,use the new ruy api for caching constant matrices piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
355,class dnnregressor estimator estimator labels which are the output of input fn and returns features and labels which will be fed into the model label dimension dimension of the label for multilabels defaults to 1 label dimension number of regression targets per example this is the size of the last dimension of the labels and logits tensor objects typically these have shape batch size label dimension embedding lr multipliers optional a dictionary from to a float multiplier multiplier will be used to multiply with learning rate for the embedding variables ,better document label dimension and logits dimension args change , fix a bug in the docstring of the docstring of the docstring change
356,static struct syscalltable copy syscall table struct syscalltable from unsig unsigned int n struct syscall copy fixme use fewer shared maps it's pretty that we use a whole page just for a copy of that struct when we could fit dozens of them in a page this would cut down our proc maps a lot copy alloc shared nr sizeof struct syscall if copy null exit exit failure for n 0 n nr n copy alloc shared sizeof struct syscall if copy null exit exit failure memcpy copy from n entry sizeof struct syscall copy number n from n entry copy memcpy copy n from n entry sizeof struct syscall copy n number n from n entry copy n return from ,reduce the number of pages allocated in copy syscall table function this patch reduces the number of pages allocated in the copy syscall table function signed off by ildar muslukhov ildarm google com , patch problem when using a popup window with a popup window solution add a test for the popup window
357,void dumpgraph stringpiece label const graph g void optimizegraph functionlibraryruntime lib std unique ptr graph g void optimizegraph functionlibraryruntime lib std unique ptr graph g const graphoptimizer options graph optimizer options optimizeroptions opts opts set do common subexpression elimination true opts set do function inlining true opts set do constant folding true graphoptimizer optimizer opts optimizer optimize lib lib env lib device g shape map nullptr optimizer optimize lib lib env lib device g graph optimizer options void optimizegraph functionlibraryruntime lib std unique ptr graph g optimizegraph lib g graphoptimizer options namespace ,do not constant fold nodes with dt variant type outputs in xla xla does not support const nodes of type variant it needs to see the source ops for the variant operations to be able to build its own representation piperorigin revid , xla python add a test for the xla cpu backend piperorigin revid
358,static void store successful fd struct results results unsigned long value results fd true static void store successful len struct results results unsigned long value if value results min results min value if value results max results max value static void handle success struct syscallrecord rec struct syscallentry entry static void handle success struct syscallrecord rec store successful fd results value break case arg len store successful len results value break case arg undefined case arg address case arg mode t ,store results for arg len , fix a bug in the watchdog page
359,status trtcandidateselector istensorrtcandidate const tensorflow node node avgpool batchmatmul biasadd if nv tensorrt version 5100 combinednonmaxsuppression endif concatv2 const conv2d ,tftrt add a conversion for combinednonmaxsuppression op , add support for the input op for the input piperorigin revid
360,class grpcworkercache public workercachepartial void tag bool ok while completion queue next tag ok auto callback tag static cast grpcclientcqtag tag grpcclientcqtag callback tag static cast grpcclientcqtag tag callback tag oncompleted ok class grpcworkercache public workercachepartial if target local target return local worker else auto channel channel cache target sharedgrpcchannelptr channel channel cache target if channel return nullptr return newgrpcremoteworker live rpc counter channel completion queue logger ,rollback it and remove auto , xla python fix a bug in the hlo computation piperorigin revid change id iefecfafdafabefecbd
361,vim main2 void if params n commands 0 exe commands params must come before the may req calls starting 0 if defined feat termresponse defined feat mbyte must be done before redrawing puts a few characters on the screen may req ambiguous char width vim main2 void redrawingdisabled 0 redraw all later not valid no wait return false starting 0 'autochdir' has been postponed do autochdir ,patch checking for width is not working problem checking for width is not working hirohito higashi solution reset starting earlier , patch problem when using a terminal window is a bit slow solution add a test for the gui
362,copyright c 2017 2019 oracle and or its affiliates all rights reserved copyright c 2017 2020 oracle and or its affiliates all rights reserved import testenv class object class testcase testenv basetestcase def self test subscription for insert update delete and truncate def test 3000 subscription self 3000 test subscription for insert update delete and truncate skip if running on the oracle cloud which does not support currently class testcase testenv basetestcase if name main testenv runtestcases ,rework build to use setuptools exclusively and enable use of rework test suite to use and simplify test suite also added a test number to each test case for easier reference , fix a bug in the new module of the new module piperorigin revid change id iaaeaebbe
363,class layoutassignment public hlomodulepass a tuple shape returns true iff all leaf shapes are at most rank 1 static bool const shape shape virtual layout const shape shape return layoututil shape protected these methods invoked by propagate a layout constraint to its neighbors i e operands and users in order to minimize ,xla virtualize the choice of default layout piperorigin revid change id , xla gpu support for xla cpu piperorigin revid change id idaceccfcbacfece
364,test capi async true remote true heavy load on streaming rpc false todo b re enable after the fix test capi disabled test capi async false remote true heavy load on streaming rpc false remote func outputs true test capi disabled test capi async true remote true heavy load on streaming rpc false remote func outputs true ,temporarily revert the waitready change for handles with unknown devices piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
365,import six import tensorflow as tf from tensorflow python platform import benchmark from tensorflow python platform import test from tensorflow python keras benchmarks import benchmark util loss function and optimizer optimizer 'rmsprop' class kerasmodelcpubenchmark six with metaclass benchmark parameterizedbenchmark test benchmark six with metaclass benchmark parameterizedbenchmark tf test benchmark required arguments for measure performance x input data it could be numpy or load from tfds y target data if x is a dataset generator instance class kerasmodelcpubenchmark if name ' main ' test main no newline at end of file tf test main no newline at end of file ,update code and build file , fix a bug in the docstring of the test case piperorigin revid
366,tf stringstream tf getlocaltempdirectories return list void tf gettempfilename const char extension char name name strdup tensorflow io gettempfilename extension c str char tf gettempfilename const char extension return strdup tensorflow io gettempfilename extension c str tf capi export extern uint64 t tf nownanos void ,return instead of using out parameter , fix a bug in the test case piperorigin revid
367,unsigned long get interesting 32bit value unsigned long get interesting value int i unsigned long low ifndef 64bit usr include bits wordsize h if wordsize 32 pragma message wordsize 32 return get interesting 32bit value endif else pragma message wordsize 64 int i unsigned long low low get interesting 32bit value unsigned long get interesting value should never be reached return 0 endif ,replace bit with wordsize i'm not sure where bit comes from but it's not present on x i using wordsize should be as good it has support in glibc and uclibc , make the syscall page
368,final class nativeinterpreterwrapper implements autocloseable this inferencedurationnanoseconds inferencedurationnanoseconds private static native boolean run long interpreterhandle long errorhandle private static native void run long interpreterhandle long errorhandle resizes dimensions of a specific input void resizeinput int idx int dims ,changed return type of run from boolean to void piperorigin revid , fix a bug in the test case piperorigin revid
369,coordinator coordinator status coordinator std unique ptr runnerinterface runner mutex lock l mu if should stop return status error failed precondition the coordinator has been stopped mutex lock l runners lock runners push back std move runner return status ok bool coordinator shouldstop status coordinator join todo yuefengz deal with unexpected calls to join todo yuefengz deal with stragglers for const auto t runners reportstatus t join mutex lock l mu if should stop return status error failed precondition joining coordinator without requesting to stop runners clear return status mutex lock l runners lock for const auto t runners reportstatus t join runners clear return getstatus void coordinator reportstatus const status status ,make coordinator and coordinator join thread safe change , fix a typo in the docstring of the docstring of the docstring change
370,bool mkleageroprewrite slowcheckifkernelregistered string op name datatype dt find if the eager op name exists in mkl eager ops list auto element mkl eager ops find op name if element mkl eager ops end dt dt float if element mkl eager ops end eager op exists so verify registry and return registered or not return mkl op registry ismklnamechangeop mkl op registry getmkleageropname op name dt ,intel mkl enable eager mode support for mkl convd bf , fix a bug in the test case piperorigin revid
371,struct cpudevice t switch fusion case fusedcomputationtype kundefined op requires ok context errors internal fusion type is undefined break case fusedcomputationtype op requires ok context context bias add ,add missing break to the switch statement piperorigin revid , fix a bug in the parser test piperorigin revid
372,op shift oparg t oap int curs top int amount changed lines oap start lnum 0 oap end lnum 1 0l ifdef feat folding the cursor line is not in a closed fold foldopencursor endif if oap block mode curwin w cursor lnum oap start lnum op shift oparg t oap int curs top int amount else curwin w cursor lnum put cursor on last line for ifdef feat folding the cursor line is not in a closed fold foldopencursor endif if oap line count p report if oap op type op rshift ,patch problem when using indent folding and changing indent the wrong fold is opened jonathan solution open the fold under the cursor a bit later christian brabandt , fix a bug in the new parser test piperorigin revid change id icfcccdcbedbaacf
373,limitations under the license include tensorflow core common runtime sycl sycl device context h include tensorflow core common runtime dma helper h define eigen use sycl include third party eigen3 unsupported eigen cxx11 tensor namespace tensorflow void sycldevicecontext copycputensortodevice const tensor cpu tensor void sycldevicecontext copydevicetensortocpu const tensor device tensor statuscallback done const int64 total bytes device tensor totalbytes if total bytes 0 device eigen sycl device deallocate all const void src ptr dmahelper base device tensor void dst ptr dmahelper base cpu tensor memcpy dst ptr src ptr total bytes ,added sycl device data after execution on the sycl device , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
374,class compileonlyservice public service private explicit compileonlyservice const serviceoptions options compiler compiler std unique ptr backend compute constant backend explicit compileonlyservice const serviceoptions options compiler compiler compileonlyservice const compileonlyservice delete void operator const compileonlyservice delete ,tf xla use hloevaluator for computeconstant remove the need of a dedicated compute constant backend piperorigin revid , xla gpu support for the hlo hlo client piperorigin revid change id idadedfddaccd
375,modulepassbase mlir modulepassbase mlir return new llvmloweringpass ,add missing mlir namespace in definition of piperorigin revid , xla gpu support for the hlo hlo client piperorigin revid change id idadedfddaccd
376,static char features static int included patches add new patch number below this line 1540 1539 ,patch the user cannot try out emoji character widths problem the user cannot try out emoji character widths solution move the emoji script to the runtime tools directory , patch problem when using a channel to be a bit a bit slow solution add a test for the test
377,ins mousescroll int dir col mouse col find the window at the pointer coordinates wp mouse find win row col fail popup wp mouse find win row col find popup if wp null return curwin wp ins mousescroll int dir long curwin w botline curwin w topline else scroll redraw dir 3l ifdef feat text prop if win is popup curwin popup set firstline curwin endif ifdef feat gui else ,patch cannot use mouse scroll wheel in popup in insert mode problem cannot use mouse scroll wheel in popup in insert mode mouse clicks in popup close the popup menu solution check if the mouse is in a popup window do not let mouse events close the popup menu closes , patch problem when using a popup window with a terminal window solution add the option to the current buffer when the cursor is set
378,static char features static int included patches add new patch number below this line 1125 1124 ,patch wrong window height when splitting window with window toolbar problem wrong window height when splitting window with window toolbar solution add or subtract the window toolbar height , patch problem when using a channel to be a bit a bit slow solution add a test for the test
379,status grpcsession close mutex lock l mu if handle empty return errors invalidargument a session is not created yet return status ok req set session handle handle handle clear ,addresses the bug that when a grpc session is created and immediately closed an error was returned because the handle was still empty now it just returns status ok piperorigin revid , fix a bug in the file file in the file file
380,def neg x name none return gen math ops neg x name name def sign x name none with ops op scope x name sign as name if isinstance x ops sparsetensor x sign gen math ops sign x values name name return ops sparsetensor indices x indices values x sign shape x shape else return gen math ops sign x name name def complex abs x name none r computes the complex absolute value of a tensor ,enable tf sign for sparsetensor , fix a bug in the docstring of the docstring of the docstring change
381,xla test f concattest concat r1 with nothing computeandcomparer1 float builder expected errorspec 0 0001 xla test f concattest concat r1 l0 with nothing computationbuilder builder client testname auto a builder constantr1 float auto concatenated builder concatindim a 0 std vector float expected computeandcomparer1 float builder expected errorspec 0 0001 show that we can't concatenate r0 with r0 because we can't name the dimension to concatenate on xla test f concattest cannotconcatr0withr0 ,xla eliminate empty operands of concat operations at the hlo level change , xla python add a xla interface to the xla client piperorigin revid
382,struct scalarstufft public flatbuffers nativetable flatbuffers optional double maybe f64 flatbuffers nullopt double default f64 42 0 bool just bool false flatbuffers optional bool maybe bool true flatbuffers optional bool maybe bool flatbuffers nullopt bool default bool true optional scalars just enum optional scalars none optional scalars default enum optional scalars one ,fix generation of c code with optional enum , fix a bug in the parser test piperorigin revid
383,status fusescaleoffsettoconvweights const std vector float scale values nodedef bias add node bias add node set op biasadd bias add node set name conv output name copynodeattr conv node data format data format bias add node if hasattr conv node data format copynodeattr conv node data format data format bias add node copynodeattr conv node t t bias add node addnodeinput conv node name bias add node addnodeinput bias offset node name bias add node ,copy data format if the original node has that attr , fix a bug in the test case piperorigin revid
384,limitations under the license include deque include tensorflow compiler xla service call graph h include tensorflow compiler xla service hlo dce h include tensorflow core lib core errors h namespace xla statusor bool callinliner run hlomodule module return status ok if did mutate run dce to remove called computations which are now becoming unused this can result then in problems if within the called computation there were send recv instructions which the module group verifier will flag as error same channel id used for multiple send recv instructions tf return if error hlodce run module status return did mutate ,fix hlo domains mis handling from hlo passes piperorigin revid , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
385,static int connection connect return 1 ifdef oci attr driver name printf setting driver name to s n driver name status ociattrset self sessionhandle oci htype session text driver name strlen driver name oci attr driver name self environment errorhandle if environment checkforerror self environment status connection connect set driver name 0 return 1 endif set the session handle on the service context handle status ociattrset self handle oci htype svcctx self sessionhandle 0 oci attr session ,added support for setting client driver in v session connect info in oracle g and higher , fix a bug in the file
386,status constantfolding createnodedef const string name attrvalue attr tensor tensorproto t attr tensor mutable tensor bool optimized false const size t original size tensor totalbytes size t encoded size use the packed representation whenever possible to avoid generating large graphdefs moreover avoid repeating the last values if they're equal status constantfolding createnodedef const string name node mutable attr insert value attr tensor if encoded size 10 1024 1024 return status ok if encoded size original size encoded size 10 1024 1024 return errors invalidargument strings strcat can't fold name its size would be too large return errors invalidargument strings strcat can't fold name its size would be too large return status ok status constantfolding evaluatenode const nodedef node ,only apply size limit if size of tensor is increasing , xla gpu support for the xla client piperorigin revid
387,def constant value dtype none shape none name none return constant op constant value dtype dtype shape shape name name keras export 'keras backend is keras tensor' def is keras tensor x returns whether x is a keras tensor ,expose backend method is keras tensor piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
388,class meaniou metric super meaniou self init name name dtype dtype self num classes num classes variable to accumulate the predictions in the confusion matrix setting the type to be float64 as required by confusion matrix ops variable to accumulate the predictions in the confusion matrix self total cm self add weight 'total confusion matrix' shape num classes num classes initializer init ops zeros initializer dtype dtypes float64 dtype dtypes float32 def update state self y true y pred sample weight none accumulates the confusion matrix statistics class meaniou metric y pred self num classes weights sample weight dtype dtypes float64 dtype dtypes float32 return self total cm assign add current cm def result self ,use float instead of float for confusion matrix computations to make it compatible with tpus piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
389,void optimized ops transpose uint16 t params tfl shape reinterpret cast uint16 t weights data raw coreml shape reinterpret cast uint16 t coreml weights data coreml shape reinterpret cast uint16 t coreml weights front ,fix const cast error on convolution op builder piperorigin revid change id , add a new op to the new op api piperorigin revid change id icbbdbfafcdfcae
390,status gcsfilesystem statforobject const string fname const string bucket request setresultbuffer output buffer request timeouts connect timeouts idle timeouts metadata if stats nullptr stats tf return with context if error request send when reading metadata of gs bucket object ,export gcs object metrics fix the wrong define guard name in gcs file system h piperorigin revid , xla python python gpu support for the cpu backend piperorigin revid change id iefecfafdafabefecbd
391,class public opkernel void compute opkernelcontext context override const int32 split dim context input 0 scalar int const int64 split dim context input 0 scalar int64 const tensor input indices context input 1 const tensor input values context input 2 const tensor input shape context input 3 ,update sparse split op cc changing the data type of split dim to resolve sparse split op test failure on big endian system , add support for int ops piperorigin revid
392,static int check shm sanity void continue if pid is valid pid false shm exit reason exit pid out of range if shm exit reason still running shm exit reason exit pid out of range return shm corrupt static void kill all kids void wait a second to give kids a chance to exit sleep 1 if check shm sanity fixme if we get here we over wrote the real exit reason we should have saved that and handled appropriately if check shm sanity return just to be sure clear out the pid slots ,only set exit pid out of range if we haven't got a pre existing exit reason , fix a bug in the watchdog process
393,test quantizationutiltest multiplybyquantizedmultiplierint64 return multiplybyquantizedmultiplier x quantized multiplier shift negative multipliers are not supported by the 64 bit multiplybyquantizedmultiplier only use 0 multipliers expect eq quant and multiply 0 0 1 0 expect eq quant and multiply 1 0 0 expect eq quant and multiply 10000 0 00097656 10 expect eq quant and multiply 10000 0 00097656 10 expect eq quant and multiply 10000 0 00097656 10 expect eq quant and multiply 10000 0 00097656 10 expect eq quant and multiply 1ll 47 0 00001 expect eq quant and multiply 1ll 47 0 00001 expect eq quant and multiply 1ll 47 1 0 00001 expect eq quant and multiply 1ll 47 1 0 00001 test with maximum possible x and quantized multiplier const int64 t x 1ll 47 1 ,remove bit multiplybyquantizedmultiplier tests using a negative multiplier as they are not supported , xla gpu support for the xla client client piperorigin revid
394,popup adjust position win t wp wantcol screen wantcol else left of the text wantcol screen scol wantcol 1 wantcol screen scol wantcol 2 if wp w popup pos poppos center ,patch not enough tests for text property popup window problem not enough tests for text property popup window solution add a few more tests , patch problem when using a popup window with a popup window solution add the option to the list of the cursor
395,class meansquarederrortest test testcase losses mean squared error self predictions self predictions weights none def testscalar self with self test session self assertequal 0 0 losses mean squared error predictions constant op constant 0 labels constant op constant 0 eval def self loss losses mean squared error self predictions self predictions with self test session ,losses should support scalar logits labels change , fix a bug in the docstring of the test case piperorigin revid
396,classifiers operating system os independent programming language c programming language python programming language python 2 programming language python 3 topic database ,added additional classifiers to make it clear that cx oracle supports version of python as recommended by amaury forgeot d'arc , fix a bug in the test case piperorigin revid
397,def stack bidirectional dynamic rnn cells fw to be used for forward direction cells bw list of instances of rnncell one per layer to be used for backward direction inputs a length t list of inputs each a tensor of shape batch size input size or a nested tuple of such elements inputs the rnn inputs this must be a tensor of shape batch size max time or a nested tuple of such elements initial states fw optional a list of the initial states one per layer for the forward rnn each tensor must has an appropriate type and shape def stack bidirectional dynamic rnn cells fw raises typeerror if cell fw or cell bw is not an instance of rnncell valueerror if inputs is none not a list or an empty list valueerror if inputs is none if not cells fw raise valueerror must specify at least one fw cell for ,update stack bidirectional dynamic rnn and bidirectional dynamic rnn inputs argument's documentation change , fix a bug in the docstring of the docstring of the tf data strategy piperorigin revid
398,register kernel builder name stridedslice hostmemory strides hostmemory output stridedsliceop cpudevice int32 register kernel builder name stridedslicegrad device device gpu typeconstraint int32 t typeconstraint int32 index hostmemory shape hostmemory begin hostmemory end hostmemory strides hostmemory dy hostmemory output stridedslicegradop cpudevice int32 undef register gpu ,register kernels for int change , fix a bug in the test case piperorigin revid
399,def multi label head n classes applications the shape is batch size n classes labels can be a multi hot tensor of shape d0 d1 dn n classes an integer sparsetensor of class indices the dense shape must be d0 d1 dn and the values within 0 n classes ,fixes documentation of multi label head to render accepted labels as markdown list piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the tf nn rnn api piperorigin revid
400,session createsession class directsessionminusaxtest public testing test public void initialize std initializer list float a values graph graph opregistry global tensor a tensor dt float tensorshape 2 2 ,remove no longer needed requiredefaultops change , fix a bug in the docstring of the test piperorigin revid
401,integertype getvectorsubscripttype builder builder returns an integer array attribute containing the given values using the integer type required for subscripts in the vector dialect arrayattr getvectorsubscriptattr builder b arrayref int32 t values arrayattr getvectorsubscriptattr builder b arrayref int64 t values define get op classes include mlir dialect vectorops vectorops h inc ,vectorops unify vector dialect subscripts piperorigin revid change id , xla gpu support for the hlo hlo dialect piperorigin revid change id idadedfddaccd
402,std string getoneinputcode const operationtype op type result n break case operationtype elu result 0 x 0 x flt 0 0f exp 0 x flt 1 0f 0 x n result 0 y 0 y flt 0 0f exp 0 y flt 1 0f 0 y n result 0 z 0 z flt 0 0f exp 0 z flt 1 0f 0 z n result 0 w 0 w flt 0 0f exp 0 w flt 1 0f 0 w n result 0 x 0 x flt 0 0f expm1 0 x 0 x n result 0 y 0 y flt 0 0f expm1 0 y 0 y n result 0 z 0 z flt 0 0f expm1 0 z 0 z n result 0 w 0 w flt 0 0f expm1 0 w 0 w n break case operationtype exp result 0 exp 0 n ,call expm x instead of exp x it has higher precision and is potentially faster depending on hardware piperorigin revid change id , xla gpu support for the layout of the xla client piperorigin revid
403,set option default opt idx opt flags compatible set all options except terminal options to their default value when opt flags is non zero skip 'encoding' static void set options default opt flags set options default opt flags endif for i 0 istermoption options i i if options i flags p nodefault if options i flags p nodefault opt flags 0 options i var char u p enc set option default i opt flags p cp ifdef feat windows do set arg opt flags arg only for set command set global value of local options set options default opt free opt flags redraw all later clear else ,patch problem resetting 'encoding' when doing set all causes problems bjorn linse display is not updated solution do not reset 'encoding' do a full redraw , patch problem when using a terminal window is a bit slow solution add a test for the cursor
404,statusor std unique ptr pjrtclient getcpuclient bool asynchronous return std make unique pjrtclient kcpu client std move devices host id 0 kcpuname client std move devices host id 0 allocator nullptr host memory allocator nullptr should stage host to device transfers false gpu run options nullptr ,refactor pjrt replace enum with a fingerprint platform name this is an open set it's fast and avoids string comparison piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id iadbdbdeeebea
405,filter map typval t argvars typval t rettv int map else semsg e listdictarg semsg e return ,patch filter may give misleading error message problem filter may give misleading error message solution also mention blob as an allowed argument , patch problem when using a channel to be a list of a terminal window solution add a test for the command line
406,def selu x the scaled exponential linear unit selu activation function is scale x if x 0 and scale alpha exp x 1 if x 0 where alpha and scale are pre defined constants alpha 1 6732632423543772848170429916717 and scale 1 0507009873554804934193349852946 alpha 1 and scale 1 the selu activation function multiplies scale 1 with the elu https www tensorflow org versions r2 0 api docs python tf keras activations elu exponential linear unit elu to ensure a slope larger than one ,trim digits in alpha and scale acc to , fix a bug in the docstring of the documentation of the documentation of the example change
407,from tensorflow python client import session as tf session from tensorflow python framework import errors from tensorflow python framework import ops from tensorflow python framework import random seed from tensorflow python framework import sparse tensor from tensorflow python ops import control flow ops from tensorflow python ops import data flow ops from tensorflow python ops import variables class baseestimator restore checkpoint path checkpoint path unpack batches into individual predictions if return dict batch length list output batch values 0 shape 0 first tensor list output batch values 0 if isinstance first tensor sparse tensor sparsetensorvalue batch length first tensor dense shape 0 else batch length first tensor shape 0 for i in range batch length yield key value i for key value in six iteritems output batch else ,fix bug in baseestimator that called shape on change , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
408,def remote fused graph execute inputs if default graph input tensor type shapes for type shape in default graph input tensor type shapes type shape proto info proto default graph input tensor shape add type shape proto dtype int dtypes as dtype type shape 0 type shape proto dtype dtypes as dtype type shape 0 as datatype enum for dim in type shape 1 type shape proto shape dim add size dim if default graph output tensor type shapes for type shape in default graph output tensor type shapes type shape proto info proto default graph output tensor shape add type shape proto dtype int dtypes as dtype type shape 0 type shape proto dtype dtypes as dtype type shape 0 as datatype enum for dim in type shape 1 type shape proto shape dim add size dim ,dtype is no longer convertible to an int use dtype as datatype enum instead of int dtype to get the same result piperorigin revid , tf data fix a bug in the graph optimizer piperorigin revid
409,class saver object if self is empty return logging info restoring parameters from s save path sess run self saver def restore op name self saver def filename tensor name save path ,add logging to indicate which checkpoint is being restored change , fix a bug in the docstring of the docstring of the docstring change
410,class distribution basedistribution denote this distribution self by p and the other distribution by q assuming p q are absolutely continuous with respect to reference measure r cross entropy is defined as measure r the kl divergence is defined as none kl p q e p log p x q x ,fix documentation typo piperorigin revid , tf data saveable dataset to be used for tf data dataset piperorigin revid
411,std string makecamel const std string in bool first generate a documentation comment if available void gencomment const std string dc std string code ptr void gencomment const std vector std string dc std string code ptr const char prefix std string code code ptr if dc length code std string prefix dc n for auto it dc begin it dc end it code std string prefix it n ,output multiline doc comments over multiple lines tested on linux bug change id , xla python fix a bug in the hlo computation piperorigin revid change id id iefecfafdafabefecbd
412,limitations under the license tests for this file live in python kernel tests array ops test py from future import absolute import from future import division ,clear deleted api guide links these guides have been deleted had no content fixes piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
413,class dfshlovisitorbase virtual status handleconvert hloinstructionptr hlo return handleelementwiseunary hlo virtual status handlebitcastconvert hloinstructionptr hlo return handleelementwiseunary hlo virtual status handlecopy hloinstructionptr hlo return handleelementwiseunary hlo ,xla add bitcastconvert hlo op to enable bitwise operations on floating point types piperorigin revid , xla python add a xla hlo flag to the hlo hlo hlo flag to the hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo hlo flag to be used to the hlo hlo
414,from future import print function import collections from tensorflow contrib tpu python tpu import util as util lib from tensorflow python estimator import run config as run config lib class tpuconfig iterations per loop 2 num shards 2 per host input for training false check iterations per loop util lib check positive integer iterations per loop iterations per loop' check num shards util lib check positive integer num shards num shards' return super tpuconfig cls new cls iterations per loop iterations per loop ,adds explicit type checks for all steps iterations in tpuestimator piperorigin revid , fix a bug in the test case piperorigin revid
415,channel has readahead channel t channel ch part t part if ch mode mode json ch mode mode js jsonq t head channel ch part part ch json head jsonq t item head jq next return item null if head jq next null parse json from readahead there might be a complete message to process channel parse json channel part return head jq next null return channel peek channel part null ,patch vim may delay processing messages on a json channel problem vim may delay processing messages on a json channel pontus solution try parsing json when checking if there is readahead , patch problem when using a terminal window is a bit slow solution add a test for the gui
416,class tensorflowtestcase googletest testcase del path 1 a and b are ndarray like objects else self a b rtol rtol atol atol msg mismatched value a s is different from b s path str path str try self a b rtol rtol atol atol msg mismatched value a s is different from b s path str path str except typeerror as e msg error a s has s but b s has s path str type a path str type b e args e args 0 ' ' msg e args 1 raise def assertallclose self a b rtol 1e 6 atol 1e 6 asserts that two structures of numpy arrays have near values ,make typeerror more explicit on piperorigin revid , fix a bug in the test case piperorigin revid
417,class basesession sessioninterface if isinstance subfeed val ops tensor raise typeerror 'the value of a feed cannot be a tf tensor object ' 'acceptable feed values include python scalars ' 'strings lists numpy ndarrays or ' 'strings lists numpy ndarrays or ' 'for reference the tensor object was ' str feed val ' which was passed to the ' with key ' str feed ' ' ,nit added a missing space in an error message piperorigin revid , fix a bug in the docstring of the docstring of the documentation of the example change
418,class datasetv2 tracking base trackable composite tensor compositetensor def list files file pattern shuffle none seed none a dataset of all files matching one or more glob patterns the file pattern argument should be a small number of glob patterns if your filenames have already been use dataset from tensor slices filenames instead as re globbing every filename with list files may result in poor performance with remote storage systems note the default behavior of this method is to return filenames in a non deterministic random shuffled order pass a seed or shuffle false to get results in a deterministic order ,document that list files is meant to be used with patterns not file literals piperorigin revid change id , fix a bug in the documentation of the test case piperorigin revid
419,include shm h include compat h include trinity h include udp h static int memfd create unused const char uname unused unsigned int flag static void memfd destructor struct object obj static void memfd dump struct object obj unused bool global struct memfdobj mo obj memfdobj struct msg objmsg int len output 0 memfd fd d name s flags x n mo fd mo name mo flags init msgobjhdr objmsg hdr obj created memfd global obj objmsg fd mo fd len strlen mo name strncpy objmsg name mo name len objmsg flags mo flags sendudp char objmsg sizeof objmsg static int open memfd fds void ,log decode memfd objects , move the syscall process to the syscall process
420,static void log main started void if logging enabled false return mainmsg hdr pid getpid mainmsg hdr type main started init msghdr mainmsg hdr main started mainmsg num children max children mainmsg shm begin shm mainmsg shm end shm shm size 1 static void log main exiting void if logging enabled false return mainmsg hdr pid getpid mainmsg hdr type main exiting init msghdr mainmsg hdr main exiting mainmsg reason shm exit reason sendudp char mainmsg sizeof mainmsg ,use init msghdr for main messages , fix a bug in the watchdog page
421,def moving average update x value momentum def dot x y multiplies 2 tensors and or variables and returns a tensor this operation corresponds to numpy dot a b out none arguments x tensor or variable y tensor or variable def dot x y examples if inputs x and y are 2 d arrays then it is equivalent to tf matmul x tf keras backend placeholder shape 2 3 y tf keras backend placeholder shape 3 4 xy tf keras backend dot x y def dot x y xy kerastensor shape 32 28 4 dtype float32 if x is an n d array and y is an m d array where m 2 it is a sum product over the last axis of x and the second to last axis of y x tf keras backend random uniform variable shape 2 3 low 0 high 1 y tf keras backend ones 4 3 5 xy tf keras backend dot x y ,updated the description of k dot https github com tensorflow tensorflow issues piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring change
422,class test util tensorflowtestcase parameterized testcase rt input 1 2 3 4 5 multiples 1 1 1 0 expected multiple 1 dict descr 'rank 4 multiples 1 no repeats ' rt input 1 2 3 4 5 6 multiples 1 1 1 1 expected 1 2 3 4 5 6 pyformat disable def self ,bug fix for tf ragged tile relnotes n a piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
423,static tf tensor emptytensor tf datatype dtype const tensorshape shape non static for testing tf tensor tf tensorfromtensor const tensorflow tensor src tf status status tf setstatus status tf ok if src isinitialized status status failedprecondition attempt to use a tensor with an uninitialized value ,fix tf tensorfromtensor not setting status on success piperorigin revid , fix a bug in the graph piperorigin revid
424,class test testcase self assertequal y device expected name with ops device ' cpu 0' x stager get 1 y stager peek 1 y stager peek 1 0 z stager get self assertequal x device ' device cpu 0' self assertequal x 0 device ' device cpu 0' self assertequal y device ' device cpu 0' self assertequal z device ' device cpu 0' self assertequal z 0 device ' device cpu 0' g finalize class test testcase sess run stage feed dict x i pi i for i in range n self asserttrue sess run peek feed dict gi i i self asserttrue sess run peek feed dict gi i 0 i self asserttrue sess run size 10 ,update stage op and map stage op to not special case returning one element piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
425,public block void clear drop all references from within this block dropallreferences clear instructions in the reverse order so that uses are destroyed before their defs while empty public const cast instruction inst this all operand uses from instructions within this block which is an step in breaking cyclic between references when they are to be deleted void dropallreferences terminator management ,add a block to drop all references from held instructions and call it when clearing the block this fixes a bug where forinst ifinst instructions may still have references to values while being destroyed piperorigin revid , fix a bug in the parser test piperorigin revid
426,terminal loop int blocking fd curbuf b term tl job jv channel ch part get tty part curbuf b term ch fd endif intrestore cursor intrestore cursor false remember the terminal we are sending keys to however the terminal might be closed while waiting for a character e g typing exit in a ,patch coverity warns for variable that may be uninitialized problem coverity warns for variable that may be uninitialized solution initialize the variable , patch problem when using a terminal window is a bit slow solution add a test for the gui
427,static pyobject module initialize void if pymodule addstringconstant module version build version string 0 return null if pymodule addstringconstant module version build version string 0 return null if pymodule addstringconstant module buildtime date time 0 return null ,issue added version attribute version attribute added to conform with pep , patch problem when using a terminal window doesn't work solution add a test for the cursor
428,include string include type traits include vector include memory include limits if defined stlport version defined flatbuffers cpp98 stl define flatbuffers cpp98 stl ,made stl emulation h usable by itself change id , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
429,class cppgenerator public basegenerator auto full struct name ev true true todo make this decisions more universal how code setvalue u get type name field uniontypefieldsuffix code setvalue u get type escapekeyword field name uniontypefieldsuffix code setvalue u element type wrapinnamespace u defined namespace getenumvaluse u ev class cppgenerator public basegenerator std string genunionunpackval const fielddef afield const char vec elem access const char vec type access return afield value type enum def name union unpack e vec elem access name afield uniontypefieldsuffix return afield value type enum def name union unpack e vec elem access escapekeyword afield name uniontypefieldsuffix vec type access resolver ,fix union escaping order fix union escaping order fixes style , fix a bug in the parser test piperorigin revid
430,def docker run run args print output true try subprocess check call command stdout stdout stderr subprocess stdout except subprocess calledprocesserror return false except subprocess calledprocesserror as e return e returncode return true return 0 def docker build build args pull false def run fuzzer args args fuzzer name args fuzzer args docker run run args return docker run run args def coverage args def reproduce args ' runs 100' args fuzzer args docker run run args return docker run run args def generate args ,helper use return code from docker run for reproduce run fuzzer fixes , fix a bug in the docstring of the new module piperorigin revid
431,static void checkstats allocator a int64 num allocs int64 bytes in use int64 max bytes in use int64 max alloc size allocatorstats stats a getstats stats log info alloc stats endl stats debugstring log info alloc stats n stats debugstring if defined platform google defined ndebug note allocator stats expectation depends on the system malloc expect eq stats bytes in use bytes in use ,tensorflow no such thing as log info endl change , fix a bug in the new code of the new code piperorigin revid
432,see the license for the specific language governing permissions and limitations under the license include tensorflow compiler tf2xla lib triangular solve h include tensorflow compiler tf2xla xla op kernel h include tensorflow compiler tf2xla xla op registry h include tensorflow compiler xla client lib triangular solve h namespace tensorflow namespace class matrixtriangularsolveop public xlaopkernel void compile xlaopkernelcontext ctx override auto result triangularsolve auto result xla triangularsolve ctx input 0 ctx input 1 left side true lower lower transpose a adjoint conjugate a adjoint ctx setoutput 0 result ,tf xla move triangularsolve into xla client library piperorigin revid , add a test for the new op op piperorigin revid
433,term update window win t wp char mb 2 0 0 1 screenlines off mb 0 screenlines off 1 mb 1 screenlines off 1 mb 1 cell width mb ptr2cells mb else term update window win t wp if enc utf8 screenlinesuc off nul else if has mbyte don't set the second byte to nul for a dbcs encoding it has been set above if enc utf8 has mbyte screenlines off nul pos col off ,patch terminal second byte of double byte char wrong problem terminal second byte of double byte char wrong solution set the second byte to nul only for utf and non multibyte , patch problem when using a terminal window is a bit slow solution add a test for the gui
434,do buffer go to the other buffer set curbuf buf action if defined feat listcmds defined feat scrollbind defined feat cursorbind if defined feat listcmds if action dobuf split reset binding curwin reset 'scrollbind' and 'cursorbind' ,patch too many ifdefs problem too many ifdefs solution graduate feat scrollbind and feat cursorbind , patch problem when using a terminal window doesn't work solution add a test for the mouse command
435,constexpr float boost math constants pi float constexpr double dval boost math constants pi double constexpr long double boost math constants pi long double constexpr float boost math float constants pi constexpr double boost math double constants pi constexpr long double boost math long double constants pi endif we need to declare a conceptual type whose precision is unknown at ,constants fix namespace scope constants so they are constexpr see https svn boost org trac boost ticket , xla gpu support for the layout inference piperorigin revid change id ifedfbcdcccfcfbbc
436,static bool is arg address enum argtype argtype return false unsigned long find previous arg address int childno unsigned int argnum unsigned long find previous arg address struct syscallrecord rec unsigned int argnum struct syscallrecord rec struct syscallentry entry unsigned long addr 0 unsigned int call rec shm children childno syscall call rec nr entry syscalls call entry ,convert arg address handling from to , fix a bug in the previous commit piperorigin revid
437,class test util vectordistributiontesthelpers self assertequal 4 5 x shape self assertequal 4 5 log prob x shape def self with self test session mixture same family lib mixturesamefamily mixture distribution categorical lib categorical probs 0 3 0 7 components distribution normal lib normal loc 1 1 scale 0 1 0 5 x sample 4 5 seed 42 log prob x log prob x self assertequal 4 5 1 x shape self assertequal 4 5 1 log prob x shape def self mix probs np float32 3 7 probs np float32 4 6 25 75 ,add unittest for tf contrib distributions mixturesamefamily batch shape piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
438,test add a large string tensor slice which will fail tensorshape shape 100 1000000 tensorshape shape 256 1024 tensorslice slice tensorslice const std vector string data 100000000 const std vector string data 256 1024 std string 8192 'f' status s writer add test2 shape slice data data expect eq s code error invalid argument expect true stringpiece s error message ,make large variable saving tests shorter to prevent timeouts change , fix a bug in the test case piperorigin revid
439,const absl string view khostthreads host cpu const absl string view kgpuplaneprefix device gpu const absl string view kcuptidriverapiplanename host cupti const absl string view kmetadataplane host metadata const absl string view ktfstreamzplane host tfstreamz const int32 khostplaneid 49 const int32 kgpuplanebaseid 0 const int32 kcuptidriverapiplaneid 50 const int32 kmetadataplaneid 51 const int32 kmetadataplaneid 99 const int32 ktfstreamzplaneid 98 const int32 kthreadgroupminplaneid kcuptidriverapiplaneid 1 const int32 kthreadgroupmaxplaneid ktfstreamzplaneid 1 namespace ,tfstreamz metric provider piperorigin revid change id , xla python add a xla interface to the xla client piperorigin revid change id idaceccfcbacfece
440,graph int num const string func test benchmark device num func run iters benchmark bm device func scalar arg 4096 must 4096 arg 32768 arg 131072 arg 1048576 arg 1 12 must 4096 arg 1 13 arg 1 14 arg 1 15 1 13 arg 1 15 arg 1 15 1 14 arg 1 16 arg 1 17 1 15 arg 1 17 arg 1 17 1 16 arg 1 18 arg 1 19 arg 1 20 bm binary scalar cpu less if google cuda tensorflow use rocm ,more granularity for binaryop benchmarks piperorigin revid , add a test for the graph and the graph piperorigin revid
441,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 9 30 forward compatibility horizon datetime date 2020 10 1 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
442,tflitestatus evalfloat tflitecontext context tflitenode node gettensordata float input gettensorshape filter gettensordata float filter gettensorshape bias gettensordata float bias gettensorshape output gettensordata float output gettensordata float output cpubackendcontext getfromcontext context else tf lite kernel log context unsupported sparse fully connected weight format ,add multi threaded sparse fullyconnected kernel piperorigin revid change id , add support for int ops piperorigin revid
443,static char features static int included patches add new patch number below this line 1724 1723 ,patch vim assignment tests spread out problem vim assignment tests spread out solution create new test file for assignment tests , patch problem when using a channel to be a bit a bit slow solution add a test for the test
444,def get build steps project dir ' ' 80 format name name unpack the corpus and run coverage script coverage env env 'http port ' 'coverage extra args s' project yaml 'coverage extra args' strip if 'dataflow' in project yaml 'fuzzing engines' coverage env append 'full summary per target 1' build steps append 'name' 'gcr io oss fuzz base base runner' 'env' env 'http port ' 'coverage extra args s' project yaml 'coverage extra args' strip 'name' 'gcr io oss fuzz base base runner' 'env' coverage env 'args' 'bash' ' c' 'for f in corpus zip do unzip q f d f ' ,infra generate full coverage for dataflow enabled targets , infra fix a bug in the documentation of the new module change
445,void setup fds void writelog fd 1 pipe n printf opening fds n open sockets open fds dev open fds sys open fds proc open sockets printf done getting fds idx d n fd idx if fd idx ,generate the sockets first this should solve the sporadic 'too many error while generating the sockets cachefile , make the syscall page we can be a bit more than the syscall process
446,class linearclassifier evaluable evaluable trainable trainable feature columns occupation education x occupation optimizer tf contrib linear optimizer sdcaoptimizer example id column 'example id' num loss partitions symmetric l2 regularization 2 0 ,expose number of partitions to tf learn svm estimator for multi machine training of change , update docstring for tf nn rnn py
447,static pyobject cursor itemdescriptionhelper type pyobject vartype pythontype if type pyobject g stringvartype displaysize charsize if py major version 3 else if type pyobject g unicodevartype displaysize charsize endif else if type pyobject g binaryvartype displaysize internalsize else if type pyobject g fixedcharvartype displaysize charsize if py major version 3 else if type pyobject g fixedunicodevartype displaysize charsize endif else if type pyobject g numbervartype if precision displaysize precision 1 ,expose the unicode fixed unicode and long unicode types so that in python one can actually specify the use of the nchar type fields when binding or using setinputsizes , patch problem when using a terminal window doesn't work solution add a test for the cursor
448,term color char u s int n else char format s s dm endif sprintf buf format i 2 char lead i 2 if defined feat vtp defined feat termguicolors s 1 ' ' if eb 033 esc str s 1 ' ' if eb 033 esc str endif if eb 033 esc str 233 s i '3' n 16 38 5 9 n 16 48 5 10 if eb 033 esc str 233 char tail s i '3' n 16 38 5 9 n 16 48 5 10 sprintf buf format lead tail out str buf 0 n 16 n n 8 else ,patch clang warns for undefined behavior problem clang warns for undefined behavior solution move ifdef outside of sprintf call suggestion by michael jarvis closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
449,action template namespace testing include any custom callback actions added by the local installation include any custom actions added by the local installation we must include this header at the end to make sure it can use the declarations from this file include gmock internal custom callback actions h include gmock internal custom gmock generated actions h endif gmock include gmock gmock generated actions h ,rename custom callback actions h pump custom gmock generated actions h pump , fix a bug in the parser test piperorigin revid
450,limitations under the license include tensorflow python framework python op gen internal h include stdio h include float h include stdio h include iomanip include sstream include unordered map ,sanitize with clang foramt signed off by yong tang yong tang github outlook com , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
451,typedef std function void const status statuscallback debug only version of tf check ok compiler still parses 'val' even in opt mode ifdef ndebug ifndef ndebug define tf dcheck ok val tf check ok val else define tf dcheck ok val ,fix reversed sense of ifndef ndebug in definition of tf dcheck ok change , fix a bug in the parser test piperorigin revid
452,class hoistcommonfactoroutofaggregation public arithmeticoptimizerstage them it's possible that rewritten node already exists in a graph return rewritten nodes find node name rewritten nodes end ctx node map nodeexists node false ctx node map nodeexists node true ctx node map nodeexists node true ctx node map nodeexists node keep names of the nodes that were optimized by this stage ,grappler fix bug in arithmetic optimizer causing non unique node names piperorigin revid , fix a bug in the test case piperorigin revid
453,author 'oracle' version '2 0' the full version including alpha beta rc tags release '2 0 0 beta 2' release '2 0 0 beta 3' the theme to use for html pages html theme 'oracle' ,preparation for release of odpi c beta , fix a bug in the new module of the new module of the new module and the new module is not used in the new class class and the new class class and the new class is not used in the same class piperorigin revid
454,class audioprocessor object self background data background dir os path join self data dir background noise dir name if not os path exists background dir if not gfile exists background dir return self background data with tf compat v1 session graph tf graph as sess wav filename placeholder tf compat v1 placeholder tf string ,fix warnings and minor refactoring piperorigin revid change id , fix a bug in the docstring of the new api api piperorigin revid change id ieedaecadfaccdddeec
455,class test testcase self assertequal set m variables set ops get collection ops graphkeys local variables self assertequal ops get collection ops graphkeys global variables self assertequal set m variables set ops get collection ops graphkeys metric variables def self with context graph mode ops graph as default m metrics mean use global variables true m 1000 self assertequal set m variables set ops get collection ops graphkeys global variables self assertequal ops get collection ops graphkeys local variables self assertequal set m variables set ops get collection ops graphkeys metric variables ,allow eager metrics to save internal variables by using global variables piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
456,static funcentry t global functions screenrow 0 0 0 ret number f screenrow screenstring 2 2 fearg 1 ret string f screenstring search 1 4 fearg 1 ret number f search searchcount 0 1 fearg 1 ret dict any f searchcount 1 3 fearg 1 ret number f searchpair 3 7 0 ret number f searchpair 3 7 0 ret list number f ,patch cannot get the search statistics problem cannot get the search statistics solution add the searchcount function fujiwara takuya closes , patch problem when using a terminal window is a bit slow solution add a test for the test
457,static const unsigned int tcp opts tcp congestion tcp md5sig tcp cookie transactions tcp thin linear timeouts tcp thin dupack tcp user timeout tcp repair tcp repair queue tcp queue seq tcp repair options tcp fastopen tcp timestamp tcp notsent lowat tcp cc info tcp notsent lowat tcp cc info tcp save syn tcp saved syn void tcp setsockopt struct sockopt so ,add tcp save syn tcp saved syn , fix a bug in the syscall page
458,int32 tputopologyexternal core type int32 tputopologyexternal const return tpu executorapifn tputopology topology int32 tputopologyexternal const return tpu executorapifn tputopology topology tputopologyexternal chip bounds const return tpu executorapifn tputopology topology tpu executorapifn tputopology topology ,add chipsperhost api to tputopologyexternal piperorigin revid change id , xla python fix a bug in the hlo evaluator piperorigin revid change id icccbcbdbcfaadbee
459,from future import print function import cx oracle import db config con cx oracle connect pythonhol welcome localhost orclpdb con cx oracle connect db config user db config pw db config dsn cur con cursor create table ,modified the solutions of the hol for collaborate added db config and made changes to solutions to use db config values , fix a bug in the test case piperorigin revid
460,class randomdatasetparams public datasetparams return status ok virtual string op name const override virtual string dataset type const override return randomdatasetop kdatasettype ,update test case to match latest version of test harness , fix a bug in the test case piperorigin revid
461,tfe op tfe context ctx const tensorflow nameattrlist func namespace void tfe tfe context ctx tensorflow eagercontext context tensorflow contextfrominterface tensorflow unwrap ctx context startstep tensorflow unwrap ctx startstep void tfe tfe context ctx tensorflow eagercontext context tensorflow contextfrominterface tensorflow unwrap ctx context endstep tensorflow unwrap ctx endstep const tfe tfe tfe op op ,add and which are used in training models piperorigin revid change id , tf data optimization to use the gradient of the graph piperorigin revid
462,public patternmatchresult matchandrewrite operation op arrayref value operands patternrewriter rewriter const override auto int64ty lowering converttype operands 0 gettype auto int64ty lowering converttype rewriter getintegertype 64 edsc scopedcontext context rewriter op getloc rewriter replaceop op extractvalue int64ty operands 0 rewriter 1 ,fix type lowering to llvm this fixes a bug where the result type was incorrect when lowering to llvm piperorigin revid , xla gpu support for the hlo instruction piperorigin revid change id icabdabcccecababba
463,include trinity h include sanitise h static void sanitise unused unsigned long a1 unused unsigned long a2 unused unsigned long a3 unsigned long a4 unused unsigned long a5 unused unsigned long a6 retry pos if int a4 0 a4 rand64 goto retry pos struct syscall syscall name num args 4 ,move sanity into syscall def , move the syscall page to the syscall process
464,class variablestestcase test testcase sess run v0 initializer sess run add def self def cond i return i 10 def body i zero array ops zeros dtype dtypes int32 v variables variable initial value zero return i 1 v read value with self assertraisesregexp valueerror inside a control flow control flow ops while loop cond body 0 0 def self with self test session var x variables variable 2 0 ,issue a more user friendly error message if a variable's initializer is from inside a control flow scope such as tf cond or tf while loop fixes piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
465,void check parent pid void fixme add locking so only one child does this output output 0 bugtxt child pid d got reparented parent pid d watchdog pid d n pid mainpid shm watchdog pid pid mainpid watchdog pid output 0 bugtxt last syscalls n for i 0 i max nr children i ,move watchdog pid out of shm take this way should work better , fix a bug in the watchdog page
466,checkederror parser parsesinglevalue value e assert 0 shouldn't happen we covered all types e constant 0 next else bool match false ,fixed json integers as strings not being parsed correctly change id tested on linux , fix a bug in the parser test piperorigin revid
467,class sleepmilliseconds random generate 30 gtest check posix success pthread mutex unlock memory barrier mutex gtest check posix success pthread mutex destroy memory barrier mutex value temp 1 ,fixes a resource leak in gtest port test by haruka iwao , fix a bug in the file file
468,class sliceop public opkernel return if slice dim0 t input shape if slice dim0 isdim0slicealigned t input shape begin 0 size 0 vlog 1 slice dim 0 input shape debugstring check ge input dims 1 otherwise is identity should be true context set output 0 input slice begin 0 begin 0 size 0 ,optimize slice for d tensors avoid copy for aligned slices of d tensors the previous alignment check returned false for d aligned slices resulting in an unnecessary copy change , add a test for the test case piperorigin revid
469,absl status gpuoperation compile const creationcontext creation context code main function compiler options creation context context creation context device kernel return postcompilecheck creation context device info return postcompilecheck creation context device info kernel info int3 gpuoperation getgridsize const ,kernelinfo separated from kernel gpuoperation don't need api specific now and uses kernelinfo api neutral piperorigin revid change id , xla gpu support for the xla client piperorigin revid change id idaceccfcbacfece
470,status dynamicdimensioninferencevisitor foreachoperanddynamicdimension static statusor dynamicdimensioninference dynamicdimensioninference run hlomodule module vlog 0 param config module dynamic parameter binding tostring vlog 2 param config module dynamic parameter binding tostring dynamicdimensioninference inference module tf return if error inference analyzedynamicdimensions return inference ,xla fix vlog usage in dynamic dimension inference that caused a lot of log spam piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id iffcbbabfbaeecaeaa
471,class eagercontext public core refcounted mutex remote state mu uint64 context id uint64 context id guarded by remote state mu std vector string remote contexts int keep alive secs guarded by remote state mu ,fix two race conditions found in eager c api test context id shouldn't be read during update eagerexecutor state should be set before creating eagerexecutor thread piperorigin revid , xla python python gpu support to be enabled piperorigin revid change id ifdfebeffeebfcdeae
472,a different filter to each input channel expanding from 1 channel to channel multiplier channels for each then concatenates the results together thus the output has in channels channel multiplier channels for k in 0 in channels 1 for q in 0 channel multiplier 1 output b i j k channel multiplier q sum di dj input b strides 1 i di strides 2 j dj k filter di dj k q must have strides 0 strides 3 1 for the most common case of the same horizontal and vertices strides strides 1 stride stride 1 ,improve docs for tf nn depthwise convd native , fix a bug in the new delegate test piperorigin revid
473,expand wildcards eval pat num file file flags expand wildcards calls gen expand wildcards and removes files matching 'wildignore' returns ok or fail returns ok or fail when fail then num file won't be set int expand wildcards num pat pat num file file flags expand wildcards num pat pat num file file flags retval gen expand wildcards num pat pat num file file flags when keeping all matches return here if flags ew keepall if flags ew keepall retval fail return retval ifdef feat wildign ,fixed crash with find completion using uninitialized count , patch problem when using a terminal window is a bit solution add a few more tests to the new code
474,class customgradienttest test testcase gx gradients impl gradients fx x 0 fx gx sess run fx gx self assertallequal f x fx self assertallequal g x gx self assertallclose f x fx self assertallclose g x gx def test works correctly both f g zero self with self test session as sess class customgradienttest test testcase gx gradients impl gradients fx x 0 fx gx sess run fx gx self assertallequal f x fx self assertallequal g x gx self assertallclose f x fx self assertallclose g x gx def test works correctly vector of vars self with self test session as sess ,change contrib bayesflow custom grad tests to assertallclose piperorigin revid , fix a bug in the docstring of the test piperorigin revid
475,class modelfntests test util tensorflowtestcase l2 0 01 tree complexity 0 min node weight 0 center bias center bias center bias center bias pruning mode 'none' estimator spec boosted trees bt model fn pylint disable protected access features features ,boosted trees revealing pruning mode as one of the parameters for a gbdt estimator piperorigin revid , fix a bug in the test case piperorigin revid
476,dt cg act exit dt pcb t pcb dt node t dnp dtrace actkind t kind dt regset free pcb pcb regs dnp dn args dn reg static void dt cg act freopen dt pcb t pcb dt node t dnp dtrace actkind t kind static void dt cg act ftruncate dt pcb t pcb dt node t dnp dtrace actkind t kind dt cg act dt pcb t pcb dt node t dnp dtrace actkind t kind static void dt cg act system dt pcb t pcb dt node t dnp dtrace actkind t kind static void dt cg act trace dt pcb t pcb dt node t dnp dtrace actkind t kind ,add and system support signed off by eugene loh eugene loh oracle com reviewed by kris van hees kris van hees oracle com , dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
477,def run in graph and eager modes func none except unittest case skiptest pass if reset test this decorator runs the wrapped test twice reset the test environment between runs self teardown self tempdir none self setup def run eagerly self kwargs if not use gpu with ops device cpu 0 def run in graph and eager modes func none assert no garbage created run eagerly with context eager mode if reset test this decorator runs the wrapped test twice reset the test environment between runs self teardown self tempdir none self setup run eagerly self kwargs return decorated ,run setup in the same mode each time piperorigin revid , fix a bug in the docstring of the docstring of the tf data strategy piperorigin revid
478,limitations under the license should implement their own versions of this function void respondtodetection tflite errorreporter error reporter int8 t person score int8 t no person score if person score no person score led on led green else ,correcting for pr comments , xla python fix a bug in the client backend piperorigin revid change id iefaaedbcfceefdda
479,class memorycheckertest test testcase foo foo pylint disable unused variable memory checker record snapshot todo kkb 'builtins weakref' 1 is unexpected locate and fix it todo kkb 'builtins weakref' 1 'builtins function' 1 is unexpected locate and fix it memory checker assert no new python objects threshold ' main foo' 1 'builtins weakref' 1 'builtins weakref' 1 'builtins function' 1 memory checker assert no new python objects threshold ' main foo' 2 'builtins weakref' 1 'builtins weakref' 1 'builtins function' 1 def self ,temporarily whitelist an unexpected in test which was flaky due to this piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
480,status graphdef graph def specs prune unused nodes false specs convert legacy fed inputs false specs graph as function false specs upgrade legacy false specs upgrade legacy true tf return if error config feed name remap specs tf return if error config specs ,tf mlir when importing graphdef to mlir for tfcompile set upgrade legacy flag to allow the functionalization of tensorflow v control flow piperorigin revid change id , tf data optimization for tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental piperorigin revid change id idbefdcccaffb
481,class def function function self concrete functions concrete functions self function spec function spec prevent from spamming users with frequent tracing warnings self omit frequent tracing warning true def list all concrete functions for serialization self return self concrete functions ,reduce retracing warning from piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
482,whitelist 'python platform control imports py' 'tools docker jupyter notebook config py' 'tools ci build update version py' 'tools ci build copy binary py' tests that must not import division ,adding a copy binary script to github to change python versions for whl files piperorigin revid , fix a bug in the file in the file piperorigin revid
483,void runonmodule helper that propagates an op's recorded operand device assignments to its called function's arguments auto propagate operands to callee arguments operation caller llvm iterator range operanditerator caller operands operation caller operation operand range caller operands llvm stringref called func name const caller res auto callee ,nfc use operation result range operand range instead of spelling out the entire type piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
484,class test testcase def testplaceholder self foo array ops sparse placeholder dtypes float32 shape 10 47 self assertallequal 10 47 foo get shape self assertallequal none 2 foo indices get shape as list def self foo array ops sparse placeholder dtypes float32 shape none 47 self assertallequal none none foo get shape as list self assertallequal none 2 foo indices get shape as list def self foo array ops sparse placeholder dtypes float32 shape none self assertallequal none foo get shape self assertallequal none none foo indices get shape as list if name main ,make indices placeholder in sparse placeholder maintain rank information piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
485,void dpienv free dpienv env dpierror error if env i env i env null ifndef win32 free env i if env versioninfo versionnum 12 free env i endif env i null ,with client the thread key destructor does run at process exit even if the thread key itself has been destroyed so ensure that the same code that runs on windows runs on platforms other than windows as well , fix a bug in the documentation of the client client client
486,include mlir spirv spirvops h namespace mlir include mlir spirv transforms stdopstospirvconversion cpp inc include stdopstospirvconversion cpp inc namespace mlir using namespace mlir ,nfc move standard to spir v conversion to lib conversion piperorigin revid , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
487,bool gpumultioutputfusion shapescompatibleforfusion hloinstruction instr1 element instr fused expression root special handling of kreduce instructions the fusion applies to the first operand if element instr opcode hloopcode kreduce return element instr operand 0 shape return element instr shape the elementwise output shapes must be the same including layout return shapeutil shapeutil equal get element shape instr1 get element shape instr2 return shapeutil equal get element shape instr1 get element shape instr2 bool gpumultioutputfusion hloinstruction instr ,xla gpu check the reduce input shape when multi output fusing reduces otherwise we can end up in a situation where incompatible reduces that happen to have the same output shape are fused piperorigin revid , xla gpu support for the hlo evaluator piperorigin revid change id icabdabcccecababba
488,class graph object names are ignored but it will not check for pre existing membership of value in any of the collections in names names can be any iterable but if names is a string it is treated as a single collection name args names the keys for the collections to add to the graphkeys class contains many standard names for collections value the value to add to the collections for name in set names make sure names are unique but treat strings as a single collection name names names if isinstance names six string types else set names for name in names self add to collection name value def get collection ref self name ,make sure add to collection treats a passed in string as a single name added tests for add to collections change , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
489,public class flatbufferbuilder param s the string to encode return the offset in the buffer where the encoded string starts public int createstring string s public int createstring s int length s length int int length encoder if dst null dst capacity ,can now use of string works with http io api io util html https docs oracle com docs api java html https docs oracle com docs api java lang html , fix a bug in the parser test piperorigin revid
490,static char features static int included patches add new patch number below this line 1007 1006 ,patch problem when a symbolic link points to a file in the root directory the swapfile is not correct solution do not try getting the full name of a file in the root directory closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
491,status init const functiondef function def function ' function def signature name ' has a preferred device but does not implement an interface handles the case that api implements exists but device does not exist currently this is for tf lite mlir which depends on api implements if interface name empty preferred device empty vlog 1 a function has api implements interface name but api preferred device interface name clear return status ok ,handle the case where api implements exists but api device does not exist piperorigin revid change id , fix a bug in the graph piperorigin revid
492,void generate rand bytes unsigned char ptr unsigned int len unsigned int i unsigned char choice rand 3 unsigned int startoffset 0 remain unsigned char separators 3 ' ' ' ' ' 0' unsigned char separator switch choice switch rand 3 case 0 complete garbage for i 0 i len i ,random remove unnecessary local var , make the syscall page we can be a child process
493,public final class tensorbufferfloat extends tensorbuffer return arr override public float int return buffer getfloat 2 override nonnull public int public final class tensorbufferfloat extends tensorbuffer return arr override public int int return int buffer getfloat 2 override public int gettypesize return data type bytesize ,implement index accessors to tensorbuffer piperorigin revid change id , fix a bug in the parser test piperorigin revid
494,class prepackedcache returns the total size in bytes of data held in this cache int const return cache size all calls to get current go through here todo b profile timestamps on relevant models to see if this level of is sufficient is cheap so it would be nice to keep it timepoint cachenow const return performs the memory allocation for the data and sums members of a void pmatrix ,ruy profile cache ejection piperorigin revid change id , xla python fix a bug in the hlo client piperorigin revid change id icccbcbdbcfaadbee
495,include set include sstream include string include type traits include utility include vector include gmock gmock actions h class functionmocker r args final public untypedfunctionmockerbase const oncallspec f const spec args if spec nullptr os internal type equals result void value returning directly n returning default value n os std is void result value returning directly n returning default value n else os taking default action specified at n formatfilelocation spec file spec line n ,remove custom implementations of std is same , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
496,void greedypatternrewritedriver simplifyfunction addtoworklist operand getowner res replacealluseswith i op erase op erase continue ,when canonicalizing only erase the operation after calling the hook if replacement results were supplied this fixes a bug where the operation would always get erased even if it was modified in place piperorigin revid , xla gpu support for the hlo client piperorigin revid
497,else pylint disable line too long console scripts 'tensorboard tensorflow tensorboard backend tensorboard main' 'tensorboard tensorflow tensorboard tensorboard main' pylint enable line too long ,fix tensorboard import path , fix a bug in the docstring of the new module piperorigin revid
498,eval1 char u arg typval t rettv evalarg t evalarg char u p int getnext clear pointer rettv get the first variable ,patch v lock is used when it is not initialized problem v lock is used when it is not initialized yegappan lakshmanan solution initialize the typval in eval , patch problem when using a channel to be a bit a bit slow solution add a test for the gui
499,register kernels gpu double undef register cpu kernels undef register kernels note this op works on cpu only template typename t typename tindex class sparseapplyrmspropop public opkernel class sparseapplyrmspropop public opkernel errors invalidargument indices must be one dimensional for int d 1 d var dims d op requires ctx var dim size d grad dim size d errors invalidargument var and grad must match in dimension d op requires ctx var dim size d grad dim size d errors invalidargument var and grad must match in dimension d const tindex n indices dim size 0 op requires register kernels double int64 undef register kernels namespace tensorflow ,improved the formatting of the code change , add support for int int piperorigin revid
500,class testdistributionstrategywithdatasets test testcase with self cached session with distribution scope input img keras layers input 64 64 3 name 'img' input lbl keras layers input 64 64 1 name input lbl keras layers input 64 64 2 name input weight keras layers input 64 64 name 'weight' predict keras layers conv2d 2 1 1 padding 'same' input img loss lambda keras layers lambda class testdistributionstrategywithdatasets test testcase return inputs targets fake imgs np ones 50 64 64 3 dtype np float32 fake np ones 50 64 64 1 dtype np float32 fake np ones 50 64 64 2 dtype np float32 fake weights np ones 50 64 64 dtype np float32 data dataset ops dataset from tensor slices ,fix failed test case signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the input piperorigin revid
501,class oplevelcostestimator int n int k struct std vector int batch dims matmul dims struct convolutiondimensions int64 batch batch size int64 ix input size x class oplevelcostestimator bool found unknown shapes const int64 const opinfo op info bool found unknown shapes const int64 const opinfo op info batch mat mul bool found unknown shapes const int64 countconv2dbackpropinputoperations const opinfo op info convolutiondimensions returned conv dims bool found unknown shapes const ,adding a data structure to extract batch mat mul parameters along with a version of the that can extract batch mat mul parameters piperorigin revid change id , fix a bug in the graph piperorigin revid
502,static char features static int included patches add new patch number below this line 2265 ,patch position unknown for a mouse click in a popup window problem position unknown for a mouse click in a popup window solution set v mouse col and v mouse lnum closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
503,namespace detail template class t static t step const t x const t f0 const t f1 const t f2 using std fabs t denom 2 f0 t num 2 f1 f0 f2 f1 t delta ,add test case for root finding also fix missing using declaration in roots hpp , fix a bug in the parser test for the new code svn r
504,test const string credentials json r client id test client id client test client client refresh token test refresh token type user test std vector httprequest requests new fakehttprequest uri https www googleapis com v3 token n post body client id test client id client test client client refresh token test refresh token type refresh token n env ,change the client secret that looks like a private key to something more obviously fake piperorigin revid change id , fix a bug in the test piperorigin revid
505,find name end arg expr start expr end flags else if br nest 0 mb nest 0 p ' ' s is start of s var but n is not and can be used in slice n also xx is not a namespace slice n also xx is not a namespace but ns is len int p arg if len 1 vim strchr namespace char arg null len 1 len 1 p 1 ' ' break ,patch problem using ns in variable name does not work lilydjwg solution fix recognizing colon add a test , patch problem when using a terminal window is a bit slow solution add a test for the command line
506,tflitestatus evalgeneric tflitecontext context tflitenode node tflitestatus tflitecontext context tflitenode node opcontext op context context node gemmlowp scopedprofilinglabel label sum const auto input op context input const auto output op context output const bool same scale ,add gemmlowp label for squareddifference and sum ops piperorigin revid , add support for int int piperorigin revid
507,limitations under the license include tensorflow core platform logging h include tensorflow core platform windows windows file system h pragma comment lib lib namespace tensorflow namespace ,revert make tutorial example trainer build on windows with bazel , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
508,class defun object def call self func various sanity checks on the callable func if not callable func raise valueerror func s must be callable func raise valueerror function s must be callable func func should not use kwargs and defaults argspec tf inspect getargspec func if argspec keywords or argspec defaults raise valueerror functions with argument defaults or keywords arguments are not supported raise valueerror function with argument defaults or keywords arguments are not supported has defaults and keywords format func argspec defaults argspec keywords computes how many arguments 'func' has min args len argspec args ,preserve decorators applied to inner functions use a lightweight internal only decorator that is compatible with tf function piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the input piperorigin revid
509,static char features static int included patches add new patch number below this line 359 358 ,patch 'number' and 'relativenumber' are not properly tested problem 'number' and 'relativenumber' are not properly tested solution add tests change old style to new style tests ozaki kiichi closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
510,class textembeddingmodel tf train checkpoint return tf nn safe embedding lookup sparse embedding weights self embeddings sparse ids tf sparse sparsetensor token ids token values token dense shape sparse ids tf sparse sparsetensor token ids token values token dense shape sparse weights none combiner sqrtn ,fix pylint errors line too long , fix a bug in the docstring of the test case piperorigin revid
511,grapplerfunctionitem grapplerfunctionitem graphdef other return this std vector string outputtensors const grapplerfunctionitem item std vector string output tensors for const outputargexpansion output item outputs for const string tensor output output tensors output tensors push back tensor return output tensors bool const functiondef func const auto is type parametrized const opdef argdef arg return arg type attr empty arg number attr empty ,resolve inlined function input output types from grapplerfunctionitem remove duplicated code to resolve type from attributes piperorigin revid , fix a bug in the parser test piperorigin revid
512,def sparse mask a mask indices name none with ops name scope name sparse mask a mask indices as name indices a indices out indices to gather setdiff1d indices mask indices out indices to gather gen array ops list diff indices mask indices out values gather a values to gather name name return ops indexedslices out values out indices a dense shape ,add deprecation messages specifically replace tensorflow api modules with a an object and getattr method to print warnings i'm going with overriding getattr approach so that isinstance and subclassing works for deprecated classes piperorigin revid , fix a bug in the docstring of the docstring of the test case piperorigin revid
513,static int netlink opts nr sol netlink opts netlink add membership netlink drop membership netlink pktinfo netlink broadcast error netlink no enobufs define nr sol tipc opts 6 static int tipc opts nr sol tipc opts tipc importance tipc src droppable tipc dest droppable tipc conn timeout tipc node recvq depth tipc sock recvq depth void sanitise setsockopt int childno void sanitise setsockopt int childno break case sol tipc shm a4 childno sizeof u32 val rand nr sol tipc opts shm a3 childno tipc opts val break case sol rxrpc case sol pppol2tp case sol bluetooth ,tipc support for setsockopt , proto llc to use the syscall process
514,ui set shellsize mustset ifdef feat gui if gui in use gui set shellsize mustset ifdef win3264 true else false endif resize both gui set shellsize mustset true resize both else endif mch set shellsize ,updated for version problem only ms windows limits the gui window size to what fits on the monitor solution limit the size for all systems daniel , patch problem when using a terminal window is a bit slow solution add a test for the gui
515,void decode main started char buf struct msg mainstarted mainmsg mainmsg struct msg mainstarted buf printf main started pid d number of children d shm p p initial seed u n mainmsg hdr pid mainmsg num children mainmsg shm begin mainmsg shm end printf main started pid d shm p p initial seed u n mainmsg hdr pid mainmsg shm begin mainmsg shm end mainmsg initial seed ,num children moved to the handshake message , patch problem when using a popup window with a terminal window solution add a test for the mouse flag
516,check termcode key name 0 int ks extra key name 1 int ke ignore slen i 1 tp i esc if tp i 0x07 i 1 len tp i 1 0x18 sometimes the 0x07 is followed by 0x18 unclear when this happens slen break if i len ,patch sometimes an xterm sends an extra ctrl x problem sometimes an xterm sends an extra ctrl x after the response for the background color related to t rs solution check for the ctrl x after the terminating x , patch problem when using a terminal window is a bit slow solution add a test for the gui
517,def castgrad op grad return math ops cast grad src type else return none ops registergradient fft2d def grad size math ops cast array ops size grad dtypes float32 return math ops ifft2d grad math ops complex size 0 ops registergradient ifft2d def grad 1 math ops cast array ops size grad dtypes float32 return math ops fft2d grad math ops complex 0 ,adds gradients for fftd and ifftd change , tf data dataset to tf data dataset piperorigin revid
518,limitations under the license this file implements logic for lowering lhlo dialect to affine dialect include absl memory memory h include mlir dialect affineops affineops h from llvm project include mlir dialect affine ir affineops h from llvm project include mlir dialect standardops ir ops h from llvm project include mlir ir attributes h from llvm project include mlir ir location h from llvm project ,bump open source llvm revision to piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
519,static char features static int included patches add new patch number below this line 1334 1333 ,patch github workflow timeout needs tuning problem github workflow timeout needs tuning solution use a minute timeout fail when timing out ken takata closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
520,include stdlib h if msc ver gtest disable msc warnings push 4127 conditional expression is constant endif msc ver if gtest is threadsafe using testing scopedfaketestpartresultreporter using testing testpartresultarray int main int argc char argv are registered and torn down in the reverse order testing addglobaltestenvironment new fooenvironment testing addglobaltestenvironment new barenvironment if msc ver gtest disable msc warnings pop endif msc ver return runalltests ,msvc warnings silence , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
521,datatypevector dt qint8 dt quint8 dt qint32 else defined android elif defined android types full datatypevector return dt float dt int32 dt int64 datatypevector return dt float dt int32 dt int64 dt qint8 dt quint8 dt qint32 datatypevector quantizedtypes return dt qint8 dt quint8 dt qint16 dt quint16 dt qint32 datatypevector realandquantizedtypes return dt float dt int32 dt int64 dt qint8 dt quint8 dt qint16 dt quint16 dt qint32 else defined android defined android types full datatypevector return dt float dt int32 ,adding more types for android types full profile change , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
522,limitations under the license include tensorflow compiler tf2xla xla op registry h include tensorflow compiler xla client lib constants h include tensorflow core framework kernel def builder h include tensorflow core framework tensor shape h namespace tensorflow class public xlaopkernel public explicit opkernelconstruction ctx xlaopkernel ctx datatype dtype tensorshape tensor shape tensor shape can be unknown partialtensorshape tensor shape op requires ok ctx ctx getattr dtype dtype op requires ok ctx ctx getattr shape tensor shape op requires ok ctx tensorshapetoxlashape dtype tensor shape shape ,tfxla support unknown ranked tensor in fake param unknown ranked tensor are expressed as xla shape t as used in other places across the tfxla bridge i don't quite like it but fixing that is outside the scope of this cl piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
523,def train and evaluate estimator train spec eval spec 'for distributed training there can only be one evaluator task ' ' with task id 0 given task id ' format config task id executor run return executor run class session run hook sessionrunhook ,actually return the value from train and evaluate piperorigin revid , update docstring for tf nn rnn py
524,class nnapidelegatekernel break case ktflitebuiltinsoftmax if version 1 const auto input context tensors node outputs data 0 if input type ktflitefloat32 input type ktfliteuint8 return nullptr const int input rank input dims size if input rank 4 return nullptr before api level 29 only 2d and 4d input tensors were supported if android sdk version kminsdkversionfornnapi12 if input rank 2 input rank 4 return nullptr return const nnapiopmappingargs mapping args aneuralnetworksoperationtype auto builtin reinterpret cast tflitesoftmaxparams mapping args node builtin data mapping args builder addscalarfloat32operand builtin beta optional scalar specifying the dimension the activation would be performed on is not added default to 1 return aneuralnetworks softmax ,updated softmax to check input type and rank piperorigin revid , fix a bug in the new delegate piperorigin revid
525,init longversion void strlen vim version date only strlen date time longversion char alloc len longversion char alloc unsigned len if longversion null longversion vim version long else static char features static int included patches add new patch number below this line 156 155 ,patch ms windows compiler warning problem ms windows compiler warning solution add a type cast mike williams , patch problem when using a terminal window doesn't work solution add a test for the gui
526,static char features static int included patches add new patch number below this line 831 ,patch xxd test fails if man page has dos fileformat problem xxd test fails if man page has dos fileformat solution make a copy with unix fileformat , patch problem when using a channel to be a bit a bit slow solution add a test for the test
527,patch test mock patch modir dir tmp hparams hparam lib hparams learning rate 0 01 must specify output dir msg must specify an output directory missing model dir err msg must specify a model directory in run config missing model dir err msg must specify a model directory model dir in run config exp not callable msg experiment builder is not callable invalid hparams err msg hparams must be hparams instance not exp type msg experiment builder did not return an experiment ,improve the docstring for learn runner with new experiment fn piperorigin revid , xla gpu support for the layout of the xla client piperorigin revid
528,see the license for the specific language governing permissions and limitations under the license include cmath include tensorflow compiler xla tests exhaustive op test utils h ifdef fast math binary test 16bit min todo bixia pow fails with bfloat16 on cpu binary test 16bit disabled on cpu pow run pow std powf run pow std pow todo bixia atan2 fails with bfloat16 on cpu binary test 16bit disabled on cpu atan2 run atan2 std run atan2 std atan2 if defined xla backend does not support float16 instantiate test suite p f16 ,replace with pow and with atan gcc doesn't support them also add the missing header include cmath piperorigin revid change id , add a test for the new op op piperorigin revid
529,class spectralopstest test testcase inverse stft error test compute gradient error stft stft shape inverse stft inverse stft shape self assertless stft error 2e 3 self assertless inverse stft error 4e 4 self assertless inverse stft error 5e 4 if name main ,relax tolerance to fix oss test failure on macos piperorigin revid , fix a bug in the docstring of the test piperorigin revid
530,char u str blob t blob blob alloc char u s str if blob null return null if s 0 '0' s 1 'z' s 1 'z' goto failed s 2 ,patch may use null pointer when out of memory problem may use null pointer when out of memory coverity solution check for blob alloc returning null , patch problem when using a terminal window is a bit slow solution add a test for the test
531,from tensorflow python data ops import dataset ops from tensorflow python eager import context from tensorflow python eager import function from tensorflow python framework import dtypes from tensorflow python framework import test util as tf test util from tensorflow python framework import ops from tensorflow python keras import keras parameterized from tensorflow python keras import testing utils from tensorflow python ops import array ops class testsequential keras parameterized testcase todo kaftan this test fails w run with all keras modes file ticket parameterized parameters true false tf test util run deprecated v1 def test training and eval methods on symbolic tensors self deferred with self cached session with ops graph as default self cached session def get model if deferred ,remove the private test annotation for run deprecated v replaced it with ops graph as default also add some todos to update the tests which is currently only run in graph mode piperorigin revid change id , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
532,syn cmd keyword eap syncing if p 1 nul emsg2 missing ' ' s kw kw p 2 skip over the nul break goto error if p 1 ' ' if p 2 nul emsg3 trailing char after ' ' s s kw p 2 goto error kw p 1 skip over the break syn cmd keyword eap syncing error vim free keyword copy vim free syn opt arg cont in list vim free syn opt arg next list ,patch problem invalid memory access for syn keyword x a solution do not skip over the nul dominique pelle , patch problem when using a terminal window is a bit solution add a test for the test
533,mch start job char cmd job t job jobopt t options job jv job object jo job jv status job started if use file for in closehandle ifd 0 if use file for out closehandle ofd 1 if use out for err use file for err closehandle ifd 0 closehandle ofd 1 if use out for err use null for err closehandle efd 1 job jv channel channel ,patch problem ms windows some files remain after testing solution close the channel output file wait for the file handle to be closed before deleting the file , patch problem when using a terminal window is a bit slow solution add a test for the command line
534,void hlomodule replacecomputations case hloopcode kmap case hloopcode kreduce case hloopcode kreducewindow case hloopcode kscatter case hloopcode kscatter case hloopcode ksort hlocomputation new arg tensorflow gtl findwithdefault replacements instruction to apply nullptr if new arg nullptr ,sort has a and should be included in a check , xla python add a xla hlo flag to the hlo hlo flag to the hlo hlo dialect to the hlo hlo dialect to the hlo dialect to the hlo dialect piperorigin revid change id ifaabbbebbb
535,class threadpooldevice public localdevice status sync override return status ok void compute opkernel op kernel opkernelcontext context override void computeasync asyncopkernel op kernel opkernelcontext context asyncopkernel donecallback done override private allocator allocator not owned std unique ptr scopedallocatormgr scoped allocator mgr ,expose step container name in tracemes for ops piperorigin revid , xla gpu support for the xla client piperorigin revid
536,struct gpudevice t int64 out cols output dim size 3 if padding padding same pad planes out planes 1 strides 0 filter planes in planes pad planes std max int64 0 out planes 1 strides 0 filter planes in planes pad rows std max int64 0 out rows 1 strides 1 filter rows in rows pad cols std max int64 struct gpudevice t transformed input tensor t 5 input transformed input check pad rows 0 pad cols 0 negative row or col paddings pad rows pad cols check pad rows 0 pad cols 0 pad planes 0 negative paddings pad rows pad cols pad planes perftools gputools dnn batchdescriptor input desc 3 input desc set count in batch set feature map count in depth ,clipping the negative padding for planes in convd change , fix a bug in the new delegate piperorigin revid
537,syn cmd cluster exarg t eap int syncing unused if scl id 0 syn combine list syn curwin w s scl id scl list list list op else vim free list got true get id list if count 0 emsg2 s must be first in contains list name 1 emsg2 s must be first in contains list name 1 failed true vim free name break ,patch leaking memory when syntax cluster id is unknown problem leaking memory when syntax cluster id is unknown coverity solution free the memory , patch problem when using a terminal window is a bit slow solution add a test for the command line
538,bool const graphview graph view const nodedef node returns true if node has at least one fanout node at given output port bool const graphview graph view const nodedef node int port 0 bool const graphview graph view const nodedef node bool const graphview graph view const nodedef node bool const graphview graph view const nodedef node returns true if the node has at least one input control dependency bool const graphview graph view const nodedef node returns true if the node has at least one output control dependency bool const graphview graph view const nodedef node returns true if the node has at least one input or output control dependency bool hascontrolfaninorfanout const graphview graph view const nodedef node end namespace grappler end namespace tensorflow ,grappler remapper for gpu convd biasadd activation piperorigin revid , add a new function to the graph piperorigin revid
539,class singulargradientoptest test testcase test util run deprecated v1 def testgradientatsingularity self if not compat forward compatible 2019 5 14 if not compat forward compatible 2019 6 14 self skiptest skipping test for future functionality ops and singularity ,move compat date for safe gradients change forward by one month this will give us more time do the impact of this change piperorigin revid , fix a bug in the docstring of the test piperorigin revid
540,affinestructures cpp mlir affine structures class c affinestructures cpp mlir affine structures class copyright 2019 the mlir authors ,remove unnecessary c specifier in cpp files nfc these are only required in h files to disambiguate between c and c header files piperorigin revid , fix a bug in the parser interface piperorigin revid change id iaaeaebbe
541,from setuptools import find packages setup command from setuptools command install import install as installcommandbase from setuptools dist import distribution version '0 12 0 cmake experimental' version '1 0 0 alpha cmake experimental' required packages 'numpy 1 11 0' ,update version string to alpha , updated for version problem when using a dictionary of a dictionary of a dictionary of a character solution add a test for the line
542,patternmatchresult matchandrewrite operation op patternrewriter rewriter const auto tf concat op cast tf concatop op smallvector value 4 values tf concat op values auto values tf concat op values auto output type tf concat op output gettype extract axis attribute from constant concat dims tensor elementsattr axis patternmatchresult matchandrewrite operation op patternrewriter rewriter const auto tf concat op cast tf concatv2op op smallvector value 4 values tf concat op values auto values tf concat op values auto output type tf concat op output gettype extract axis attribute from constant axis tensor elementsattr axis ,remove explicit materialization of smallvector value now that the build api takes supports operand and result ranges so many of these vectors don't need to be materialized anymore piperorigin revid change id , xla gpu support for xla hlo layout piperorigin revid change id iaaeabfdfedfeacedf
543,class cppgenerator public basegenerator public cppgenerator const parser parser const std string path const std string file name basegenerator parser path file name cur name space nullptr basegenerator parser path file name cur name space nullptr iterate through all definitions we haven't generate code for enums structs and tables and output them to a single file ,fix missing space clang format , fix a bug in the parser test piperorigin revid
544,void init watchdog void while shm watchdog pid 0 nanosleep ts null output 0 d started watchdog thread d n getpid shm watchdog pid output 0 d started watchdog process pid is d n getpid shm watchdog pid static int check shm sanity void corrupt out output 0 d watchdog thread exiting n getpid output 0 d watchdog exiting n getpid exit exit success ,stop calling the watchdog a thread the watchdog is a process not a thread , fix a bug in the watchdog page
545,type opspec struct being added controldependencies operation other possible fields device the device on which the operation should be executed if omitted an appropriate device will automatically be selected for example if set of device gpu 0 then the operation will execute on gpu 0 device string other possible fields addoperation adds an operation to g func g graph addoperation args opspec operation error return nil fmt errorf v memory will be leaked err if len args device 0 c cstring args device c tf setdevice cdesc c free unsafe pointer c c tf finishoperation cdesc status c if err status err err nil return nil err ,go support device annotations when constructing graphs piperorigin revid , fix a bug in the new delegate piperorigin revid
546,test if major 0 minor 11 return if str util consumeprefix semver head assert true semver empty return assert true str util consumeleadingdigits semver patch if semver empty return if semver 0 ' ' ,fix util semver test to allow head , fix a bug in the test case piperorigin revid
547,class tensorflowlitedialect public dialect location loc override include tensorflow compiler mlir lite experimental estimators estimator h include tensorflow compiler mlir lite ir tfl ops interface h inc define get op classes include tensorflow compiler mlir lite ir tfl ops h inc ,add experimental directory under mlir lite and add new interface for hardwares this is experimental and can be deleted at any time piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idfbdfbcdacfbeebb
548,namespace ntl boost math tools digits ntl rr inline ntl rr sinh ntl rr z return expm1 z expm1 z 2 inline ntl rr cosh ntl rr z return exp z exp z 2 inline ntl rr fmod ntl rr x ntl rr y this is a really version of fmod we rely on lots ,updated hypot with simpler formula added sinh and cosh to ntl hpp fixed freebsd test failures no real long long support svn r , fix a bug in the new parser test svn r
549,status hlocostanalysis handlecrossreplicasum const hloinstruction crs todo b compute correct cost here taking the actual number of replicas into account current properties kflopskey shapeutil elementsin crs shape double flops 0 0 shapeutil foreachsubshape crs shape this const shape subshape const shapeindex if shapeutil isarray subshape flops shapeutil elementsin subshape current properties kflopskey flops return status ok ,allow crossreplicasum to take multiple operands internally piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
550,include maps h include trinity h array size include arch h page size include random h include sanitise h include ioctls h static void scsi sg io sanitise int childno switch rand 3 case 0 sgio ioh len rand page size break case 1 sgio ioh len get interesting value break case 1 sgio ioh len unsigned int rand32 break case 2 sgio ioh len rand 512 break default break ,don't directly call the functions rand rand will sometimes call these so just use those that way we'll also get some randomness used , proto zmalloc conversion
551,status graph isvalidnode const node node const status graph isvalidoutputtensor const node node int idx const tf return if error isvalidnode node if idx node num outputs if idx node num outputs idx 0 return errors outofrange node ' node name ' type ' node op def name ' num of outputs node num outputs status graph isvalidoutputtensor const node node int idx const status graph isvalidinputtensor const node node int idx const tf return if error isvalidnode node if idx node num inputs if idx node num inputs idx 0 return errors outofrange node ' node name ' type ' node op def name ' num of inputs node num inputs ,check that isvalid input output tensor is only given non control edges piperorigin revid , add a test for the graph and the graph piperorigin revid
552,bool matchandexplain return true void describeto std ostream os const hlomatcher describeto os os with call target that testing string call target matcher bool matchandexplain const hloinstruction instruction testing matchresultlistener listener const if hlomatcher matchandexplain instruction listener return false testing stringmatchresultlistener sub listener bool result explainmatchresult call target matcher instruction custom call target sub listener if sub listener str empty sub listener that testing string call target matcher negation result listener custom call with call target sub listener str return result namespace testing void printto const hloinstruction inst std ostream os ,xla add hlo matcher for customcall that accepts a call target piperorigin revid , xla gpu support for the hlo client piperorigin revid change id icabdabcccecababba
553,class graphproperties const std vector opinfo tensorproperties getoutputproperties const string node name const static void filltensorpropertiesfromcontext const shape inference shapehandle const datatype shape inference inferencecontext opinfo tensorproperties private inputs grappleritem item ,improvements in graph properties cc removed code duplication and one todo reduced number of extra allocations and vector copying exposing as a function because i need it for another change related to shape inference piperorigin revid , tf data service support for tf data experimental piperorigin revid
554,statusor mlir operation hlofunctionimporter importinstructionimpl auto attr createdenseelementsattrfromliteral literal builder if attr ok return attr status mlir operation new operation func builder create mlir constantop loc attr valueordie func builder create mlir mhlo constop loc attr valueordie for auto attr attributes new operation setattr attr first attr second ,import hlo constants as ops instead of 'constant' ops ops work better with the lowering from dialect to dialect piperorigin revid change id , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
555,def download corpus project name print 'downloading corpus for s project' project name thread pool threadpool multiprocessing cpu count return not false in thread pool map download for single target fuzz targets return all thread pool map download for single target fuzz targets def profile args ,infra helper py rewrite conditional to be more readable and idiomatic conditional to be more readable and idiomatic in fact simplify further , fix a bug in the docstring of the new module piperorigin revid
556,inline bool isfloat basetype t return t base type float t base type double inline bool islong basetype t return t base type long t base type ulong inline bool basetype t return t base type bool extern const char const ktypenames extern const char ktypesizes ,c add support for boolean types in flexbuffers add support for boolean types in flexbuffers simplify casting number boolean added comments for tests add proper support for booleans bad rebase no special case for strings removed unused test simplify logic , fix a bug in the parser test piperorigin revid
557,class audioprocessor object statinfo os stat filepath tf compat v1 logging info 'successfully downloaded s d bytes ' filename statinfo st size tarfile open filepath 'r gz' extractall dest directory tarfile open filepath 'r gz' extractall dest directory def prepare data index self silence percentage unknown percentage wanted words validation percentage ,fix changes during last commit mistakenly removed proposed change during resolving merge conflict , fix a bug in the file file in the file
558,annotatecompileopandgetexecuteargtowhileargsmapping mapping emplace back it second std move while args sort the mapping according to execute operand order llvm sort mapping llvm less first llvm sort mapping populate the retval index for sharding field of the argument metadate for auto entry llvm enumerate execute device var reads indices int64 t arg index entry value cast integerattr getint ,fix code relying on implicit bool conversion of mlir value https github com llvm llvm project commit abedcececdbceefdcecc breaks this piperorigin revid change id , xla gpu support for the hlo ir piperorigin revid change id iaaffafbceeeafc
559,from future import print function import itertools import math import os import numpy as np import tensorflow as tf ,remove unused os import , fix a bug in the test case piperorigin revid
560,class gfile fileio super gfile self init name name mode mode deprecated none 'use tf gfile gfile ' tf export 'gfile fastgfile' class fastgfile fileio deprecated none 'use tf gfile gfile ' def init self name mode 'r' super fastgfile self init name name mode mode ,moved deprecated decorator to init , fix a bug in the docstring of the test case piperorigin revid
561,class gradienttape gtl arrayslice gradient output gradients std vector gradient result bool ispersistent const return persistent private tensor tape backwardfunction op tape ,clarifying when is it possible to use a tape while it is still active piperorigin revid , fix a bug in the graph piperorigin revid
562,static size t bldevs chrdevs miscdevs static void parse proc devices void file fp char name line null char p name line null size t n 0 int block major void new static void parse proc devices void while getline line n fp 0 if strcmp block devices n line 0 block 1 else if sscanf line d as major name 2 else if strcmp character devices n line 0 block 0 else if sscanf line d s major 1 if p strrchr line ' ' null continue p name strdup p if block new realloc block devs bldevs 1 sizeof block devs if new ,devices c dont use as scanf format string but instead allocate and parse the device name manually for compatibility with non glibc , patch problem when using a terminal window doesn't work solution add a test for the cursor
563,void dump childnos void for j 0 j 8 j struct childdata child if i j max children break child shm children i j if child pid empty pidslot ,make sure we don't try to dump children that don't exist , fix a bug in the previous commit piperorigin revid
564,boost auto test case signed zero test template class chartype class valtype void signed zero test impl if signbit static cast chartype 1e 6f std numeric limits chartype max 0 if signbit static cast chartype 1e 6f std numeric limits chartype max 0 boost message signed zero is not supported on this platform return ,with min max requirements svn r , fix a bug in the new parser test piperorigin revid
565,def eval results to str eval results def write summary results output dir eval results current global step logging info evaluation summary for d step s' current global step logging info evaluation summary for step d s' current global step eval results to str eval results summary writer get summary writer output dir summary summary pb2 summary ,improve readability of summary log change , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary solution add a test for the line
566,executionoptions layoututil settodefaultlayout execution options mutable shape with output layout for const std string disabled pass build options disabled hlo passes execution options mutable debug options add xla disable hlo passes disabled pass return execution options ,expose xla disable hlo passes via executablebuildoptions piperorigin revid , xla gpu support for the hlo ir piperorigin revid
567,def checkpoint exists internal checkpoint prefix tf train latest checkpoint regardless of sharded non sharded or v1 v2 returns a bool true iff a checkpoint referred to by checkpoint prefix exists a bool true if a checkpoint referred to by checkpoint prefix exists return checkpoint exists internal checkpoint exists return checkpoint exists internal checkpoint prefix deprecation deprecated ,fix parameter and typos , update docstring for tf nn rnn py
568,def calib graph to infer graph calibration graph def is dynamic op false args calibration graph def the calibration graphdef object with calibration data is dynamic op whether to create dynamic engines or static engines from calibration is dynamic op whether to create dynamic static engines from calibration returns new graphdef with placed in graph replacing calibration nodes raises ,fix line too long error on method doc , fix a bug in the docstring of the test piperorigin revid
569,std string generatefbs const parser parser const std string file name continue std string basename if parser opts keep include path basename flatbuffers stripextension it second else basename flatbuffers strippath flatbuffers stripextension it second else basename flatbuffers stripextension it second schema include basename fbs n num includes ,correct inverted logic around include prefixes inverted the logic around keeping the include prefix this change fixes the error , xla gpu support for the layout of the client client piperorigin revid
570,impl 'a monster 'a self tab get i16 monster vt hp some 100 unwrap inline pub fn name 'a self option 'a str self tab get flatbuffers forwardsuoffset str monster vt name none pub fn name 'a self 'a str self tab get flatbuffers forwardsuoffset str monster vt name none unwrap inline pub fn key compare less than self o monster bool impl 'a monster 'a inline pub fn key compare with value self val option str std cmp ordering pub fn key compare with value self val str std cmp ordering let key self name key cmp val ,don't return option from required table field accessors , fix a bug in the new module of the new module of the new module and the new module is not used by the new class and the new class is not used by the new class and the new class is not used by the same value piperorigin revid
571,public attribute iterator attribute begin attribute iterator attribute end llvm iterator range attribute iterator int return attributes size attribute getattribute int index return attributes index const attribute getattribute int index const return attributes index operations operand accessors struct operand public operand iterator operand end llvm iterator range operand iterator getoperands operand getoperand int index return operands index const operand getoperand int index const return operands index int getnumoperands return operands size operations argument accessors using argument llvm pointerunion attribute operand ,use operator class in cleanup nfc piperorigin revid , fix a bug in the parser parser test for the parser and the parser has been removed from the parser and the parser test for the parser and the parser has been removed
572,limitations under the license include grpcpp grpcpp h include absl strings str cat h include tensorflow core platform env h include tensorflow core profiler profiler service grpc pb h include tensorflow core profiler rpc profiler service impl h include tensorflow core util ptr util h namespace tensorflow void profilerserver startprofilerserver int32 port string server address absl strcat 0 0 0 0 port std unique ptr grpc profilerservice service service createprofilerservice service createprofilerservice grpc serverbuilder builder builder addlisteningport server address grpc insecureservercredentials builder registerservice service get builder registerservice service get server builder buildandstart log info profiling server listening on server address ,tf profiler fix use after free bug introduced by previous change piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
573,class queuebase object name a name for the operation optional returns the tuple of concatenated tensors that was dequeued the list of concatenated tensors that was dequeued if name is none name s self name ,update data flow ops py , fix a bug in the docstring of the documentation of the documentation of the example change
574,static struct syscalltable copy syscall table struct syscalltable from unsig unsigned int n struct syscall copy fixme use fewer shared maps it's pretty that we use a whole page just for a copy of that struct when we could fit dozens of them in a page this would cut down our proc maps a lot for n 0 n nr n copy alloc shared sizeof struct syscall if copy null ,add a fixme about the shared mmaps , patch problem when using a popup window with a popup window solution add a test for the popup window
575,void dependencyoptimizer optimizenode int node idx const auto output nodes node map getoutputs node name const int num outputs output nodes size const int num inputs node input size if num inputs 1 num outputs 1 if num inputs num outputs num inputs num outputs return vlog 1 input around node name ,optimize away noop in the common case where num inputs num piperorigin revid , add a test for the graph and the graph and the graph is not enabled piperorigin revid
576,inline raw ostream operator raw ostream os const type type return os primitive types are the atomic base of the type system including integer and floating point values primitive types are the atomic base of the type system including affine integer and floating point values class primitivetype public type public static primitivetype get kind kind mlircontext context ,clarify that the integer in primitive types is affine integer not to be confused with integertype piperorigin revid , xla gpu support for the hlo instruction piperorigin revid
577,class tensorflowestimator baseestimator if isinstance x dd series or isinstance y dd series data feeder cls data feeder daskdatafeeder self data feeder data feeder cls x y self n classes self batch size if has dask import dask dataframe as dd if isinstance x dd series and isinstance y dd series data feeder cls data feeder daskdatafeeder else if hasattr x 'next' or hasattr x ' next ' if not hasattr y 'next' and not hasattr y ' next ' raise valueerror both x and y should be iterators for streaming learning to work data feeder cls data feeder streamingdatafeeder self data feeder data feeder cls x y self n classes self batch size self data feeder data feeder cls x y self n classes self batch size def setup training self ,lint fixes import dependencies , fix a bug in the docstring of the docstring of the docstring change
578,static struct vimoption options p nodup ifdef feat diff char u p dip pv none char u filler char u null char u internal filler char u null else char u null pv none char u char u null ,patch internal diff isn't used by default as advertised problem internal diff isn't used by default as advertised solution add internal to the default value of 'diffopt' also add couple of files missing from the distribution , patch problem when using a terminal window is a bit slow solution add a test for the gui
579,tflitestatus prepare tflitecontext context tflitenode node double real multiplier 0 0 tf lite ensure status getquantizedconvolutionmultipler context input filter bias output real multiplier tf lite ensure context real multiplier 1 0 quantizemultipliersmallerthanoneexp real multiplier data output multiplier data output shift data output shift 1 int exponent quantizemultiplier real multiplier data output multiplier exponent data output shift exponent calculateactivationrangeuint8 params activation output data output activation min data output activation max ,generalize the conv op to support input product scale output scale i e output multiplier piperorigin revid , add support for int int piperorigin revid
580,class distributediteratorsingleworkertest distributediteratortestbase def self input type api type iteration type distribution enable get next as optional worker device pairs collections ordereddict for tpu device in distribution extended tpu devices for tpu device in distribution extended worker devices host device device util get host for device tpu device worker device pairs setdefault host device worker device pairs host device append tpu device ,add support for model parallelism to the tpustrategy piperorigin revid change id , fix a bug in the test case piperorigin revid
581,attribute parser parseattribute type type case token integer case token minus auto scalar parseattribute type getelementtype if scalar return nullptr if parsetoken token greater expected ' ' return nullptr return builder getsplatelementsattr type scalar ,handle parsing failure for splat elements attribute currently it emits the error but does not terminate parsing tested with unit test piperorigin revid , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
582,unsigned int new seed void unsigned int r r rand if rand 1 if rand 2 gettimeofday t 0 r t tv usec ,fix off by rand usage , make the syscall page we can be a child process
583,static char features static int included patches add new patch number below this line 380 ,updated for version problem configure silently skips interfaces that won't work solution add the enable fail if missing argument shlomi fish , patch problem when using a channel to be a bit a bit slow solution add a test for the test
584,hostcast requires its input and produces its output in host memory register op abs input x t output y t attr t bfloat16 half float double int32 int64 attr t bfloat16 half float double int8 int16 int32 int64 setshapefn shape inference unchangedshape register op complexabs ,support tf abs on cpu for int int and bfloat piperorigin revid , fix a bug in the parser test piperorigin revid
585,def matvec a overridebinaryoperatorhelper matmul matmul sparse matmul gen math ops sparse mat mul sparse matmul deprecation deprecated none use tf linalg matmul instead gen math ops sparse mat mul tf export v1 sparse matmul sparse matmul ,add rename of tf sparse matmul to tf linalg matmul to renames v py script piperorigin revid , tf data saveable shape inference for tf data dataset piperorigin revid change id iecfaffaaebbbfd
586,module tf public target d3 selection any this outer target public redraw this outer redraw public destroy this outer destroy ,readd the destroy method as it was still being used by the code change , xla python fix a bug in the test piperorigin revid
587,class tfliteconverterv2 object if self representative dataset if not isinstance self representative dataset representativedataset raise typeerror representative dataset must be an instance of representativedataset self representative dataset representativedataset self representative dataset if self representative dataset input gen is none raise valueerror provide an input generator for representative dataset provide an input generator for representative dataset todo for now use optimizations order is ignored both size and latency optimizations decide whether to apply post ,auto wrap representative dataset in tfliteconverterv piperorigin revid , fix a bug in the docstring of the docstring of the test case piperorigin revid
588,func fail func string interface len want want len got got flatbuffers table bytes b bytes uoffset flatbuffers uoffsett len b bytes table1 flatbuffers table bytes b bytes uoffset flatbuffers uoffsett len b bytes table2 flatbuffers table bytes b bytes uoffset flatbuffers uoffsett len b bytes obj2 flatbuffers table bytes b bytes pos flatbuffers uoffsett len b bytes table1 flatbuffers table bytes b bytes pos flatbuffers uoffsett len b bytes table2 flatbuffers table bytes b bytes pos flatbuffers uoffsett len b bytes obj2 func tab flatbuffers table a flatbuffers voffsett b c d byte vtable size ,go fix unknown field to signed off by koichi shiraishi zchee io gmail com , patch problem when using a terminal window is a bit solution add a test for the job
589,struct idloptions this encapsulates where the parser is in the current source file struct parserstate parserstate cursor nullptr line 1 token 1 parserstate cursor nullptr line start nullptr line 0 token 1 protected void const char source cursor source line 0 void line start cursor line 1 int64 t const flatbuffers assert cursor line start cursor line start return static cast int64 t cursor line start const char cursor const char line start int line the current line being parsed int token ,parser error message reports both the line number and the cursor position , fix a bug in the parser test piperorigin revid
590,void init sink set formatter expr stream expr attr unsigned int expr attr unsigned int or throw this attribute will not be found which will cause an exception expr attr severity level severity expr ,updated example to make sure an exception is thrown , patch problem when using a terminal window is a bit solution add a test for the mouse engine
591,class binvaluesfixedwidth test testcase value range np float32 0 0 0 0 values np float32 1 0 0 0 1 5 2 0 5 0 15 expected bins 0 0 4 4 4 4 with self assertraises errors impl invalidargumenterror with self assertraises valueerror with self cached session histogram ops histogram fixed width bins values value range nbins 5 ,change to use tensor util constant value if possible and raise valueerror signed off by yong tang yong tang github outlook com , fix a bug in the graph piperorigin revid
592,referenceutil convarray4dgeneraldimensionsdilated lhs each check trivial log if fatal trivial lhs is all 0 0 if trivial log fatal lhs is all 0 0 trivial true rhs each check trivial log if fatal trivial rhs is all 0 0 if trivial log fatal rhs is all 0 0 return result ,tf xla update tensorflow llvm release to upstream r fix broken xla build piperorigin revid , xla gpu support for the hlo instruction piperorigin revid change id iaaeabfdfedfeacedf
593,typedef eigen gpudevice gpudevice assignopt cpudevice type tf call all types register kernels tf call quantized types register kernels undef register kernels if google cuda ,register quantized types for dense assign change , fix a bug in the test case piperorigin revid
594,class conv2dtest tf test testcase filter larger than input with self assertraisesregexp valueerror filter must not be larger than the input filter must not be larger than the input tf nn conv2d tf placeholder tf float32 shape 32 20 20 3 tf placeholder tf float32 shape 20 21 3 2 strides 1 1 1 1 padding same with self assertraisesregexp valueerror filter must not be larger than the input filter must not be larger than the input tf nn conv2d tf placeholder tf float32 shape 32 20 20 3 tf placeholder tf float32 ,add support for d convolutions and pooling cpu kernels use eigen gpu kernels use cudnn change , fix a bug in the graph piperorigin revid
595,bool kernel taint param occured false void enable disable fd usage void todo build this dynamically outputerr enable fds disable fds sockets pipes perf epoll eventfd pseudo timerfd testfile memfd drm n ,todo iterate fd provider list in help text , fix a bug in the parser build piperorigin revid
596,void sanitise mremap unsigned long mask page size 1 int i flags rand64 mremap fixed mremap maymove addr mask i 0 ,now done in the struct def , make the syscall page we can be a bit more than the syscall process
597,next search hl intsave called emsg called emsg for range s pat only highlight inside the range if lnum search first line lnum search last line shl lnum 0 return if shl lnum 0 check for three situations ,patch 'incsearch' doesn't work for s g or v problem 'incsearch' doesn't work for s g or v solution also use 'incsearch' for other commands that use a pattern , patch problem when using a terminal window is a bit slow solution add a test for the gui
598,include llvm adt h include cctype namespace mlir converts a string to snake case from camel case by replacing all uppercase letters with ' ' followed by the letter in lowercase except if the ,add missing include file to cpp use of std and std islower need header file fix that and also fix the header of a file to match the file name piperorigin revid , fix a bug in the new dialect of the dialect of the dialect of the dialect is not used in the dialect of the dialect and the module to the same class piperorigin revid change id ibcaccabdeabcbbeae
599,include stdlib h include unistd h include string h include values h include arch h include debug h include tables h include trinity h num online cpus static unsigned int get cpu void static int get cpu void int i i rnd 100 static unsigned int get cpu void switch i case 0 return 1 case 1 return rnd 4096 case 2 99 case 2 return int max case 3 98 return rnd num online cpus return 0 ,get cpu type fixes needs us to return a signed int return int max as a possibility too fallthrough to allow to be a possible case , dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
600,ifndef flatbuffers base h define flatbuffers base h if defined msc ver defined debug if defined flatbuffers memory leak tracking defined msc ver defined debug define crtdbg map alloc endif include cstdlib include cstring if defined msc ver defined debug if defined flatbuffers memory leak tracking defined msc ver defined debug include crtdbg h define debug new new normal block file line define new debug new ,fixed vs memory tracking leaking into user code , fix a bug in the new parser test svn r
601,static void parse proc misc void if fp return while fscanf fp d as minor name 2 while fscanf fp d ms minor name 2 new realloc misc devs miscdevs 1 sizeof misc devs if new free name ,switch as usage to ms as well as cppcheck this also keeps newer toolchains happy which for some reason started warning , fix a bug in the watchdog process
602,instantiate test case p if xla test backend gpu xla test backend cpu class public todo b enable half data type tests for cpu xla test p testimpl eigen half instantiate test case p convolve1dtestparam 130 1 1 1 3 convolve1dtestparam 64 1 1 1 1 convolve1dtestparam 128 1 1 1 1 todo b 72566306 the following five tests fail on cpu backend due to result todo b 72566306 the following five tests failed on cpu with unreasonable relative errors last ran on 2018 02 22 if xla test backend gpu convolve1dtestparam 139 1 1 128 1 convolve1dtestparam 640 3 3 128 1 ,add to disabled tests the date they were last ran and failed this is to address the comments in cl piperorigin revid , xla gpu support for the layout of the hlo client piperorigin revid
603,do put regname dir count flags if flags put line split char u p p or p in visual mode split the lines to put the text in between if u save cursor fail goto end ptr vim strsave ml get cursor p ml get cursor if dir forward p nul mb ptr adv p ptr vim strsave p if ptr null goto end ml append curwin w cursor lnum ptr colnr t 0 false vim free ptr ptr vim strnsave ml get curline curwin w cursor col oldp ml get curline p oldp curwin w cursor col if dir forward p nul mb ptr adv p ptr vim strnsave oldp p oldp if ptr null goto end ml replace curwin w cursor lnum ptr false ,patch problem p in visual mode causes an unexpected line split solution advance the cursor first yukihiro nakadaira , patch problem when using a terminal window is a bit slow solution add a test for the gui
604,class public opkernel release the reference to the resource once we're done using it core scopedunref unref me decision tree ensemble resource if use locking mutex lock l decision tree ensemble resource get mutex tf shared lock l decision tree ensemble resource get mutex docompute context decision tree ensemble resource else docompute context decision tree ensemble resource class public opkernel release the reference to the resource once we're done using it core scopedunref unref me decision tree ensemble resource if use locking mutex lock l decision tree ensemble resource get mutex tf shared lock l decision tree ensemble resource get mutex docompute context decision tree ensemble resource else docompute context decision tree ensemble resource ,use the shared locks when reading the model piperorigin revid , fix a bug in the test case piperorigin revid
605,void compile xlaopkernelcontext ctx if is gpu output xla argmintwopass input index xla type axis else output xla argmin input index xla type axis output xla argmin input index xla type axis stable true else if is gpu ,tfxla make tf argmin stable on xla tpu piperorigin revid change id , xla gpu support for the hlo client piperorigin revid
606,static funcentry t global functions endif test alloc fail 3 3 fearg 1 t void f test alloc fail test autochdir 0 0 0 t void f test autochdir test clear search pat 0 0 0 t void f test clear search pat test feedinput 1 1 fearg 1 t void f test feedinput test garbagecollect now 0 0 0 t void f test garbagecollect now test garbagecollect soon 0 0 0 t void f test garbagecollect soon ,patch test clear search pat is unused problem test clear search pat is unused solution remove the function yegappan lakshmanan closes , patch problem when using a terminal window is a bit slow solution add a test for the test
607,public memref types represent a region of memory that have a shape with a fixed number of dimensions each shape element can be a positive integer or number of dimensions each shape element can be a non negative integer or unknown represented by any negative integer memref types also have an affine map composition represented as an array affinemap pointers class memreftype ,failed on d tensors check to allow tensors with shape piperorigin revid , xla gpu support for the hlo hlo instruction piperorigin revid change id idadedfddaccd
608,void get writable address unsigned long size struct map map struct object obj void addr null int tries 0 retry tries if tries 100 return null map get map if map size size goto retry if rand bool map get map if map size size goto retry addr map ptr map prot prot read prot write else obj get random object obj sysv shm obj global if obj sysv shm size size goto retry addr obj sysv shm ptr addr map ptr mprotect addr map size prot read prot write map prot prot read prot write mprotect addr size prot read prot write return addr ,let get writable address return some sysv shm objects , fix a bug in the watchdog page
609,include boost math tools roots hpp include boost math tools tuple hpp include utility for std pair our headers don't know what tuple type is to be used we have to supply it note this header includes no other headers this is important if this test is to be ,fix some test failures in non c mode , fix a bug in the new parser test piperorigin revid change id iaaeaebbe
610,logicalresult op getresulttypes front dyn cast or null rankedtensortype if result type result type hasstaticshape return failure bool changed false for uint64 t i 0 e op getnumoperands i e i check that the i'th operand is a broadcast auto broadcast llvm dyn cast or null tf broadcasttoop logicalresult update the operand of the op to be the operand of the broadcast rewriter op op getopoperand i set broadcast input return success changed true return failure return success changed void runonfunction ,support folding multiple broadcasts in the pass previously if both operand was a foldable broadcast we only folded the first one piperorigin revid change id , fix a bug in the toy latelowering piperorigin revid change id ieffeabbcfbfbfadcee
611,void deriveeventsfromhosttrace const xplane host trace void generatederivedtimelines const groupmetadatamap group metadata map xspace space bool step info only for xplane plane space mutable planes derived only generated for device traces if plane name deriveeventsfromannotations group metadata map plane step info only std vector xplane device traces findmutableplaneswithprefix space kgpuplaneprefix generatederivedtimelines group metadata map device traces step info only void generatederivedtimelines const groupmetadatamap group metadata map ,remove from xplane schema h piperorigin revid change id , xla gpu support for the hlo hlo client piperorigin revid change id idadedfddaccd
612,static char features static int included patches add new patch number below this line 915 914 ,patch wrong initialisation of global problem wrong initialisation of global solution use init , patch problem when using a channel to be a bit a bit slow solution add a test for the test
613,inline size t inlinealignment const type type struct enumval enumval const std string name int64 t val name name value val enumval enumval value 0 offset reflection enumval serialize flatbufferbuilder builder const parser parser const class parser public parserstate bool deserialize const reflection schema schema type const reflection type type checks that the schema represented by this parser is a safe evolution of the schema provided returns non empty error on any problems std string conformto const parser base ,fix high warnings from pvs studio fix high warnings from pvs studio introduced flatbuffers attribute macro to use attribute if modern c compiler used update the note about cplusplus usage in the msvc , fix a bug in the parser test piperorigin revid
614,bool gpumultioutputfusion legaltofuse hloinstruction instr1 return false multi output loop fusions must have equal output shapes to be lowered if instr1 fusion kind hloinstruction fusionkind kloop shape shape1 instr1 ismultioutputfusion instr1 shape tuple shapes 0 instr1 shape shape shape2 instr2 ismultioutputfusion instr2 shape tuple shapes 0 instr2 shape if shapeutil equal shape1 shape2 return false do this check last as it may be expensive return gpuinstructionfusion fusionwouldbetoolarge instr1 instr2 ,xla gpu do not fuse loop fusions with different output shapes piperorigin revid , xla gpu support for the hlo evaluator piperorigin revid change id icabdabcccecababba
615,class dumpingdebugwrappersessiontest test util tensorflowtestcase self assertequal repr self inc v dump run fetches info self assertequal repr none dump run feed keys info def self sess dumping wrapper dumpingdebugwrappersession self sess session root self session root log usage false sess run self inc v dump dirs glob glob os path join self session root run cwd os getcwd try os chdir self session root dump debug data debugdumpdir os path relpath dump dirs 0 self session root self assertallclose 10 0 dump get tensors v 0 debugidentity finally os chdir cwd def self sess dumping wrapper dumpingdebugwrappersession self sess session root self session root log usage false ,tfdbg add test for loading debugdumpdir with a relative path piperorigin revid , fix a bug in the test case piperorigin revid
616,static char features static int included patches add new patch number below this line 544 543 ,patch setting 'filetype' in a modeline causes an error problem setting 'filetype' in a modeline causes an error hirohito higashi solution don't add the p insecure flag when setting 'filetype' from a modeline also for 'syntax' , patch problem when using a channel to be a bit a bit slow solution add a test for the test
617,static char features static int included patches add new patch number below this line 1492 ,patch build failures problem build failures solution move typedef out of ifdef adjust argument types discover , patch problem when using a channel to be a bit a bit slow solution add a test for the test
618,include compat h include net h include random h include utils h void nfc gen sockaddr struct sockaddr addr socklen t addrlen struct sockaddr nfc nfc todo see also sockaddr nfc llcp nfc malloc sizeof struct sockaddr nfc if nfc null return nfc zmalloc sizeof struct sockaddr nfc nfc sa family pf nfc nfc dev idx rand ,proto nfc zmalloc conversion , proto zmalloc conversion
619,def num present losses weights per batch false def num elements losses with ops name scope none num elements values losses as scope return array ops size losses name scope out type losses dtype return math ops cast array ops size losses name scope dtype losses dtype tf export losses compute weighted loss ,fixes a type conversion bug in losses compute weighted loss for reduction sum over batch size piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the example change
620,f getchangelist typval t argvars typval t rettv if argvars 0 v type var unknown buf curbuf else void tv get number argvars 0 issue errmsg if type error emsg off buf tv get buf argvars 0 false emsg off buf tv get buf from arg argvars 0 if buf null return ,patch vim fixes not tested failure in getchangelist problem vim fixes for functions not tested failure in getchangelist solution add tests closes closes closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
621,statusor std unique ptr literal hloevaluator evaluate hloinstruction instruction tf ret check hlo query alloperandsareconstants instruction tf ret check instruction opcode hloopcode kparameter tf ret check instruction opcode hloopcode ktuple tf return if error shapeutil validateshape instruction shape arg literals clear ,xla remove check in hloevaluator inadvertently left out piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
622,class adadelta optimizer v2 optimizerv2 e g 2 t rho e g 2 t 1 1 rho g 2 delta x t rms delta x t 1 g t rms g t e delta x 2 t rho e delta x 2 t 1 1 rho delta x t 2 x t x t 1 delta x t x t x t 1 delta x t references see m d zeiler http arxiv org abs 1212 5701 ,fixed formatting error , update keras layers to keras piperorigin revid
623,if gtest os linux on some platforms regex h needs someone to define size t and won't compile otherwise we can include it here as we already included stdlib h which is guaranteed to define size t through stddef h include regex h nolint defines this iff google mock uses the enhanced posix regular expression syntax this is public as it affects how a user uses regular expression matchers define gmock uses posix re 1 endif gtest os linux if defined gmock uses pcre defined gmock uses posix re defines this iff regular expression matchers are supported this is public as it tells a user whether he can use regular expression matchers define gmock has regex 1 endif defined gmock uses pcre defined gmock uses posix re namespace testing namespace internal ,enables regex matchers on all platforms , fix a bug in the new page of the new page of the new seed this is a bit more than the same process and the same process and the same process and the same process is the same as the same value
624,char page allocs void alloc shared unsigned int size return mmap null size prot read prot write map anon map shared 1 0 void ret ret mmap null size prot read prot write map anon map shared 1 0 if ret map failed return null return ret static struct map alloc map ,make syscall structs shared between children , fix a bug in the watchdog process
625,syn list header int endcol 19 int newline true int name col 0 if did header syn list header if got int return true msg outtrans hl table id 1 sg name name col msg col endcol 15 else if msg col outlen 1 columns syn list header show xxx with the attributes if did header if endcol columns 1 endcol name col msg putchar ' ' msg puts attr xxx syn id2attr id msg putchar ' ' ,patch on a narrow screen hi output is confusing problem on a narrow screen hi output is confusing solution insert a space between highlight group name and xxx masato closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
626,variance name class normalization combinerpreprocessinglayer feature wise normalization of the data this layer will its inputs into a normal distribution centered around this layer will its inputs into a distribution centered around 0 with standard deviation 1 it this by the mean and variance of the data and calling input mean sqrt var at runtime ,minor docstring change delete normal piperorigin revid change id , fix a bug in the test case piperorigin revid
627,test disabled testcase disabled fail unexpected failure test in disabled test case should not be run check that when all tests in a test case are disabled setuptestcase and check that when all tests in a test case are disabled setuptestcase and teardowntestcase are not called class public test protected static void setuptestcase fail unexpected failure all tests disabled in test case setuptestcase should not be called setuptestcase should not be called static void teardowntestcase ,fix typo in comment and string , fix a bug in the new delegate test piperorigin revid
628,class variablescopetest test testcase self assertfalse ops get collection ops graphkeys global variables self assertfalse ops get collection ops graphkeys trainable variables def self with context eager mode container variable scope eagervariablestore x constant op constant 2 0 with container as default y core layers dense x 1 name my dense kernel initializer init ops ones initializer self assertallequal y 2 0 self assertequal len container variables 2 recreate the layer to test reuse with container as default core layers dense x 1 name my dense kernel initializer init ops ones initializer self assertequal len container variables 2 todo mihaimaruseac not converted to use wrap function because of typeerror expected tf group expected tensor arguments not 'none' with type ' type 'nonetype' ' ,move the test with the private symbol variable scope eagervariablestore from keras to tf piperorigin revid change id , fix a bug in the docstring of the docstring of the test case piperorigin revid
629,tflitestatus interpreterbuilder parsetensors but we really only support one value for the whole tensor todo aselle this breaks as well if these are todo aselle this assumes non per channel quantization if q params scale quantization scale q params scale get 0 if q params zero point if q params scale if q params scale size 1 error reporter report has d scale values only 1 is supported q params scale size return ktfliteerror quantization scale q params scale get 0 if q params zero point if q params zero point size 1 error reporter report has d zero point values only 1 is supported q params zero point size return ktfliteerror quantization zero point q params zero point get 0 tflitetype type ,tflite ensure only scale zero point is in quantizationparam piperorigin revid , xla gpu support for the layout of the layout is a bit piperorigin revid
630,test opversiontest fake op sig op builtinoperator transpose conv input types std vector tensortype tensortype int8 input types std vector tensortype tensortype int32 tensortype int8 tensortype int8 expect eq getbuiltinoperatorversion fake op sig 2 test opversiontest tensortype int8 tensortype int32 expect eq getbuiltinoperatorversion fake op sig 3 const auto none type static cast tflite tensortype 1 fake op sig op builtinoperator transpose conv input types std vector tensortype tensortype int32 tensortype int8 tensortype int8 none type expect eq getbuiltinoperatorversion fake op sig 2 test opversiontest ,don't use version for transposeconv if the optional bias isn't specified and fix incorrect check of version piperorigin revid change id , fix a bug in the graph piperorigin revid
631,static char features static int included patches add new patch number below this line 1135 1134 ,patch vim getting a dict member may not work problem vim getting a dict member may not work solution clear the dict only after copying the item , patch problem when using a channel to be a bit a bit slow solution add a test for the test
632,static int re mult next char what static char u e n missing after s static char u e reverse range n reverse range in character class ifdef feat mbyte static char u e large class n range too large in character class endif static char u e n unmatched s static char u e n unmatched s static char u e n unmatched s ,patch warning for unused variable in tiny build problem warning for unused variable in tiny build tony mechelynck solution add an ifdef , patch problem when using a terminal window doesn't work solution add a test for the cursor
633,public unsigned getnumoperands return size value getoperand unsigned idx return idx get value getoperand unsigned idx return getopoperand idx get void setoperand unsigned idx value value return idx set value return getopoperand idx set value support operand iteration public returns an iterator on the underlying value's value operand range getoperands mutablearrayref instoperand getinstoperands return getinstoperands mutablearrayref opoperand return getoperands instoperand unsigned idx return getinstoperands idx opoperand getopoperand unsigned idx return idx results ,rename instoperand to piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id icabdabcccecababba
634,from tensorflow python framework import ops from tensorflow python ops import array ops from tensorflow python ops import gen linalg ops from tensorflow python ops import linalg ops from tensorflow python ops import linalg ops impl from tensorflow python ops import math ops from tensorflow python ops import special math ops from tensorflow python util tf export import tf export eigvalsh linalg ops self adjoint eigvals einsum special math ops einsum expm gen linalg ops matrix exponential tf export 'linalg expm eye linalg ops impl eye eye linalg ops eye inv linalg ops matrix inverse gen linalg ops matrix logarithm tf export 'linalg ,revert unneeded change , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
635,namespace boost else value type result boost math tools sum series s boost math policies get epsilon value type policy max iter endif policies check series iterations function max iter pol policies check series iterations t function max iter pol return policies checked narrowing cast t policy result function ,add new series evaluation forms for the bessel j and y functions also take extra care when evaluating to avoid spurious overflow underflow changed check series iterations to know the real number type so messages are properly formatted updated docs to match and regenerated fixes svn r , fix a bug in the parser test that the test fails on the same case of the same class and the same value of the same value of the same value of the same value piperorigin revid
636,class replacetransformer gast nodetransformer we could allow changing just node arg so that we end up with bar baz raise valueerror 'a keyword argument may only be replaced by another keyword or a ' 'non empty list of keywords found s' repl 'non empty list of keywords found for keyword ' format repl node arg def visit functiondef self node node self generic visit node ,slightly improve the error message when attempting to replace a keyword argument with something unsupported piperorigin revid , fix a bug in the test case piperorigin revid
637,def reductiondims x reduction indices return constant op constant np arange rank dtype dtypes int32 otherwise we rely on range and rank to do the right thing at run time todo zongheng remove this once rank supports sparsetensor if isinstance x ops sparsetensor return range 0 array ops size x shape return range 0 array ops rank x ,remove an obsolete todo for sparse tensor tf rank is recently patched to work on sparsetensor change , fix a bug in the docstring of the docstring of the docstring change
638,class conv2dtranspose conv2d def build self input shape if len input shape 4 raise valueerror 'inputs should have rank ' str 4 'received input shape ' str input shape raise valueerror 'inputs should have rank 4 received input shape ' str input shape if self data format 'channels first' channel axis 1 else ,fix the wrong formatting in convolutional py , fix a bug in the docstring of the test case piperorigin revid
639,boost auto test case template test odd even t all test types note slightly unexpected this unit test passes even when t char boost auto test case template test pow t all test types if std numeric limits t digits 32 return invokes undefined behaviour polynomial t a d3a begin d3a end polynomial t const one t 1 boost array double 7 const d3a 100 120 44 108 20 24 9 ,disable test case which invokes undefined behaviour , fix a bug in the parser test piperorigin revid
640,class savedmodelbuilder object path os path join compat as bytes self export dir compat as bytes constants saved model filename pb file io write string to file path self saved model serializetostring file io write string to file path self saved model serializetostring deterministic true tf logging info savedmodel written to s compat as text path return path ,change model saver to always use deterministic serialization piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring change
641,get function args typval trettv find the end of the expression doesn't evaluate it any default true p skipwhite p 1 p skipwhite p ,patch vim optional function arguments don't work yet problem vim optional function arguments don't work yet solution implement optional function arguments , patch problem when using a terminal window is a bit slow solution add a test for the gui
642,private static void cpuid uint32 t eax uint32 t uint32 t uint32 t if defined gnuc if defined i386 defined pic pic 0 if defined i386 defined pic pic 0 defined vxworks defined pic we have to backup in 32 bit pic code because it is reserved by the abi uint32 t backup asm volatile ,protect on bit on vxworks because the gcc throws error if we don't , fix a bug in the new parser test piperorigin revid
643,include unistd h include fcntl h include sys link h include link h include sys dtrace h include sys compiler h include sys ioctl h static int gen dof helper generation extern dof hdr t sunw dof dof defined in the sunw dof section static boolean t dof init debug b false from dtrace dof init debug typedef struct link map link map dt constructor dtrace dof init static void dtrace dof init void ,remove include sys link h most of declarations of include sys link h are useless move link map to c and adjust the related files to include link h , dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
644,def rejection resample class func target dist initial dist none seed none filtered ds filtered ds prefetch 3 prob original static get prob original static initial dist target dist t if initial dist is not none else none initial dist t target dist t if initial dist is not none else none if prob original static 1 return dataset ops dataset zip class values ds dataset elif prob original static 0 ,tf data pass a tensor to tensor util constant value instead of possible a python list , fix a bug in the docstring of the test case piperorigin revid
645,def numpy input fn x shuffle boolean if true the queue avoid shuffle at prediction time queue capacity integer size of queue to accumulate num threads integer number of threads used for reading and enqueueing num threads integer number of threads used for reading and enqueueing in order to have predicted and repeatable order of reading and enqueueing such as in prediction and evaluation mode num threads should be 1 returns function that has signature of dict of features target ,update the comment for num threads in input fn change , fix a bug in the docstring of the keras model piperorigin revid
646,class multivariatenormaldiag the batch shape is the broadcast shape between loc and scale arguments the event shape is given by the last dimension of loc or the last dimension of the matrix implied by scale the event shape is given by last dimension of the matrix implied by scale the last dimension of loc if provided must broadcast with this recall that covariance scale scale t a non batch scale matrix is ,distribution added added but not exposed as part of api det covariance and log det covariance removed from some small docfix to mvn piperorigin revid , xla python fix a bug in the graph piperorigin revid
647,const graphview outputport graphview getregularfanin return fanin const std unordered set graphview outputport graphview graphview const nodedef node bool include controlling nodes const std unordered set outputport result for int i 0 i node input size i outputport fanin string fanin name parsenodename node input i fanin port id if fanin port id 0 if include controlling nodes break auto it nodes find fanin name if it nodes end fanin node it second result insert fanin return result end namespace grappler end namespace tensorflow ,implemented heuristic to decrease memory utilization of addn nodes piperorigin revid , fix a bug in the graph piperorigin revid
648,benchmarktflitemodel tflitedelegateptrmap benchmarktflitemodel getdelegates tflitegpudelegateoptionsv2 gpu opts tflitegpudelegateoptionsv2default gpu opts inference preference tflite gpu inference preference sustained speed gpu opts is precision loss allowed params get bool gpu precision loss allowed 1 0 if params get bool gpu precision loss allowed gpu opts inference priority1 tflite gpu inference priority min latency gpu opts inference priority2 tflite gpu inference priority min memory usage gpu opts inference priority3 tflite gpu inference priority max precision interpreter tflitedelegateptr delegate evaluation creategpudelegate model get gpu opts elif defined real iphone device ,use explicit inference priorities instead of setting just allow precision loss piperorigin revid change id , add a new op to the new op api piperorigin revid change id icbbdbfafcdfcae
649,class object config proto serialized setter def config proto serialized self config if isinstance config config pb2 configproto self config proto serialized config serializetostring self config proto serialized config serializetostring deterministic true elif isinstance config str self config proto serialized config elif config is none ,make saved models more deterministic nondeterministic serialized protos hurt caching piperorigin revid change id , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
650,class test testcase partitions constant op constant np arange 1000 dtype np int32 10 result data flow ops dynamic partition data partitions 10 results append self evaluate result self assertallequal results np zeros len device list 10 100 if device list self assertallequal results np zeros len device list 10 100 if name main ,make pass when on cpu only , fix a bug in the docstring of the test case piperorigin revid
651,def entergrad op grad return grad if op get attr is constant add a gradient accumulator for each loop invariant result grad ctxt addbackpropaccumulator grad if isinstance grad ops indexedslices result grad ctxt addbackpropindexedslicesaccumulator grad else result grad ctxt addbackpropaccumulator grad else result exit grad grad ctxt exitresult result ,fix for indexedslices gradient accumulation in while loop change , tf data fix a bug in the docstring of the tf data optimizer piperorigin revid
652,limitations under the license namespace tensorflow namespace class public opstestbase class public opstestbase protected void setup override std unique ptr tensorflow device device gpu class public opstestbase test f test f float 18 0f 9 0f 1e 6f 0 0f 0 0f 1e 6 0 1f 0 2f 0 3f 0 5f 0 7f 0 9f 9 0f 18 0f test f test f double 18 0 9 0 1e 6 0 0 0 0 1e 6 0 1 0 2 0 3 0 5 0 7 0 9 9 0 18 0 test f test f eigen half float static cast eigen half 18 0 static cast eigen half 9 0 static cast eigen half 1e 6 static cast eigen half 0 0 ,move mlir generated kernels to a separate directory piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
653,tensorflow status trtoptimizationpass optimize tensorflow tensorrt convert conversionparams cp if use calibration precision mode int8mode log error calibration with fp32 or fp16 is not implemented falling back to use calibration false vlog 1 calibration with fp32 or fp16 is not implemented falling back to use calibration false note that the default value of use calibration is true use calibration false ,tftrt change log error to vlog when use calibration true with fp fp , xla python add a test for the xla cpu backend piperorigin revid
654,class statusadaptorformacros define tf assert ok and assign impl statusor lhs rexpr auto statusor rexpr assert true statusor status ok statusor status lhs statusor consumevalueordie lhs std move statusor valueordie define tf status macros concat name x y tf status macros concat impl x y define tf status macros concat impl x y x y ,xla appease clang tidy by switching away from statusor consumevalueordie piperorigin revid , xla python fix a bug in the hlo evaluator piperorigin revid change id iefecfafdafabefecbd
655,class callbacklist object performance check check batch hooks for compared to batch time only run check for custom callbacks i e not present in this file self check timing self class not in globals self check timing any cbk class name not in globals for cbk in self callbacks self num batches for timing check 5 self hook times self batch start time none class callbacklist object avg begin hook time sum self hook times begin hook name len self hook times begin hook name threshold time 1 5 avg batch time threshold time 1 0 avg batch time warning msg method hook is slow compared to ' 'the batch time batch time batch time 4f s vs ' ' hook time hook time 4f s check your callbacks ' ,fix issue with callback timing check piperorigin revid change id , fix a bug in the new delegate test piperorigin revid change id idacdededdbdcfbcdb
656,status cuptimanager disabletrace void cuptimanager uint8 t buffer size t size size t vlog 2 void p port aligned malloc kbuffersize kbufferalignment void p port alignedmalloc kbuffersize kbufferalignment size kbuffersize buffer reinterpret cast uint8 t p 0 void cuptimanager cucontext ctx uint32 t streamid log warning dropped dropped activity records port aligned free buffer port buffer cuptimanager ,switch open source to use jemalloc for cpu tensor memory allocation grpc and other places where we call malloc free only enabled on linux for now added as a configure option defaulting to enabled change , fix a bug in the file file in the file
657,import tensorflow as tf from google protobuf import message from google protobuf import text format from tensorflow python framework import test util from tensorflow python lib io import file io from tensorflow python framework import test util from tensorflow python platform import resource loader from tensorflow python platform import test from tensorflow python platform import tf logging as logging def keytofilepath key api version def replacecapswithdash matchobj ,automated rollback of commit piperorigin revid , tf data service support for tf data dataset piperorigin revid
658,struct truncatednormalfunctor cpudevice t normal normal dist vectorized intermediate calculations for uniform rejection sampling we always generate at most 4 samples eigen array t 4 z eigen array t 4 g const int length std max uniform kresultelementcount normal kresultelementcount eigen array t length z eigen array t length g for int64 b start batch b limit batch b we are passed a flat array for each of the parameter tensors ,address hard code for distribution and fix build order , fix a bug in the new delegate piperorigin revid
659,automatically by the optimizers in most cases scatter sub sparse mask indexedslices exporting and importing meta graphs export meta graph import meta graph from future import absolute import ,added for metagraph change , fix a bug in the test case piperorigin revid
660,def add engine args parser def add sanitizer args parser parser add argument ' sanitizer' default 'address' choices 'address' 'memory' 'undefined' 'coverage' choices 'address' 'memory' 'undefined' 'coverage' 'profile' def add environment args parser ,infra bring configuration back to helper py for testing coverage , fix a bug in the documentation of the documentation of the documentation of the default value of the default value of the default value of the default value of the default value of the default value of the input is not used piperorigin revid
661,oplevelcostestimator oplevelcostestimator const int quantize v2 cost eigen cost scalar product op float eigen cost scalar max op float eigen cost scalar min op float eigen cost scalar round op float const int quantize and dequantize v2 cost quantize v2 cost eigen cost scalar product op float unary ops alphabetically sorted elementwise ops emplace acos eigen cost scalar acos op float oplevelcostestimator oplevelcostestimator elementwise ops emplace log eigen cost scalar log op float elementwise ops emplace log1p eigen cost scalar log1p op float elementwise ops emplace neg eigen cost scalar opposite op float elementwise ops emplace quantizeanddequantizev2 quantize and dequantize v2 cost elementwise ops emplace quantizev2 quantize v2 cost elementwise ops emplace reciprocal eigen cost scalar inverse op float elementwise ops emplace rint 1 ,added cost estimation for quantizeanddequantizev to op level cost estimator piperorigin revid change id , add a test for the graph and the graph piperorigin revid
662,class matchingfilesdatasetop public datasetopkernel filesystem fs tf return if error ctx env getfilesystemforfile dataset patterns std max size t 0 current pattern index 1 dataset patterns current pattern index 0 current pattern index 1 0 fs while filepath queue empty ,solve the size t issue in computing pattern index , fix a bug in the test case piperorigin revid
663,def wrapped get potentially supported ops def wrapped experimental mlir quantize input data str disable per channel inference type fully quantize inference type return pywrap toco api input data str disable per channel fully quantize inference type ,expose the fully quantize flag for the new mlir quantizer piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring change
664,void eigen gpudevice t operator logconvautotuneresults se dnn convolutionkind backward filter se dnn todatatype t value input desc se dnn todatatype t value input ptr filter backprop ptr out backprop ptr input desc filter desc output desc conv desc stream parent results op requires ok ctx bestcudnnconvalgorithm results algorithm config ,log buffer addresses during convolution autotuning piperorigin revid , add support for int ops piperorigin revid
665,class batchnormtest test testcase return expected var correction factor def testbatchnormcenterfalse self a array ops placeholder dtype float32 shape 10 10 10 10 a array ops placeholder dtype dtypes float32 shape 10 10 10 10 test that center false builds a valid graph layers batch norm a center false data format 'nchw' zero debias moving mean true ,update layers test py done with the necessary change please verify and get back , fix a bug in the docstring of the test piperorigin revid
666,class linearmodel training model with sparse combiner as mean the linear model outputs conceptually are with sparse combiner as mean the linear model outputs conceptually are y 0 1 0 2 0 w a w b w c b 0 y 1 w d 1 0 3 0 w e w f w g b 1 ,address pylint failures , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the input shape is not used in the graph piperorigin revid
667,limitations under the license include tensorflow core kernels bounds check h namespace eigen namespace numext if google cuda template eigen device func eigen always inline std complex float exp const std complex float x auto com expf x real auto res real com cosf x imag auto res imag com sinf x imag return std complex float res real res imag template eigen device func eigen always inline std complex double exp const std complex double x auto com exp x real auto res real com cos x imag auto res imag com sin x imag return std complex double res real res imag endif namespace numext namespace internal template typename t ,upgrade eigen version piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
668,void expected results else largest type long s double endif ifndef boost math no long double math functions if boost math tools digits long double boost math tools digits double boost math tools digits long double 100 void expected results test data group 10 10 test function endif add expected result compiler ,fix expected failure rates for platforms with no long doubles svn r , fix a bug in the previous commit case the previous commit is not used by the previous commit
669,def flag value else run name none path specification if not os path isabs path create absolute path out of relative one path os path join os path realpath ' ' path files path run name return files ,resolve relative tensorboard logs paths to absolute change id , tf data service support for tf data dataset piperorigin revid
670,win lbr chartabsize wp line s col headp col w width wp numberextra w width wp numberextra win col off2 wp if p sbr nul col colnr t strlen p sbr col colnr t strlen p sbr if numberextra 0 col col numberextra ,updated for version problem cursor movement is incorrect when there is a number column sign fold column and is displayed solution adjust the column for christian brabandt , patch problem when using a terminal window is a bit solution add a few more tests to the new code
671,without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license ifdef google cuda include tensorflow core kernels collective nccl reducer h include algorithm limitations under the license include tensorflow core public session options h include tensorflow core public version h ifdef google cuda namespace tensorflow static constexpr int kstepid 10 ,build fix for collective nccl reducer test gpu for non cuda builds piperorigin revid , add a test for the new op op piperorigin revid
672,def validate cuda config environ cp cuda libraries 'cuda' 'cudnn' if is linux if environ cp get 'tf need tensorrt' none if int environ cp get 'tf need tensorrt' false cuda libraries append 'tensorrt' if environ cp get 'tf nccl version' none cuda libraries append 'nccl' ,fix configure trying to find tensorrt when it shouldn't piperorigin revid , fix a bug in the docstring of the documentation of the tf data dataset piperorigin revid
673,struct pointeeof t typedef t type nolint smart pointer or returns p itself when p is already a raw pointer the following default implementation is for the smart pointer case template typename pointer inline typename pointer element type getrawpointer const pointer p inline const typename pointer element type getrawpointer const pointer p return p get this overloaded version is for the raw pointer case ,makes gmock's work for optional t by jeffrey yasskin , fix a bug in the parser test piperorigin revid
674,gui mch init void if defined msc ver msc ver 1400 define handletolong for old ms and non ms compilers if not defined ifndef handletolong define handletolong h long h define handletolong h long intptr t h endif endif set the v windowid variable ,patch problem a few more compiler warnings axel bender solution add type casts , patch problem when using a terminal window is a bit slow solution add a test for the gui
675,def efficientnet input shape optional shape tuple only to be specified if include top is false it should have exactly 3 inputs channels pooling optional pooling mode for feature extraction when include top is false it could be none means that the output of the model will be the 4d tensor output of the last convolutional layer avg means that global average pooling will be applied to the output of the last convolutional layer and thus the output of the model will be a 2d tensor max means that global max pooling will be applied pooling optional pooling mode for feature extraction when include top is false if 'max' or 'avg' pooling is applied the output of the model will be a 2d tensor none will directly output the last convolutional layer a 4d tensor classes optional number of classes to classify images into only to be specified if include top is true and if no weights argument is specified ,the lines going over characters add the missed article grammar , fix a bug in the docstring of the docstring of the test case piperorigin revid
676,func t table indirect off uoffsett uoffsett string gets a string from data stored inside the flatbuffer func t table string off uoffsett string return string t bytevector off b t bytevector off return b bytevector gets a byte slice from data stored inside the flatbuffer ,fix heap allocation when reading a string , patch problem when using a terminal window doesn't work properly solution add a test for the job
677,void ssematrixbatchvectormultiplyaccumulate postamble for 8 bit inputs if col m cols 3 const m128i vec 32x4 mm epi32 mm si128 reinterpret cast const int vectors col mm reinterpret cast const m128i vectors col const m128i row 32x4 mm epi32 mm si128 reinterpret cast const int row ptr col mm reinterpret cast const m128i row ptr col dotprod vec ¬∑ row dotprod 32x4 mm add epi32 dotprod 32x4 mm epi32 vec 32x4 row 32x4 ,rollback load only bit from memory in the x bit case instead of due to ubsan errors piperorigin revid change id , fix a bug in the new delegate piperorigin revid
678,xlaop lgamma xlaop input lgamma inf inf xlaop inf bcast fulllike input std numeric limits float infinity return select or isfinite input is finite or not or lt input one ge input one is nan result inf bcast return select isinf input inf bcast result auto b input builder ,xla use isinf function in implementation of lgamma piperorigin revid , fix a bug in the parser test piperorigin revid
679,class backendutilstest test testcase self assertequal keras backend get session run fetches x y 30 40 def test function fetch callbacks self class object def init self self times called 0 self callback result 0 def fetch callback self result self times called 1 self callback result result with self test session callback x placeholder keras backend placeholder shape y placeholder keras backend placeholder shape callback op x placeholder y placeholder f keras backend function inputs x placeholder y placeholder outputs x placeholder y placeholder f fetches append callback op f fetch callbacks callback op callback fetch callback f 10 20 self assertequal callback times called 1 self assertequal callback callback result 200 class test testcase ,update tensorboard callback to run histogram summaries within keras test function and to write histogram outputs with a batch level global step piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
680,version '1 4 0' required packages 'absl py 0 1 6' weakref finalize introduced in python 3 4 'backports weakref 1 0rc1 python version 3 4 ' enum module introduced in python 3 4 'enum34 1 1 6 python version 3 4 ' needed for unittest mock in python 2 'mock 2 0 0 python version 3 0 ' 'numpy 1 12 1' 'six 1 10 0' 'protobuf 3 4 0' ,closes piperorigin revid , fix a bug in the new module of the new module piperorigin revid
681,statusor bool hlocse run hlomodule module for auto instruction computation makeinstructionpostorder if the instruction has zero operands constants parameters etc skip over it if instruction operand count 0 if instruction operand count 0 instruction opcode hloopcode kpartitionid instruction opcode hloopcode kreplicaid continue skip instructions which have side effects ,enable cse for piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
682,status posixfilesystem copyfile const string src const string target return ioerror src errno string translated target translatename target o wronly o creat o wronly o creat o trunc open file for write and if file does not exist create the file if file exists truncate its size to 0 when creating file use the same permissions as original mode t mode sbuf st mode s irwxu s irwxg s irwxo int target fd open translated target c str o wronly o creat mode int target fd open translated target c str o wronly o creat o trunc mode if target fd 0 close src fd return ioerror target errno ,truncate file before overwrite without o trunc the original content of the target file will be left over if the src file is shorter , xla python fix a bug in the hlo evaluator piperorigin revid
683,def aot compile cpu meta graph def checkpoint path for n in signature def outputs values variable names blacklist name for name node modified in all variables items if node modified 1 n name for n in variable nodes to feed ,tf saved model cli aot unit tests for aot compilation with fed variables fixes a bug where we were freezing readonly variables now we do not freeze any variables that are to be fed piperorigin revid change id , fix a bug in the test case piperorigin revid
684,import time import numpy as np import six from google protobuf any pb2 import any from google protobuf import text format from tensorflow core framework import graph pb2 class saver object update checkpoint state save path model checkpoint path self last checkpoints latest filename meta graph file name join checkpoint file meta graph suffix self export meta graph meta graph file name with sess graph as default self export meta graph meta graph file name return model checkpoint path def get kind name item kind int64 list elif isinstance item float kind float list elif isinstance item any kind any list else kind node list return kind ,added the use of google protobuf any in meta graph proto to allow packing any any user protos change , fix a bug in the docstring of the test piperorigin revid
685,struct deviceinfo deviceinfo default explicit deviceinfo cl device id id bool isadreno const bool isadreno3xx const bool const bool const bool const bool isadreno6xxorhigher const bool ispowervr const bool isnvidia const bool ismali const bool isamd const bool isintel const bool supportstexturearray const bool supportsimagebuffer const bool supportsimage3d const ,added default compile concat and changed to support new style piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id id iaaeabfdfedfeacedf
686,def import graph def graph def input map none return elements none node 'input tensor r s' input name te pylint disable protected access if op input dtypes input types if op input types input types raise valueerror node 'input types mismatch expected r but got r ' ' ' join dtypes as dtype x name for x in input types ' ' join x name for x in op input dtypes ' ' join x name for x in op input types pylint enable protected access if not g is function op type pylint disable protected access ,remove private operation input dtypes alias this isn't necessary for anything but it limits the surface area of private api piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
687,static char features static int included patches add new patch number below this line 1415 1414 ,patch problem dropped the skip tags setting solution put it back , patch problem when using a channel to be a bit a bit slow solution add a test for the test
688,from tensorflow python platform import tf logging reader dataset ops textlinedataset tfrecorddataset fixedlengthrecorddataset fixedlengthrecorddataset fixedlengthrecorddatasetv2 ,add to the reader list of tf contrib distribute so that tf contrib input op could correctly locate the dataset signed off by yong tang yong tang github outlook com , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
689,hlotestbase hlotestbase se platform test platform static std unique ptr hlomodule hlotestbase createnewmodule const string name hlomoduleconfig config auto debug options hlotestbase getdebugoptionsfortest debug options set xla gpu max kernel unroll factor 1 config set debug options debug options config set debug options getdebugoptionsfortest return makeunique hlomodule name versionedcomputationhandle config std unique ptr hlomodule hlotestbase createnewmodule const string name auto debug options legacy flags getdebugoptionsfromflags todo b change tests to use parameters instead of constants debug options add xla disable hlo passes constant folding debug options set xla gpu max kernel unroll factor 1 return debug options ,xla consistently apply gpu max kernel unroll factor in hlotestbase previously we set it in createnewmodule but not in getdebugoptionsfromflags which seems wrong piperorigin revid , xla gpu support for the hlo client piperorigin revid change id icbbdbfafcdfcae
690,def ctc loss labels inputs sequence length this op implements the ctc loss as presented in the a s f j schmidhuber a s f j schmidhuber temporal classification sequence data with recurrent neural networks icml 2006 pp 369 376 http www cs edu icml 2006 pdf with recurrent neural networks icml 2006 pp 369 376 http www cs edu icml 2006 pdf input requirements ,make link clickable make link clickable wrap to not sure if this works undo , fix a bug in the docstring of the docstring of the docstring change
691,status cuptitracer cucontext context uint32 t stream id return status ok static std string cuptitracer if cuptitracer numgpus 0 return no gpu detected else if cuptitracer return insufficient to run libcupti you need root permission else if cuptitracer gettimestamp 0 return failed to load libcupti is it installed and accessible return namespace profiler namespace tensorflow ,prepare for surfacing libcupti errors to the overview page of the profiler piperorigin revid change id , xla gpu support for xla cpu piperorigin revid change id idaceccfcbacfece
692,class collectiveallreducestrategytestbase self cached session config config target master target as sess iterator distribution make input fn iterator input fn sess run iterator initialize sess run iterator initializer for expected value in expected values next element iterator get next class collectiveallreducestrategytestbase after re initializing the iterator should be able to iterate again if test reinitialize sess run iterator initialize sess run iterator initializer for expected value in expected values next element iterator get next ,move to using from to be more consistent with the tf data apis piperorigin revid change id , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
693,inline llvm hash code hash value operationname arg be used as a temporary object on the stack it is generally unwise to put this in a collection struct operationstate mlircontext const context location location operationname name smallvector value 4 operands ,nfc remove the explicit context from operation create and operationstate the context can easily be recovered from the location in these situations piperorigin revid , fix a bug in the parser test piperorigin revid
694,class annotatedtraceme scoped annotation emplace absl string view name if tf predict true traceme enabled trace me emplace name std move name return name level trace me emplace name return std move name level ,avoid a copy in piperorigin revid change id , fix a bug in the test case piperorigin revid
695,void const t value std ostream os 7 3 4 1 namespace udir this allows us to fall back onto testing internal2 operator in case t doesn't come with a operator we cannot write 'using testing internal2 operator ' which gcc 3 3 fails to compile due to a compiler bug using namespace testing internal2 nolint using testing internal2 operator assuming t is defined in namespace foo in the next statement the compiler will consider all of ,remove g workaround using on operator , xla gpu support for the hlo instruction piperorigin revid change id icabdabcccecababba
696,class mirroredextended distribute lib strategyextendedv1 cross device ops lib choose the best devices self host input device numpy dataset singledevice cpu 0 self is multi worker training false logging info using mirroredstrategy with local devices r devices def initialize multi worker self devices class mirroredextended distribute lib strategyextendedv1 containing job names self inferred cross device ops cross device ops lib ncclallreduce logging info using mirroredstrategy with remote devices r devices def get variable creator initial value self replica id device ,log list of devices in the constructor of mirroredstrategy piperorigin revid , fix a bug in the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
697,tflitestatus interpreterbuilder buildlocalindextoregistrationmapping namespace template class t std vector int t flat array initialize shape of tensors with null shape empty vectors are converted to nullptr for models that are constructed via flatbuffers pack if flat array nullptr return std vector int ret flat array length for int i 0 i flat array length i ret i flat array get i ,handle model deserialization when output tensor shape is null in flatbuffers vectors default to null original change by piperorigin revid , xla gpu support for the layout of the layout is a bit piperorigin revid
698,def get logged ops graph run meta none if run meta graph fill missing graph shape graph run meta op missing shape 0 logged ops graph def graph as graph def for node in graph def node def get logged ops graph run meta none stats ops get stats for node def graph node registered flop stats except valueerror catch exception when shape is incomplete skip it op missing shape 1 stats none if not stats or not stats value def get logged ops graph run meta none logged ops entry name entry else logged ops v op name types append trainable variables if op missing shape 0 and not run meta sys stderr write ' d ops no flops stats due to incomplete shapes ' 'consider passing run meta to use run time shapes n' op missing shape return logged ops ,improve tfprof doc support binary graphdef change , fix a bug in the docstring of the test case piperorigin revid
699,class int filter top offset if padding valid filter left offset output width 1 stride filter width input width 2 output width 1 stride filter width input width 1 2 filter top offset output height 1 stride filter height input height 2 output height 1 stride filter height input height 1 2 else filter left offset output width 1 stride filter width input width 2 ,fixed the filter position for the valid padding mode , fix a bug in the documentation of the new version of the client client piperorigin revid
700,struct map common set mmap ptr len void return map routine to perform various kinds of write operations to a mapping that we created void dirty mapping struct map map bool rw rand bool if rw true check mapping is writable or we'll segv todo perhaps we should do that and trap it mark it writable then after we it if map prot prot write return random map writefn map return else if map prot prot read return random map readfn map void dirty random mapping void struct map map map get map dirty mapping map ,fold the remnants of maps fault back into maps c , patch problem when using a popup window with a terminal window solution add a test for the mouse event
701,static char features static int included patches add new patch number below this line 609 608 ,updated for version problem file names in output are garbled solution check for zs in the pattern lech lorens , patch problem when using a channel to be a bit a bit slow solution add a test for the test
702,def cudnn rnn inputs args num proj 0 if num proj is none else num proj outputs output h output c gen cudnn rnn ops cudnn args elif time major is false or num proj batch id 1 if time major else 0 time id 0 if time major else 1 batch id time id 1 0 if time major else 0 1 batch size array ops shape inputs batch id max time array ops shape inputs time id sequence lengths array ops fill batch size max time ,use a tuple for batch time id , fix a bug in the docstring of the docstring of the tf data strategy piperorigin revid change id iafeaeadbafaddecdc
703,void eagerexecutor nodedone const core refcountptr nodeitem item nodes list however we only notify if we are at the front of the list since we don't want to notify any waiters of earlier nodes need notification item id unfinished nodes begin first remove item if it exists in unfinished nodes with async execution if two separate nodes failed and enter this callback then the second node might not find itself in unfinished nodes in the following 1 callback of the first failed node clears unfinished nodes 2 clearerror is called and executor status is set to ok 3 callback of the second failed node is triggered in this case do not taint the executor status or other note items because they are inserted after the clearerror auto result unfinished nodes erase item id dcheck gt result 0 if result 0 return if status ok item node fatal ,remove the check of nodeitem exists in unfinished nodes in node callback this fixes the failure of test out of range with while loop in debug mode piperorigin revid change id , add a test for the graph and the graph piperorigin revid
704,status xlacompilationcache compileimpl const xlacompiler compileoptions compile options bool compile single op check ne executable nullptr vlog 1 xlacompilationcache compile debugstring vlog 2 xlacompilationcache compile debugstring if vlog is on 2 vlog 2 num inputs ctx num inputs status xlacompilationcache compileimpl cache eviction mutex lock entry lock entry mu if entry compiled vlog 1 compilation cache miss for signature vlog 2 compilation cache miss for signature signaturedebugstring signature tensorflow env env tensorflow env default const uint64 compile start us env nowmicros ,make logging less verbose i want vmodule xla compilation cache to print only the most essential things piperorigin revid , xla python add a test for the xla client piperorigin revid
705,graph int num void bm device cube impl testing benchmark state state const int num state range 0 test benchmark device impl num run state iterations test benchmark device impl num old benchmark api false run state const int64 tot static cast int64 state iterations num state setitemsprocessed tot state tot sizeof float ,fix and re enable cwise ops benchmark piperorigin revid change id , add a test for the graph and the graph piperorigin revid
706,class tensor internal nativeobject def disallow when autograph enabled self task raise errors operatornotallowedingrapherror is not allowed autograph did not convert this function try decorating it directly with tf function format task is not allowed autograph did convert this function this might indicate you are trying to use an unsupported feature format task def disallow in graph mode self task raise errors operatornotallowedingrapherror ,correct the error message piperorigin revid change id , fix a bug in the test case piperorigin revid
707,using std tuple size endif gtest has seh gtest api qualifies all symbols that must be exported the definitions below are guarded by ifndef to give embedders a chance to define gtest api in gtest internal custom gtest port h ifndef gtest api ifdef msc ver if gtest linked as shared library define gtest api declspec dllimport using std tuple size define gtest api attribute visibility default endif msc ver endif gtest api ifndef gtest api define gtest api endif endif gtest api ifdef gnuc ask the compiler to never inline a given function ,pick up gtest api definition in gtest internal custom gtest port h this makes it possible for a port to define the specifier used for exported symbols without having to change google test , fix a bug in the parser test piperorigin revid
708,double data values 25 06 25 18 24 87 25 51 25 34 25 41 int main cout example2 using student's t function if defined file defined timestamp if defined file defined timestamp defined msc full ver cout file ' ' timestamp ' ' msc full ver endif cout endl students t example2 0 error s 0 warning s ,change configuration jamfile so it's no longer dependent on the testing module fixed students t example and updated docs to match removed two dead files svn r , fix a bug in the new delegate piperorigin revid change id idacdededdbdcfbcdb
709,class pyoptest tf test testcase def my func x y return np sinh x np cosh y single type with self test session x tf constant 1 0 tf float32 y tf constant 2 0 tf float32 z tf py func my func x y tf float32 self assertequal z eval my func 1 0 2 0 astype np float32 scalar with self test session x tf constant 1 0 tf float32 ,make py func return scalar when pass single type to output , fix a bug in the test case piperorigin revid
710,test directsessionwithtrackingalloctest costmodeltest which increments the value of allocationid thus allocationid becomes more than 3 and 4 if mkl is used now they are 9 and 10 for mkl expect eq 15 cm allocationid node 0 expect eq 19 cm allocationid node 0 else expect eq 9 cm allocationid node 0 expect eq 13 cm allocationid node 0 endif else ifdef intel mkl expect eq 16 cm allocationid node 0 expect eq 20 cm allocationid node 0 else expect eq 10 cm allocationid node 0 expect eq 14 cm allocationid node 0 endif ,updated the allocation id in the direct file , add support for int and max types piperorigin revid
711,costs virtualscheduler summary runmetadata metadata for const auto node def device second nodes executed const nodestate nodestate node map at node def nodeexecstats node stats device stepstats add node stats for int slot 0 slot nodestate output properties size slot const auto properties nodestate output properties slot nodeoutput no node stats add output no set slot slot tensordescription tensor descr no mutable tensor description tensor descr set dtype properties dtype tensor descr mutable shape properties shape node stats set timeline label node def op node stats set node name node def name node stats set op start rel micros 0 ,add tensor sizes to grappler's runmetadata output piperorigin revid , tf data service support for tf data experimental piperorigin revid
712,public pattern insertion void insert rewritepattern pattern patterns emplace back pattern add an instance of each of the pattern types to the pattern list with the given arguments note is necessary here to separate the two variadic lists note is necessary here to separate the two variadic lists template typename ts typename typename typename typename std enable if t sizeof ts 0 void insert arg args the following expands a call to emplace back for each of the pattern types this magic is necessary due to a limitation in the places ,enable owningrewritepatternlist insert overload with parameter pack only when there is at least one template pattern type also remove the other insert overload with pattern pointer as there are no existing users nor any potential known use case piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id icabdabcccecababba
713,def toco convert protos model flags str toco flags str input data str def tensor name x return x name split 0 parts x name split if len parts 2 raise valueerror tensor name invalid expect 0 or 1 colon got 0 format len parts 1 to be consistent with the tensor naming scheme in tensorflow we need drop the ' 0' suffix for the first tensor if len parts 1 and parts 1 0 return x name return parts 0 don't expose these for now ,in tensor name function don't drop the suffix behind colon if it's not the first tensor for example it should make sure tensor tensor tensor tensor tensor tensor piperorigin revid , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
714,statusor bool instructionfusion run hlomodule module fusion config module mutable fusion config fusion config clear for auto computation module makenonfusioncomputations use sorted computations because fusion configuration is order sensitive for auto computation module check computation isfusioncomputation computation computation reachability hloreachabilitymap build computation ,add interfaces to modify an hlo module after already being scheduled replace computation parameter remove replace scheduled computation instruction piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
715,expandbufnames make a copy of pat and change to if pat ' ' alloc unsigned strlen pat 11 alloc strlen pat 11 if null return fail strcpy expandbufnames break if round 1 file char u alloc unsigned count sizeof char u file char u alloc count sizeof char u if file null vim regfree regmatch regprog ,patch using int for alloc often results in compiler warnings problem using int for alloc often results in compiler warnings solution use size t and remove type casts remove alloc check vim only works with bit ints anyway , updated for version problem when using a character of a character of a character of the line line is not used solution add the line to the line
716,class singulargradientoptest test testcase test util run deprecated v1 def testgradientatsingularity self if not compat forward compatible 2019 4 14 if not compat forward compatible 2019 5 14 self skiptest skipping test for future functionality ops and singularity ,move compat date for safe gradients change forward by one month this should give us time to address test failures and resolve questions about the underlying assumptions piperorigin revid , fix a bug in the docstring of the test piperorigin revid
717,include string include sstream include fstream include vector include zlib h for crc32 include libprotobuf mutator src libfuzzer libfuzzer macro h std string prototopng const pngproto png proto auto other chunk chunk other chunk char type 5 0 if other chunk has known type static const std vector const char known chunks static const char known chunks exif hist iccp phys text time trns size t chunk idx other chunk known type known chunks size size t known chunks size sizeof known chunks sizeof known chunks 0 size t chunk idx other chunk known type known chunks size memcpy type known chunks chunk idx 4 else if other chunk has unknown type uint32 t unknown type int other chunk unknown type ,libpng proto don't use vector use a plain array instead , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
718,class datasetserializationtestbase test testcase def teardown self self delete ckpt todo b 70988345 support native tf sparsetensor objects and get rid of sparse tensors argument def run core tests self ds fn1 ds fn2 num outputs sparse tensors false runs the core tests ,changing tf contrib data dense to sparse batch to return tf sparsetensor piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
719,class microbenchmarks test benchmark def benchmark add self a b def func return memoryview math ops add a b return memoryview math ops add v2 a b with ops device gpu 0 if context num gpus else cpu 0 for in range 1000 ,use addv in benchmark piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
720,tflitestatus interpreter invoke ensuretensorsvectorcapacity tensor resized since op invoke false if opinvoke registration node ktfliteerror status ktfliteerror force execution prep for downstream ops if the latest op triggered the resize of a dynamic tensor if tensor resized since op invoke context node outputs next execution plan index to prepare execution plan index 1 if allow buffer handle output tflitestatus interpreter resizetensorimpl tflitetensor tensor if tensor allocation type ktflitearenarw tensor allocation type ktflitedynamic tensor allocation type ktflitearenarwpersistent tensor resized since op invoke tfliteintarrayequal tensor dims new size 0 if tensor type ktflitestring size t bytesrequired tflitestatus status bytesrequired tensor type new size data ,refresh allocations in the presence of dynamic tensors piperorigin revid , add support for int int piperorigin revid
721,def clip by global norm t list clip norm use norm none name none scale for finite clip norm math ops minimum 1 0 use norm constant op constant 1 0 dtype use norm dtype clip norm scale array ops where math ops is finite use norm scale for finite return nan if use norm is not finite constant op constant float nan dtype use norm dtype if use norm is any finite number this is a no op for inf inf nan this will make scale nan scale scale for finite use norm use norm values ops convert to tensor ,use arithmetic instead of tf where to set nan for tf clip by global norm failure arithmetic operations are much faster than tf where also add unit tests for tf clip by global norm piperorigin revid change id , fix a bug in the docstring of the docstring of the documentation of the example change
722,std unique ptr tensor opkernelcontext forward input return output tensor status opkernelcontext forward input or allocate temp gtl arrayslice int candidate input indices datatype type const tensorshape shape const allocatorattributes allocator attr tensor out temp for int input index candidate input indices std unique ptr tensor new tensor forward input input index type shape device memory allocator attr if new tensor nullptr out temp std move new tensor return status ok return allocate temp type shape out temp allocator attr void opkernelcontext delete ref input int index bool lock held dcheck ge index 0 dcheck lt index num inputs ,add a convenience method forward input or allocate temp to use buffer forwarding for temporary tensors add buffer forwarding in a few additional places including pooling ops and fused rnn kernels change , xla gpu support for the cpu backend piperorigin revid
723,class scopedshapedbuffer public shapedbuffer tf must use result shapedbuffer release protected void deallocate devicememoryallocator allocator ,xla fix memory leak in move assignment operator piperorigin revid , xla python fix a bug in the test piperorigin revid
724,class hloinstruction precondition opcode hloopcode ksend or hloopcode krecv int64 channel id const return channel id returns the channel name associated with the instruction the name is used to identify host send recv operations precondition opcode hloopcode khostcompute string channel name const return channel name returns feature index field associated with the instruction the index represents the index of the feature dimension ,allow setting of opmetadata for send hlos piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
725,class crossedcolumn featurecolumn staticmethod def is column return isinstance column sparsecolumn crossedcolumn bucketizedcolumn def assert is column if isinstance column sparsecolumn crossedcolumn bucketizedcolumn return raise typeerror columns must be a set of sparsecolumn crossedcolumn or bucketizedcolumn instances column is a format column column class name def new cls columns class crossedcolumn featurecolumn ckpt to load from none tensor name in ckpt none for column in columns if not crossedcolumn is column raise typeerror columns must be a set of sparsecolumn crossedcolumn or bucketizedcolumn instances column format column crossedcolumn assert is column if len columns 2 raise valueerror columns must contain at least 2 elements ,cleanup consolidate specification of what a column into a single function change , fix a bug in the docstring of the docstring of the docstring change
726,def random hue image max delta seed none equivalent to adjust hue but uses a delta randomly picked in the interval max delta max delta max delta must be in the interval 0 0 5 usage example python tf random set seed 1 x tf constant 2 0 3 0 2 0 y tf image random hue x max delta 0 1 seed 1 2 5 3 2 args image rgb image or images the size of the last dimension must be 3 ,removed random hue example because of an already existing pr , fix a bug in the docstring of the docstring of the new module change
727,from tensorflow core framework import graph pb2 from tensorflow core framework import op def pb2 from tensorflow core protobuf import meta graph pb2 from tensorflow core protobuf import saver pb2 from tensorflow python framework import graph io from tensorflow python framework import importer from tensorflow python framework import op def registry from tensorflow python framework import ops from tensorflow python framework import versions from tensorflow python lib io import file io from tensorflow python platform import tf logging as logging from tensorflow python training import training util from tensorflow python util import compat def export scoped meta graph filename none kwargs if filename training util write graph graph io write graph scoped meta graph def os path dirname filename os path basename filename ,add missing dependencies and resolve circular dependencies change , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
728,monte carlo integration and helpers see the python contrib bayesflow monte carlo guide expectation expectation importance sampler expectation importance sampler ,remove magic doc links from code this change contains no code changes only doc strings we can't use relative links in code files so we don't have much choice but to link to tensorflow org the deleted links were to docs that no longer exist piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
729,limitations under the license include llvm ir datalayout h include tensorflow compiler xla literal h include tensorflow compiler xla literal util h include tensorflow compiler xla service gpu gpu compiler h include tensorflow compiler xla service gpu nvptx compiler h include tensorflow compiler xla service gpu outfeed manager h include tensorflow compiler xla shape util h include tensorflow compiler xla status macros h ,xla gpu rename to nvptxcompiler to cope with upcoming introduction of amdgpu support in xla rename and associated gpu backend lib module to nvptxcompiler and nvptx backend lib , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
730,bool isinputfusiblereduction hloinstruction instr of input parameters differ in such it is beneficial not to fuse we consider input params with maximum rank only params with smaller ranks will be broadcasted and have not been observed to cause data locality issues todo b improve reduce emitters to remove this limitation todo b improve reduce emitters to remove this limitation bool hloinstruction instr int64 max rank 0 const layout max rank layout ,xla gpu update the tracking bug number for making reduce emitters deal well with transposes piperorigin revid , xla gpu support for the xla client piperorigin revid
731,tflitestatus parseopdata const operator op builtinoperator op type case builtinoperator segment sum return ktfliteok return ktfliteerror nolint readability fn size namespace tflite ,fix a missing default case statement piperorigin revid change id , add support for int int piperorigin revid
732,bool isopallowedtf2xlafallback operation op typeid get tf atanhop typeid get tf atanop typeid get tf batchmatmulv2op typeid get tf batchtospacendop typeid get tf batchtospaceop typeid get tf biasaddgradop typeid get tf biasaddop typeid get tf bool isopallowedtf2xlafallback operation op typeid get tf logicalorop typeid get tf logop typeid get tf matmulop typeid get tf matrixdiagv3op typeid get tf typeid get tf mirrorpadop typeid get tf mulop typeid get tf negop bool isopallowedtf2xlafallback operation op typeid get tf softplusgradop typeid get tf typeid get tf typeid get tf typeid get tf spacetobatchop typeid get tf typeid get tf sqrtgradop typeid get tf squareop ,legalize tensorflow ops related to matrix diag space and batch conversion in the fallback path these ops are batchtospacendop spacetobatchndop piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id icbecbbdcaecdf
733,setmark pos c pos fnum ifdef feat visual if c ' ' if c ' ' c ' ' curbuf b visual vi start pos return ok if c ' ' curbuf b visual vi end pos if c ' ' curbuf b visual vi start pos else curbuf b visual vi end pos if curbuf b visual vi mode nul visual mode has not yet been set use a sane default curbuf b visual vi mode 'v' return ok endif ,updated for version b problem when setting the visual area manually and 'selection' is exclusive a yank includes one character too much ingo karkat solution default the visual operation to v christian brabandt , patch problem when using a terminal window is a bit slow solution add a test for the command line
734,def nth element input n reverse false name none return gen nn ops nth element input n reverse reverse name name deprecation deprecated arg values none ' nchw for data format is deprecated use ncw instead' warn once true data format nchw deprecation deprecated arg values none ' nhwc for data format is deprecated use nwc instead' warn once true data format nhwc def conv1d value filters stride padding use cudnn on gpu none data format none name none ,add deprecated arg values to convd for nhwc nchw this commit adds deprecated arg values to convd for nhwc nchw use nwc instead signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the test case piperorigin revid
735,def softmax cross entropy with logits v2 logits labels as name logits ops convert to tensor logits name logits labels ops convert to tensor labels name labels convert to float32 logits dtype dtypes float16 or logits dtype dtypes bfloat16 precise logits math ops cast logits dtypes float32 if logits dtype dtypes float16 else logits logits dtypes float32 if convert to float32 else logits labels and logits must be of the same type labels math ops cast labels precise logits dtype input rank array ops rank precise logits def softmax cross entropy with logits v2 del shape dim cost set shape shape if logits dtype dtypes float16 return math ops cast cost dtypes float16 if convert to float32 return math ops cast cost logits dtype else return cost ,use high precision to compute softmax cross entropy with logits piperorigin revid , fix documentation of the docstring of the docstring of the docstring change
736,static void fmul 4s 4s v4 4s n b 2f n 1 n mov 4s v4 4s n mov 4s v4 4s n mov v4 n mov v4 n 2 n mat ptr0 16 n vec ptr 16 n ,armv asm fix vector piperorigin revid change id , fix a bug in the previous commit piperorigin revid
737,class tpuembedding object def check data name feature enqueue data helper function to check device if data is not none and data device enqueue data embedding indices device raise valueerror ,style nits on helper docstring , fix a bug in the docstring of the test piperorigin revid
738,def checked scope cell scope reuse none kwargs if weights found and reuse is none raise valueerror attempt to have a second rnncell use the weights of a variable scope that already has weights ' s' and rnncell was not constructed with reuse true scope that already has weights ' s' and the cell was not constructed as s reuse true to share the weights of an rnncell simply reuse it in your second calculation or create a new one with the argument reuse true scope name the argument reuse true scope name type cell name everything is ok update the scope and yield it cell scope checking scope pylint disable protected access ,cleaner error messages for rnncell scope failures change , fix a typo in the docstring of the docstring change
739,class basesession sessioninterface if isinstance subfeed val ops tensor raise typeerror 'the value of a feed cannot be a tf tensor object ' 'acceptable feed values include python scalars ' 'strings lists numpy ndarrays or ' 'strings lists numpy ndarrays or ' 'for reference the tensor object was ' str feed val ' which was passed to the ' with key ' str feed ' ' subfeed dtype subfeed t dtype as numpy dtype if isinstance subfeed val int and convert to numpy obj ,tensorflow adds additional debugging info to feed dict failure condition if you have a large feed dict determining the type of each object can be difficult and this additional debugging info me in such a case piperorigin revid , fix a bug in the docstring of the docstring of the documentation of the example change
740,void basegpudevice reinitializedevice opkernelcontext context peropgpudevice device int stream id allocator allocator concreteperopgpudevice concrete device dynamic cast concreteperopgpudevice device static cast concreteperopgpudevice device dcheck concrete device if defined gcudacc defined gcudacc host concrete device reinitialize context streams stream id compute allocator ,replace dynamic cast with static cast in change , xla gpu support for the layout of the input dimension piperorigin revid
741,test conditionvariable waitformilliseconds timeout mutex m mutex lock l m condition variable cv result time t start time null expect eq waitformilliseconds l cv 3000 timeout condition variables are subject to spurious on some platforms so need to check for a timeout within a loop while result result waitformilliseconds l cv 3000 expect eq result timeout time t finish time null expect ge finish start 3 test conditionvariable waitformilliseconds signalled sleep for just 1 second then notify we have a timeout of 3 secs so the condition variable will notice the cv signal before the timeout pool schedule m cv sleep 1 env default sleepformicroseconds 1 1000 1000 mutex lock l m cv notify all ,make port test work on windows , fix a bug in the test case piperorigin revid
742,configurations 'sanitizer undefined' 'sanitizer undefined' default sanitizers 'address' 'undefined' def usage sys stderr write def get build steps project yaml for sanitizer in project yaml sanitizers sanitizers project yaml get 'sanitizers' default sanitizers for sanitizer in sanitizers env configurations sanitizer sanitizer out ' workspace out ' sanitizer zip file name sanitizer ts zip ,gcb set default sanitizers , fix for the issue with the same value of the default value of the input piperorigin revid
743,register op fusedbatchnormex output reserve space 1 u output reserve space 2 u output reserve space 3 u ifdef enable mkldnn v1 attr t half float bfloat16 else attr t half float endif attr u float attr epsilon float 0 0001 attr exponential avg factor float 1 0 ,fuse bn and relu in mkl path , tf data dataset support for tf data dataset piperorigin revid
744,limitations under the license namespace tensorflow if google cuda if google cuda tensorflow use rocm these tests are copied from non max suppression op test cc file and modified to use gpu ops see other file for test details ,fixing and enabling nonmaxsuppression for rocm , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
745,int main no newline at end of file ,add clang and python configurations for ubuntu piperorigin revid , patch problem when using a popup window with a popup window solution add the cursor to the current buffer when the cursor is set
746,mch parse cmd char u cmd int use shcf char argv int argc 1 find number of arguments 2 separate them and build argv for i 0 i 2 i for i 1 i 2 i p skipwhite cmd inquote false argc 0 for while p nul if i 1 if i 2 argv argc char p argc d p mch parse cmd char u cmd int use shcf char argv int argc second pass remove the backslash p if i 1 if i 2 d p p if p nul if i 1 if i 2 d nul break if i 1 if i 2 d nul p skipwhite p 1 ,patch trailing space in job start command causes empty argument problem trailing space in job start command causes empty argument solution ignore trailing space closes , patch problem when using a terminal window is a bit slow solution add a test for the command line
747,from setuptools dist import distribution this version string is semver compatible but incompatible with pip for pip we will remove all ' ' characters from this string and use the result for pip version '1 6 0 rc1' version '1 6 0' required packages 'absl py 0 1 6' ,update version string to , fix a bug in the documentation of the new version of the client client client piperorigin revid
748,class derived ts conversions template typename e std enable if sizeof ts 1 typename e type nullptr explicit ts params params std move params explicit ts params params std forward ts params template typename e std enable if sizeof ts 1 typename typename e type ts params params std move params nolint ts params nolint params std forward ts params template typename f operator testing matcher f const nolint runtime explicit ,googletest export fix std move to std forward where appropriate to support reference types piperorigin revid , fix a bug in the new delegate test piperorigin revid change id icccbcbdbcfaadbee
749,class hloinstruction backend config std move config str bool is default config const return is default config void set default config is default config true returns a string representation of a proto in the format used by raw backend config string class hloinstruction hlo see the documentation on backend config string backend config this field is assigned to true when backend config is assigned to a default configuration bool is default config false string identifier for instruction string name ,add a field in hloinstruction to indicate whether the instruction is explicitly assigned with a default backend configuration or not piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id iffcbbabfbaeecaeaa
750,include stdlib h include net h include compat h include utils h array size include utils h rand array static const unsigned int iucv opts so iprmdata msg so msglimit so msgsize void iucv setsockopt struct sockopt so unsigned char val val rand array size iucv opts val rand array iucv opts so optname iucv opts val so optlen sizeof int ,use array rand in proto iucv , move the dtrace proto to the syscall process
751,static char features static int included patches add new patch number below this line 1568 1567 ,patch strftime test fails on ms windows problem strftime test fails on ms windows solution skip the check for using the environment variable , patch problem when using a channel to be a bit a bit slow solution add a test for the test
752,class gtest api asserthelper gtest disallow copy and assign asserthelper enum gtestcolor color default color red color green color yellow gtest api gtest attribute printf 2 3 void coloredprintf gtestcolor color const char fmt namespace internal the pure interface class that all value parameterized tests inherit from ,make and coloredprintf available as internal apis from gtest h this is for use in abseil exception safety testing piperorigin revid , fix a bug in the parser build piperorigin revid change id icaabbeacfcfdbfaba
753,static bool tensorproto in tensorproto out else tensor t in dtype if t fromproto cpu allocator in return false t asprotofield out t asprototensorcontent out return true ,replace with asprototensorcontent for efficiency , updated for version problem when using a function to be a dictionary solution add a test for the line
754,class exporttest test util tensorflowtestcase with self assertraises valueerror as e export build all signature defs receiver tensor none self assertequal export outputs must be a dict str e exception self asserttrue str e exception startswith export outputs must be a dict def test get timestamped export dir self export dir base tempfile mkdtemp export ,fix export test failure , fix a bug in the docstring of the test piperorigin revid
755,def trace model call model input signature none 'set usually input shapes are automatically determined from ' fit or predict to manually set the shapes call ' 'model set inputs inputs ' format model input specs for input tensor input name in zip inputs input names input specs append tensor spec tensorspec flat inputs nest flatten inputs flat input names nest flatten input names flat input specs for input tensor input name in zip flat inputs flat input names flat input specs append tensor spec tensorspec shape input tensor shape dtype input tensor dtype name input name input specs nest pack sequence as structure inputs flat sequence flat input specs the input signature of the call function is a list with one element since all tensor inputs must be passed in as the first argument input signature input specs if len input specs 1 else input specs ,fix savedmodel tracing for layers with structured inputs fixes export of densefeatures layers fixes piperorigin revid , fix a bug in the docstring of the test piperorigin revid
756,class clusterspec object def ne self other return self cluster spec other def str self def repr self key values self as dict string items repr k repr key values k for k in sorted key values ,switch str to repr str is generally human readable while repr is an eval ready reproduction string the existing implementation of str is eval ready the default str calls repr so the test for this function is still valid piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid change id ieedaecadfaccdddeec
757,def gettestexecutablepath executable name build dir none message 'unable to find the test binary please make sure to provide path n' 'to the binary via the build dir flag or the build dir n' 'environment variable for convenient use invoke this script via n' test py n' todo vladl google com change mk test py to test py after renaming the file 'please run mk test py h for help ' 'environment variable ' print sys stderr message sys exit 1 ,updates an outdated error message , fix a bug in the documentation of the new api change
758,status datasetopstestbase checkiteratorsaveandrestore std unique ptr serializationcontext serialization ctx tf return if error serialization ctx bool end of sequence false std vector tensor out tensors int cur iteration 0 auto expected outputs it expected outputs begin for int breakpoint breakpoints status datasetopstestbase checkiteratorsaveandrestore dataset iterator while cur iteration breakpoint std vector tensor out tensors tf return if error iterator getnext iterator ctx get out tensors end of sequence if end of sequence expect ne expected outputs it expected outputs end tf expect ok expectequal out tensors back expected outputs it expected outputs it for const auto out tensor out tensors tf expect ok expectequal out tensor expected outputs it expected outputs it cur iteration ,refactor , fix a bug in the test case piperorigin revid
759,class mean metric update total op state ops assign add self total values with ops control dependencies update total op update count op state ops assign add self count num values return ops convert to tensor update count op with ops control dependencies update count op return control flow ops no op def result self return math ops div no nan self total self count ,change return of the update op to be a no op piperorigin revid , tf data saveable dataset to be used by default piperorigin revid
760,limitations under the license include tensorflow core framework run handler util h include vector include tensorflow core lib strings strcat h include tensorflow core platform env h include tensorflow core platform logging h include tensorflow core platform test h namespace tensorflow ,implement an alternative setenv unsetenv as it is not available on windows switch uses of setenv unsetenv to the new one piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
761,tv get string buf chk typval t varp char u buf case var number vim snprintf char buf numbuflen lld long long t varp vval v number varnumber t varp vval v number return buf case var func case var partial ,patch mixing up long long and int may cause problems problem mixing up long long and int may cause problems john marriott solution pass varnumber t to vim snprintf add v , patch problem when using a terminal window is a bit slow solution add a test for the command line
762,chk modeline current sctx sc sid sid modeline current sctx sc seq 0 current sctx sc lnum 0 current sctx sc version 1 endif make sure no risky things are executed as a side effect secure 1 ,patch cannot enforce a vim script style problem cannot enforce a vim script style solution add the scriptversion command closes , patch vim cannot use a function to be used problem vim cannot use a terminal window with a terminal window solution add a test for the terminal window
763,def build fuzzers impl pylint disable too many arguments return 1 project out dir get output dir project name project work dir get work dir project name if clean print existing build artifacts ' def build fuzzers impl pylint disable too many arguments 'gcr io oss fuzz s' project name ' bin bash' ' c' 'rm rf out ' docker run ' v' ' s work' project work dir ' t' 'gcr io oss fuzz s' project name ' bin bash' ' c' 'rm rf work ' else print 'keeping existing build artifacts as is if any ' env def build fuzzers impl pylint disable too many arguments if env to add env env to add project work dir get work dir project name copy instrumented libraries if sanitizer 'memory' docker run ,helper clean work as well if clean is specified , fix a bug in the file in the file
764,class object pylint disable line too long only show profiler nodes consuming no less than 'min float ops' please see https github com tensorflow tensorflow tree master tensorflow core profile model architecture md please see https github com tensorflow tensorflow tree master tensorflow core profiler g3doc profile model architecture md on the of calculating float operations args ,fix the profiler python docstring link this fix fixes the python docstring link of the profiler profiler gdoc signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the docstring of the docstring change
765,class apichangespec object function warnings maps full names of functions to warnings that will be printed out if the function is used e g tf nn convolution function transformers maps function names to custom handlers leftover warnings these warnings are printed if a matching attribute still exists after all other transformations have run module deprecations maps module names to warnings that will be printed if the module is still used after all other transformations have run for an example see tfapichangespec ,make converter handle tf flags as a module deprecation warning piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the docstring change
766,def split compile and shard computation return x 3 shard computation todo phawkins consider adding support for broadcasting tensors passed as inputs if outputs from all shards is true the outputs from all shards of computation are concatenated back together along their output shards axes otherwise each output is taken from an arbitrary shard def split compile and shard computation valueerror if len input shard axes len inputs valueerror if len output shard axes len outputs from computation todo phawkins consider adding support for broadcasting tensors passed as inputs if num shards 0 raise valueerror num shards must be a positive integer ,hide an internal todo item from public doc piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
767,class inferencecontext return s dims idx int32 rank shapehandle s const return s rank bool rankknown shapehandle s const return rank s kunknownrank int32 rank shapehandle s const dcheck s isset return s rank bool rankknown shapehandle s const return s isset rank s kunknownrank inline int64 value dimensionorconstant d const return d dim isset d dim value d val ,refactor fold constants to make reuse easier change , fix a bug in the graph piperorigin revid
768,struct fastpathopexecinfo if py major version 3 parse value int pylong check pylong aslong parse value parseint64value int64 t pylong check pylong aslong parse value parseint64value int64 t pylong check pylong else parse value int pyint check pyint aslong endif ,fix bug where int attributes caused on exception on some platforms piperorigin revid change id , fix a bug in the new delegate test piperorigin revid
769,def export estimator estimator features that are then passed to the model signature fn function that given tensor of example strings dict of tensor s for features and dict of tensor s for predictions and returns default and named exporting and returns default and named exporting signatures default batch size default batch size of the example placeholder exports to keep number of exports to keep ,fix typo change , tfgan update documentation for tf nn softmax py
770,status const google protobuf any any t message expected any type url for type name got string any type url data any type url size if message parsefromstring any value if message parsefromstring protobufstringtostring any value return errors failedprecondition failed to unpack any ,add a missing piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id ibebfcffdcbdbdafeb
771,string lowercase stringpiece s return upper cased version of s string uppercase stringpiece s converts to i you more specifically converts all non alphanumeric characters to underscores replaces each occurence of a capital letter except the very first character and if there is already an ' ' before it with ' ' followed by this letter in lower case skips leading non alpha characters this method is useful for producing strings matching a z a z0 9 as required by opdef argdef name the resulting string is either empty or matches this regex string argdefcase stringpiece s first character of each word in s delimiters is a set of characters that can be used as word boundaries void titlecasestring string s stringpiece delimiters ,add conversion to tensorflow str util piperorigin revid , fix a bug in the test case piperorigin revid
772,class tfapichangespec ast edits apichangespec tf strings length input name unit tf transpose a perm name conjugate tf tuple tensors name control inputs tf io parse example serialized features name example names tf io parse single example serialized features name example names tf while loop cond body loop vars shape invariants parallel iterations back prop swap memory name ,change api for io parse example and io parse single example for tf piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
773,class demodataprovider implements dataprovider shape 150 4 fpath tensors metadata path labels shape 8 3 fpath tensors metadata path labels name of the folder where the demo datasets are stored ,add a unit cube to a the projector demo datasets change , fix a bug in the new delegate piperorigin revid
774,class test testcase accidentally share state m1 metrics mean m1 0 with self assertraises valueerror m2 metrics mean m2 2 m2 metrics mean m2 2 self assertallequal 0 0 m1 result self assertallequal 2 0 m2 result def self verify two metrics with the same class and name don't ,no need for unique variable names in eager piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
775,def project log stochastic matrix wrt kl divergence log matrix for numerical reasons make sure that the largest matrix element is zero before log matrix standard ops reduce max log matrix axis 0 keep dims true log matrix standard ops reduce max log matrix axis 0 keepdims true log matrix standard ops log standard ops reduce sum standard ops exp log matrix axis 0 keep dims true standard ops exp log matrix axis 0 keepdims true return log matrix ,update keep dims for reduce max signed off by yong tang yong tang github outlook com , fix a bug in the documentation of the new module piperorigin revid
776,export class projector extends projectorpolymer implements selectioncontext this projectionspanel initialize this this this as this this dom select ' status bar' this bookmarkpanel this panel' as bookmarkpanel getdataprovider this routeprefix dataprovider this dataprovider dataprovider this datapanel initialize this dataprovider this bookmarkpanel this panel' as bookmarkpanel this bookmarkpanel initialize this dataprovider this this ' wrapper notify true ,create the variable outside the call to fix an undefined bug when is called change , fix a bug in the docstring of the new module change
777,void const model model static constexpr char general comment is it a typo to silence this message pass this flag allow nonexistent arrays for const auto input array model flags input arrays qcheck getopwithinput model input array name specified input array input array name is not consumed by any op in this graph general comment for const string output array model flags output arrays if isconstantparameterarray model output array continue it is ok to request that a constant be an output ,toco should not reject models with inputs piperorigin revid , fix a bug in the graph optimizer piperorigin revid
778,func b builder endvector vectornumelems int uoffsett createstring writes a null terminated string as a vector func b builder createstring s string uoffsett return b createbytestring byte s createbytestring writes a null terminated as a vector func b builder createbytestring s byte uoffsett b prep int sizeuoffsett len s 1 sizebyte b placebyte 0 x byte s l uoffsett len x l uoffsett len s b head l copy b bytes b head b head l x copy b bytes b head b head l s return b endvector len x return b endvector len s writes a ubyte vector ,reduce allocations when building strings builder has a new function that writes a null byte slice to the buffer this results in zero allocations for writing strings , patch problem when using a terminal window is a bit slow solution add a test for the file
779,register op const return status ok returns a constant tensor on the host useful for writing c tests and benchmarks which run on gpu but require arguments pinned to the host used by test graph value attr value is the tensor to return register op output output dtype attr value tensor attr dtype type setshapefn shape inference unknownshape todo mgubin update the doc when the freeze graph script supports converting into memmapped format ,automated rollback of commit piperorigin revid , fix a bug in the graph piperorigin revid
780,class estimator object s and the inputs are always the input receivers provided by the serving input receiver fn extra assets may be written into the savedmodel via the extra assets extra assets may be written into the savedmodel via the assets extra argument this should be a dict where each key gives a destination path including the filename relative to the assets extra directory the corresponding value gives the full path of the source file to be copied ,fix typo in export savedmodel api doc piperorigin revid , update docstring for tf nn rnn py
781,class cancellablecall void start const statuscallback done cancellationtoken token cancel mgr get cancellation token const bool not yet cancelled cancel mgr registercallback token this token opts startcancel const bool not yet cancelled cancel mgr registercallback token this opts startcancel if not yet cancelled this token done const status s cancel mgr deregistercallback token ,remove a few warnings on macos remove unused captures in lambdas reorder a field initializer list remove some unused typedefs remove a few unused variables many warnings remain including many thread safety warnings which are somewhat alarming , fix a bug in the file file in the file
782,get toolbar bitmap vimmenu t menu didn't exist or wasn't specified try the menu name if hbitmap null gui find bitmap menu name fname bmp ok gui find bitmap menu en dname null menu en dname menu dname fname bmp ok hbitmap loadimage null fname ,updated for version problem gvim does not find the toolbar bitmap files in if the corresponding menu command contains additional characters like the shortcut marker ' ' or if you use a non english locale solution use menu en or menu martin , patch problem when using a terminal window is a bit slow solution add a test for the gui
783,status iremitterunnested handlereplicaid hloinstruction hlo status iremitterunnested handlecollectivepermute hloinstruction hlo config hlo addthunktothunksequence absl make unique collectivepermutethunk getthunkinfo hlo getallocationslice hlo operand 0 getallocationslice hlo getthunkinfo hlo std move config getallocationslice hlo operand 0 getallocationslice hlo return status ok ,nfc eliminate references to hlo inst from collectivepermute thunk introduce a object to hold relevant properties needed for execution of the thunk and use that in the thunk object piperorigin revid change id , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
784,shapeutil const shape shape pre return std make tuple true deleted indices inserted indices return std make tuple deleted indices empty inserted indices empty deleted indices inserted indices static std vector std pair int64 int64 ,xla no op reshapes should not return true for inserting or deleting one sized dimensions piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id id ibaaeabeded
785,import time import numpy as np from tensorflow core framework import types pb2 from tensorflow python distribute import all reduce as ar from tensorflow python distribute v1 import all reduce as ar from tensorflow python framework import constant op from tensorflow python framework import ops from tensorflow python framework import tensor shape ,tf distribute move old unused all reduce util to v piperorigin revid change id , fix a bug in the docstring of the test piperorigin revid
786,vim main2 void starttermcap start termcap if not done by wait return time msg start termcap if defined feat termresponse if defined feat mbyte may req ambiguous char width endif may req bg color endif ifdef feat mouse setmouse may start using the mouse vim main2 void requesting the termresponse is postponed until here so that a c q argument doesn't make it appear in the shell vim was started from may req termresponse if defined feat mbyte may req ambiguous char width endif may req bg color endif start in insert mode ,patch call for requesting color and ambiwidth is too early problem call for requesting color and ambiwidth is too early hirohito higashi solution move the call down to below resetting starting , patch problem when using a terminal window is a bit slow solution add a test for the gui
787,static char features static int included patches add new patch number below this line 1143 1142 ,patch problem can't sort on floating point numbers solution add the f flag to sort alex jakushev also add the f flag to sort , patch problem when using a channel to be a bit a bit slow solution add a test for the test
788,class dictwrapper trackabledatastructure wrapt objectproxy if wrapped dict is none allow zero argument construction e g from session re wrapping wrapped dict if not isinstance wrapped dict collections mapping if not isinstance wrapped dict collections abc mapping allow construction from a sequence e g from nest pack sequence as wrapped dict dict wrapped dict wrapt objectproxy init self wrapped dict ,fix kokoro build deprecated message piperorigin revid change id , tf data saveable dataset to be used by default piperorigin revid
789,int open perf fds void int get rand perf fd void if shm perf fds 0 0 perf unavailable disabled return 1 return shm perf fds rand max perf fds ,move perf fd get failure checking into the get function , fix a bug in the watchdog page
790,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2019 12 14 forward compatibility horizon datetime date 2019 12 15 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
791,test since in that case both overloads would be feasible string str expect true str avoid warning unused function int a 1 expect false a namespace ,fix another unused code warning change , xla python fix a bug in the test piperorigin revid
792,class tensorarraygatherop public xlaopkernel xla computationdatahandle ta resource value xla computationdatahandle gather xlacomputegatherdynamicslice ta ta shape indices indices shape dtype b ctx ta ta shape indices indices shape dtype b ctx setoutput 0 gather ,use xla while loop in gather scatter tfxla bridge ops to prevent excessively large hlo output for models with large numbers of embedding lookups piperorigin revid , xla gpu support for the xla client piperorigin revid change id idaceccfcbacfece
793,prompt for number int mouse used save cmdline row cmdline row cmdline row 0 save state state state cmdline state askmore prevents a screen update when using a timer i get number true mouse used if keytyped ,patch screen is messed by timer up at inputlist prompt problem screen is messed by timer up at inputlist prompt solution set state to closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
794,class cppgradients public bool usemlir const return strcmp std get 0 getparam mlir 0 bool usefunction const return std get 2 getparam bool usefunction const return std get 2 getparam test p cppgradients testbiasaddgrad ,revert usefunction to original , fix a bug in the test case piperorigin revid
795,def bfs for reachable nodes target nodes name to input name breadth first search to find all the nodes that we should keep next to visit target nodes while next to visit n next to visit 0 node next to visit 0 del next to visit 0 if n in nodes to keep if node in nodes to keep already visited this node continue nodes to keep add n next to visit name to input name n nodes to keep add node if node in name to input name next to visit name to input name node return nodes to keep ,ophints supports dynamic rnn currently only add support for time major true case piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
796,class topologyconstructiontest test testcase assert out shape 4 3 2 1 self assertallclose out x 0 2 x 0 3 atol 1e 4 def test constant initializer with numpy self with self test session initializer keras initializers constant np ones 3 2 model keras models sequential model add keras layers dense 2 input shape 3 kernel initializer keras initializers constant np ones 3 2 model add keras layers dense 2 input shape 3 kernel initializer initializer model add keras layers dense 3 model compile loss 'mse' optimizer 'sgd' metrics 'acc' ,reorg code to escape bad indentation , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
797,class copytensor copyfunction copy function void const tensor input allocator cpu allocator allocator out allocator stringpiece edge name device src tensor output devicecontext send dev context statuscallback done namespace tensorflow endif tensorflow core common runtime copy tensor h ,fix tensorlistfromtensor xla compile constant folding bug piperorigin revid , fix a bug in the graph piperorigin revid
798,static char features static int included patches add new patch number below this line 479 478 ,patch failure when setting to end in a comma problem failure when setting to end in a comma ralf schandl solution reject value with trailing command add test for invalid values closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
799,from tensorflow python framework import dtypes from tensorflow python framework import errors impl from tensorflow python ops import array ops from tensorflow python ops import check ops from tensorflow python ops import math ops from tensorflow python platform import test ,remove unused math ops import to pass ci test signed off by yong tang yong tang github outlook com , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
800,register cpu kernel uint8 register cpu kernel uint16 undef register cpu kernel if google cuda if google cuda tensorflow use rocm define register gpu kernel type register kernel builder ,add rocm support for most cwise ops , add support for int ops piperorigin revid
801,static struct fst endif tempname 0 0 f tempname ifdef feat terminal term 1 1 f term term getattr 2 2 f term getattr term getcursor 1 1 f term getcursor term getjob 1 1 f term getjob ,patch can't use the alternate screen in a terminal window problem can't use the alternate screen in a terminal window solution the alternate screen yasuhiro matsumoto closes add term , patch problem when using a terminal window is a bit slow solution add a test for the gui
802,def run all in graph and eager modes cls base decorator run in graph and eager modes for name value in cls dict copy items if callable value and name startswith test and not name startswith testskipeager if callable value and name startswith test and not name startswith testskipeager or name startswith test skip eager setattr cls name base decorator value return cls ,small addition for test method name consistency piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
803,void test nr examples auto f2 real x real return pow x real 2 real 7 exp x x q integrator integrate f2 0 std numeric limits real has infinity std numeric limits real infinity boost math tools max value real q expected half real boost math tgamma real 5 real 14 boost check close fraction q q expected tol 3 boost check close fraction q q expected tol 6 ,tanh sinh quadrature test cpp up expected error rate on one failing test , fix a bug in the new code of the new code and the new code is not used by the same value of the same value of the same value of the same value of the same value of the same value of the same value of the same value
804,singlemachine singlemachine int timeout s int num cpu cores int num gpus num gpus num gpus expected init time s 0 closing false vlog 1 number of cpu cores num cpu cores number of gpus num gpus thread pool reset new thread threadpool env default sanitizethreadsuffix single machine 2 status singlemachine provision deviceproperties attr getlocalcpuinfo devices job localhost replica 0 task 0 cpu 0 getlocalcpuinfo vlog 1 number of gpus num gpus for int i 0 i num gpus i devices strings strcat job localhost replica 0 task 0 gpu i getlocalgpuinfo i string device name strings strcat job localhost replica 0 task 0 gpu i vlog 1 adding gpu device device name devices device name getlocalgpuinfo i return status ok ,add a standalone cost analysis tool improved logging piperorigin revid , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
805,static int open files void if files in index 0 something bad happened crappy v maybe return false fixme we should log something here probably if files in index nr file fds nr to open files in index else nr to open nr file fds nr to open min files in index nr file fds if fileindex null this can happen if we ctrl return false ,replace open coded min with min invocation , make the watchdog process to be a child process
806,void model model bool resolveconstantbinaryoperator run model model std size t op index const auto binary it model operators begin op index const auto binary op binary it get if the output of this op is a non discardable array such as an input array or a state array of the model then this is a job for removeunusedop not for constants propagation if isdiscardablearray model binary op outputs 0 return false test for binary ops of types that we know how to resolve if binary op type operatortype kadd binary op type operatortype kmul ,automated rollback of commit piperorigin revid , tf data vectorization optimization to use the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
807,def get container name returns container name or none if not in a container result subprocess run 'systemd detect virt' ' c' stdout subprocess pipe stdout result subprocess run pylint disable subprocess run check 'systemd detect virt' ' c' stdout subprocess pipe stdout if b'docker' not in result return none with open ' etc hostname' as file handle ,utils ignore subprocess run check check is omitted intentionally there a follow up to https github com google oss fuzz pull , fix a bug in the docstring of the documentation of the new class change
808,class cancellationmanager cancellationtoken token cm get cancellation token mutex lock mu already cancelled cm registercallback already cancelled cm registercallback this token cancel token if already cancelled issue asynchronous operation associate the pending operation ,fix example in comments for cancellationmanager piperorigin revid , fix a bug in the new delegate test piperorigin revid
809,limitations under the license include absl strings str cat h include absl strings str join h include tensorflow compiler jit xla activity listener h include tensorflow compiler tf2xla shape util h include tensorflow compiler tf2xla type util h include tensorflow compiler tf2xla xla context h status xlacompilationcache compileimpl tensorflow strings humanreadableelapsedtime it second cumulative compile time us 1 0e6 xlajitcompilationactivity jit compilation activity jit compilation activity set cluster name function name jit compilation activity set compile count it second compile count jit compilation activity set compile time us compile time us jit compilation activity set cumulative compile time us it second cumulative compile time us tf return if error broadcastxlaactivity std move jit compilation activity tf return if error entry compilation status ,roll forward add an xla activity listener mechanism piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
810,class depthtospacetest test testcase x out batch output elt i for i in range batch size self testone x np block size x out def self block size 2 batch size 0 input nhwc array ops ones batch size 2 3 12 x out array ops ones batch size 4 6 3 with self test session use gpu false test nhwc default on cpu x tf array ops depth to space input nhwc block size self assertallequal x tf shape x out shape x tf eval if test is gpu available with self test session use gpu true test nhwc default on gpu x tf array ops depth to space input nhwc block size self assertallequal x tf shape x out shape x tf eval tests for different width and height def self x np 1 10 2 20 3 30 4 40 ,fix depthtospace and spacetodepth to silently return instead of failing when the input tensor is empty piperorigin revid , fix a bug in the test case piperorigin revid
811,tf call half register cpu tf call float register cpu tf call double register cpu if google cuda if google cuda tensorflow use rocm register kernel builder name softmaxcrossentropywithlogits device device gpu typeconstraint eigen half t register kernel builder name softmaxcrossentropywithlogits device device gpu typeconstraint double t softmaxxentwithlogitsop gpudevice double endif google cuda endif google cuda tensorflow use rocm ifdef tensorflow use sycl register kernel builder name softmaxcrossentropywithlogits ,adding rocm support for softmax cross entropy with logits op , fix a bug in the test case piperorigin revid
812,win line wp lnum startrow endrow nochange shl attr cur shl attr else if v long shl endcol else if v long shl endcol shl lnum lnum shl attr cur 0 next search hl wp shl lnum colnr t v cur ,updated for version problem screen updating is slow when using matches solution do not use the as in patch check the lnum , patch problem when using a popup window with a terminal window solution add the option to the list of the buffer
813,doc and width and height should be no smaller than 32 e g 200 200 3 would be one valid value pooling optional pooling mode for feature extraction when include top is false when include top is false it could be none means that the output of the model will be the 4d tensor output of the last convolutional block ,fix sub list indent on argument list on models , update the version of the documentation of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value piperorigin revid
814,class argminmaxtest xla test xlatestcase def testargminmax self complex numbers do not support argmin argmax minmax types self all types np int32 np int64 for dtype in minmax types for dtype in self int types self float types output type is a numpy data type that is used to specify the desired output type of the op as well as to convert the python number to the array scalar of the type ,extend the argmin argmax test to include all numeric types in the reduction not just the integer types , fix a bug in the test piperorigin revid
815,class sessioninterface object raise notimplementederror str' def run self fetches feed dict none options none run metadata none raise notimplementederror 'run' def partial run setup self fetches feeds none ,fix pydoc reference and add more tests for empty args passed to session run change , fix a bug in the docstring of the docstring of the docstring of the docstring change
816,win line break line continues beyond line end if lcs ext show extends character from 'listchars' if beyond the line end and 'list' is set if lcs ext nul wp w p list wp w p wrap ifdef feat diff filler todo 0 ,patch extends from 'listchars' is used when 'list' is off problem extends from 'listchars' is used when 'list' is off hiroyuki solution only use the extends character when 'list' is on hirohito higashi closes , patch problem when using a popup window with a terminal window solution add the cursor to the current buffer when the cursor is set
817,args done output s string if dopause 1 if dopause 1 synclogs sleep 1 ia64 is retarde wspecial ifdef ia64 ,might as well sync when we sleep for a second , fix a bug in the watchdog process
818,xla statusor xla xlaop makexlabackpropfilterconvop int n dim gettensorbatchdimindex num dims attrs data format int c dim gettensorfeaturedimindex num dims attrs data format the conversion logic below assumes that the data format is nhwc so we also check that here bool use batch group count filter tensor shape dim size num dims 1 1 attrs depthwise attrs data format format nhwc filter tensor shape dim size num dims 1 1 attrs depthwise std vector std pair int64 int64 padding attrs num spatial dims std vector int64 rhs dilation attrs num spatial dims ,remove nhwc format restriction while using batch group count for convolutions of depthwise backprop filters piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
819,class parameterserverstrategy distribute lib distributionstrategy variables 3 it is also not recommended to open a colocation scope i e calling tf colocate with under the strategy's scope for colocating variables use distribution colocate vars with instead colocation of ops will possibly create conflicts of device assignment tf colocate with under the strategy's scope for colocating variables use strategy extended colocate vars with instead colocation of ops will possibly create conflicts of device assignment def init self num gpus per worker 0 ,switch callers from deprecated tf distribute strategy colocate vars with to its replacement tf distribute strategy extended colocate vars with piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
820,class function object self function spec function lib functionspec from function and signature python function input signature experimental follow type hints experimental follow type hints experimental compile experimental compile experimental follow type hints experimental follow type hints self implements experimental implements if true the function uses the rendezvous of the parent this is only needed to support code where raw send recv operations are inserted and ,save and restore experimental compile when using saved model previously the experimental compile option was being silently dropped when exported via saved model piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
821,class binaryopstest xla test xlatestcase self testbinary array ops expand dims np array 42 dtype dtype np int32 0 np array 0 dtype np int64 expected np array 42 dtype dtype self testbinary array ops expand dims class binaryopstest xla test xlatestcase np array 1 2 3 4 dtype dtype np int32 3 expected np array 1 2 3 4 dtype dtype self testbinary array ops expand dims np array 1 2 3 4 dtype dtype np array 2 dtype np int64 expected np array 1 2 3 4 dtype dtype def self for dtype pad type in itertools product ,tf xla drop support for legacy scalars vectors the concept of a legacy scalar vector has been deprecated since early and graph producers haven't produced graphs containing them since that time we never need handle such a graph piperorigin revid , xla gpu support for the xla client piperorigin revid
822,void atalk gen sockaddr unsigned long addr unsigned long addrlen addrlen sizeof struct sockaddr at void atalk rand socket struct proto type pt void atalk rand socket struct socket triplet st if rand bool pt type sock dgram pt protocol 0 st type sock dgram st protocol 0 return pt protocol rand proto max pt type sock raw st protocol rand proto max st type sock raw ,kill off struct proto type seems pointless given we have the triplet , proto llc to use the syscall page
823,register op tensorscattersub attr tindices int32 int64 setshapefn scatterndtensorshape register op tensorscattermin input tensor t input indices tindices input updates t output output t attr t type attr tindices int32 int64 setshapefn scatterndtensorshape register op tensorscattermax input tensor t input indices tindices input updates t output output t attr t type attr tindices int32 int64 setshapefn scatterndtensorshape register op scatterndnonaliasingadd input input t input indices tindices ,add registration for non stateful scatter nd min and scatter nd max manual import of closes fixes piperorigin revid change id , tf data vectorization test for tf data dataset piperorigin revid
824,bool const cuptitracerevent event int64 line id if event stream id cuptitracerevent line id event stream id return false else if event thread id cuptitracerevent else if event thread id cuptitracerevent event thread id 0 line id event thread id return true void createxevent const cuptitracerevent event xplanebuilder plane todo profiler we should get rid of klevel0 it is based on the assumption that those op related scopedannotation are at the very top level if annotation stack empty xevent addstatvalue plane getorcreatestatmetadata getstattypestr stattype klevel0 plane getorcreatestatmetadata getstattypestr stattype ktfop plane getorcreatestatmetadata annotation stack begin name ,change the producer side to populate tf op instead of level stats piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id idfbdfbcdacfbeebb
825,static void dirty mapping reverse struct map map char p map ptr unsigned int i nr nr nr pages map nr nr pages map 1 for i nr i 0 i p i page size rand ,fix another write past the end of array , make the watchdog process to the syscall process
826,static char features static int included patches add new patch number below this line 850 ,patch ms windows exepath works different from cmd exe problem ms windows exepath works different from cmd exe solution make exepath work better on ms windows closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
827,class timedistributedtest test testcase mask value 0 input shape none 4 model add keras layers timedistributed keras layers dense 5 model compile optimizer 'rmsprop' loss 'mse' model input np random randint low 1 high 5 size 10 3 4 model input np random randint low 1 high 5 size 10 3 4 astype np float32 for i in range 4 model input i i 0 model compile optimizer 'rmsprop' loss 'mse' ,fix tensorflow python keras wrappers test for new keras single code path piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
828,bool graphtransformationspass int increment model model check increment 1 increment 1 bool changed false if model operators empty log info model is empty return false int op index increment 1 0 model operators size 1 ,changes to fix a bug in shared tensors are removed without checking if they are used in other operators in the graph , fix a bug in the graph piperorigin revid
829,copyright 2020 google inc licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license you may obtain a copy of the license at http www apache org licenses license 2 0 unless required by applicable law or agreed to in writing software distributed under the license is distributed on an as is basis without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license include stdint h include stdlib h include stdio h extern c int llvmfuzzerinitialize const int argc char argv fixme fix this buffer with connection for mysql 8 21 const uint8 t x00 x00 x01 x85 x01 x00 x00 x00 x01 x00 x00 x00 x00 x00 x00 x00 x00 x00 x00 x00 x00 x00 x00 x00 x00 x00 x00 x00 ,updates patch for mysql updates patch for mysql fixup fuzz to keep going with other targets for now do not even compile fuzz adding license no longer compiled nits , fix a bug in the dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
830,class layernormalizationtest keras parameterized testcase if test is gpu available cuda only true with self session use gpu true model keras models sequential norm keras layers layernormalization input shape 3 4 4 norm keras layers layernormalization input shape 3 4 4 params axis 1 model add norm model compile loss 'mse' optimizer gradient descent gradientdescentoptimizer 0 01 ,fix keras normalization layers test piperorigin revid , fix a bug in the test case piperorigin revid
831,dyn libintl init if hlibintldll return 1 load gettext library libintl dll hlibintldll vimloadlib gettext dll ifdef gettext dll alt if hlibintldll hlibintldll vimloadlib gettext dll alt endif if hlibintldll hlibintldll vimloadlib gettext dll if hlibintldll if p verbose 0 ,patch problem using another language on ms windows does not work wu solution undo the change to try loading libintl dll first , patch problem when using a terminal window is a bit slow solution add a test for the gui
832,void benchmarkperformanceoptions resetperformanceoptions single option run params set std string nnapi accelerator name single option run params set bool disable nnapi cpu false single option run params set int max delegated partitions 0 single option run params set bool nnapi allow fp16 false endif if defined tflite enable hexagon single option run params set bool use hexagon false void benchmarkperformanceoptions createperformanceoptions benchmarkparam create bool false params addparam max delegated partitions benchmarkparam create int 0 params addparam max delegated partitions params addparam nnapi allow fp16 benchmarkparam create bool false all run params emplace back std move params ,add nnapi allow fp option to benchmark model , fix a bug in the test case piperorigin revid
833,class estimator baseestimator model fn ops self call model fn features labels model fn lib modekeys eval features labels self feature engineering fn features labels custom metrics should overwrite defaults if metrics model fn ops eval metric ops update make metrics ops ,estimator call feature engineering fn in get eval ops change , update keras layers to keras piperorigin revid
834,class model network for name in self output names if name not in loss logging warning 'output ' name ' missing from loss dictionary ' 'we assume this was done on purpose ' 'and we will not be expecting ' data to be passed to ' name ' during training ' 'output ' name ' missing from loss dictionary we assume ' 'this was done on purpose the fit and evaluate apis will not be ' 'expecting any data to be passed to ' name ' ' loss functions append losses get loss get name elif isinstance loss list if len loss len self outputs ,fix warning message when output not in loss dictionary output may be used just in summary so this message can be misleading piperorigin revid , update keras layers to the keras api piperorigin revid change id iecadcdbe
835,namespace ops namespace builtin namespace bidirectional sequence lstm lint ifchange input tensors of size max time n batch n input constexpr int kinputtensor 0 constexpr int 47 optional constexpr int kfwoutputtensor 0 constexpr int 1 ignored if merge outputs is set lint thenchange tensorflow lite tools optimize quantize weights cc temporary tensors enum scratch buffers for input forget etc gates ,add lint checks to make sure bidi rnn lstm stay in sync with quantize weights piperorigin revid , fix a bug in the graph piperorigin revid
836,slash adjust p if msc ver 1300 define open oh argtype intptr t else define open oh argtype long endif static int stat symlink aware const char name struct stat stp stat symlink aware const char name struct stat stp int fd n fd open intptr t h o rdonly fd open open oh argtype h o rdonly n fstat fd struct stat stp close fd return n wstat symlink aware const wchar name struct stat stp int fd fd open intptr t h o rdonly fd open open oh argtype h o rdonly n fstat fd stp close fd return n ,updated for version problem can't build with old msvc wang solution define open oh argtype instead of using intptr t directly , patch problem when using a terminal window is a bit slow solution add a test for the cursor
837,limitations under the license include tensorflow compiler jit shape inference helpers h include tensorflow compiler tf2xla const analysis h include tensorflow compiler tf2xla dump graph h include tensorflow compiler tf2xla validate control flow h include tensorflow compiler xla status macros h include tensorflow core common runtime function h include tensorflow core common runtime optimization registry h status encapsulator splitintosubgraphs for auto entry subgraphs subgraph subgraph entry second fixupsourceandsinkedges subgraph getgraph verify that the graph has well formed control flow structure to be functionalized verify that the graph has well formed control flow structure std vector controlflowinfo dummy tf return if error subgraph getgraph dummy tf return if error buildcontrolflowinfo subgraph getgraph dummy return s ,move control flow validation from tfxla to tf core piperorigin revid , xla python add a test for the xla client client piperorigin revid
838,statusor llvm smallvector affinemap 1 getpermutationifavailable return tensorflow errors internal permutations for dynamic shapes are not yet supported llvm smallvector int64 t 2 permuted sizes for auto dim llvm reverse shape layout minor to major permuted sizes push back shape dimensions dim int64 t accumulated stride 1 llvm smallvector int64 t 4 strides shape rank 1 for int64 dim layoututil minortomajor shape strides dim accumulated stride accumulated stride shape dimensions dim return llvm smallvector affinemap 1 affinemap get permuted sizes size 0 permuted sizes builder getcontext return llvm smallvector affinemap 1 makestridedlinearlayoutmap strides offset 0 builder getcontext namespace ,xla mlir emit memref strides in the right order before f becomes memref affine map d d d d but should become memref affine map d d d d piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
839,class public mlir functionpass returns the defining op for a value looking through islands static operation getdefiningop value val operation op val getdefiningop auto island op dyn cast tf executor islandop op auto island op dyn cast or null tf executor islandop op if island op return op auto yield op island op getyield auto index val cast mlir opresult getresultnumber static operation getdefiningop value val static value value pred val if pred val return pred val auto op getdefiningop pred val if auto id op dyn cast tf identityop op pred val id op input if auto id op dyn cast or null tf identityop op pred val id op input return pred val ,fix crash when trying to look through blockarg piperorigin revid change id , xla gpu support for the hlo hlo pipeline piperorigin revid change id idadedfddaccd
840,class mlircompiler public compiler struct irhook enum class loweringstage lhlo gpu llvm std function void mlir moduleop callback bool apply on lowered loweringstage stage void irhook module hook ,add lowering pipeline from lhlo to nvvm this adds a first simple lowering pipeline to the mlir gpu compiler that takes an mlir module containing lhlo to a module with kernel functions containing llvm nvvm dialect only piperorigin revid , xla gpu support for the hlo hlo instruction piperorigin revid change id idadedfddaccd
841,static char features static int included patches add new patch number below this line 1430 1429 ,patch popup window option wrap not supported problem popup window option wrap not supported solution implement it , patch problem when using a channel to be a bit a bit slow solution add a test for the test
842,status optimize cluster cluster const grappleritem item graphview graph output std set string nodes to delete for const nodedef node item graph node if node op batchdataset if node op batchdataset node op batchdatasetv2 continue status optimize cluster cluster const grappleritem item set the drop remainder input argument if batch node op batchdatasetv2 new node add input batch node input 2 else nodedef tmp tf return if error graph utils addscalarconstnode bool false output tmp ,tf data adding drop remainder argument to tf data dataset batch and tf data dataset padded batch deprecating tf contrib data batch and drop remainder and tf contrib data padded batch and drop remainder piperorigin revid , add a function to the graph piperorigin revid
843,class partitionedcallop public asyncopkernel op requires async ctx fbody nullptr errors internal could not find handle handle done op requires async ctx args size fbody arg nodes size errors invalidargument wrong number of arguments to the op function expects fbody arg nodes size but partitionedcall received args size done we need to pass global op registry as default registry when creating graph so that graph optimization passes can lookup all possible ops by name ,error out when partitionedcall is created with the wrong number of arguments used to be a segfault piperorigin revid , add support for int ops piperorigin revid
844,ins compl get exp pos t ini found new match search for exact line ins buf pos compl direction compl pattern else found new match searchit null ins buf pos found new match searchit null ins buf pos null compl direction compl pattern 1l search keep search re last linenr t 0 null null ,patch gn selects the wrong text with a multi line match problem gn selects the wrong text with a multi line match solution get the end position from searchit directly closes , patch problem when using a terminal window is a bit solution add a few more tests to the new code
845,class svdopgpu public asyncopkernel void computeasync opkernelcontext context donecallback done final const tensor input context input 0 const int ndims input dims const int64 m input dim size ndims 2 const int64 n input dim size ndims 1 const int64 p std min m n validate inputs op requires async class svdopgpu public asyncopkernel errors invalidargument input must have rank 2 got ndims done const int64 m input dim size ndims 2 const int64 n input dim size ndims 1 const int64 p std min m n output tensors tensor null tensor outputs null ,verify dimensions before we assume we have at least i e before we end up calling dim size with a negative dim index this fixes tensorflow python kernel tests svd op test gpu when running with asan piperorigin revid change id , fix a bug in the test piperorigin revid
846,from tensorflow python keras layers embeddings import embedding einsum based dense layer from tensorflow python keras layers einsum dense import einsumdense multi head attention layer from tensorflow python keras layers multi head attention import multiheadattention locally connected layers from tensorflow python keras layers local import locallyconnected1d from tensorflow python keras layers local import locallyconnected2d ,add multiheadattention layer for keras piperorigin revid change id , update keras layers to keras piperorigin revid
847,public static llvmtype getdoublety llvmdialect dialect static llvmtype getfloatty llvmdialect dialect static llvmtype gethalfty llvmdialect dialect static llvmtype llvmdialect dialect static llvmtype llvmdialect dialect utilities used to generate integer types static llvmtype llvmdialect dialect unsigned numbits ,add llvm ir dialect hooks for fp and x fp types closes copybara integrate review https github com tensorflow mlir pull from schweitzpgi more float types piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id icabdabcccecababba
848,class devicespecv2 object nodes created here will be assigned to job train device gpu 1 a devicespec consists of 5 components each of a devicespec consists of 5 components each of which is optionally specified job the job name ,fixed one trailing whitespace and one , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
849,f term dumpwrite typval t argvars typval t rettv unused int c cell chars i int pc prev cell chars i int should break c nul pc nul for the first character nul is the same as space if i 0 f term dumpwrite typval t argvars typval t rettv unused if c pc same chars false if c nul pc nul if should break break same attr cell attrs ,patch valgrind warns for using uninitialized access in tests problem valgrind warns for using uninitialized access in tests solution fix condition for breaking out of loop dominique pell√© closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
850,def set tf cunn version environ cp cudnn path from run shell bin ' p' cudnn path from re search ' so ' cudnn path from if cudnn path from none if cudnn path from cudnn path from cudnn path from group 1 if os path exists ' s s' cudnn path from tf cudnn version cudnn install path os path dirname cudnn path from break if os path exists ' s s' cudnn path from tf cudnn version cudnn install path os path dirname cudnn path from break reset and retry print ,move path exists if block inside none check , fix a bug in the docstring of the docstring of the documentation of the example change
851,def hook dummy table variables to activations tpu embedding activations new activations feature tpu ops tpu embedding activations dummy table variables table activations feature table id tpu embedding table to config dict keys index table table id list tpu embedding table to config dict index table lookup id tpu embedding table to features dict table index feature return new activations ,key returns a dict key object in python which doesn't have index so switch to use list instead which extracts the list of keys in both python and piperorigin revid , tf data fix a bug in the graph piperorigin revid
852,void confidence limits on frequency unsigned trials unsigned successes failures trials successes calculate confidence limits for an observed frequency of occurance that follows a negative binomial distribution frequency of occurrence that follows a negative binomial distribution using namespace std using namespace boost math ,one great big spell check lots of trivial typo fixes svn r , fix a bug in the watchdog page
853,std unordered set string grappleritem nodestopreserve const result insert nodename queue runner cancel op name if allowed optimizations prune ops with side effects for const nodedef node graph node if isfreeofsideeffect node result insert node name return result ,check if it's allowed to prune side effects in model pruner piperorigin revid , add a test for the graph and the graph piperorigin revid
854,add tag field add the tags matching the specified pattern to the list list as a dictionary add the tags matching the specified pattern pat to the list list as a dictionary use buf fname for priority unless null int get tags list t list char u pat get tags list t list char u pat char u buf fname intnum matches i ret char u matches p get tags list t list char u pat static ret find tags pat num matches matches tag regexp tag int maxcol null tag regexp tag int maxcol buf fname if ret ok num matches 0 for i 0 i num matches i ,patch taglist does not prioritize tags for a buffer problem taglist does not prioritize tags for a buffer solution add an optional buffer argument closes , patch problem when using a terminal window is a bit slow solution add a test for the file
855,tfliteregistration register pack tfliteregistration register split tfliteregistration register unpack tfliteregistration register neg tfliteregistration register add allopsresolver allopsresolver addbuiltin builtinoperator depthwise conv 2d register depthwise conv 2d allopsresolver allopsresolver max version 3 addbuiltin builtinoperator unpack register unpack addbuiltin builtinoperator neg register neg addbuiltin builtinoperator add register add namespace micro ,port add operation to micro piperorigin revid , add support for int ops piperorigin revid
856,edit revins legal 0 revins scol 1 endif if p ek disable bracketed paste mode we won't recognize the escape sequences out str t bd handle restarting insert mode ins esc ifdef cursor shape ui cursor shape may show different cursor shape endif if p ek re enable bracketed paste mode out str t be when recording or for ctrl o need to display the new mode ,patch paste does not work when 'esckeys' is off problem pasting in insert mode does not work when bracketed paste is used and 'esckeys' is off solution when 'esckeys' is off disable bracketed paste in insert mode , patch problem when using a terminal window is a bit solution add a test for the cursor
857,xla variadic op pattern afterall xla variadic op pattern concatenate xla variadic op pattern customcall xla variadic op pattern dynamicslice xla variadic op pattern fusion xla variadic op pattern map xla variadic op pattern reduce xla variadic op pattern sort ,support in the hlo pattern matcher piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
858,void automixedprecisionimpl bool automixedprecisionimpl const nodedef node const if node op identity node input size 1 if node op identity graphview inputport node input node 0 mutablegraphview outputport prev output graph view getregularfanin node input ,remove unnecessary condition on identity nodes , fix a bug in the test case piperorigin revid
859,static char u e n missing after s static char u e n unmatched s static char u e n unmatched s static char u e n unmatched s ifdef feat syn hl static char u e z not allowed n e66 z not allowed here static char u e z1 not allowed n e67 z1 et al not allowed here endif define not multi0 define multi one1 ,updated for version problem compiler warnings for unused variables solution put the variables inside ifdef , patch problem when using a terminal window is a bit slow solution add a test for the test
860,class tensorflowdialect public dialect same interface template typename args void addoperations void std initializer list int 0 addoperation abstractoperation get args this 0 dialect addoperations args using constantfoldhook logicalresult operation arrayref attribute ,nfc call into the base dialect instead of reimplementing it this allows for hiding the internal implementation details which can be subject to change piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id iefecfafdafabefecbd
861,class workerheartbeatmanager object logging info 'shutting down s ' self req event pb2 workerheartbeatrequest watchdog config event pb2 watchdogconfig timeout ms timeout ms watchdog config event pb2 watchdogconfig timeout ms timeout ms shutdown mode event pb2 wait for coordinator self configure req wait for workers to shutdown this isn't strictly required ,ensure workers are configured to shut down on timeout piperorigin revid , fix a bug in the new module of the new module piperorigin revid
862,def set tf cuda version environ cp cuda toolkit path cygpath cuda toolkit path if is windows cuda rt lib path 'lib x64 cudart lib' cuda rt lib paths 'lib x64 cudart lib' elif is linux cuda rt lib path 'lib64 so s' tf cuda version cuda rt lib paths ' s so s' x tf cuda version for x in 'lib x86 64 linux gnu' elif is macos cuda rt lib path 'lib s dylib' tf cuda version cuda rt lib paths 'lib s dylib' tf cuda version cuda toolkit path full os path join cuda toolkit path cuda rt lib path if os path exists cuda toolkit path full break cuda toolkit paths full os path join cuda toolkit path x for x in cuda rt lib paths if any os path exists x for x in cuda toolkit paths full break reset and retry print 'invalid path to cuda s toolkit s cannot be found' ,update cuda and cudnn paths to for debian , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
863,def process list value name parse fn var type m dict values def parse values values type map parses hyperparameter values from a string into a python map values is a string containing comma separated name value pairs for each pair the value of the hyperparameter named name is set to ,fixes typo in hparams comment piperorigin revid , fix a bug in the docstring of the docstring of the new api change
864,from future import print function import platform from tensorflow python framework import ops if platform system windows pylint disable wildcard import unused import g import not at top from tensorflow contrib tpu ops import gen tpu ops from tensorflow contrib tpu ops gen tpu ops import from tensorflow contrib util import loader if platform system windows tpu ops loader load op library resource loader get path to datafile tpu ops so ops registergradient crossreplicasum def cross replica sum grad op grad del op unused the gradient of a cross replica sum is also a cross replica sum return gen tpu ops cross replica sum grad else we have already built the appropriate libraries into the binary via cmake if we have built contrib so we don't need this ,tpu register gradient for crossreplicasum the gradient for crossreplicasum is just a crossreplicasum piperorigin revid , fix a bug in the test case piperorigin revid
865,without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license include tensorflow lite experimental acceleration whitelist android info h include tensorflow lite experimental acceleration compatibility android info h include string ,rename gpu whitelist compatibility list piperorigin revid change id , add a test for the new op op piperorigin revid
866,void benchmarklogginglistener onbenchmarkend const benchmarkresults results tflite log info average inference timings in us warmup warmup us avg init init us no stats inference us avg inference inference us avg std vector flag benchmarkmodel getflags ,modify prefix for average inference stats in benchmark model use inference rather than no stats for clarity piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id iaaffafbceeeafc
867,class tensorlistelementshape public opkernel list saw ' c input 0 scalar variant debugstring ' tensor result op requires ok c c allocate output 0 tensorshape l element shape dims result for int i 0 i l element shape dims i if l element shape unknown rank op requires ok c c allocate output 0 tensorshape result if result dtype dt int32 result flat int32 i l element shape dim size i result scalar int32 1 else result flat int64 i l element shape dim size i result scalar int64 1 else op requires ok c c allocate output 0 tensorshape l element shape dims result for int i 0 i l element shape dims i if result dtype dt int32 result flat int32 i l element shape dim size i else result flat int64 i l element shape dim size i ,tensorlistelementshape should return scalar with value if shape has unknown rank piperorigin revid , fix a bug in the test case piperorigin revid
868,struct graphexecutionstateoptions buildgraphoptions struct explicit std unique ptr functionlibrarydefinition flib datatypevector feed types datatypevector fetch types int64 collective graph key datatypevector feed types datatypevector fetch types flib def std move flib graph flib def get feed types std move feed types fetch types std move fetch types collective graph key collective graph key fetch types std move fetch types each client graph gets its own function library since optimization passes post rewrite for execution might want to introduce new functions std unique ptr functionlibrarydefinition flib def graph graph datatypevector feed types datatypevector fetch types int64 collective graph key graphexecutionstate is responsible for generating an ,automated rollback of commit piperorigin revid , fix a bug in the toy overview class piperorigin revid change id iaaeaebbe
869,static void dpidebug getformatwithprefix const char format char formatwithprefix size t char size t size int uint64 t threadid int size t size ifdef win32 time else void dpidebug initialize void valid integer it is ignored getenv dpi debug level if dpidebuglevel strtol null 10 dpidebuglevel unsigned long strtol null 10 determine the value of the environment variable dpi debug prefix and store it in the static buffer available for it a static buffer is used ,eliminate warnings raised by static source code analyzer , fix a bug in the new page of the new page of the number of the number of the number of the number of the same value of the same process
870,class operation object raises valueerror if this op does not have an attr with the given name fields s i f b type shape tensor fields s i f b type shape tensor func if name not in self node def attr raise valueerror no attr named ' name ' in str self node def ,operation get attr should support function attrs piperorigin revid , tf data service support for tf data dataset piperorigin revid
871,this module can perform operations on nested structures a nested structure is a python sequence tuple including namedtuple or dict that can contain further sequences tuples and dicts structures are scalar or tuple or dict or list of constructed scalars and or other tuples lists or a scalar object note numpy arrays are considered scalars structures are atom or tuple or dict or list of constructed atoms and or other tuples lists or an atom object note numpy arrays are considered atoms attr s decorated classes http www attrs org are also supported in the same way as namedtuple def flatten structure expand composites false running args structure an arbitrarily nested structure structure an arbitrarily nested structure note numpy arrays are considered atoms and are not flattened expand composites if true then composite tensors such as tf sparsetensor and tf raggedtensor are expanded into their component tensors ,changed scalar to , fix a bug in the new overview class piperorigin revid change id iaaeaebbe
872,limitations under the license define tensorflow lib core refcount h include atomic include memory include tensorflow core platform logging h namespace tensorflow class refcounted void operator const refcounted delete a deleter class to form a std unique ptr that unrefs objects struct void operator tensorflow core refcounted o const o unref a unique ptr that unrefs the owned object on destruction template typename t using refcountptr std unique ptr t helper class to unref an object when out of scope class scopedunref public ,a deleter class that calls refcounted unref and a unique ptr alias that uses this deleter this class can be used to automate the management of ref owned objects piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
873,static inline size t raxlowwalk rax rax unsigned char s size t len raxnode if j h size break else even when h size is large linear scan provides good compared to other that are in theory more like performing a binary search for j 0 j h size j if v j s i break ,clarify why scan children even for large h size values , fix a bug in the new parser test for the new code
874,class raggedtensortest test util tensorflowtestcase 0 1 2 3 4 5 6 7 8 9 10 11 12 13 self assertlen rt nested row splits 1 self assertallequal rt nested row splits 0 0 2 2 5 6 7 self assertlen rt nested value rowids 1 self assertallequal rt nested value rowids 0 0 0 2 2 2 3 4 def 3d with ragged rank 2 self values constant op constant 'a' 'b' 'c' 'd' 'e' 'f' 'g' class raggedtensortest test util tensorflowtestcase self assertlen rt nested row splits 2 self assertallequal rt nested row splits 0 0 2 3 3 5 self assertallequal rt nested row splits 1 0 2 2 5 6 7 self assertlen rt nested value rowids 2 self assertallequal rt nested value rowids 0 0 0 1 3 3 self assertallequal rt nested value rowids 1 0 0 2 2 2 3 4 raggedtensor shape ,added a function for nested value rowids similar to nested row lengths this will help when handling value rowids natively piperorigin revid , tf data dataset to tf data dataset dataset to tf data dataset piperorigin revid
875,static char features static int included patches add new patch number below this line 1551 ,patch warnings from asan with clang problem warnings from asan with clang james mccoy solution avoid using a null pointer issue , patch problem when using a channel to be a bit a bit slow solution add a test for the test
876,buflist new ffname sfname lnum flags buf b wininfo wi win curwin ifdef feat eval init var dict buf b vars buf b bufvar init b variables init b variables init var dict buf b vars buf b bufvar var scope endif ifdef feat syn hl hash init buf b s b keywtab ,updated for version problem it is possible to add replace builtin functions by calling extend on g solution add a flag to a dict to indicate it is a scope check for existing functions zyx , fix a bug in the new parser test for the new code
877,static char features static int included patches add new patch number below this line 661 ,patch eval test is still old style problem eval test is still old style solution change into new style tests yegappan lakshmanan closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
878,class rnn cell rnncell returns a tuple containing a 2d batch x output size tensor representing the output of the cell after reading inputs when previous state was state a 2d batch x state size tensor representing the new state of the cell ,fix broken lists in documentation and back quote more identifiers change , tf data dataset dataset to the dataset dataset to the dataset to be used for the same shape of the same shape piperorigin revid
879,class modekeys object predict class metrickeys object loss 'loss' auc 'auc' accuracy 'accuracy' class estimatorspec collections namedtuple 'predictions' 'loss' 'train op' 'eval metric ops' ,added mean 'loss' to estimator evaluate change , fix a bug in the docstring of the keras model piperorigin revid
880,def enable c api fn def run in graph and eager modes unused none graph none config none use gpu false force gpu false use gpu false force gpu false reset test false runs the test in both graph and eager modes args def run in graph and eager modes unused none graph none config none session use gpu if true attempt to run as many ops as possible on gpu force gpu if true pin all ops to device gpu 0 reset test if true teardown and setup the test case again returns returns a decorator that will run the decorated test function def run in graph and eager modes unused none graph none config none with self test session graph config use gpu force gpu f self if reset test self teardown self setup def run eager mode if force gpu gpu name gpu device name ,fix adam in eager mode and test adam momentum piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
881,define un magic x x 256 define is magic x x 0 static int no magic int x static int toggle magic int x static int no magic int x ,patch problem superfluous function prototypes solution remove them , fix a bug in the new module of the new module of the dtrace hdl is not used in the dtrace hdl and the dtrace is not used in the dtrace process and the dtrace is not used in the same class piperorigin revid
882,datatypevector datatypevector return dt float dt int32 dt int64 datatypevector return dt float dt int32 dt int64 dt qint8 dt quint8 dt qint32 return dt float dt int32 dt int64 dt qint8 dt quint8 dt qint32 dt half datatypevector quantizedtypes datatypevector quantizedtypes datatypevector realandquantizedtypes return dt float dt int32 dt int64 dt qint8 dt quint8 dt qint16 dt quint16 dt qint32 return dt float dt int32 dt int64 dt qint8 dt quint8 dt qint16 dt quint16 dt qint32 dt half else defined android defined android types full ,fix a case where dt half would not be part of the right type lists for android types full change , fix a bug in the file header piperorigin revid change id iefaaedbcfceefdda
883,using std tuple size define gtest has cxxabi h 0 endif a function level attribute to disable checking for use of uninitialized memory when built with if defined clang if has feature memory sanitizer define gtest attribute no sanitize memory attribute no sanitize memory else define gtest attribute no sanitize memory endif else define gtest attribute no sanitize memory endif namespace testing class message ,add memorysanitizer annotations in gtest printers also remove unused variable , fix a bug in the parser build piperorigin revid
884,class kerasinitializerstest test testcase model get config custom objects 'my initializer' my initializer self assertequal model2 layers 1 kernel initializer my initializer test util run v2 only def test load external variance scaling v2 self external serialized json 'class name' 'variancescaling' 'config' 'normal' 'mode' 'fan avg' 'scale' 1 0 none initializer keras initializers deserialize external serialized json self assertequal initializer distribution 'truncated normal' if name ' main ' test main ,fix serialization compatibility with external keras for variancescaling with distribution normal piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid change id iffafdbbcddfebbeac
885,if gtest has typed test gtest has typed test p ifdef gnuc ifdef gnuc is too general here it is possible to use gcc without using which is where cxxabi h comes from ifdef glibcxx include cxxabi h endif gnuc endif glibcxx include typeinfo string gettypename if gtest has rtti const char const name typeid t name ifdef gnuc ifdef glibcxx int status 0 gcc's implementation of typeid t name the type name so we have to demangle it string gettypename return name str else return name endif gnuc endif glibcxx else return type ,fixes the logic for determining whether cxxabi h is available , updated for version problem when using a character of a character of the buffer is a character solution add the option to the list of the line
886,class test benchmark device device dtype str dtype replace ' ' '' str n 'x' str m 'x' str k ' ta ' str transpose a ' tb ' str transpose b replace ' ' '' str transpose a ' tb ' str transpose b replace ' ' '' iters num iters wall time duration return duration class test benchmark self run test gpu n m k transpose a transpose b dtype num iters def benchmark matmul self num iters 200 for in range 10 self test round num iters self test round num iters 200 if name ' main ' ,change to only run one round of matmul benchmark piperorigin revid , tf data service support for tf data dataset piperorigin revid
887,class categorical distribution distribution array ops slice array ops shape logits 0 array ops rank logits 1 dtype k dtype k set shape tensor shape tensorshape logits get shape 1 return nn ops sparse softmax cross entropy with logits logits k ,categorical log prob shape fix change , fix a bug in the docstring of the docstring of the docstring change
888,statusor literal const literal from return double from indices extract as scalar case c64 return std complex float from indices extract as scalar case u64 return uint64 from indices extract as scalar statusor literal const literal from return int64 from indices extract as scalar case c128 return std complex double from indices extract as scalar default return invalidargument unsupported type for sort s primitivetype name type ,xla add support for c to the sort evaluator we were just missing some entries in a switch case to enable this piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid
889,xlaop compare const xlaop lhs const xlaop rhs broadcast dimensions direction xlaop compare const xlaop lhs const xlaop rhs comparisondirection direction return compare lhs rhs direction xlaop dot const xlaop lhs const xlaop rhs const precisionconfig precision config return lhs builder dot lhs rhs precision config ,add a compare builder that is compatible with omitting broadcast dimensions with the same ordering as the other binary ops this helps reduce boilerplate of generated code that to treat all binary ops generically piperorigin revid change id , xla gpu support for the xla client piperorigin revid change id id iaaeabfdfedfeacedf
890,test functionalizecontrolflow tf expect ok scope tograph graph regression test control edges from an enter node to the graph sink should be ignored for node n graph nodes if n name while enter graph addcontroledge n graph sink node functionlibrarydefinition library opregistry global tf assert ok functionalizecontrolflow graph library ,tf xla ignore control edges from enter nodes to the graph sink during loop functionalization piperorigin revid , add a test for the graph and the graph piperorigin revid
891,class xlatensorbuffer public tensorbuffer allocator allocator exposed in this header file for purposes but this is an internal implementation detail namespace internal return the subtree of the given shapedbuffer as a scopedshapedbuffer the returned scopedshapedbuffer takes ownership of the subtree and sets the input's buffer pointers to nullptr for the subtree xla scopedshapedbuffer extractsubshapedbuffer xla shapedbuffer shaped buffer int index xla devicememoryallocator allocator namespace internal namespace tensorflow endif tensorflow compiler jit xla launch util h ,xla move into xla scopedshapedbuffer as a new method this method seems like it more belongs in the xla libraries simplify and generalize the implementation and add a test piperorigin revid , fix a bug in the test piperorigin revid
892,def cudnn rnn backwardv3 op grads seed op get attr seed seed2 op get attr seed2 time major op get attr time major num proj op get attr num proj rnn mode op get attr rnn mode input mode op get attr input mode direction op get attr direction none ,add cudnn lstm projection , tf data saveable dataset to be used by default piperorigin revid
893,from future import division from future import print function import collections import contextlib import copy import random import threading def eager mode return context mode eager mode pylint disable protected access todo agarwal get rid of this and use ops name scope instead contextlib contextmanager def namescope name ctx context old name ctx scope name ctx scope name s s old name name if old name else name try yield finally ctx scope name old name def scope name return context scope name ,removed unused context if this change breaks you switch to tf name scope piperorigin revid , tf data service support for tf data dataset piperorigin revid
894,ex echo exarg t eap void ex exarg t eap intid id syn name2id eap arg if id 0 echo attr 0 else echo attr syn id2attr id echo attr syn eap arg ,patch cannot define a toolbar for a window problem cannot define a toolbar for a window solution add a window local toolbar , patch problem when using a terminal window is a bit slow solution add a test for the command line
895,include stdio h include stdlib h include stdarg h include unistd h void output const char fmt printf s outputbuf if logfile null printf logfile not open n exit exit failure fprintf logfile s outputbuf ,be defensive in output this should hopefully prevent the previous bug from , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
896,static void init child struct childdata child int childno wait for parent to set our childno while pids childno pid int ret 0 make sure parent is actually alive to wait for us ret pid alive mainpid if ret 0 if pid alive mainpid false panic exit shm corruption outputerr bug parent d went away n mainpid sleep 20000 static void check parent pid void main pid d ppid d n pid mainpid ppid if pid alive mainpid 1 if pid alive mainpid false output 0 main pid d is dead n mainpid panic exit reparent problem void child process struct childdata child int childno if we're exiting because we tainted wait here for it to be done while shm postmortem in progress true make sure the main process is still around if pid alive mainpid 1 if pid alive mainpid false goto out usleep 1 ,pid alive is a boolean thing so make it return bool , fix a bug in the watchdog page
897,win line wp lnum startrow endrow nochange special character via 'listchars' option precedes char if lcs prec todo nul wp w p list wp w p wrap wp w skipcol 0 wp w leftcol 0 ifdef feat diff filler todo 0 ,updated for version problem the precedes entry in will be drawn when is set and list is not solution only draw this character when 'list' is on christian brabandt , patch problem when using a popup window with a terminal window solution add the option to the current buffer when the cursor is set
898,static char features static int included patches add new patch number below this line 2167 2166 ,patch mapping test fails on ms windows problem mapping test fails on ms windows solution remove all the existing insert mode mappings , patch problem when using a channel to be a bit a bit slow solution add a test for the test
899,void shard int max parallelism thread threadpool workers int64 total workers parallelfor total cost per unit work return sharder do total cost per unit work workers sharder closure c workers schedule c max parallelism void sharder do int64 total int64 cost per unit const work work const runner runner int max parallelism cost per unit std max int64 1 cost per unit we shard 0 total into num shards shards 1 num shards num worker threads void shard int max parallelism thread threadpool workers int64 total blockingcounter counter num shards used 1 for int64 start block size start total start block size auto limit std min start block size total workers schedule work counter start limit runner work counter start limit work start limit compute the shard counter decrementcount the shard is done ,refactor the impl of shard so that the caller can use a runner piperorigin revid , xla python add a xla interface to the xla client piperorigin revid
900,class condv2test test testcase output build cond with indexed slices self assertallequal output 1 def self def function function def build cond with indexed slices pred constant op constant true def true fn return none none none math ops as indexed slices constant op constant 1 def false fn return none none none math ops as indexed slices constant op constant 2 result cond v2 cond v2 pred true fn false fn self assertisnone result 0 self assertisnone result 1 self assertisnone result 2 return ops convert to tensor result 3 output build cond with indexed slices self assertallequal output 1 def testexternalcontroldependencies self with ops graph as default self test session v variables variable 1 0 ,correctly handle nones in cond v make indexed slices indices types match piperorigin revid change id , tf data dataset to tf data dataset piperorigin revid
901,getcmdkeycmd c1 to special c1 c2 if c1 ctrl v ctrl v is followed by octal hex or other characters reverses what appendtoredobufflit does no reduce keys true don't merge modifyotherkeys c1 get literal no reduce keys false if got int aborted true ,patch cmd does not handle ctrl v problem cmd does not handle ctrl v solution call get literal after encountering ctrl v closes , patch problem when using a terminal window is a bit slow solution add a test for the current line
902,regmatch scan limit operand min rp rs scan if reg multi if rp rs un regsave rs u pos col 0 if limit 0 rp rs un regsave rs u pos lnum behind pos rs u pos lnum colnr t strlen regline behind pos rs u pos col rp rs un regsave rs u pos col limit no fail else if rp rs un regsave rs u pos col 0 if rp rs un regsave rs u pos lnum behind pos rs u pos lnum regmatch scan else endif rp rs un regsave rs u pos col if limit 0 rp rs un regsave rs u pos lnum behind pos rs u pos lnum colnr t strlen regline behind pos rs u pos col rp rs un regsave rs u pos col limit no fail else ,updated for version problem new regexp engine and are not implemented solution implement look behind matching fix off by one error in old regexp engine , patch problem when using a terminal window is a bit solution add a test for the test
903,class opdefbuilder python framework common shapes py opdefbuilder setshapefn opshapeinferencefn fn allows the type in calls to attr to be any this is used by for pass through parameters opdefbuilder sets op reg data op def to the requested opdef and op reg data shape inference fn to the requested shape inference function or returns an error class opdefbuilder std vector string control outputs std string doc std vector string errors bool allow attr type any false namespace tensorflow ,update opdefbuilder with an option to allow attr type to be piperorigin revid change id , tf data saveable shape for tf data dataset piperorigin revid
904,class typedexpectation public expectationbase if matchers args describematchfailuretupleto matchers args os if extra matcher matches args stringmatchresultlistener listener if extra matcher matchandexplain args listener os expected args extra matcher describeto os os n actual don't match internal explainmatchresultasneededto const argumenttuple extra matcher args os internal listener str os os n else if ,implements the new matcher api , xla python fix a bug in the client client piperorigin revid
905,ifdef use caif include linux caif caif socket h void caif gen sockaddr struct sockaddr addr socklen t addrlen static void caif gen sockaddr struct sockaddr addr socklen t addrlen struct sockaddr caif caif unsigned int i struct netproto proto caif name caif socket caif rand socket setsockopt caif setsockopt gen sockaddr caif gen sockaddr endif ,convert pf caif to use gen sockaddr , proto zmalloc conversion
906,static device dev const char type const char name return new attr class devicesettest public testing test class devicesettest public testing test public void adddevice const char type const char name device d dev type name ,tensorflow fully qualify testing namespace for gunit change , fix a bug in the test case piperorigin revid
907,pyobject tfe py initeagertensor pyobject base class eagertensortype eagertensortype py incref eagertensortype endif we disable instance based attribute lookup its not clear if these dictionaries are correctly initialized in the first place eagertensortype tp 0 return reinterpret cast pyobject eagertensortype ,enable variable indices assign in eager to match existing graph semantics piperorigin revid , fix a bug in the test case piperorigin revid
908,void outputstd const char fmt va end args static void output syscall prefix to fd const unsigned int childno file fd bool mono static void output syscall prefix to fd int childno file fd bool mono struct syscallentry entry struct syscallrecord rec static void output syscall prefix to fd const unsigned int childno file fd bo this function is always called from a fuzzing child void output syscall prefix const unsigned int childno void output syscall prefix int childno file log handle ,childno can be signed , fix a bug in the watchdog process
909,class public opkernel auto do quantile add summary const int64 begin const int64 end iterating all features for int64 feature idx begin feature idx end feature idx quantilestream stream stream resource stream feature idx if stream vlog 1 quantilestream has already been finalized for feature feature idx continue const tensor summaries summaries list feature idx const auto summary values summaries matrix float const auto tensor shape summaries shape ,ignore push summary when stream is already finalized piperorigin revid , fix a bug in the delegate test piperorigin revid
910,limitations under the license include set include llvm adt densemap h include mlir analysis h tf llvm project include mlir dialect standardops ir ops h tf llvm project include mlir ir builders h tf llvm project include mlir ir function h tf llvm project class assign variable resource return todo ashwinm combine these two using callopinterface if auto call dyn cast tf op call f call getoperands symbol table return if auto call dyn cast tf partitionedcallop op if auto call dyn cast callopinterface op if auto sym op getattroftype symbolrefattr f sym cast flatsymbolrefattr getvalue call getoperands sym cast flatsymbolrefattr getvalue call getargoperands symbol table return ,consolidate via callopinterface the various tf call ops handling in optimize global tensors pass piperorigin revid change id , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
911,class action template typename result typename argumenttuple result perform const argumenttuple args const processes the arguments and returns a result using tr1 get n args to get the n th 0 based argument in the tuple std get n args to get the n th 0 based argument in the tuple class setargumentpointeeaction template typename result typename argumenttuple void perform const argumenttuple args const compileasserttypesequal void result testing get n args value std get n args value private class setargumentpointeeaction n proto true template typename result typename argumenttuple void perform const argumenttuple args const compileasserttypesequal void result testing get n args copyfrom proto std get n args copyfrom proto private ,unconditionally use std tuple remove all mention of tr tuple and our own implementation of tuple piperorigin revid , fix a bug in the toy tutorial piperorigin revid change id icfcccdcbedbaacf
912,void registerbitcastop tf deletestatus status maybe unused static bool static bool if should register op bitcast registerbitcastop ,clean up only piperorigin revid change id , xla python add a test for the xla cpu backend piperorigin revid
913,class savedmodeltest tf test testcase self assertcommandsucceeded use model in sequential keras model dir export dir def test text embedding in dataset self export dir self get temp dir self assertcommandsucceeded export simple text embedding export dir export dir self assertcommandsucceeded use text embedding in dataset model dir export dir def test mnist cnn self export dir self get temp dir self assertcommandsucceeded ,integration test for use of a text embedding saved model in a dataset map function piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
914,void const char function system call and thus safer in the presence of threads exit will invoke user defined exit hooks which may do dangerous things that conflict with death tests exit 1 some compilers can recognize that exit never returns and issue the code' warning for code following this function unless by a fake condition if alwaystrue exit 1 tests that death tests work ,fixes an warning by msvc on certain opt settings in gtest death test test cc , fix a bug in the parser test piperorigin revid
915,from tensorflow python ops import array ops from tensorflow python ops import check ops from tensorflow python ops import math ops from tensorflow python ops import sparse ops from tensorflow python ops ragged import ragged math ops from tensorflow python ops ragged import ragged tensor from tensorflow python platform import tf logging from tensorflow python util lazy loader import lazyloader from tensorflow python util tf export import tf export avoid circular dependencies with raggedtensor todo b refactor ragged modules so this is unnecessary ragged tensor lazyloader ragged tensor globals tensorflow python ops ragged ragged tensor ragged math ops lazyloader ragged math ops globals tensorflow python ops ragged ragged math ops todo b refactor code move input verification to feature configuration objects e g varlenfeature should check that dtype is a valid dtype ,remove circular dependencies by removing submodule imports from ragged package if ragged init py imports all ragged modules then it's impossible to depend on one ragged module without depending on all of them piperorigin revid change id , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
916,doesckey if p im goto normalchar insert ctrl z as normal char do cmdline cmd char u stop c ctrl o fallthrough ifdef cursor shape ui cursor shape may need to update cursor shape endif continue case ctrl o execute one command ifdef feat compl func ,patch ctrl z and mouse click use ctrl o unnecessary problem ctrl z and mouse click use ctrl o unnecessary solution remove stuffing ctrl o james mccoy closes , patch problem when using a popup window with a popup window solution add a test for the cursor
917,class timedistributedtest keras parameterized testcase inputs keras input batch shape 1 none 32 32 1 outputs layer inputs make sure the batch dim is not lost after array ops reshape self assertequal outputs shape 1 none 30 30 16 self assertlistequal outputs shape as list 1 none 30 30 16 combinations generate combinations combine mode 'graph' 'eager' ,fix a bug due to comparing list and tensorshape in timedistributed layer test , fix a bug in the docstring of the keras model piperorigin revid
918,class context object raise valueerror execution mode should be none sync async got s execution mode if execution mode is none execution mode async if tfrt utils enabled else sync execution mode sync self default is async execution mode async self lazy remote inputs copy none self use tfrt tfrt utils enabled ,handle error metadata properly in c api tfrt update is async based on the eagerexecutor in async mode don't report error synchronously piperorigin revid change id , tf data service support for tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
919,class tf test testcase logdir test dir self get temp dir 'test with tf graph as default tf contrib framework get or create global step do step tf assign add 1 tf scalar summary 'my summary tag' 2 new tf assign add 1 tf scalar summary 'my summary tag' new 2 with tf train monitoredtrainingsession is chief true checkpoint dir logdir as session for in range 101 100 is default summary writing steps session run do step session run new summaries testing latest summaries logdir tags s summary value 0 tag for s in summaries self assertin 'my summary tag' tags ,fixed condition in monitoredsession test change , tf data dataset to tf data dataset piperorigin revid
920,def ndtri x name none return the of the input element wise for example tf math ceil 1 7 1 5 0 2 0 2 1 5 1 7 2 0 tf tensor shape 7 dtype float32 numpy array 1 1 0 1 2 2 2 dtype float32 args x a tf tensor must be one of the following types bfloat16 half float32 float64 int32 name a name for the operation optional returns a tf tensor has the same type as x compatibility numpy equivalent to np ceil end compatibility return gen math ops ceil x name ,improve documentation of tf math ceil piperorigin revid change id , fix a bug in the docstring of the docstring of the new api change
921,abort search endif feat textobj check if the pattern is one character long or zero width check if the pattern is zero width if move is true check from the beginning of the buffer else from position cur direction is forward or backward current search put cursor on last character of match curwin w cursor end pos if lt pos visual end pos if lt pos visual end pos forward dec cursor else if visual active lt pos curwin w cursor visual curwin w cursor pos put the cursor on the start of the match ,patch gn is off by one in visual mode problem gn is off by one in visual mode solution check moving forward christian brabandt , patch problem when using a terminal window is a bit slow solution add a test for the cursor
922,def createhtmlfile tflite input html output spec on what keys to display buffer keys to display data datasizemapper operator keys to display builtin code none custom code none operator keys to display builtin code none custom code none version none for subgraph idx g in enumerate data subgraphs subgraph local specs on what to display ,show op versions is tflite model visualization tool piperorigin revid , fix a bug in the test case piperorigin revid
923,win line else tocol maxcol do at least one character happens when past end of line if fromcol tocol if fromcol tocol search match endcol tocol fromcol 1 area highlighting true vi attr hl attr hlf i ,patch highlighting a character too much with incsearch problem highlighting a character too much with incsearch solution check search match christian brabandt closes , patch problem when using a popup window with a terminal window solution add the option to the current buffer when the cursor is set
924,limitations under the license define eigen use threads include tensorflow core kernels concat op h include tensorflow core kernels concat lib h include vector include tensorflow core framework register types h include tensorflow core util work sharder h ,give tensorflow core kernels its own build file change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
925,mch setmouse int on endif mouse vers if defined feat x11 defined feat xclipboard if on make sure not tracing mouse important when a button down was received but no release yet stop xterm trace endif if on mouse ifdef feat beval term p bevalterm bevalterm ,patch using inputlist during startup results in garbage problem using inputlist during startup results in garbage dominique pelle solution make sure the xterm tracing is stopped when disabling the mouse , patch problem when using a terminal window is a bit slow solution add a test for the cursor
926,test argstest for testing args 's explanation class public matcherinterface std tuple char int public virtual void describeto std ostream os const void describeto std ostream os const override virtual bool matchandexplain std tuple char int value matchresultlistener listener const bool matchandexplain std tuple char int value matchresultlistener listener const override const int diff std get 0 value std get 1 value if diff 0 listener where the first value is diff ,fix clang winconsistent missing override warnings and matchandexplain in gmock matchers test both override virtual methods remove the virtual keyword and apply override to them instead signed off by enji cooper yaneurabeya gmail com , fix a bug in the test case piperorigin revid
927,def main environment variables environ cp dict os environ current bazel version check bazel version '0 22 0' '0 24 1' current bazel version check bazel version '0 24 1' '0 25 0' tf current bazel version convert version to int current bazel version reset tf configure bazelrc ,bump the minimal bazel version to we'll have to bump the minimal bazel version to because google cloud cpp v doesn't work with bazel piperorigin revid , fix a bug in the documentation of the new module piperorigin revid
928,struct void operator const device device outputtype output const inputtype images const transform const output device device images generate output device device output generate projectivegenerator device t images transform interpolation ,allow output has a different shape from input in the image transform piperorigin revid , add a test for the new op api piperorigin revid
929,dotopemitter matmultdims dotopemitter getmatmultdims const layoututil minor target array getshape layout 0 0 return whether the given shape is a matrix with no padding static bool isrank2withnopadding const shape shape return shapeutil rank shape 2 layoututil ispadded shape return whether the given shape is rank 2 static bool const shape shape return shapeutil rank shape 2 in a gemm operation where output lhs rhs check whether the given shapes are valid for the operation static bool arevalidgemmshapes return false if isrank2withnopadding lhs shape isrank2withnopadding rhs shape isrank2withnopadding output shape if lhs shape rhs shape output shape return false ,remove the padded dimensions and padding value fields from the layout these fields were never used nor supported piperorigin revid , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
930,class experiment object runs infinite eval on the evaluation data set this function starts evaluating after delay secs seconds and then runs no more than one evaluation with self eval steps steps each time per throttle delay secs it never returns throttle delay secs if train steps is not none will return after global step reaches train steps args input fn the input to use for this eval class experiment object results as arguments at the beginning of evaluation the passed eval results will be none so it's expected that the predicate function handles that gracefully when predicate fn is not specified continuous eval will run in an infinite loop continuous eval will run in an infinite loop if train steps is none or exit once global step reaches train steps raises valueerror if continuous eval predicate fn is neither none nor ,update the docstring for continuous eval change , fix a bug in the docstring of the docstring of the docstring change
931,class basegenerator protected virtual basegenerator const char flatbuffersgeneratedwarning return automatically generated by the flatbuffers compiler do not modify n n bool iseverythinggenerated for auto it parser enums vec begin it parser enums vec end it ,sharing the flatbuffers warning , fix a bug in the parser test piperorigin revid
932,static int gs to raster fuzz const unsigned char buf size t size mostly stolen from cups filters gstoraster char args 1 1 rgb ,ghostscript limit ghostscript memory usage to gbyte , fix a bug in the client client client client
933,class dynamicdecodernntest test testcase initial state cell zero state dtype dtypes float32 batch size batch size final outputs final state decoder dynamic decode rnn final outputs final state decoder dynamic decode my decoder output time major time major maximum iterations maximum iterations class dynamicdecodernntest test testcase match the variable scope of dynamic rnn below so we end up using the same variables with vs variable scope root as scope final decoder outputs final decoder state decoder dynamic decode rnn final decoder outputs final decoder state decoder dynamic decode my decoder finished true ensures outputs and final state match those of dynamic rnn called with sequence length not none ,remove complicated decoder api in favor of new object oriented api in tf contrib seqseq expose the new classes and functions in tf contrib seqseq delete old functions rename dynamic decode rnn dynamic decode change , fix a bug in the docstring of the test case piperorigin revid
934,static pyobject stringvar getvalue ifdef py unicode wide return pyunicode data var actuallength pos null null else return pyunicode py unicode data var actuallength pos return pyunicode py unicode data var actuallength pos 2 endif endif ,fix handling of unicode on narrow build machines now that byte length semantics are being used in all cases , fix a bug in the client client client client
935,static inline const char const ugt ugt uge uge return returns a value of the predicate corresponding to the given returns numpredicates one past end if there is no such ,fix a few warnings for missing parentheses around ' ' and extra semicolons piperorigin revid , fix a bug in the parser test piperorigin revid
936,getout int exitval win t wp exiting true if defined feat job channel ch log null exiting endif when running in ex mode an error causes us to exit with a non zero exit code posix requires this although it's not 100 clear from the ,patch channel log doesn't mention exiting problem channel log doesn't mention exiting solution add a ch log call in , patch problem when using a terminal window is a bit slow solution add a test for the command line
937,set var return else if v di tv v type tv v type internal error set var emsg2 setting s to value with wrong type name clear tv v di tv ,patch setting v errors to a string give confusing error problem setting v errors to a string give confusing error christian brabandt solution change internal error into normal error message , patch problem when using a terminal window is a bit slow solution add a test for the command line
938,limitations under the license include tensorflow core framework op kernel h include tensorflow core framework register types h include tensorflow core framework tensor h include tensorflow core kernels pooling ops common h include tensorflow core platform errors h include tensorflow core util tensor format h ,additional cleanup of build files piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
939,inline void ensuredirexists const std string filepath obtains the absolute path from any other path returns the input path if the absolute path couldn't be resolved inline std string absolutepath const std string filepath ifdef no absolute path resolution return filepath else ifdef win32 char abs path max path return getfullpathnamea filepath c str max path abs path nullptr ifdef flatbuffers no absolute path resolution return filepath else char abs path path max return realpath filepath c str abs path endif abs path filepath endif no absolute path resolution ifdef win32 char abs path max path return getfullpathnamea filepath c str max path abs path nullptr else char abs path path max return realpath filepath c str abs path endif abs path filepath endif no absolute path resolution to and from utf 8 unicode conversion functions ,made requested revisions for naming and spacing , fix a bug in the toy tutorial piperorigin revid change id icfcccdcbedbaacf
940,class basesession sessioninterface raise typeerror 'graph must be a tf graph but got s' type graph self graph graph self opened false self closed false self current version 0 ,remove unused attribute , fix a bug in the docstring of the docstring of the test case piperorigin revid
941,limitations under the license namespace void initkerneltest int argc char argv bool use nnapi false std vector tflite flag flags tflite flag createflag use nnapi use nnapi use nnapi tflite flags parse argc const cast const char argv flags if use nnapi tflite singleopmodel setforceusennapi true tflite kerneltestdelegateproviders const delegate providers tflite kerneltestdelegateproviders get delegate providers initfromcmdlineargs argc const cast const char argv todo b 160764491 remove the special handling of nnapi delegate test tflite singleopmodel setforceusennapi delegate providers constparams get bool use nnapi namespace int main int argc char argv tflite logtostderr testing initgoogletest argc argv initkerneltest argc argv testing initgoogletest argc argv return run all tests ,support more delegate options in kernel tests by utilizing tflite tooling's delegate registrar piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
942,namespace boost variance template class realtype class policy realtype pdf const bernoulli distribution realtype policy dist const realtype k realtype pdf const bernoulli distribution realtype policy dist const realtype k probability density mass function boost fpu exception guard error check namespace boost pdf template class realtype class policy inline realtype cdf const bernoulli distribution realtype policy dist const realtype k inline realtype cdf const bernoulli distribution realtype policy dist const realtype k cumulative distribution function bernoulli realtype p dist success fraction error check ,changed call signatures to keep borland happy svn r , fix a bug in the new parser test svn r
943,using namespace mlir void print raw ostream os const os addf xx yy n os addf xx yy return an error message on failure const char verify const void dimop print raw ostream os const os dim xxx getindex n os dim xxx getindex const char dimop verify const ,move newline printed with op to function basic block printer allows printing the instruction to string without trailing newline making it easier to reuse print to annotate instructions during lowering and removes need for newline in the print functions of ops piperorigin revid , xla gpu support for the hlo hlo client piperorigin revid change id idadedfddaccd
944,void parallelinterleavedatasetop makedataset opkernelcontext ctx int64 buffer output elements model kautotune int64 prefetch input elements model kautotune if op version 4 op requires ok ctx parsescalarargument ctx buffer output elements op requires ctx buffer output elements model kautotune buffer output elements 0 buffer output elements 0 errors invalidargument buffer output elements must be model kautotune or 0 but is model kautotune or 0 but is buffer output elements op requires ok ctx parsescalarargument ctx ,tf data fix some small typo in parallel interleave dataset op piperorigin revid change id , add a new method to the graph piperorigin revid
945,def tensor list pop back input handle element dtype name none name name def tensor list gather input handle indices element dtype name none def tensor list gather input handle indices element dtype element shape none name none return gen list ops tensor list gather input handle input handle indices indices element shape 1 element shape build element shape element shape element dtype element dtype name name def tensor list scatter tensor indices element shape name none name name def tensor list stack input handle element dtype num elements 1 name none def tensor list stack input handle element dtype num elements 1 element shape none name none return gen list ops tensor list stack input handle input handle element shape 1 element shape build element shape element shape element dtype element dtype num elements num elements name name ,in tensorarray v pass element shape inferred from write calls to tensorliststack and tensorlistgather piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
946,def toco convert input data input array name tensor name input tensor input array shape dims extend map int input tensor get shape toco inference input type tflite input type for output tensor in output tensors model output arrays append tensor name output tensor todo aselle consider handling the case of allowing quantized inputs to be converted to float via the toco inference input type field data toco convert protos model serializetostring toco serializetostring input data serializetostring ,tflite don't always treat inputs and outputs as encoded floats piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
947,limitations under the license include tensorflow compiler tf2xla kernels while op h include absl strings str split h include tensorflow compiler tf2xla kernels if while utils h include tensorflow compiler tf2xla kernels tensor list utils h include tensorflow compiler tf2xla shape util h include tensorflow compiler tf2xla side effect util h limitations under the license namespace tensorflow const char xla propagate compile time consts namespace builds xlacompiler argument descriptions args from ctx ,propagate compile time constants into the branch functions of cond v in xla this enables using ops like stridedslice which require compile time constants in the branch functions piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
948,namespace native float z x 0 y 0 z 0 float x float y float z this x x this y y this z z float x float y float z this x x this y y this z z ,fix compilation error in tests local variables were shadowing member fields causing errors , fix a bug in the parser test piperorigin revid
949,test graphtransferer loadgraphfromprotofile status status gt loadgraphfromprotofile ops definitions filename input node info list output node names is text proto true output tensor info todo satok uncomment following assert once we fix the loader problem assert true status ok status namespace tensorflow ,add soc control wrapper for graph transfer to soc change , xla python fix a bug in the graph piperorigin revid
950,reusable code for making a simple neural net layer it does a matrix multiply bias add and then uses relu to it does a matrix multiply bias add and then uses relu to it also sets up name scoping so that the resultant graph is easy to read and adds a number of summary ops ,delete null and relu to relu , updated for version problem when using a terminal window doesn't work properly solution add a test for the command line
951,class public hlomodulepass statusor bool run hlomodule module override private given the caller shape operand or output and its corresponding in the fused computation parameter or root propagates the memory space to all the in the callee side returns true if the module is modified bool const shape caller shape const hloinstruction callee instruction const given the shape index operand or output and its corresponding instruction in the fused computation parameter or root propagates the memory space in the callee side returns true if the module is modified bool propagate shapeindexview index const hloinstruction callee instruction int64 memory space const std unique ptr hlodataflowanalysis dataflow analysis ,xla propagate memory spaces recursively inside nested fusions piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
952,bool deviceoptionstocontextflags const deviceoptions device options return port status ok static bool gpudriver funcsetcacheconfig cufunction function cache cache config curesult res function cache config if res cuda success log error failed to set cuda kernel cache config kernel function config cache config result tostring res return false return true static port status gpudriver funcsetcacheconfig cufunction function cache cache config return if cuda res error function cache config failed to set cuda kernel cache config return port status ok static port statusor ,se nfc change to return status piperorigin revid , xla gpu support for the layout interface piperorigin revid change id iaaeabfdfedfeacedf
953,status propagateshapes const graph graph shapes even if no shape function is registered for a node status status shape refiner addnode n if status ok vlog 1 shape inference failed for node status vlog 1 shape inference failed for node n name status else shape inference inferencecontext context shape refiner getcontext n for int i 0 i n num outputs i shape inference shapehandle handle context output i vlog 4 output i for node n name context debugstring handle if n type string arg ,handle outside compilation at beginning end of tpu computation piperorigin revid , tf data optimization for tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental piperorigin revid change id idbefdcccaffb
954,from tensorflow python keras layers dense attention import attention embedding layers from tensorflow python keras layers embeddings import embedding einsum based dense layer from tensorflow python keras layers einsum dense import einsumdense locally connected layers from tensorflow python keras layers local import locallyconnected1d from tensorflow python keras layers local import locallyconnected2d ,add an einsum layer piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id ifdfeefacdfaaacaec
955,def index to string table from tensor mapping default value unk name none python mapping string t constant emerson lake palmer indices tf constant 1 5 tf int64 table tf contrib lookup index to string from tensor table tf contrib lookup index to string table from tensor mapping string default value unknown values table lookup indices ,correcting index to string table from tensor doc , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
956,void allocateflags bool setter for debugoptions set xla cpu use mkl dnn flag values xla cpu use mkl dnn generate calls to mkl dnn in the cpu backend tensorflow flag xla gpu crash on verification failures bool setter for debugoptions set xla gpu crash on verification failures flag values xla gpu crash on verification failures crashes the program on extra verification failures e g cudnn cross checking failures parseflagsfromenv flag objects ,add a flag to crash on cudnn cross checking failures piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
957,class whilev2test pfortestcase body true 0 0 b enabling xla true triggers a check in debug mode self test loop fn loop fn 3 force xla false self test loop fn loop fn 3 force xla true if name main ,enforce xla in xla control flow ops test i actually don't understand how one can avoid using xla in an xla test but the test seems to pass now piperorigin revid change id , fix a bug in the graph piperorigin revid
958,limitations under the license ifndef third party tensorflow examples android jni limiting file input stream h define third party tensorflow examples android jni limiting file input stream h include errno h include unistd h include google protobuf io zero copy stream impl h include google protobuf io zero copy stream impl lite h ,add include errno h to to prevent build errors with android api change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
959,class tpubackend xla client backend options self client compile options device assignment def get default device assignment self num replicas return self client num replicas def get default device assignment self num replicas num partitions return self client num replicas num partitions def serialize self executable return self client serializeexecutable executable ,xla python plumb num partitions through backend get default device assignment also includes a few small logging changes piperorigin revid change id , xla python fix a bug in the test piperorigin revid
960,class sequential model model built false return model property def input spec self if self layers and hasattr self layers 0 'input spec' return self layers 0 input spec return none def get input shape and dtype layer retrieve input shape and input dtype of layer if applicable ,propagate input checks of the first layer of sequential to the sequential instance piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
961,bool iswhitelistedflexop const std string tensorflow op name save saveslices savev2 scatternd segmentmax segmentmean segmentmin ,add scatternd to flex whitelist piperorigin revid , fix a bug in the graph piperorigin revid
962,class groupiterable groupiterable tensor ix tensor vals int dims const group dims ix ix ix matrix ix matrix int64 vals vals dims dims group dims group dims begin group dims end class groupiterable private friend class group tensor ix const tensor ix const ttypes int64 constmatrix ix matrix tensor vals const int dims const gtl inlinedvector int64 8 group dims ,sparsetensor avoid calling tensor matrix int for each element of a sparsetensor when iterating over it piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid change id iffafdbbcddfebbeac
963,public class fail not expected catch org tensorflow e expected exception asserttrue e getmessage contains savedmodel not found asserttrue e getmessage contains could not find savedmodel ,tf savedmodel split off a reader from the loader module piperorigin revid , fix a bug in the parser test piperorigin revid
964,std vector int32 t arenaplanner int first node return this alloc node idx1 this alloc node idx2 std set int32 t tensors set std vector int32 t tensor order for int i 0 i static cast int graph info num tensors i if alloc node i first node alloc node i last node tensors set insert i tensor order push back i indices of tensors in order their allocation offsets will be calculated std vector int32 t tensor order tensors set begin tensors set end std sort tensor order begin tensor order end tensor compare return tensor order ,arena planner create tensor order vector directly instead of using tensors set piperorigin revid change id , fix a bug in the new delegate piperorigin revid
965,class attrbuilder well as any default attr value pairs from the associated op def if there is one void fillattrvaluemap attrvaluemap m const fill m with the attr value pairs set via attrbuilder set so far except when the value matches the default for this attr more precisely if the global op registry contains an opdef for this op and if an attribute value is the same as the default according to the opdef this attr value pair is not added to m void attrvaluemap m const const nodedef buildnodedef private ,strip default attributes before sending a function or op to eager service we don't need to add default attributes back because function instantiation already adds default attributes conversion from eager to nodedef adds default attributes piperorigin revid , fix a bug in the test case piperorigin revid
966,class tpuestimator estimator lib estimator current limitations 1 outside compilation does not work yet b def init self ,update documentation for export savedmodel piperorigin revid , update keras layers to keras piperorigin revid
967,test statusor expect eq ki thing valueordie test statusor statusor std unique ptr int expect eq get 0 test statusor statusor error status tensorflow error cancelled cancelled expect death error pad cancelled test statusor statusor std unique ptr int expect eq 0 test statusor statusor error status tensorflow error cancelled cancelled expect death error cancelled note tucker statusor does not support this kind of resize op test statusor ,se port and operator for from absl piperorigin revid change id , xla gpu support for the xla client piperorigin revid
968,status algebraicsimplifiervisitor handleconcatenate auto replacement computation addinstruction concatenate clonewithnewoperands concatenate shape new operands recurse to handle multiple disjoint sequence of inputs the logic above merge only 1 sequential series of inputs otherwise it can lead to the fixpass optimization hitting its threshold if replaceinstructionifsameshape concatenate replacement return handleconcatenate replacement replaceinstructionifsameshape concatenate replacement return status ok ,internal change piperorigin revid change id , xla gpu support for the xla client piperorigin revid
969,class executorstate if val field is set val destroy val field is set false has value false ,has value when clearing an entry change , fix a bug in the docstring of the test case piperorigin revid
970,job check ended void returns null when out of memory job t job start typval t argvars char argv arg jobopt t opt arg job start typval t argvars char argv arg jobopt t opt arg int is terminal unused job t job char u cmd null job start typval t argvars char argv arg jobopt t opt arg ch log null starting job s char ga ga data ga clear ga mch job start argv job opt mch job start argv job opt is terminal else ch log null starting job s char cmd mch job start char cmd job opt ,patch vim terminal is also set when not in a terminal window problem vim terminal is also set when not in a terminal window solution pass a flag to indicate whether the job runs in a terminal , patch problem when using a terminal window is a bit slow solution add a test for the gui
971,status kernelthunk initialize const gpuexecutable executable tensorflow mutex lock lock mutex if loader spec loader spec reset new se multikernelloaderspec args size absl string view ptx executable ptx convert absl string view to se port stringpiece because streamexecutor uses the latter loader spec addcudaptxinmemory se port stringpiece ptx data ptx size kernel name loader spec addcudaptxinmemory executable ptx kernel name if executable cubin empty loader spec addcudacubininmemory ,xla remove remaining stringpiece references stringpiece and string view are the same now no need to convert between them piperorigin revid , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
972,string const string command const string options namespace bool newprofiler const string graph const string op log check tf stat currently only 1 living tfprof profiler is allowed check graph graph mustn't be null std unique ptr graphdef graph ptr new graphdef if graph ptr parsefromstring graph ,some profiler fixes and cleanup piperorigin revid , xla python fix a bug in the test piperorigin revid
973,class converter object that file identifier require this raises runtimeerror when flatc cannot be invoked runtimeerror 1 when flatc cannot be invoked 2 when json file does not exists valueerror when the extension is not json or bin returns ,update runtimeerror in read , fix a bug in the documentation of the test case piperorigin revid
974,static void dpivar dpivar var dpierror error dpioci var data 0 dpi oci dtype interval ym break case dpi oracle type rowid dpioci var data asrowid 0 dpi oci dtype rowid break default break ,remove improper call to , fix a bug in the new client client client client
975,value is computed as sqrt a 2 b 2 setshapefn shape inference unchangedshape define unary gradient complex input x t input y t input y t input dy t output z t attr t half float double complex64 complex128 setshapefn shape inference unchangedshape ,documentation , fix a bug in the parser test piperorigin revid
976,void init child mappings void will be faulted into the child when they get accessed list for each node initial mappings list struct map m struct map m struct object m struct map node alloc object m ptr struct map name strdup m name size m size prot m prot zmalloc sizeof struct object map ptr m ptr map name strdup m name map size m size map prot m prot we leave type as until we change the mapping by mprotect mremap munmap etc type trinity map initial map type trinity map initial add object obj local obj mmap ,move mapping struct into a union in the object structs , fix a bug in the syscall page
977,class distributiontestbase test testcase v1 cls 1 0 self assertequal true v1 trainable v2 cls 1 0 synchronization variables variablesynchronization on read v2 cls 1 0 synchronization variables variablesynchronization on read self assertequal false v2 trainable v3 cls 1 0 synchronization variables variablesynchronization on read trainable true v3 cls 1 0 synchronization variables variablesynchronization on read trainable true self assertequal true v3 trainable v4 cls 1 0 synchronization variables variablesynchronization on read trainable false self assertequal false v4 trainable class onedevicedistributiontestbase test testcase ,tidy up variables tests piperorigin revid , fix a bug in the docstring of the test piperorigin revid
978,class matmulgradienttest tf test testcase def randgauss shape dtype if dtype is tf complex64 return np random normal size shape astype 'float32' 1j np random normal size shape astype 'float32' return np random normal size shape astype 'float32' 1j np random normal size shape astype 'float32' else return np random normal size shape astype 'float32' ,tensorflow fix incorrect indent in matmul op test py some more linting errors change id , fix a bug in the test case piperorigin revid
979,class capturedfunction capturedfunction const std shared ptr const functionmetadata metadata std vector tensor captured inputs determines whether the captured function requires the use of the multi device function backend status ismultidevice iteratorcontext ctx bool is multi device const std shared ptr const functionmetadata metadata const std vector tensor captured inputs ,tf data adding dynamic detection for whether multi device backend should be used piperorigin revid , tf data service support for tf data dataset piperorigin revid
980,class resourcevariableopstest test util tensorflowtestcase v load 2 0 self assertequal 2 0 self evaluate v value def self with ops graph as default v def resource variable ops resourcevariable initial value constant op constant 3 0 to proto v prime resource variable ops resourcevariable variable def v def self asserttrue getattr v prime cached value none is none other v def resource variable ops resourcevariable caching device cpu 0 initial value constant op constant 3 0 to proto other v prime resource variable ops resourcevariable variable def other v def self asserttrue other v prime cached value is not none def self with ops graph as default self cached session as sess v def resource variable ops resourcevariable ,fixes issue loading cached value from resourcevariable proto piperorigin revid , fix a bug in the test case piperorigin revid
981,from tensorflow python framework import dtypes from tensorflow python ops import array ops from tensorflow python ops import init ops from tensorflow python ops import math ops from tensorflow python ops import nn grad pylint disable unused import from tensorflow python ops import nn ops from tensorflow python ops import rnn from tensorflow python ops import rnn cell from tensorflow python ops import tensor array grad pylint disable unused import from tensorflow python ops import variable scope from tensorflow python training import gradient descent ,bugfixes to tfprof model analyzer unit tests piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
982,class flatmapdataset dataset class interleavedataset dataset def init self input dataset map func cycle length block length ,minor change in description piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
983,f deepcopy typval t argvars typval t rettv if argvars 1 v type var unknown noref int tv get bool chk argvars 1 null if noref 0 noref 1 emsg e invarg semsg e using number as bool nr noref else copyid get copyid f typval t argvars typval t rettv if argvars 1 v type var unknown int tv get bool argvars 1 if 0 1 emsg e invarg semsg e using number as bool nr else func mb ptr2char adv mb ptr2char adv mb cptr2char adv ,patch using where bool is expected may throw an error problem using where bool is expected may throw an error solution make this backwards compatible , patch problem when using a terminal window is a bit slow solution add a test for the gui
984,class partitioner object raise notimplementederror tf export 'distribute experimental partitioners v1 tf export 'distribute experimental partitioners v1 class partitioner partitioner that allocates a fixed number of shards ,fixed a typo piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
985,void directsession maybeinitializeexecutionstate const graphdef graph return set up the per session execution state flib def reset new functionlibrarydefinition graph library flib def reset new functionlibrarydefinition opregistry global graph library simplegraphexecutionstateoptions options options device set device set options session options options ,make functionlibrarydefinition take the underlying default opregistryinterface as an argument instead of defaulting to opregistry global change , xla python fix a bug in the graph piperorigin revid
986,struct operator operator operatortype kfullyconnected weights format kdefault keep num dims is supported in the fullyconnected kernel version 5 but it's never supported by toco bool keep num dims false dequantization operator converting a quantized array of integers with ,fix fullyconnected version versioning logic piperorigin revid , fix a bug in the new delegate piperorigin revid
987,status buildswappair nodedef node int input to swap const std unordered map string const nodedef name map graphdef graph std pair nodedef nodedef swap pair string task device if devicenameutils node device task device str util strcontains device device gpu return errors invalidargument can't swap input input to swap of node node name since it is not on gpu const opdef op def tf return if error opregistry global lookupopdef node op op def datatype input type ,grappler don't build swap in swap out pairs in memory optimizer unless the node is on gpu piperorigin revid , xla gpu support for the cpu backend piperorigin revid change id idaceccfcbacfece
988,tensorflow doc sources docsource docstring module name distributions distributions' docsource docstring module name 'experimental numpy' docsource docstring module name numpy ops' docsource docstring module name 'platform 'graph util' docsource docstring module name graph util' 'image' docsource docstring module name image ops' ,export module comments for tf experimental numpy piperorigin revid change id , fix a bug in the docstring of the test piperorigin revid
989,set ref in timer int copyid for timer first timer timer null timer timer tr next tv v type var partial tv vval v partial timer tr partial if timer tr partial null tv v type var partial tv vval v partial timer tr partial else tv v type var func tv vval v string timer tr callback abort abort set ref in item tv copyid null null return abort ,patch problem closures are not supported solution capture variables in lambdas from the outer scope yasuhiro matsumoto ken takata , patch problem when using a terminal window is a bit slow solution add a test for the command line
990,bool parseinputnodequantspecs absl string view node names std vector double node maxs if max values empty std vector std string node maxs str absl strsplit max values ' ' for size t i 0 i node maxs str size i for int i llvm seq int node maxs str size double value if absl simpleatod node maxs str i value llvm errs unexpected mins node maxs str i n ,update quantization config cc , xla gpu support for the layout inference piperorigin revid change id id icfecdffaddccbded
991,class symbolicshaperefiner const datatype data type c input types i int32 rank ic rank shape handle if rank 1 input tensor vector emplace back tensor data type input tensor vector at i tensor data type else input tensor vector emplace back tensor data type rank input tensor vector at i tensor data type rank auto tensor input tensor vector back auto tensor input tensor vector at i if data type dt int32 auto flat tensor flat int32 for int j 0 j rank j ,change emplace back to at i not to increase reserved vector size piperorigin revid , fix a bug in the test case piperorigin revid
992,void tfe opconsumeinput tfe op op tfe tensorhandle h tf status status void tfe startprofilerserver int port release child thread intentionally the child thread can be terminated by terminating the main thread tensorflow startprofilerserver port release auto profiler server absl make unique tensorflow profilerserver profiler server startprofilerserver port release child server thread intentionally the child thread can be terminated when the main program exits profiler server release void tfe contextenablegraphcollection tfe context ctx ,add profiler service to eager context so that it is started by default piperorigin revid change id , tf data service support for tf data experimental piperorigin revid change id idaceccfcbacfece
993,copyright 2016 google inc licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license you may obtain a copy of the license at http www apache org licenses license 2 0 unless required by applicable law or agreed to in writing software distributed under the license is distributed on an as is basis without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license include plist plist h include stdio h extern c int llvmfuzzertestoneinput const char data size t size plist t root node null plist from bin data size root node plist free root node return 0 ,add fuzzers for , fix a bug in the dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
994,private simplify the numerator and the denominator if gcd 1 for unsigned i 0 i lhs size i lhs i lhs i gcd lhs i lhs i static cast int64 t gcd int64 t denominator rhsconst gcd if the denominator becomes 1 the updated lhs is the result the ,fix bug in gcd calculation when flattening affineexpr adds unit test which triggers the bug and tests the fix piperorigin revid , fix a bug in the toy tutorial piperorigin revid
995,def do test create module fn exported names none show debug info false logging info 'saved model to s' save model path mlir pywrap tensorflow experimental convert saved model to mlir save model path ' ' join exported names show debug info we don't strictly need this but it serves as a handy sanity check for that api which is otherwise a bit annoying to test the canonicalization shouldn't affect these tests in any way mlir pywrap tensorflow experimental run pass pipeline mlir show debug info print mlir app run app main ,expose a way to run an mlir pass pipeline from python piperorigin revid change id , fix a bug in the documentation of the documentation of the documentation of the default value of the default value of the default value of the default value of the default value of the input is not used piperorigin revid
996,status constantfolding optimize cluster cluster const grappleritem item graphdef output graph item graph node map reset new nodemap graph for const auto node item fetch nodes to preserve insert nodename node for const auto node item feed nodes to preserve insert nodename node first nodes to preserve item nodestopreserve device reset new devicesimple output graphdef ,avoid duplicating the functionality in grappleritem piperorigin revid , xla gpu support for the layout inference piperorigin revid change id idaceccfcbacfece
997,f has typval t argvars typval t rettv vimscript 1 vimscript 2 vimscript 3 vimscript 4 virtualedit visual visualextra ,patch has 'vimscript ' is always problem has 'vimscript ' is always solution add vimscript to the feature table naruhiko nishino closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
998,ex set eap ex nohlsearch eap exarg t eap unused no hlsearch true set no hlsearch true redraw all later some valid ,updated for version problem a script cannot detect whether 'hlsearch' highlighting is actually displayed solution add the v hlsearch variable zyx , patch problem when using a terminal window is a bit slow solution add a test for the command line
999,see the license for the specific language governing permissions and limitations under the license import ctypes from import number types as n from import packer from compat import memoryview type ,python remove ctypes dependency in runtime library , add a test for the new op op piperorigin revid
1000,def has inf or nan datum tensor bool true if and only if tensor consists of any nan or inf values datum datum metadata is unused in this datum datum metadata is unused in this predicate if tensor is none uninitialized tensor doesn't have bad numerical values return false else elif np issubdtype tensor dtype np float or np issubdtype tensor dtype np complex or np issubdtype tensor dtype np integer return np any np isnan tensor or np any np isinf tensor else return false class object ,tfdbg fix a dtype related bug in debug data is inf or nan previously is inf or nan errors out if the dtype of the tensor numpy array is not float complex or integer this cl adds guard against such data types change , fix a bug in the docstring of the docstring of the new api change
1001,bool tpuplatform shouldregistertpudevicetodevicecopy tpuplatform shouldregistertpudevicetodevicecopyfn platform const tensorflow tpu tputopologyptr tpuplatform gettopologyptr return tpu executorapifn tpuplatform platform void tpuplatform insertevent stream executor internal eventinterface key se event val tensorflow mutex lock lock event map mu ,introduce public version of for chip core location identification piperorigin revid change id , xla python fix a bug in the hlo client piperorigin revid change id id ibebfcffdcbdbdafeb
1002,def remove squeezable dimensions tf export 'train confusion matrix' v1 'train confusion matrix' 'confusion matrix' deprecation deprecated endpoints 'confusion matrix' 'math confusion matrix' v1 'math confusion matrix' 'train confusion matrix' 'confusion matrix' deprecation deprecated endpoints 'confusion matrix' 'train confusion matrix' def confusion matrix labels predictions num classes none dtype dtypes int32 name none weights none computes the confusion matrix from predictions and labels ,export confusion matrix as tf math confusion matrix instead of tf train confusion matrix this change is based on feedback at https github com tensorflow issues issuecomment https github com tensorflow community pull piperorigin revid , fix a typo in docstring piperorigin revid
1003,void immutableexecutorstate initializepending const graph graph finfo pending counts absl make unique pendingcounts finfo pending counts layout if requires control flow atomic pending counts reset new std atomic int32 num nodes std fill atomic pending counts get atomic pending counts get num nodes 0 for const node n graph nodes if issink n continue const int id n id void immutableexecutorstate initializepending const graph graph n max pending max dead auto counts ensureframeinfo name pending counts counts set initial count pending ids id max pending if requires control flow atomic pending counts id max pending namespace tensorflow ,internal change piperorigin revid change id , add a new method to the new dialect piperorigin revid
1004,def filter ds dataset dist ds initial dist ds class values ds return control flow ops cond math ops less proportion rejected 5 lambda accept dist lambda logging ops logging warn pylint disable g long lambda lambda logging ops print pylint disable g long lambda accept dist proportion rejected initial dist accept dist message proportion of examples rejected by sampler is high summarize 100 ,tf data fix logging ops debug statement , fix a bug in the docstring of the docstring of the test case piperorigin revid
1005,void benchmarkparams const std string name const tflite benchmark check hasparam name name was not found void benchmarkparams set const benchmarkparams other for const auto param params const benchmarkparam other param other getparam param first if other param nullptr continue param second set other param namespace benchmark namespace tflite ,support to perform all benchmark runs of different performance options in a random order piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id id iefaaedbcfceefdda
1006,not enough else key arg 2 insert modifiers with ks modifier modifiers decode modifiers arg 1 some keys already have shift included pass them as normal keys if modifiers mod mask shift key ' ' key 'z' key ' ' key ' ' key ' ' key ' ' modifiers 0 insert modifiers with ks modifier new slen modifiers2keycode modifiers key string slen csi len ,patch some key mappings do not work with modifyotherkeys problem some key mappings do not work with modifyotherkeys solution remove the shift modifier if it is already included in the key , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary solution add a test for the command line
1007,def make example dict example protos example weights parsed parse examples example protos return dict sparse features sf from st parsed indices' parsed values' sf from st parsed indices' parsed values' parsed indices' parsed values' dense features example weights example weights example labels tf reshape parsed 'target' 1 example labels tf reshape parsed 'target' 1 example ids ' d' i for i in xrange 0 len example protos def make variable dict max age max gender ,sdca now accepts example ids change , fix a bug in the docstring of the documentation of the documentation of the documentation of the example to the documentation of the documentation change
1008,from future import print function import collections import os path import re import threading import numpy as np store everything size guidance histograms 0 when files on are deleted they are actually renamed cns deleted file pattern re compile r' d ' def istensorfloweventsfile path return in compat as str any os path basename path if not in compat as str any os path basename path return false if cns deleted file pattern search path logging info deleted file s' path return false return true class eventaccumulator object ,tensorboard ignore deleted files on change , fix a bug in the test case piperorigin revid
1009,private for int i 1 i kwarpsize i 1 value offset rewriter create llvm constantop loc int32type rewriter geti32integerattr i value shfl rewriter create nvvm shflbflyop value shfl rewriter create nvvm shfldownop loc shflty activemask value offset maskandclamp returnvalueandisvalidattr value isactivesrclane rewriter create llvm extractvalueop private for int i 1 i kwarpsize i 1 value offset rewriter create llvm constantop loc int32type rewriter geti32integerattr i value shflvalue rewriter create nvvm shflbflyop value shflvalue rewriter create nvvm shfldownop loc type activemask value offset maskandclamp return value and is valid unitattr value accumfactory loc value shflvalue rewriter ,switch from shfl bfly to shfl down both work for the current use case but the latter allows implementing prefix sums and is a little easier to understand for partial warps piperorigin revid change id , fix a bug in the toy tutorial piperorigin revid change id icaabbeacfcfdbfaba
1010,class sparseopstest test util tensorflowtestcase parameterized testcase values 'a' 'b' dense shape 2 3 dense sparse ops sparse tensor to dense sp expected dense 'a' '' '' '' '' 'b' expected dense b'a' b'' b'' b'' b'' b'b' result dense self evaluate dense self assertallequal expected dense result dense ,fix python test failure due to string vs byte signed off by yong tang yong tang github outlook com , fix a bug in the test case piperorigin revid
1011,required packages 'absl py 0 1 6' 'astor 0 6 0' 'gast 0 2 0' 'google pasta 0 1 1' 'google pasta 0 1 2' 'keras applications 1 0 6' 'keras preprocessing 1 0 5' 'numpy 1 14 5 2 0' ,bump google pasta dependency to i overlooked this when bumping the bazel pasta dependency in https github com tensorflow tensorflow commit piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
1012,static void bind child to cpu struct childdata child cpu set t set unsigned int cpudest pid t pid pids child num if no bind to cpu true return if sched getaffinity pids child num sizeof set set 0 if sched getaffinity pid sizeof set set 0 return if child num num online cpus static void bind child to cpu struct childdata child cpu zero set cpu set cpudest set sched setaffinity pids child num sizeof set set sched setaffinity pid sizeof set set ,pid caching for the child code too , fix a bug in the watchdog page
1013,file pat to reg pat pat pat end allow dirs no bslash foo bar foo bar foo bar foo bar don't unescape and others that are also special in a regexp regexp an escaped must be unescaped since we use magic not verymagic if p ' ' ifdef backslash in filename no bslash file pat to reg pat pat pat end allow dirs no bslash reg pat i ' ' else if p ' ' p ' ' p ' ' p ' ' if p ' ' p ' ' p ' ' p ' ' p ' ' reg pat i p else ,updated for version problem glob and globpath do not handle escaped special characters properly solution handle escaped characters differently , patch problem when using a terminal window is a bit slow solution add a test for the gui
1014,class test testcase with self test session use gpu false for start size in start and size sp output sparse ops sparse slice sp input start size nnz in len sp input values eval nnz out len sp output values eval sp output sparse ops sparse slice sp input start size nnz in len sp input values eval nnz out len sp output values eval err gradient checker compute gradient error err gradient checker compute gradient error sp input values nnz in sp output values nnz out self assertless err 1e 3 self assertless err 1e 3 if name ' main ' ,cln fix bad indentation , fix a bug in the docstring of the test case piperorigin revid
1015,statusor hloinstruction gatherexpander expandgather hloinstruction indvar const std vector hloinstruction loop state return gather instr indvar loop state gather instr metadata tf assign or return std vector hloinstruction gather loop result gather loop result or error ,xla attach the right metadata to the while loop in gather scatter piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
1016,void addcostnode readynodemanager node manager const opcontext op context node set compute cost node costs execution time asmicroseconds count node set compute time node costs compute time asmicroseconds count node set memory time node costs memory time asmicroseconds count node set temporary memory size node costs temporary memory node set persistent memory size node costs persistent memory node set inaccurate node costs inaccurate for const string input node manager getcurrnode input ,add memory usage details to the cost graph piperorigin revid , add a test for the graph and the graph and the graph is not enabled piperorigin revid
1017,static char features static int included patches add new patch number below this line 1578 ,patch ms windows c should depend on build options problem ms windows c should depend on build options solution generate c in the object directory fix dependencies ken takata closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1018,viewop linalg value memref for unsigned i 0 i v rank i indices i range v lb i v ub i constant index v step i return scopedcontext getbuilder create viewop return scopedcontext getbuilder create viewop scopedcontext getlocation memref indices ,usage of opbuilder nfc historically the pointer based version of builders was used this cl to opbuilder piperorigin revid , xla gpu support for the hlo hlo dialect piperorigin revid change id idadedfddaccd
1019,struct scalar left private binary typedef tout result type const tin left inline scalar left const scalar left other default eigen device func inline scalar left const scalar left other default template typename args eigen device func inline explicit scalar left const tin c args args struct scalar right private binary typedef tout result type const tin right inline scalar right const scalar right other default eigen device func inline scalar right const scalar right other default template typename args eigen device func inline explicit scalar right const tin c args args ,fix build errors caused by piperorigin revid , fix a bug in the parser interface piperorigin revid change id iaaffafbceeeafc
1020,void opbuilder builder for auto result llvm zip cluster terminator getoperands cluster getresults value cluster terminator operand std get 0 result if cluster getoperation if cluster terminator operand getdefiningop cluster getoperation cluster terminator operand getdefiningop new cluster results push back cluster terminator operand new cluster result types push back cluster terminator operand gettype ,fix segfault in pass can return nullptr if value is not the result of an operation for example an arg piperorigin revid change id , xla gpu support for the hlo ir piperorigin revid change id icabdabcccecababba
1021,class debuganalyzer object lines append line font attr segs len lines 1 len line len non ctrl len line debugger cli common menuitem none ni a d s non ctrl debugger cli common menuitem none ni a d t s non ctrl if lines append class debuganalyzer object lines append line font attr segs len lines 1 len line len ctrl len line debugger cli common menuitem none ni a d s ctrl debugger cli common menuitem none ni a d t s ctrl return debugger cli common richtextlines lines font attr segs font attr segs ,tfdbg cli add bar to cursesui hitchhiking change let node info ni menu always use the t option change , fix a bug in the documentation of the new op api piperorigin revid change id iacffbebafbeeadcfbaca
1022,limitations under the license include mlir dialect quantops quanttypes h tf local config mlir include mlir ir attributes h tf local config mlir include mlir ir builders h tf local config mlir include mlir ir function h tf local config mlir include mlir ir mlircontext h tf local config mlir include mlir ir matchers h tf local config mlir include mlir ir operation h tf local config mlir ,rename functionattr to symbolrefattr this allows for the attribute to hold symbolic references to other operations than funcop this also allows for removing the dependence on funcop from the base builder piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id icbbdbfafcdfcae
1023,class dropouttest test lib testcase with self test session t constant op constant 1 0 shape x dim y dim dtype dtypes float32 set noise shape 1 1 which means x dim 1 dropout nn ops dropout t keep prob noise shape 1 1 set noise shape none 1 which means x dim 1 dropout nn ops dropout t keep prob noise shape none 1 self assertequal x dim y dim dropout get shape final count 0 for in xrange 0 num iter ,use none instead of for partial shape signed off by yong tang yong tang github outlook com , fix a bug in the test case piperorigin revid
1024,int tf devicelistcount const tf devicelist list status status invalidargument index out of bounds return err val status status status ok return list response index accessor ,when a device list api such as tf succeeds set the output status to ok piperorigin revid , fix a bug in the test case piperorigin revid
1025,def record gradient op name inputs attrs results name it is imperative we make a copy of results here as otherwise we create a dependency cycle in the captured function and this can delay garbage collecting of the tensors arbitrarily result copies results results size len results if isinstance results list tuple else 1 def grad fn outputs def grad fn orig outputs tensors inputs result copies list outputs tensors inputs list orig outputs tensors container types make sequence tape tensors result magic gradient function op name attrs len inputs num outputs tensors if tracing print gradient for name if name else op name inputs inputs output grads outputs output grads orig outputs results size gradients result return result results tape record operation results inputs grad fn ,fixes eager higher order gradients for ops whose gradient function uses their outputs piperorigin revid , tf data dataset to tf data dataset dataset piperorigin revid
1026,namespace aux class thread specific base private union key storage void as pointer unsigned int as dword if defined boost thread platform win32 typedef unsigned long key storage else typedef void key storage endif key storage m key ,cleaned up the tls implementation to avoid reinterpret casts and associated warnings about violating strict aliasing rules , fix a bug in the parser build piperorigin revid
1027,status inferencecontext c int32 stride tf return if error c getattr stride stride dimensionhandle input channels c dim input 0 dimensionhandle input length c dim input 1 dimensionhandle input length c dim input 0 dimensionhandle input channels c dim input 1 dimensionhandle output length if c valueknown input length ,fix for spectogram shape calculation piperorigin revid , add a test for the new op op piperorigin revid
1028,def reduce tf fn todo darrenzhang01 add axis support to the size api np utils np doc 'size' def size x axis none pylint disable missing docstring x np asarray x if isinstance x tf tensor else x x asarray x data if axis is not none raise notimplementederror axis argument is not supported in the current np size implementation if isinstance x int float np int32 np int64 np float32 np float64 return 1 elif isinstance x np arrays ndarray np ndarray return prod x shape elif isinstance x np arrays ndarray np ndarray or tf is tensor x return prod tuple x shape else raise typeerror the inputs must be one of types int float numpy array tensorflow tensor tensorflow ndarray object ,revise the code to handle the graph tensors , fix a bug in the docstring of the test case piperorigin revid
1029,static int open files void break mmap fd fd filename sb st size flags mmap fd fd filename sb st size flags obj global dump objects obj global obj mmap ,change mmap fd to take a global child flag , make the watchdog process to be a child process
1030,limitations under the license namespace tensorflow class bigtabletestclient public bigtable dataclient class bigtabletestclient public google cloud bigtable dataclient public std string const project id const override return project id std string const instance id const override return instance id ,update to latest version of cloud bigtable c client piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1031,class fileio object else self prewrite check return self writable file read return self writable file tell def enter self ,fixed a typo in file io piperorigin revid change id , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
1032,namespace data class grpcdispatcherimpl public dispatcherservice service public explicit grpcdispatcherimpl grpc serverbuilder server builder explicit grpcdispatcherimpl grpc serverbuilder server builder const experimental dispatcherconfig config grpcdispatcherimpl override status start define handler method grpc status method grpc servercontext context const method request request method response response override define handler method grpc status method grpc servercontext context const method request request method response response override handler registerworker handler workerupdate handler getorregisterdataset ,enable profiler for tf data service piperorigin revid change id , xla python fix a bug in the hlo evaluator piperorigin revid change id ibebfcffdcbdbdafeb
1033,struct operationdef calculationsprecision precision std vector tensordescriptor src tensors std vector tensordescriptor dst tensors bool batch support false returns float32 for f32 precision and float16 for f16 precision datatype getdatatype const ,added batch support to softmax piperorigin revid , fix a bug in the parser test piperorigin revid
1034,export function detect h string string maximum differentiation return string string templates pairs sortby function pair level number nodes string sortby function pair level number nodes string return pair 1 level map function pair level number nodes string map function pair level number nodes string return pair 0 pair 1 nodes object ,fix incorrect typescript type annotation which was caught by the typescript compiler due to newer typings definitions for library change , fix a bug in the new version of the client client client piperorigin revid
1035,limitations under the license if defined platform google include tensorflow core tpu tpu api h include tensorflow stream executor tpu tpu platform h include tensorflow stream executor tpu tpu system device h endif define tftpu set fn struct fnname status initializetpulibrary void library handle initializeapifn tftpu initializefn registertpuplatform registertpusystemdevice return s bool findandloadtpulibrary static bool tpu library finder findandloadtpulibrary endif platform google namespace tpu ,register tpu system device when the tpu library is loaded piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1036,instantiate typed test suite p my footest mytypes define gtest name generator gtest type params namegenerator the 'types' template argument below must have spaces around it since some compilers may choke on ' ' when passing a template instance e g types int define typed test suite casename types typedef testing internal typelist types type gtest type params casename instantiate typed test suite p my footest mytypes register typed test suite p endif gtest remove legacy test the 'types' template argument below must have spaces around it since some compilers may choke on ' ' when passing a template instance e g types int define instantiate typed test suite p prefix suitename types static bool gtest prefix suitename gtest attribute unused testing internal ,remove an outdated comment , fix a bug in the parser test piperorigin revid
1037,static long mkcall unsigned int call sptr sprintf sptr yellow 0x lx white reg else if oldreg reg sptr sprintf sptr white 0x lx reg sptr sprintf sptr white else sptr sprintf sptr cyan 0x lx white reg sptr sprintf sptr cyan if reg 1024 sptr sprintf sptr 0x lx white reg else sptr sprintf sptr ld white reg else if oldreg reg sptr sprintf sptr white 0x lx reg sptr sprintf sptr white else sptr sprintf sptr cyan if reg 1024 sptr sprintf sptr 0x lx white reg else sptr sprintf sptr cyan 0x lx white reg sptr sprintf sptr ld white reg if reg unsigned long page zeros sptr sprintf sptr page zeros ,print numbers as decimal in the register dumper , fix a bug in the watchdog process
1038,class hierarchicalcontroller controller self hparams grouping hidden size self num groups if self hparams bi lstm variable scope get variable encoder lstm forward self embedding size self hparams hidden size 2 self embedding size self hparams hidden size 2 2 self hparams hidden size variable scope get variable encoder lstm backward self embedding size self hparams hidden size 2 self embedding size self hparams hidden size 2 2 self hparams hidden size variable scope get variable ,fix broken grappler test piperorigin revid change id , fix a bug in the docstring of the docstring of the new api change
1039,def loss logits labels returns loss loss tensor of type float convert from sparse integer labels in the range 0 num classes to 1 hot dense float vectors that is we will have batch size vectors each with num classes values all of which are 0 0 except there will be a 1 0 in the entry corresponding to the label batch size tf size labels labels tf expand dims labels 1 indices tf expand dims tf range 0 batch size 1 concated tf concat 1 indices labels onehot labels tf sparse to dense concated tf pack batch size num classes 1 0 0 0 cross entropy tf nn softmax cross entropy with logits logits onehot labels name labels tf to int64 labels cross entropy tf nn sparse softmax cross entropy with logits logits labels name loss tf reduce mean cross entropy name mean' return loss ,mnist example now uses sparse softmax cross entropy with logits change , fix a bug in the docstring of the docstring of the docstring of the docstring change
1040,include fd h include files h include log h include net h include params h include pids h include pipes h include random h include sanitise h ,remove more unnecessary includes , move the dtrace proto to the dtrace process to the dtrace process to the dtrace process to be used in the dtrace process and dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
1041,hash clear hashtab t ht vim free ht ht array if defined feat spell defined proto if defined feat spell defined feat terminal defined proto free the array of a hash table and all the keys it contains the keys must have been allocated off is the offset from the start of the allocate ,patch mksession does not restore shared terminal buffer properly problem mksession does not restore shared terminal buffer properly solution keep a hashtab with terminal buffers rob pilling closes , patch problem when using a terminal window is a bit slow solution add a test for the command line
1042,def gradientshelper ys todo apassos gradients of resource handles might be an issue here because of zeros if loop state out grads i loop state zeroslike op i out grads i loop state op i elif default gradient supports default grad op outputs i todo b the supports default grad check is needed because while op emits non differentiable resource tensors as outputs remove this check when that is not the case out grads i control flow state zeroslikeoutsideloop op i out grads i control flow state zeroslike op i with ops name scope op name grad pylint disable protected access with src graph original op op ,do not accumulate the forward tensor if we only need it for reduction ops like shape rank and size piperorigin revid change id , tf data fix a bug in the graph piperorigin revid
1043,class multivariatenormalfullcovariance mvn tril multivariatenormaltril the probability density function pdf is with as matrix multiplication none pdf x loc covariance matrix exp 0 5 y 2 z pdf x loc covariance matrix exp 0 5 y z y x loc t inv covariance matrix x loc z 2 pi 0 5 k det covariance matrix 0 5 class multivariatenormalfullcovariance mvn tril multivariatenormaltril loc is a vector in r k covariance matrix is an r k x k symmetric positive definite matrix z denotes the normalization constant and y 2 denotes the squared euclidean norm of y z denotes the normalization constant additional leading dimensions if any in loc and covariance matrix allow for batch dimensions ,fixing issue y is the square of distance actually piperorigin revid , tf data service support for tf data dataset piperorigin revid
1044,void opkernelcontext tf context const quint8 a data params left stream count k params left stream stride lda params left stream sum offset offset b params left stream sum offset offset b params left stream additive sum offset k offset a offset b params right stream count k params right stream stride ldb params right stream sum offset offset a params right stream sum offset offset a params right stream additive sum offset 0 params fused kernel kernel count k ,fix metagemm offsets in quantized matmul change , add a test for the graph and the graph piperorigin revid
1045,status memoryusagetracker endinstruction buffer buffer buffers at buffer id buffer unfinished user count check ge buffer unfinished user count 0 buffer tostring has negative unfinished use count buffer tostring has negative unfinished user count if buffer unfinished user count 0 buffer is now dead vlog 3 buffer tostring is now dead ,fix typo in a message piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1046,status run std unique ptr graph subgraph std vector int input permutation std vector int output permutation nodedef node optimize the subgraph graph g subgraph release optimizegraph flr get g subgraph reset g optimizegraph flr get subgraph std vector bool const args input permutation size tf return if error backwardsconstanalysis g const args tf return if error backwardsconstanalysis subgraph const args compute a permutation of the arguments such that the constant arguments are first ,add support for passes that run post partitioning to to avoid another graphdef graph graphdef conversion change device mayberewritegraph to take a graph instead of a graphdef use std unique ptr in more places to avoid some awkward release magic change , xla python fix a bug in the graph piperorigin revid
1047,struct a pass converting mlir standard and builtin operations into the llvm ir dialect class public dialectconversion class public modulepass public dialectconversion public dialectconversion passid modulepass passid constexpr static passid passid passresult runonmodule module m override return dialectconversion convert m failure success protected create a set of converters that live in the pass object by passing them a reference to the llvm ir dialect store the module associated with the ,nfc make dialectconversion not directly inherit from modulepass it is now just a utility class that performs dialect conversion on a provided module piperorigin revid , xla gpu support for the hlo backend piperorigin revid change id iaaffafbceeeafc
1048,status gdrmemorymanager init gpuprocessstate singleton addgpuallocvisitor bus id cuda alloc visitor gpuprocessstate singleton addcudahostallocvisitor 0 alloc visitor gpuprocessstate singleton addcudahostallocvisitor 1 alloc visitor for int numa idx 0 numa idx port numanumnodes numa idx gpuprocessstate singleton addcudahostallocvisitor numa idx alloc visitor log info instrumenting cuda host allocator on numa numa idx gpuprocessstate singleton addcudahostfreevisitor bus id free visitor log info instrumenting gpu allocator s with bus id bus id ,enables gpu allocators for general numa count , fix a bug in the test case piperorigin revid
1049,class einsumtest test testcase 'abc bac' 'ij ki jk' 'ijk jklm jk' 'ii' 'ii' 'ijji' long cases class einsumtest test testcase with self session use gpu true output value self evaluate output tensor correct value np einsum axes input vals correct value 0 if axes 'ijji' output math ops trace input tensors correct value self evaluate output else correct value np einsum axes input vals err np abs correct value output value max print axes err self assertless err 1e 8 def test input is placeholder self ,added second unit test for trace , fix a bug in the test case piperorigin revid
1050,struct depthwiseconvimplementation kuseneon3x3dotproduct tflite dcheck eq start width 1 tflite dcheck leading width padding tflite dcheck trailing width padding asm should use 64 bit set padding mask u64 for int k height 0 k height copy block height k height half work reg vdup n u8 input offset half work reg vld1 lane s8 reinterpret cast const int8 input block data input block offset half work reg 1 struct depthwiseconvimplementation kuseneon3x3dotproduct vld1 lane s8 reinterpret cast const int8 input block data input block offset 2 half work reg 3 half work reg s8 padding mask vget low s8 padding reg half work reg half work reg veor s8 half work reg vget low s8 sign bit tflite dcheck eq scratch data offset 8 0 ,depthwiseconv dot product kernel asm small improvement to pack function piperorigin revid , fix a bug in the parser test piperorigin revid
1051,mch start job char cmd job t job jobopt t options jo null pi closehandle job jv proc info closehandle pi job jv proc info pi job jv job object jo job jv status job started ,patch problem ms windows job start closes wrong handle solution close on the process info ken takata , patch problem when using a terminal window is a bit slow solution add a test for the command line
1052,builtinopresolver builtinopresolver max version 3 addbuiltin builtinoperator batch to space nd register batch to space nd min version 1 max version 2 max version 3 addbuiltin builtinoperator mul register mul min version 1 max version 3 addbuiltin builtinoperator l2 normalization register l2 normalization ,add d support for tflite batchtospacend piperorigin revid change id , add support for int int int piperorigin revid
1053,class threadedtcprequesthandler socketserver baserequesthandler print sending format cmd self request sendall cmd encode 'utf 8' response elif decoded 1 me' print closing self request close response elif decoded 1 a time sleep 0 2 response waited ,patch problem the close cb option is not implemented yet solution close cb yasuhiro matsumoto , patch problem when using a terminal window is a bit slow solution add a test for the gui
1054,void const int8 t vector int v size float scale void const float vector int v size float abs limit float result shift left a vector in place with v size size void float vector int v size float shift value reduce sum on a float input vector input vector float pointer to input vector output vector float pointer to vector ,remove declarations of already removed functions piperorigin revid change id , xla gpu support for the layout of the layout is a bit piperorigin revid change id id idaceccfcbacfece
1055,class using typename scalar supportsbatchoperationt matrix using typename scalar supportsbatchoperationt matrixmap using typename scalar supportsbatchoperationt constmatrixmap typedef typename scalar supportsbatchoperationt matrix matrix typedef typename scalar supportsbatchoperationt matrixmap matrixmap typedef typename scalar supportsbatchoperationt constmatrixmap constmatrixmap void computematrix opkernelcontext context const constmatrixmap matrix const constmatrixmap rhs matrixmap output override ,tensorflow use typedef instead of using declaration to fix gcc compatibility fixes change , xla gpu support for the layout inference piperorigin revid change id ibadadadacbbbef
1056,limitations under the license include tensorflow core util dump graph h include absl strings match h include absl strings str cat h include tensorflow core lib strings proto serialization h include tensorflow core platform env h string writetextprototouniquefile env env const string name variable or function argument return tf dump graph prefix not specified if absl dir absl dir test undeclared outputs dir const char tmp dir getenv test undeclared outputs dir if tmp dir nullptr log warning tf dump graph prefix but test undeclared output dirs is not set dumping to log dir else dir tmp dir string filepath null if std strncmp dir 2 0 log info proto debugstring ,support dumping tf graphs to test undeclared outputs dirs piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1057,static char features static int included patches add new patch number below this line 1277 1276 ,updated for version problem in diff mode 'cursorline' also draws in the non active window when and are set the string is not solution only draw the cursor line in the current window combine the 'cursorline' and other highlighting attributes christian brabandt , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1058,class test testcase valueerror 'on integer or non floating types are not supported' pylint disable g long lambda estimator infer real valued columns from input fn lambda constant op constant false shape 7 8 dtype dtypes bool none lambda constant op constant false shape 7 8 dtype dtypes bool none def self with self assertraisesregexp class test testcase pylint disable g long lambda estimator infer real valued columns from input fn lambda constant op constant ' d 0' i for i in xrange 8 for in xrange 7 constant op constant ' d 0' i for i in xrange 8 for in xrange 7 none def self ,move estimator export savedmodel to core change , fix a bug in the docstring of the test case piperorigin revid
1059,def op sparse shape op inputs 3 get shape if sparse shape ndims 0 num points none num nodes op inputs 6 get shape 0 value num nodes op inputs 7 get shape 0 value num classes op get attr 'num classes' the output of is leaf node index x for x in input data return tensor shape tensorshape num nodes num classes node sums ,add support for weighted inputs to change , tf data optimizer to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1060,string uppercase stringpiece s set of characters that can be used as word boundaries void titlecasestring string s stringpiece delimiters converts a time interval as double to a human readable string for example 0 001 1 ms 10 0 10 s 933120 0 10 8 days 39420000 0 1 25 years 10 10 s string humanreadableelapsedtime double seconds join functionality template typename t string join const t s const char sep ,add strings to tensorflow core lib strings numbers h move humanreadableelapsedtime from tensorflow core lib strings str util h to tensorflow core lib strings numbers h to match the other routines change , fix a bug in the test case piperorigin revid
1061,tflitestatus prepare tflitecontext context tflitenode node tf lite ensure context input type ktflitefloat32 input type ktfliteuint8 input type ktfliteint8 input type ktfliteint16 input type ktfliteint32 input type ktfliteint64 input type ktflitebool input type ktfliteint32 input type ktfliteint64 output dimensions will match input dimensions except 'axis' which will be the sum of inputs tflitestatus eval tflitecontext context tflitenode node case ktfliteint16 tf lite concatenation int16 t break case ktflitebool tf lite concatenation bool break default context reporterror context type ' s' is not supported currently tflitetypegetname output type ,add bool type support in tflite concatenation op kernel piperorigin revid change id , add support for int int piperorigin revid
1062,nodedef namespace nodedef datatype dtype mutablegraphview graph nodedef node node set op placeholder setuniquegraphnodename node op graph getgraph node node mutable attr dtype set type dtype tensorshapeproto shape node mutable attr shape mutable shape shape set unknown rank false return graph addnode std move node nodedef addnode stringpiece name stringpiece op const std vector string inputs const std vector std pair string attrvalue attributes ,fix noop elimination optimization fix for b only remove noops if they refer to const nodes piperorigin revid , tf data optimization for tf data experimental tf data experimental tf data experimental piperorigin revid change id idaceccfcbacfece
1063,logicalresult mlir mutablearrayref affineforop band assert band empty assert band size tilesizes size incorrect number of tile sizes check if the supplied for are all successively nested check if the supplied for op's are all successively nested for unsigned i 1 e band size i e i assert band i getoperation getparentop band i 1 getoperation static void function f for auto block f for auto inst block if auto forop inst dyn cast affineforop for auto op block if auto forop op dyn cast affineforop forop ,replace usages of instruction with operation in the transforms directory piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id iebdeaedebeebedaa
1064,namespace xla scale factor holding the growing product of d l i terms int64 scale 1 int64 linear index 0 bool first true for auto dimension shape layout minor to major linear index scale multi index dimension scale shape dimensions dimension if first avoid two multiplies on the first loop iteration linear index multi index dimension scale shape dimensions dimension first false else linear index scale multi index dimension scale shape dimensions dimension return linear index ,minor to xla util libraries change , xla gpu support for the hlo client piperorigin revid change id iaaffafbceeeafc
1065,class precision metric m result numpy 1 0 with top k 2 it will calculate precision over y true 2 and y pred 2 m tf keras metrics precision top k 2 m update state 0 0 1 1 1 1 1 1 m result numpy 0 0 with top k 2 it will calculate precision over y true 4 and y pred 4 m tf keras metrics precision top k 4 m update state 0 0 1 1 1 1 1 1 m result numpy 0 5 usage with tf keras api python ,added example related to top k parameter in tf keras metrics precision , fix a bug in the docstring of the test case piperorigin revid
1066,console scripts pylint enable line too long remove the tensorboard console script if building tf nightly if 'tf nightly' in project name console scripts remove 'tensorboard tensorboard main main' test packages 'scipy 0 15 1' ,remove the script as well if building tf nightly , fix a bug in the docstring of the test case piperorigin revid
1067,from future import print function import contextlib import imp from tensorflow contrib autograph import operators from tensorflow contrib autograph import utils from tensorflow contrib autograph pyct import compiler from tensorflow contrib autograph pyct import context class testcase test testcase result tf self make fake mod 'fake tf' symbols result autograph utils utils result autograph api self make fake mod 'fake api' converted call result ops operators pylint disable protected access yield result except exception pylint disable broad except if source is none ,include the operators module in the test framework as well piperorigin revid , fix a bug in the test case piperorigin revid
1068,void tfgraph build const tfgraph showinternal const options opts timeline timeline root resettotalstats root show children clear if opts output type koutput 3 fprintf stderr only view supports pprof output now n return root if timeline timeline step 0 todo xpan maybe pick a default step for users fprintf stderr ,add support to generate pprof results to tf profiler a fun thing is it can not only profile time memory but also parameters etc piperorigin revid , fix a bug in the new module of the new module piperorigin revid change id iaaffafbceeeafc
1069,int setup syscall group biarch unsigned int group for each 32bit syscall i if syscalls 32bit i entry group group activate syscall32 i toggle syscall syscalls 32bit i entry name true if shm nr active 32bit syscalls 0 int setup syscall group biarch unsigned int group now the 64 bit table for each 64bit syscall i if syscalls 64bit i entry group group activate syscall64 i toggle syscall syscalls 64bit i entry name true if shm nr active 64bit syscalls 0 ,fix group syscalls weren't actually being enabled , make the syscall page we can be a child process
1070,def zeros like x dtype none name none example from tensorflow keras import backend as k kvar k variable np random random 2 3 kvar zeros k zeros like kvar k eval kvar zeros from tensorflow keras import backend as k kvar k variable np random random 2 3 kvar zeros k zeros like kvar k eval kvar zeros array 0 0 0 0 0 0 dtype float32 ,formatting fix formatting fix in documentation of zeros like in backend py , fix a bug in the docstring of the docstring of the docstring of the docstring change
1071,test test empty made partial shapes should still be fully defined const int64 dims 0 const int64 dims 1 partialtensorshape shape expect false shape isfullydefined tf assert ok partialtensorshape dims 0 shape ,enable more c tests on windows , fix a bug in the test case piperorigin revid
1072,static dpioracletypenum dpioracletype convertfromoracle uint16 t typecode return dpi oracle type varchar case dpi sqlt flt case dpi sqlt num case dpi sqlt case dpi sqlt vnu case dpi sqlt bfloat case dpi sqlt bdouble ,added support for the packed decimal type used by object attributes with historical types decimal and numeric https github com oracle python cx oracle issues , patch problem when using a terminal window is a bit solution add a test for the file
1073,qf add entries 0 if the 'valid' field is present it overrules the detected value if dict find d char u valid 1 null valid int get dict number d char u valid status qf add entry qi null dir filename ,patch cannot set the valid flag with setqflist problem cannot set the valid flag with setqflist solution add the valid argument yegappan lakshmanan closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
1074,class mastersession reffedclientgraph public core refcounted partitions is immutable after call finishes runpartitions can access partitions safely without locks acquiring locks std vector part partitions mutable mutex mu ,update master session cc , fix a bug in the new delegate piperorigin revid change id ibebfcffdcbdbdafeb
1075,standard ps ops variable variablev2 autoreloadvariable mutablehashtable mutablehashtablev2 mutablehashtableoftensors mutablehashtableoftensorsv2 mutabledensehashtable mutabledensehashtablev2 varhandleop boostedtreesensembleresourcehandleop varhandleop boostedtreesensembleresourcehandleop boostedtreesquantilestreamresourcehandleop resourceconditionalaccumulator class roundrobinstrategy object ,boosted trees enforcing quantile and cond accumulator to be created on ps piperorigin revid , fix a bug in the test case piperorigin revid
1076,statusor returnt executable executeonstreamwrapper profile mergefrom execution profile overall execution time in nanoseconds from the executor timer profile set compute and transfer time ns timer nanoseconds if stream ok don't read timer nanoseconds if the stream isn't ok that's illegal profile set compute and transfer time ns timer nanoseconds todo b on gpu we end up including transfer time in the compute time this way instead we should get the correct ,xla don't call timer on a not ok stream if the stream is not ok the timer might not have been initialized and finalized in which case calling timer is illegal and will crash piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id iadbdbdeeebea
1077,note that functions should always return a sorted list for example base dir tmp create the directories create the directories for e in xrange 10 os mkdir s d base dir e 0o755 create a simple parser that pulls the export version from the directory create a simple parser that pulls the export version from the directory path regex re escape base dir d def parser path match re match base dir d path path match re match path regex path path if not match return none return path replace export version int match group 1 for example both gc union every fifth largest three print both all paths shows tmp 0 tmp 5 tmp 7 tmp 8 tmp 9 delete everything not in delete everything not in to delete gc negation both for p in to delete all paths gfile deleterecursively p path deletes tmp 1 tmp 2 ,fix sample usage of learn utils gc re escape the base dir before matching piperorigin revid , fix a bug in the test case piperorigin revid
1078,class sparsetensor str util join shape if increasing return errors invalidargument index is out of order return errors invalidargument index is out of order many sparse ops require sorted indices n use tf sparse reorder to create a correctly ordered copy n n if different return errors invalidargument index is repeated ,mention tf sparse reorder in the sparse indexes out of order error message fixes piperorigin revid , tf data dataset dataset dataset to be a single tensor piperorigin revid
1079,include mlir translation h include mlir ir module h include mlir support llvm h include mlir support logicalresult h include llvm support managedstatic h using namespace mlir ,include missing header this target was failing to build with newer version of libc piperorigin revid , fix a bug in the dtrace dtrace dtrace dtrace dtrace is not used in the dtrace hdl this is a bit more than the dtrace dtrace dtrace dtrace is enabled the same process and dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
1080,include stdlib h include netinet udp h include net h include maps h page rand include compat h include random h include utils h array size include compat h define nr sol udp opts array size udp opts static const unsigned int udp opts udp cork udp encap static const unsigned int udp opts udp cork udp encap void udp setsockopt struct sockopt so unsigned char val char optval so level sol udp void udp setsockopt struct sockopt so case udp cork break case udp encap page rand 0 rand 3 1 encapsulation types optval char so optval optval 0 rand range 1 3 encapsulation types break default break ,make udp setsockopt use the optval passed down , proto zmalloc conversion
1081,pybind11 module xla extension m options device assignment absl nullopt executablebuildoptions set device assignment executablebuildoptions set device assignment def property use spmd partitioning executablebuildoptions use spmd partitioning executablebuildoptions set use spmd partitioning py class xlacomputation m xlacomputation def py init const py bytes serialized hlo module proto ,xla python expose new use spmd partitioning compile option piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id iefecfafdafabefecbd
1082,include map include memory include functional include flatbuffers flatbuffers h ,fixed missing functional header vs change id tested on windows , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
1083,class tfetest test util tensorflowtestcase ctx execution mode context sync self assertequal context sync ctx execution mode self assertisnone ctx summary writer ctx summary writer 'mock' self assertequal 'mock' ctx summary writer self assertisnone ctx summary recording ctx summary recording 'mock' self assertequal 'mock' ctx summary recording self assertisnone ctx summary step ctx summary step 'mock' self assertequal 'mock' ctx summary step self assertequal '' ctx device name self assertequal ctx device name ctx device spec to string with ctx device 'gpu 0' class tfetest test util tensorflowtestcase return ctx executing eagerly ctx scope name ctx summary writer ctx summary recording ctx summary step ctx device name ctx num gpus ,moved summary attributes out of context into summary ops v the summary state does not depend on the rest of the context and is only used by summary ops v piperorigin revid , tf data fix a bug in the graph piperorigin revid
1084,int main int argc char argv if dpistmt getqueryinfo stmt i 1 queryinfo 0 return dpisamples showerror printf ' s' d d d d d d n queryinfo namelength queryinfo name queryinfo oracletypenum queryinfo sizeinchars queryinfo clientsizeinbytes queryinfo precision queryinfo scale queryinfo nullok queryinfo name queryinfo typeinfo oracletypenum queryinfo typeinfo sizeinchars queryinfo typeinfo clientsizeinbytes queryinfo typeinfo precision queryinfo typeinfo scale queryinfo typeinfo nullok clean up ,add support for fractional seconds precision on timestamps and interval day to second values https github com oracle odpi issues and for additional metadata on object types and attributes https github com oracle odpi issues , fix a bug in the watchdog process
1085,void dump childnos void if pid alive child pid 1 sptr sprintf sptr s ansi red sptr sprintf sptr d s child pid ansi reset sptr sprintf sptr u s child pid ansi reset sptr sprintf sptr n ,output valid pids as unsigned values , fix a bug in the watchdog page
1086,class functiontest test testcase lambda y assertfail y x pylint enable unnecessary lambda rewriter config rewriter config pb2 rewriterconfig dependency optimization rewriter config pb2 rewriterconfig off enables inlining config config pb2 configproto graph options config pb2 graphoptions class functiontest test testcase opt level config pb2 optimizeroptions l0 do common subexpression elimination true do function inlining true do constant folding true do constant folding true rewrite options rewriter config with session session config config as sess since the 'false' branch is not taken the assertion should not fire ,automated rollback of commit piperorigin revid , tf data dataset to use tf data dataset piperorigin revid
1087,from tensorflow python client import session from tensorflow python framework import ops from tensorflow python lib io import file io from tensorflow python training import saver as saver lib from tensorflow python util deprecation import deprecated deprecated 2017 06 30 please use savedmodel instead def maybe session bundle dir export dir checks if the model path contains session bundle model def maybe session bundle dir export dir return file io file exists meta graph filename deprecated 2017 06 30 please use savedmodel instead def load session bundle from path export dir target config none ,mark exporter and sessionbundle as deprecated add recommendation to switch to savedmodel change , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1088,class tensor tensorlike dim list append 1 else dim list append dim value with errors raise exception on not ok status as status c api tf graphsettensorshape wrapper self op graph c graph pylint disable protected access self as tf output dim list unknown shape status try with errors raise exception on not ok status as status c api tf graphsettensorshape wrapper self op graph c graph pylint disable protected access self as tf output dim list unknown shape status except errors invalidargumenterror as e convert to valueerror for backwards compatibility raise valueerror str e property def value index self ,make tensor util test py work with the c api enabled some of the shape inference error messages have changed we also need to wrap an invalidargumenterror as a valueerror for backwards compat piperorigin revid , fix a bug in the graph piperorigin revid
1089,def main unused argv regressor fit x train y train steps 5000 batch size 1 predict and score y predicted regressor predict scaler transform x test y predicted list regressor predict scaler transform x test as iterable true score metrics mean squared error y predicted y test print 0 f ' format score ,convert tensorflow examples to use iterable version of predict change , fix a bug in the docstring of the new module piperorigin revid
1090,def random uniform shape minval 0 0 maxval 1 0 dtype none seed none def random binomial shape p 0 0 dtype none seed none returns a tensor with random binomial distribution of values the binomial distribution with parameters n and p is the probability distribution of the number of successful bernoulli process only supports n 1 for now arguments shape a tuple of integers the shape of tensor to create p a float 0 p 1 probability of binomial distribution ,update random binomial to take number of trials errors out if number of trials is larger than piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
1091,status processfunctionlibraryruntime releasehandle string target device mutex lock l mu check eq 1 function data count handle check eq 1 function data count handle handle handle target device function data handle target device flr getflr target device ,don't release also added a little more debug information piperorigin revid , add a test for the graph and the graph piperorigin revid
1092,from future import print function import numpy as np from tensorflow python compat import compat from tensorflow python framework import constant op from tensorflow python framework import dtypes as dtypes lib from tensorflow python framework import ops class singulargradientoptest test testcase test util run deprecated v1 def testgradientatsingularity self if not compat forward compatible 2019 4 7 self skiptest skipping test for future functionality ops and singularity gen math ops reciprocal 0 gen math ops rsqrt 0 ,add forward compatibility guards around recent changes to singular gradients piperorigin revid , fix a bug in the test case piperorigin revid
1093,const std set std string getflexallowlist stridedsliceassign stridedslicegrad stringjoin stringlength stringlower stringsplit stringsplitv2 ,add to flex delegate op is used for tf text models piperorigin revid change id , fix a bug in the graph piperorigin revid change id ibebfcffdcbdbdafeb
1094,limitations under the license include vector include absl strings substitute h include tensorflow lite delegates gpu common gpu info h include tensorflow lite delegates gpu common model h include tensorflow lite delegates gpu common operations h include tensorflow lite delegates gpu common shape h limitations under the license include tensorflow lite delegates gpu common util h include tensorflow lite delegates gpu metal compiled model h include tensorflow lite delegates gpu metal compute task descriptor h include tensorflow lite delegates gpu metal device info h include tensorflow lite delegates gpu metal kernels add h include tensorflow lite delegates gpu metal kernels concat h include tensorflow lite delegates gpu metal kernels conv h ,extended gpu common gpu info to support using gpu common gpu info for metal backend piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1095,include sys types h include sys socket h include sys un h include netinet in h include neteconet ec h include stdlib h void gen econet unsigned long addr unsigned long addrlen struct sockaddr ec ec ec malloc sizeof struct sockaddr ec if ec null return ec sec family pf econet ec port rand ec cb rand ec type rand ec addr rand ec addr net rand ec cookie rand addr unsigned long ec addrlen sizeof struct sockaddr ec ,move econet sockaddr code out to own file , dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
1096,def set verbosity level alsologtostdout false more in depth debugging there are two controls that control the logging verbosity the set verbosity function the autograph verbosity environment variable set verbosity takes over the environment variable for example ,fix bullet list in docstring piperorigin revid , fix a bug in the docstring of the documentation of the documentation of the example to the new class change
1097,tflitestatus populatequantizedlstmparams output tensor quantization params if cell clip 0 0 quantized lstm param quantized cell clip static cast int32 t cell clip cell params scale data 0 static cast int16 t cell clip cell params scale data 0 else quantized lstm param quantized cell clip 0 if proj clip 0 0 quantized lstm param quantized proj clip static cast int32 t proj clip proj params scale data 0 static cast int8 t proj clip proj params scale data 0 else quantized lstm param quantized proj clip 0 ,make clip value int int bounded piperorigin revid , add support for int ops piperorigin revid
1098,static char features static int included patches add new patch number below this line 578 ,patch cannot disable arabic and farsi in configure problem cannot disable arabic and farsi in configure solution add flags closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1099,static char features static int included patches add new patch number below this line 407 406 ,patch no early check if find and have an argument problem no early check if find and have an argument solution add ex , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1100,void init child int childno set seed childno shm kill count childno 0 disable coredumps if sched getaffinity pid sizeof set set 0 ,change the watchdog sigkill usage kill off the s counter and instead use a after s we send kill per second which seems more with c we still see high kill counts before success but we do eventually seem to make forward progress , make the syscall page we can be a child process
1101,inline long double real cast long double concepts real concept concepts real endif if boost workaround boost msvc 1310 for some strange reason adl sometimes fails to find the correct overloads unless we bring these declarations into scope using concepts itrunc using concepts iround endif namespace math namespace boost ,apply vc fixes sometimes adl fails and we need a using declaration in order for the correct overload to be found add missing include to t distribution inv hpp suppress unnecessary instantiations in instantiate all cpp svn r , fix a bug in the previous commit case the previous commit is not used by the current code
1102,def unary assert doc sym sym name args func function for a tensorflow op returns a version of func with documentation attached returns version of func with documentation attached def decorator func ,change to ' just in case , fix a bug in the docstring of the new api change
1103,def constant value as shape tensor pylint disable invalid name valueerror if the shape is rank 0 and is not statically known to be 1 if isinstance tensor ops eagertensor return tensor shape as shape return tensor shape tensorshape dim if dim 1 else none for dim in tensor numpy if tensor get shape ndims 0 ,prefer tensorshape over as shape when passing a list , fix a bug in the docstring of the test case piperorigin revid
1104,limitations under the license include tensorflow core framework op gen lib h endif defined is mobile platform defined is slim build include tensorflow c c api internal h include tensorflow c tf status internal h include tensorflow c tf tensor h include tensorflow core common runtime device mgr h include tensorflow core common runtime eval const tensor h ,split out tf status into a separate header file so that other c api libraries can depend on it without depending on c api internal piperorigin revid , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
1105,def slice helper tensor slice spec var none typeerror if the slice indices aren't int slice ellipsis tf newaxis or scalar int32 int64 tensors if isinstance slice spec np ndarray ops tensor if isinstance slice spec np ndarray ndims slice spec slice spec ndim if ndims slice spec 0 return boolean mask tensor tensor mask slice spec if not isinstance slice spec list tuple slice spec slice spec if isinstance slice spec ops tensor shape slice spec slice spec get shape ndims slice spec shape slice spec ndims if ndims slice spec 0 return boolean mask tensor tensor mask slice spec begin end strides index 0 ,resolve tensor tf constant error add corresponding test in array ops test py , fix a bug in the docstring of the test case piperorigin revid
1106,void expected results define the max and mean errors expected for various compilers and platforms add expected result compiler stdlib platform test type s negative test data group 400 200 test function add expected result compiler stdlib platform test type s test data group 350 100 test function 2 2 test function finish off by printing out the compiler stdlib platform names we do this to make it easier to mark up expected error rates ,polygamma add optimized trigamma version that uses rational approximations , fix a bug in the new parser test for the new code svn r
1107,include stdio h include pthread h include thpool h ,add thread name fix warning in the example thread name is good for both profiling and also can turn on the option custom thread names' in the warning in example is wimplicit function declaration , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
1108,public enum datatype 32 bit signed integer int32 3 8 bit unsigned integer uint8 4 a sequence of bytes ,java add the uint data type change , fix a bug in the parser test piperorigin revid
1109,resolve reparse point char u fname if p null goto fail if p file attribute reparse point 0 vim free p goto fail h p 0 0 null open existing file flag backup semantics null vim free p ,patch ms windows resolve does not resolve all components of path problem ms windows resolve does not resolve all components of the path david briscoe solution do not bail out for a point yasuhiro matsumoto closes closes , patch problem when using a terminal window doesn't work properly solution add a test for the job
1110,diff read tag fgets linebuf fd 0 strncmp line 3 0 diff unified else format not recognized yet skip over this line cygwin diff may put a warning at the start of the file continue if diff ed ,patch cannot use diff mode with cygwin diff exe problem cannot use diff mode with cygwin diff exe solution skip over unrecognized lines in the diff output , patch problem when using a terminal window is a bit solution add a test for the test
1111,void init child int childno shm kill count childno 0 disable coredumps shm num mappings childno 0 shm mappings childno zmalloc sizeof struct map init list head shm mappings childno list void init child int childno if rand 100 50 use fpu disable coredumps void check parent pid void ,make disabling the coredumps happen after we've finished setting up , make the syscall page we can be a child process
1112,def make concat tests options axis 1 type tf float32 fully quantize false quantize mode 16x8 true quantize mode 16x8 false dynamic range quantize true ,fix tests change id , tf data dataset dataset dataset to be used for tf data dataset piperorigin revid
1113,limitations under the license include tensorflow compiler tf2xla xla compiler h include tensorflow cc framework ops h include tensorflow cc ops function ops h include tensorflow cc ops sendrecv ops h include tensorflow cc ops standard ops h include tensorflow compiler tf2xla xla compilation device h include tensorflow compiler xla client client library h ,xla drop dependency on unused internal c op lib change , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
1114,copyright 2019 the tensorflow authors all rights reserved copyright 2020 the tensorflow authors all rights reserved licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license ,corrected copyright year , fix a bug in the new module piperorigin revid
1115,class tfapichangespec ast edits apichangespec decay function comment tf train noisy linear cosine decay decay function comment tf nn embedding lookup deprecate partition strategy comment tf nn embedding lookup sparse deprecate partition strategy comment tf nn nce loss deprecate partition strategy comment tf nn safe embedding lookup sparse ,remove partition strategy from v embedding lookup and v embedding lookup sparse piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1116,channel write in channel t channel ch logn channel written d lines to channel written in part ch buf top lnum if lnum buf b ml ml line count if lnum buf b ml ml line count lnum in part ch buf bot writing is done no longer need the buffer in part ch bufref br buf null ch log channel finished writing all lines to channel close the pipe socket so that the other side gets eof may close part channel ch in fd else ch logn channel still d more lines to write ,patch problem when starting a job that reads from a buffer and reaching the end the job hangs solution close the pipe or socket when all lines were read , patch problem when using a terminal window is a bit slow solution add a test for the command line
1117,hexagonnn createnewhexagoninterface void libhexagon interface dlopen libhexagon interface so rtld lazy rtld local if libhexagon interface nullptr tflite log prod tflite log error failed to load libhexagon interface so tflite log prod tflite log error failed to load libhexagon interface so error s dlerror return hexagon nn load function libhexagon interface hexagon nn config hexagon nn ,print dlerror value in case of failure to load libhexagon interface piperorigin revid change id , fix a bug in the new parser test piperorigin revid
1118,skip enosys if syscalls call entry post syscalls call entry post ret store info for debugging shm previous syscallno childno shm syscallno childno shm previous a1 childno shm a1 childno shm previous a2 childno shm a2 childno shm previous a3 childno shm a3 childno shm previous a4 childno shm a4 childno shm previous a5 childno shm a5 childno shm previous a6 childno shm a6 childno return ret ,log the previous syscall for debugging purposes , fix a bug in the watchdog process
1119,class testdatetimevar basetestcase test cursor description is accurate self cursor execute select from self assertequal self cursor description 'intcol' cx oracle number 10 22 9 0 0 cx oracle datetime 23 7 0 0 0 'nullablecol' cx oracle datetime 23 7 0 0 1 'intcol' cx oracle number 10 none 9 0 0 cx oracle datetime 23 none none none 0 'nullablecol' cx oracle datetime 23 none none none 1 def testfetchall self test that fetching all of the data returns the correct results ,use none instead of for items in the cursor description attribute that do not have any validity , patch problem when using a terminal window is a bit solution add a test for the test
1120,class xlaopsnumericaltest xla test xlatestcase parameterized testcase args v expected np tile v 7 42 1 1 test util disable mlir bridge 'not supported yet' def testgather self operand np arange 10 dtype np int32 reshape 2 5 start indices np array 2 np int32 slice sizes np array 1 3 np int32 def gather operand start indices dimension numbers xla data pb2 gatherdimensionnumbers dimension numbers offset dims extend 1 dimension numbers collapsed slice dims extend 0 dimension numbers start index map extend 0 dimension numbers index vector dim 1 return xla gather operand start indices dimension numbers slice sizes self assertopoutputmatchesexpected gather args operand start indices expected np array 5 6 7 test util disable mlir bridge 'dynamic result types not supported' def testshiftrightlogical self self assertopoutputmatchesexpected ,add compiletimeconstantinput to xlagather piperorigin revid change id , xla gpu support for the same dimension of the input piperorigin revid
1121,costs virtualscheduler summary const persisent ops insert node op int64 max memory usage persistent memory usage state max memory usage critical path costs estimated max memory per device name max memory usage vlog 1 device name num nodes state nodes executed size ,record the maximum memory usage simulated by the analytical cost estimator piperorigin revid , fix a bug in the graph optimizer piperorigin revid
1122,void xla clientlibrary client platform backend memory allocator statusor scopedshapedbuffer result executable run execute options statusor scopedshapedbuffer result executable run absl span const shapedbuffer const execute options absl mutexlock lock results mutex results emplace back device ordinal std move result ,xla rollback of rollback of implement localclient run which supports buffer donation piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid
1123,include net h define sol netbeui 267 void netbeui setsockopt struct sockopt so so level sol netbeui ,move netbeui setsockopt out to own file , move the dtrace proto to the dtrace process to the dtrace process to the dtrace process to be used for dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
1124,test f if excluded ops find op name excluded ops end continue assert true api defs map find op name api defs map end expect true api defs map find op name api defs map end op name op does not have api def pbtxt file please add api def op name pbtxt file under tensorflow core api def base api directory ,tf data bigtable initial tf data bigtable integration this change allows tensorflow users to stream data directly from cloud bigtable into the tensorflow runtime using tf data piperorigin revid , xla python fix a bug in the test piperorigin revid
1125,syscall define1 setuid uid t uid include random h include shm h include sanitise h static void sanitise setuid int childno shm a1 childno rand32 struct syscall syscall setuid name setuid num args 1 arg1name uid sanitise sanitise setuid ,limit setuid params to sizeof uid t , fix a bug in the file page
1126,class tbplugin object metaclass abcmeta the plugin name will also be a prefix in the http handlers generated by the plugin e g data plugins plugin name handler the plugin name must be unique for each registered plugin or a valueerror will be thrown when the application is constructed plugin name none abstractmethod def get plugin apps self multiplexer logdir returns a set of wsgi applications that the plugin implements ,tensorboard plugins now contain their own name route prefix change , fix a bug in the docstring of the docstring of the new api change
1127,class arraytest pfortestcase outputs append array ops gather y i 1 2 axis 2 batch dims 1 outputs append array ops gather y 2 i i 1 2 1 axis 1 batch dims 1 outputs append array ops gather y 0 1 2 3 axis 2 batch dims 2 outputs append array ops gather y 0 1 2 axis 1 batch dims 1 outputs append array ops gather y 0 1 2 3 axis 2 batch dims 2 return outputs ,add support for batch dims to gather pfor converter piperorigin revid change id , fix a bug in the graph piperorigin revid
1128,int dpicontext initsubscrcreateparams const dpicontext context int dpicontext startpublicfn const dpicontext context const char fnname dpierror error if dpi debug level dpi debug level fns fprintf stderr fn s p n fnname context endif if dpiglobal initerror fnname error 0 return dpi failure if context context checkint dpi context check int ,added dpi debug level and three bit flags dpi debug level reports on invalid free dpi debug level refs reports on reference count changes dpi debug level fns reports on public function calls , fix a bug in the test case
1129,class batchnormalization base layer pylint disable protected access for example after a single update the moving average would be 1 decay value and the weight will be 1 decay with their ratio giving value make sure the weight is not updated until before r and d computation value array ops identity value with ops control dependencies value weight value array ops constant 1 dtype weight dtype new var moving averages assign moving average var value decay zero debias false new weight moving averages assign moving average weight 1 decay zero debias false weight weight value decay zero debias false return new var new weight with ops colocate with self moving mean ,prevent the weight from being updated too early change , fix a bug in the docstring of the docstring of the test case piperorigin revid
1130,def get module to name tf train tf train tf python io tf python io tf test tf test tf contrib distributions tf contrib distributions tf contrib layers tf contrib layers tf contrib learn tf contrib learn tf contrib util tf contrib util def all libraries module to name members documented sequenceexample library script ops wraps python functions prefix prefix text library test testing tf test library contrib distributions statistical distributions contrib tf contrib distributions library contrib layers layers contrib tf contrib layers library contrib learn learn contrib tf contrib learn library contrib util utilities contrib tf contrib util ,registering documentation for contrib distributions change , fix a bug in the docstring of the docstring of the new class change
1131,void addgraphexportloweringpasses oppassmanager pm pm addpass tfdevice createreplicatetoislandpass pm addpass createbreakupislandspass add pass tfdevice createparallelexecutetoislandspass pm addpass tfdevice createlaunchtodeviceattributepass pm addpass createbreakupislandspass add pass tfdevice createlaunchtodeviceattributepass pm addnestedpass funcop createtpudevicepropagationpass pm addpass createsymboldcepass tensorflow status runtpubridge ,update launchtodeviceattributepass to assign devices through control flow ops and function ops this will allow for explicit device assignments via tf device launch to go into nested control flow ops piperorigin revid change id , tf data service support for tf data service piperorigin revid change id idaceccfcbacfece
1132,else private map do not descend map tf doc ,change the title to rc piperorigin revid , fix a bug in the new code of the new code
1133,limitations under the license include tensorflow c eager runtime h include tensorflow core common runtime device factory h include tensorflow core common runtime rendezvous mgr h include tensorflow core framework allocator h include tensorflow core framework node def pb h include tensorflow core lib core errors h status kernelanddevice run std vector tensor input tensors params output attr array gtl vector as array out attrs params function library flib params slice reader cache slice reader cache params rendezvous rendez todo apassos use a thread pool std function void std function void runner std function void f f ,sets up a rendezvous for eager op execution piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1134,class xladevice public localdevice std shared ptr se stream stream guarded by mu if false only stream is valid and all computation and transfers use stream if true computation is performed by stream and transfers are performed by host to device device to host stream performed by host to device device to device stream or a stream for each device to host transfer const bool use multiple streams if use multiple streams host to device transfers are performed using this stream std shared ptr se stream host to device stream guarded by mu if use multiple streams device to host transfers are performed using this stream std shared ptr se stream device to host stream guarded by mu if use multiple streams transfers between different devices are performed using these streams std vector std shared ptr se stream device to device streams ,to avoid deadlocks a stream from the backend for each device to host transfer request instead of using a single stream piperorigin revid , xla python add a xla interface to the xla client piperorigin revid
1135,various routines useful for debugging include config h ifdef use backtrace include execinfo h ,always include config h missing this include has caught me out a number of times as we'll silently fail ifdefs make it implicitly included , patch problem when using a terminal window doesn't work solution add a test for the gui
1136,write the graph to a file tensorshapeutils partialtensorshape partialtensorshapeutils tf buffer thread ,documentation updates for r non rc release , fix a bug in the new delegate piperorigin revid
1137,template class t class policy inline int iconv imp t v policy const pol mpl false const boost math std using return iround v return iround v pol template class t class policy ,fix a pair of typos one a clear bug svn r , fix a bug in the parser test piperorigin revid
1138,public class if monster hp get found a monster of higher hit points set monster hp set monster name set monster name set 1 else if monster hp get public class channel localhost port channels are secure by default via ssl tls for the example we disable tls to avoid needing true build blockingstub channel public class final new 1 stat new stat public void oncompleted public void oncompleted public void onerror throwable ex ,fixed deprecated method in grpc java test change id , fix a bug in the parser test piperorigin revid
1139,namespace tftpu void createtpubridge oppassmanager pm oppassmanager func pm pm nest funcop func pm addpass tf executor createtfexecutorislandcoarseningpass func pm addpass createcanonicalizerpass func pm addpass createtpuclusterformationpass func pm addpass createcanonicalizerpass func pm addpass tf executor createtfexecutorconstantsinkingpass func pm addpass tfdevice createresourceopliftingpass ,move canonicalizer pass to after tpu cluster formation to prevent canonicalization from losing tpu replicate attributes piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id icbbdbfafcdfcae
1140,status datasetbaseiterator getnext iteratorcontext ctx dvlog 3 prefix getnext enter recordstart ctx stop output true status s getnextinternal ctx out tensors end of sequence if s ok end of sequence recordelement ctx if s ok end of sequence recordelement ctx out tensors recordstop ctx start output true if tf predict false errors isoutofrange s s errors internal iterator params prefix ,tf data adding a metric for bytes produced and consumed by individual transformations refactoring infrastructure for recording tf data metrics and moving the metrics api and implementation from common runtime to framework piperorigin revid change id , add a test for the test case piperorigin revid
1141,class resourcevariableopstest test util tensorflowtestcase test operations self assertallequal v 2 numpy v v numpy def testcontainereager self with context eager mode v1 resource variable ops resourcevariable initial value lambda 1 name same with ops container different v2 resource variable ops resourcevariable initial value lambda 0 name same v2 assign 2 self assertequal 1 v1 read value numpy self assertequal 2 v2 read value numpy if name main test main ,respect container context when creating resourcevariables in eager mode piperorigin revid , fix a bug in the test case piperorigin revid
1142,class word2vec object for c in self id2word i for i in idx 0 if c not in w0 w1 w2 print c return return unknown break print unknown def nearby self words num 20 ,fix a strange contract for the function like the nearby function , fix a bug in the documentation of the documentation of the documentation of the example
1143,void reroute const string from const string to model model to array final data type arraydatatype knone to array final data type from array final data type the 'from' array may now be unused we delete it here immediately so that this function doesn't violate graph invariants no unused arrays and as it's not trivial to get this right for the caller since will no longer delete this array since it's no longer referenced by this op deletearrayifunused from model namespace ,was violating the graph invariant of no unused arrays piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id id iaaeabfdfedfeacedf
1144,def scipy sparse to sparse tensor t def is distributed dataset ds todo b use public apis return isinstance ds input lib distributeddataset input lib distributeddatasetsfromfunction return isinstance ds input lib distributeddatasetinterface ,use public distributeddataset symbol piperorigin revid change id , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
1145,def einsum equation inputs kwargs output axis labels '' join sorted for in indices if counts 1 print 'test ' axis labels input axis labels inputs equation for a in axis labels for input labels in input axis labels if len input axis labels 1 and input labels count a 2 ,updated test cases for einsum tests , fix a bug in the documentation of the documentation of the new version of the default value of the default value of the default value of the input is not used in the same function piperorigin revid
1146,limitations under the license namespace tensorflow const char const device xla cpu xla cpu class xlacpudevicefactory public devicefactory public status createdevices const sessionoptions options const string name prefix ,preliminary infeed support for gpu backend gpu transfer manager and gpu specific infeed manager infeed buffer implementation infeed thunk piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1147,class cpucompiler public llvmcompiler stream execs using llvmcompiler compile statusor std unique ptr executable compile statusor std unique ptr hlomodule runhlopasses std unique ptr hlomodule module perftools gputools streamexecutor stream exec override statusor std unique ptr executable runbackend std unique ptr hlomodule module perftools gputools streamexecutor stream exec override ,add a compiler interface that compiles the given hlo module without optimizations piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
1148,def cosine similarity y true y pred axis 1 y true 0 1 1 1 1 1 y pred 1 0 1 1 1 1 loss tf keras losses cosine similarity y true y pred axis 1 l2 norm y true 0 1 1 1 414 1 1 414 l2 norm y pred 1 0 1 1 414 1 1 414 l2 norm y true l2 norm y pred 0 0 0 5 0 5 loss sum l2 norm y true l2 norm y pred axis 1 0 0 0 5 0 5 loss numpy array 0 0 999 0 999 dtype float32 ,removed comment lines , fix a bug in the docstring of the documentation of the documentation of the documentation of the documentation of the example
1149,class indexedslicestotensortest test util tensorflowtestcase def testwarnings self todo gunan reenable after this issue is fixed https github com google protobuf issues 2812 if sys version info 3 6 smaller than the threshold no warning c sparse ops indexedslices array ops placeholder dtypes float32 array ops placeholder dtypes int32 constant 4 4 4 4 with warnings catch warnings record true as w math ops multiply c sparse 1 0 self assertequal 0 len w if sys version info 3 6 self skiptest skipped test for python 3 6 smaller than the threshold no warning c sparse ops indexedslices array ops placeholder dtypes float32 array ops placeholder dtypes int32 constant 4 4 4 4 with warnings catch warnings record true as w math ops multiply c sparse 1 0 self assertequal 0 len w greater than or equal to the threshold warning c sparse ops indexedslices ,thoroughly skip for python version should fix nightly build errors such as https ci tensorflow org view tensorflow jenkins monitored builds job nightly matrix cpu tf build is opt no opt tf build is pip no pip tf build python version python label mac slave change , fix a bug in the docstring of the test case piperorigin revid
1150,tflitestatus eval tflitecontext context tflitenode node tf lite batch to space nd optimized ops uint8 t break case ktfliteint8 if kernel type kreference tf lite batch to space nd reference ops int8 t else tf lite batch to space nd optimized ops int8 t break case ktfliteint32 if kernel type kreference tf lite batch to space nd reference ops int32 t ,create int batch to space nd piperorigin revid , add support for int int piperorigin revid
1151,static char features static int included patches add new patch number below this line 717 ,patch there is no function for the sign jump command problem there is no function for the sign jump command solution add the sign jump function yegappan lakshmanan closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1152,eval for line if fi null return null expr skip var list arg true fi fi varcount fi fi semicolon expr skip var list arg true fi fi varcount fi fi semicolon false if expr null return fi ,patch vim cannot compile var var list problem vim cannot compile var var list solution implement list assignment , patch problem when using a terminal window is a bit slow solution add a test for the command line
1153,class parser flatbufferbuilder builder any data contained in the file structdef root struct def std string file identifier std string file extension private const char source cursor ,file identifier feature allows you to add and test for the presence of a magic char string in a flatbuffer tested on os x change id , fix a bug in the parser test piperorigin revid
1154,channel exe cmd channel t channel int part typval t argv if strcmp cmd ex 0 int save called emsg called emsg called emsg false ch logs channel executing ex command ' s' char arg emsg silent do cmdline cmd arg emsg silent if called emsg ch logs channel ex command error ' s' char get vim var str vv errmsg called emsg save called emsg else if strcmp cmd normal 0 ,patch problem no test for an invalid ex command on a channel solution test handling an invalid command gracefully avoid getting an error message do write it to the channel log , patch problem when using a terminal window is a bit slow solution add a test for the command line
1155,limitations under the license include functional include unordered map include utility include absl container flat hash map h include tensorflow core framework bounds check h include tensorflow core framework op kernel h include tensorflow core framework register types h class uniqueop public opkernel auto tin input flat t const int64 n static cast int64 tin size std unordered map t tindex uniq absl flat hash map t tindex uniq uniq reserve 2 n for eigen index i 0 j 0 i n i auto it uniq insert std make pair tin i j class uniqueop public opkernel return true std unordered map int64 int64 decltype hash fn decltype equal to fn absl flat hash map int64 int64 decltype hash fn decltype equal to fn uniq 0 hash fn equal to fn uniq reserve 2 tin dimension 1 ,use absl flat hash map in uniqueop kernel hash map insertion and lookup is dominating in uniqueop kernel after replacing std unordered map with absl flat hash map much improvement was observed in the benchmark , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1156,see accompanying file license 1 0 txt or copy at http www boost org license 1 0 txt ifdef msc ver pragma warning disable 4127 4512 4701 4702 endif ifdef msc ver pragma warning disable 4127 4512 4701 4702 endif define boost test main ,corrected file locations for trunk and removed tabs svn r , fix a bug in the new parser test piperorigin revid change id icfcccdcbedbaacf
1157,status fusioninstructionmerger handlefusion hloinstruction fusion skip 'fusion' instruction if we cannot merge into all of its users merging into all users enables the removal of 'fusion' from the computation if c all of fusion users const hloinstruction instruction return instruction opcode hloopcode kfusion instruction fusion kind hloinstruction fusionkind kloop if c all of fusion users const hloinstruction user return user opcode hloopcode kfusion user fusion kind hloinstruction fusionkind kloop user fusion kind hloinstruction fusionkind kinput vlog 3 not merging fusion name some of its users are not loop input fusion kernels ,xla gpu allow merging into input fusion nodes in seems to have been an oversight input fusion means that the output of the fusion node is the real the inputs aren't special we can fuse more stuff in piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1158,inline void fbb root inline std unique ptr mygame inline flatbuffers unique ptr mygame const void buf const flatbuffers resolver function t res nullptr return std unique ptr mygame buf unpack res return flatbuffers unique ptr mygame buf unpack res inline std unique ptr mygame inline flatbuffers unique ptr mygame const void buf const flatbuffers resolver function t res nullptr return std unique ptr mygame buf unpack res return flatbuffers unique ptr mygame buf unpack res namespace mygame ,change monster extra generation to use flatbuffers unique ptr , fix a bug in the parser test piperorigin revid
1159,static const struct sso funcptr ssoptrs family af vsock func null todo wildcard match func socket setsockopt todo how shall we match these func atm setsockopt func aal setsockopt static void do random sso struct sockopt so int i again i rand array size ssoptrs if ssoptrs i func null goto again if ssoptrs i func null socket setsockopt so return ssoptrs i func so ,instead of looping in do random sso fall back to the generic socket opts , fix a bug in the syscall page
1160,void eagerclusterfunctionlibraryruntime instantiate vlog 1 instantiate function name on target this this core refcountptr eager eagerclient eager client device device s ctx finddevicefromname target c str device if s ok done s return s ctx getclient device eager client s ctx getclient target eager client if s ok done s return ,look up eager client directly from target in eager cluster flr piperorigin revid change id , xla gpu support for the hlo layout piperorigin revid change id id iaaeabfdfedfeacedf
1161,std unique ptr stringlistdecoder newstringlistdecoder const string in if defined tensorflow protobuf uses cord void assignrefcounted stringpiece src core refcounted obj absl cord out obj ref out clear defines a lambda to unref obj when cord deletes this piece of memory converts the lambda to a c style function pointer auto cleanup absl string view donotcare void obj reinterpret cast core refcounted obj unref out appendexternalmemory absl string view src data src size obj cleanup out absl makecordfromexternal src obj obj unref void encodestringlist const tstring strings int64 n absl cord out ,internal change piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id ieffeabbcfbfbfadcee
1162,limitations under the license include cstdio include tensorflow core platform logging h include tensorflow lite core api error reporter h include tensorflow lite string type h ,add missing logging header file piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1163,def batch norm inputs layer moving mean variables collections 'moving mean' add variable to collections layer moving variance variables collections 'moving variance' if layer beta if layer beta is not none add variable to collections layer beta variables collections 'beta' if layer gamma if layer gamma is not none add variable to collections layer gamma variables collections 'gamma' ,cosmetic change to layers piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the input shape is not used in the graph piperorigin revid
1164,bool hlodataflowanalysis returns true if fusion is a loop or input fusion and fusion param is used by the root of dynamic update slice as the base of the update i e the thing being updated and all other uses of fusion param are dynamic slices that slice the same static bool hloinstruction fusion check eq fusion param opcode hloopcode kparameter check eq fusion param parent fusion fused instructions computation fusion must be a loop or input fusion auto kind fusion fusion kind if kind hloinstruction fusionkind kloop kind hloinstruction fusionkind kinput return false fusion param must be used by the root as the base of the dynamic update slice the natural way to check this would be ,support inplace dus for output fusion piperorigin revid , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
1165,class test testcase memory encoder outputs memory sequence length encoder sequence length with self test session as sess with self test session use gpu true as sess with vs variable scope root initializer init ops random normal initializer stddev 0 01 seed 3 ,tf contrib seqseq beam search tree decoder op gathertree based heavily on initial implementation change , fix a bug in the docstring of the test case piperorigin revid
1166,using tensorflow tensorid using tensorflow tensorshape using tensorflow tensorshapeproto using tensorflow versiondef using tensorflow error code using tensorflow errors failedprecondition using tensorflow errors invalidargument using tensorflow gtl arrayslice tf attrmetadata tf tf operation oper if metadata list size 0 for int i 0 i oper node op def attr size i const auto a oper node op def attr i if a name compare attr name 0 continue if a name attr name continue const string typestr a type if typestr list string metadata type tf attr string ,fix various c warnings piperorigin revid , xla gpu support for the cpu backend piperorigin revid change id id iaaeabfdfedfeacedf
1167,status splitgrad const attrslice attrs functiondef g register op gradient split splitgrad status splitvgrad const attrslice attrs functiondef g clang format off g fdh define arg defs x t size splits tlen dim int32 dy num split t ret val defs dx t d size splits tlen d dim int32 attr defs t type tlen type num split int nodes dx concat dim dy t t n num split d size splits zeroslike size splits t tlen d dim zeroslike dim t dt int32 clang format on vlog 1 splitvgrad debugstring g return status ok register op gradient splitv splitvgrad status const attrslice attrs functiondef g int n tf return if error getnodeattr attrs n n ,add c gradient for splitv op piperorigin revid , fix a bug in the graph piperorigin revid
1168,static char features static int included patches add new patch number below this line 669 ,updated for version problem using 'cindent' for javascript is less than perfect solution improve indenting of continuation lines hirohito higashi , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1169,class xla test xlatestcase l2 list ops tensor list reserve element shape element dtype dtypes float32 num elements 3 l math ops add n l1 l2 with self assertraisesregexp with self assertraisesregex errors invalidargumenterror tensorlist arguments to addn must all have the same shape list ops tensor list stack l element dtype dtypes float32 eval class xla test xlatestcase element dtype dtypes float32 num elements 3 l math ops add n l1 l2 with self assertraisesregexp with self assertraisesregex errors invalidargumenterror tensorlist arguments to addn must all have the same shape session run ,move away from deprecated asserts assertequals assertequal piperorigin revid change id , xla python fix a bug in the graph piperorigin revid
1170,from tensorflow python util tf export import tf export no tf export until tf is built against which is required for tf32 def tensor float32 execution allowed def tensor float 32 execution allowed allow use of tensorfloat 32 with float32 ops on supported hardware tensorfloat 32 is a math mode introduced with the nvidia architecture ,use float instead of float in function names , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
1171,static unsigned int new seed void unsigned int r gettimeofday t 0 r rand t tv sec getpid t tv usec r t tv usec rand return r ,simplify seed generation this seems good enough , make the syscall page
1172,status tensorhandle settensor const tensorflow tensor tensor dvlog 3 settensor on tensorhandle this if tensor dtype dt resource if tensor dtype dt resource tensor numelements 0 auto resource handle tensor flat class resourcehandle 0 handle dtypes and shapes resource handle dtypes and shapes ,make empty tensors of resource handles less crashy piperorigin revid change id , tf data service support for tf data service piperorigin revid change id idaceccfcbacfece
1173,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 2 21 forward compatibility horizon datetime date 2020 2 22 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
1174,class readvariableop public opkernel resourcehandle handle handlefrominput ctx 0 const auto status lookupresource ctx handle variable op requires ctx status ok errors notfound errors failedprecondition error while reading resource variable handle name from container handle container this could mean that the variable was uninitialized ,raise the same error for uninitialized resourcevariables as we do for variables piperorigin revid , fix a bug in the test case piperorigin revid
1175,copyright john maddock 2006 use modification and distribution are subject to the boost software license version 1 0 see accompanying file license 1 0 txt or copy at http www boost org license 1 0 txt include boost math interpolators cubic b spline hpp include boost math concepts std real concept hpp void compile and link test boost math concepts std real concept data 1 2 3 boost math cubic b spline boost math concepts std real concept s data 3 2 1 s2 s 1 0 s prime 1 0 ,add concept checks for cubic spline code and fix resulting errors , fix a bug in the previous commit by the previous commit
1176,void init child int childno set make it fail if rand 100 50 if rand bool use fpu mask signals child ,replace open coded rand bool , fix a bug in the syscall page
1177,class queuebase object if not isinstance vals list tuple vals vals if len vals len self dtypes raise valueerror queue contains d component s but enqueue attempted with d tensor s len self dtypes len vals tensors for i val dtype in enumerate zip vals self dtypes tensors append ops convert to tensor val dtype dtype ,added a check to ensure of queue components match the list of tensors getting enqueued piperorigin revid , fix a bug in the docstring of the docstring of the documentation of the example change
1178,template struct todatatype int8 static constexpr datatype value datatype kint8 template struct todatatype int32 static constexpr datatype value datatype kint32 specifies the types of a rnn model enum class rnnmode ,simplify some cuda dnn logic de duplicate the accumulator type logic currently we have two ways to specify them as template argument or removed simplified piperorigin revid , fix a bug in the toy tutorial piperorigin revid change id icfcccdcbedbaacf
1179,class layer module module version utils layerversionselector node index integer index of the node from which to retrieve the attribute e g node index 0 will correspond to the first time the layer was called first input node of the layer returns a tensor or list of tensors if the layer has multiple inputs class layer module module version utils layerversionselector node index integer index of the node from which to retrieve the attribute e g node index 0 will correspond to the first time the layer was called first output node of the layer returns a tensor or list of tensors if the layer has multiple outputs ,fixes github piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
1180,def block inputs if 0 se ratio 1 filters se max 1 int filters in se ratio se layers name name x se layers reshape 1 1 filters name name se if bn axis 1 se shape filters 1 1 else se shape 1 1 filters se layers reshape se shape name name se se layers conv2d filters se 1 ,fix channel first support for reshape was hardcoded to channel last now bn axis is used , tf data dataset dataset to be a single device to be used by default piperorigin revid
1181,xla statusor xla deviceassignment builds an xla localclient for the gpu platform statusor localclient getgpuxlaclient gpu will be by the default defined in platform util cc tf assign or return se platform platform platformutil getplatform gpu if platform visibledevicecount 0 ,comment about the gpu platform , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1182,export class projector extends projectorpolymer implements selectioncontext height can grow indefinitely let container this dom select ' container' container style 'height' container property 'px' this scatterplot resize this scatterplot render run string tensorinfo embeddinginfo export class projector extends projectorpolymer implements selectioncontext neighborsoffirstpoint knn nearestentry this selectedpointindices neighborsoffirstpoint this scatterplot resize this scatterplot render private onhover number ,render scatter plot later when the container has height change , fix a bug in the docstring of the new module change
1183,class trtoptimizationpass public tensorflow grappler customgraphoptimizer minimum segment size 3 precision mode 0 maximum batch size 1 maximum workspace size 1 is dynamic op false max cached batches 1 max workspace size bytes 256ll 20 vlog 1 constructing name class trtoptimizationpass public tensorflow grappler customgraphoptimizer const tensorflow grappler grappleritem item private string name const string name int minimum segment size int precision mode int maximum batch size bool is dynamic op std vector int batches int max cached batches int64 t maximum workspace size int64 t max workspace size bytes namespace convert ,initialize members in the constructor and use a util function to get the precision mode piperorigin revid , xla gpu support for the layout of the layout piperorigin revid
1184,copyright john maddock 2008 copyright paul a bristow 2010 copyright paul a bristow 2010 2013 use modification and distribution are subject to the boost software license version 1 0 see accompanying file license 1 0 txt ,changed links in examples to use def style links svn r , fix a bug in the new parser test piperorigin revid change id icfcccdcbedbaacf
1185,class permute layer arguments dims tuple of integers permutation pattern does not include the samples dimension indexing starts at 1 for instance 2 1 permutes the first and second dimension for instance 2 1 permutes the first and second dimensions of the input input shape class permute layer def init self dims kwargs super permute self init kwargs self dims tuple dims if sorted dims list range 1 len dims 1 raise valueerror 'invalid permutation dims for permute layer s ' 'the set of indices in dims must be consecutive and start from 1 ' dims self input spec inputspec ndim len self dims 1 def compute output shape self input shape ,improve doc string and error checking in permute layer check the validity of the permutation dims in the constructor of tf keras layers permute this improves the error messages on invalid dims piperorigin revid , fix a bug in the graph piperorigin revid
1186,module vz prevent it from falling off the right side of the screen let left math min 0 left width 60 this tooltip style 'left' left 'px' compute top position if bottom height vz charthelpers tooltip y pixel offset document body clientheight this tooltip style bottom vz charthelpers tooltip y pixel offset else this tooltip style top vz charthelpers tooltip y pixel offset let top height vz charthelpers tooltip y pixel offset this tooltip style 'transform' ' left ' top ' this tooltip style 1 ,fix tooltip positioning to be below the chart at all times to not get in front of the chart change , xla python python python client piperorigin revid change id icccbcbdbcfaadbee
1187,class converter const nvinfer1 itensor output tensor converts 'input' into 'tensor' with shape specified by 'dims' if validation only is true it doesn't do the conversion but only do some minimum validation for the eligibility of the conversion and tensor will be set to nullptr status preparetensorforshape const trt tensororweights input const nvinfer1 dims dims const bool validation only const nvinfer1 itensor tensor return ok if the broadcast scheme is supported and compute the shapes after ,add more validation to batchmatmul converter this also fix batch matmul test so the expected engines to run are the same as the engines to build after this we'll be able to remove piperorigin revid , fix a bug in the test case piperorigin revid
1188,from future import division from future import print function import base64 import import json import os import shutil import threading from six moves import http client from six moves import xrange pylint disable redefined builtin import tensorflow as tf class tensorboardservertest tf test testcase self server thread threading thread target self server serve forever self server thread daemon true self server thread start self connection 'localhost' self server server address 1 self connection http client 'localhost' self server server address 1 def teardown self self connection close ,use six moves http client instead of change , tf data service support for tf data dataset piperorigin revid
1189,static void parse args int argc char argv for i 0 i max nr syscalls i if strcmp optarg syscalls i name 0 printf found s at u n syscalls i name i if syscalls i flags avoid syscall printf s is marked avoid syscall probably for good reason n syscalls i name exit exit failure specific syscall i break static void parse args int argc char argv try looking in the 32bit table for i 0 i max nr syscalls32 i if strcmp optarg syscalls32 i name 0 if syscalls32 i flags avoid syscall printf s is marked avoid syscall probably for good reason n syscalls32 i name exit exit failure printf found in the 32bit syscall table s at u n syscalls32 i name i specific syscall i printf forcing into 32bit mode n ,don't let c call avoid syscall annotated syscalls , make the syscall page
1190,def sampled sparse softmax loss weights a batch size 1 d tensor of per example sampled softmax losses logits labels nn impl compute sampled logits logits nn impl compute sampled logits weights weights biases biases labels labels def sampled sparse softmax loss weights subtract log q true remove accidental hits remove accidental hits partition strategy partition strategy labels as indices true name name there is only one true label compute sampled logits puts the true logit at index 0 labels tf zeros array ops shape logits 0 1 dtype dtypes int64 sampled losses nn ops sparse softmax cross entropy with logits labels array ops squeeze labels logits logits sampled losses is a batch size tensor ,removing labels as indices logic from compute sampled logits now computing index labels in sampled sparse softmax loss , fix a bug in the docstring of the docstring of the docstring change
1191,static garray t 0 0 sizeof char u 10 null use get deleted augroup to get this static char u deleted augroup null set by the apply autocmds group function if the given event is equal to event filetype used by the readfile function in order to determine if event triggered the event filetype relying on this value requires one to reset it prior calling apply autocmds group int au did filetype init false the id of the current group group 0 is the default one ,patch au did filetype is declared twice problem au did filetype is declared twice solution remove it from autocmd c closes , patch problem when using a terminal window is a bit solution add a few more tests to the new code
1192,static char features static int included patches add new patch number below this line 2295 2294 ,patch problem cscope test fails solution avoid checking for specific line and column numbers , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1193,static char features static int included patches add new patch number below this line 2164 2163 ,patch stuck when using j in a popupwin with popup filter menu problem stuck when using j in a popupwin with popup filter menu if a line wraps solution check the cursor line is visible closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1194,def set cc opt flags environ cp elif is windows default cc opt flags ' arch avx' else default cc opt flags ' march native' default cc opt flags ' march native sign question 'please specify optimization flags to use during compilation when' ' bazel option config opt is specified default is s ' default cc opt flags ,disable signed compare warnings in tensorflow default build we have a lot of such warnings and don't make an attempt to clean them up internally piperorigin revid , fix a bug in the documentation of the documentation of the new version of the default value of the default value of the default value of the default value of the same value piperorigin revid
1195,class definedfunction object constructed only when c api is enabled lazily self c func none self sub functions dict constructed with definition or c func device stack ops get default graph device function stack pylint disable protected access get the innermost device if self caller device device stack 1 if device stack else none cached opdef for this function when c api is enabled this is the only part of functiondef that we cache in python when c api class definedfunction object create the func def object temp graph funcgraph capture by value self capture by value with temp graph as default with temp graph as default ops device self caller device list of placeholders for the function def inputs for argname argtype in self args ,function should inherit device information from the caller site piperorigin revid , fix a bug in the graph piperorigin revid
1196,status hosttracer const string cpu name host cpu for auto thread events step stats collector cpu name thread thread tid thread thread name for auto event thread events if event end time auto it end times find event activity id ,add thread name to profile result piperorigin revid , xla python add a test for the xla client piperorigin revid
1197,static char features static int included patches add new patch number below this line 944 ,patch problem new style testing is incomplete solution add the runtest script to the list of distributed files add the new functions to the function overview rename the functions to match vim function style move undolevels testing into a new style test script , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1198,class stridedsliceop public xlaopkernel ctx output elements input elements sliced errors invalidargument the number of output elements output elements has to equal to number of input elements that are sliced has to equal to number of input elements that are sliced input elements sliced when input indices are not constant for int64 i 0 i ctx inputshape begin dims i ,tfxla remove extra space in error message piperorigin revid change id , xla gpu support for the same dimension of the input piperorigin revid
1199,boost software license version 1 0 see accompanying file license 1 0 txt or copy at http www boost org license 1 0 txt define l22 define l22 include tools ntl rr lanczos hpp include tools ntl rr digamma hpp include boost math tools ntl hpp ntl rr f const ntl rr x int variant return l return expm1 x x case 12 return exp x return 0 ,more editorial and proof reading fixes added initial draft of remez background information svn r , fix a bug in the new parser test svn r
1200,did set spelllang wp if spl copy null goto theend ifdef feat mbyte wp w s b cjk 0 endif loop over comma separated language names for spl copy nul did set spelllang wp if strcmp lang cjk 0 ifdef feat mbyte wp w s b cjk 1 endif continue ,updated for version problem can't build small version solution add ifdef where the b cjk flag is used ken takata , patch problem when using a terminal window is a bit slow solution add a test for the gui
1201,set cmd context xp str len col intold char nul char u store the string here so that call user expand func can get to them easily xp xp line str xp xp col col avoid a warning from only save the character if it has been written before set cmd context xp str len col while null set one cmd context xp store the string here so that call user expand func can get to them easily xp xp line str xp xp col col str col old char ,updated for version problem command line completion does not work solution move setting xp line down daniel , patch problem when using a terminal window is a bit slow solution add a test for the command line
1202,assertionresult hresultfailurehelper const char expr char error text ' 0' dword message length formatmessagea 0 no source we're asking system hr the error static cast dword hr the error 0 no line width restrictions error text output buffer buf size ,unbreak windows build windows msvc toolchain with werror and wconversion will break if converting long to , fix for the build failure
1203,add pack plugin char u fname void cookie if load files static char s plugin vim static char s plugin vim static char s vim int len char u pat ,patch problem packadd does not work the same when used early or late solution always load plugins matching plugin vim , patch problem when using a terminal window is a bit slow solution add a test for the command line
1204,statusor mlir operation hlofunctionimporter importinstruction convert interior padding getoperation case hloopcode ksetdimensionsize attributes push back builder getnamedattr dimension builder getintegerattr builder getintegertype 32 instruction dimension makeandreturn case hloopcode kslice return func builder create mlir xla hlo sliceop ,add setdimensionsize op to hlo dialect piperorigin revid change id , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
1205,class convlstm2d convrnn2d currently specifying any dilation rate value 1 is incompatible with specifying any strides value 1 activation activation function to use if you don't specify anything no activation is applied ie linear activation a x x by default hyperbolic tangent activation function is applied tanh x recurrent activation activation function to use for the recurrent step use bias boolean whether the layer uses a bias vector ,fix activation argument document for convlstmd in the example https www tensorflow org versions r api docs python tf keras layers convlstmd init the activation whereas the documentation says no activation is applied ie linear activation a x x , fix a bug in the docstring of the docstring of the docstring change
1206,compute the upper regularized incomplete gamma function q a x the upper regularized incomplete gamma function is defined as q a x gamma a x gamma x 1 p a x q a x gamma a x gamma a 1 p a x where compute the lower regularized incomplete gamma function q a x the lower regularized incomplete gamma function is defined as p a x gamma a x gamma x 1 q a x p a x gamma a x gamma a 1 q a x where ,correct documentation for igammac and igamma change , xla gpu support for the layout interface piperorigin revid change id icccbcbdbcfaadbee
1207,class tpuextended distribute lib strategyextendedv1 atexit register async wait flag to turn on variablepolicy self use var policy true self use var policy false def validate colocate with variable self colocate with variable distribute utils validate colocate colocate with variable self ,disable variable policy for tpustrategy piperorigin revid change id , tf data optimizer to use the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
1208,test f scalarcomputationstest complicatedarithmeticexpressions32 computeandcomparer0 int32 b 10 test f scalarcomputationstest sqrtf320 computationbuilder builder client testname literal zero literal literalutil zero primitivetype f32 std unique ptr globaldata zero data client transfertoserver zero literal consumevalueordie computationdatahandle zero builder parameter 0 zero literal shape zero builder sqrtf32 zero computeandcomparer0 float builder 0 0f zero data get error spec namespace namespace xla ,add an xla test for computationbuilder sqrtf change , fix a bug in the test case piperorigin revid
1209,void destroy initial mappings void struct list head node list tmp struct objhead head struct map m head shm global objects obj mmap list head list list for each safe node tmp list struct object obj struct map m obj struct object node m obj map void destroy initial mappings void munmap m ptr m size free m name destroy object struct object m obj global obj mmap destroy object obj obj global obj mmap head num entries 0 ,destroy the obj not the map , fix a bug in the syscall page
1210,static char features static int included patches add new patch number below this line ,patch using old c style comments problem using old c style comments solution use comments where appropriate , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1211,class testkerasestimator test util tensorflowtestcase writer cache filewritercache clear gfile deleterecursively self config model dir test util run in graph and eager modes def test train with tf optimizer self for model type in 'sequential' 'functional' keras model class testkerasestimator test util tensorflowtestcase writer cache filewritercache clear gfile deleterecursively self config model dir test util run in graph and eager modes def test train with subclassed model self keras model train input fn eval input fn get resource for simple model ,unblock eager execution for model to estimator piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid change id iffafdbbcddfebbeac
1212,static char features static int included patches add new patch number below this line 1187 ,updated for version problem newline characters messing up error message solution remove the newlines kazunobu kuriyama , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1213,def batch norm inputs collections moving variance collections if is training calculate the moments based on the individual batch mean variance nn moments inputs axis mean variance nn moments inputs axis shift moving mean update the moving mean and moving variance moments update moving mean moving averages assign moving average moving mean mean decay ,use running mean as a shift value to moment computation in layers change , fix a bug in the docstring of the test case piperorigin revid
1214,sliceindex handlecopies opkernelcontext ctx const sliceindex indices size static cast sliceindex indices dimension 0 const sliceindex batch size static cast sliceindex params dimension 0 const index limit static cast index params dimension 1 t out base out 0 0 0 const t params base params 0 0 0 t out base out data const t params base params data if static slice elems 0 give compiler static knowledge of the number of elements bytes slice elems static slice elems ,fix so it no longer invokes ub when the params or out are empty with no backing data piperorigin revid change id , add a test for the new op api piperorigin revid
1215,test quantizationutiltest getinvsqrtquantizedmultiplierexp test quantizationutiltest multiplybyquantizedmultiplierint32 auto quant and multiply int32 x double multiplier auto quant and multiply int32 t x double multiplier int32 t quantized multiplier int shift quantizemultiplier multiplier quantized multiplier shift test quantizationutiltest multiplybyquantizedmultiplierint32 test quantizationutiltest multiplybyquantizedmultiplierint64 auto quant and multiply int64 x double multiplier auto quant and multiply int64 t x double multiplier int32 t quantized multiplier int shift quantizemultiplier multiplier quantized multiplier shift ,use t instead of , xla gpu support for the xla client client piperorigin revid
1216,class categoricalaccuracy meanmetricwrapper class sparsecategoricalaccuracy meanmetricwrapper calculates how often predictions matches integer labels acc np dot sample weight np equal y true np argmax y pred axis 1 python acc np dot sample weight np equal y true np argmax y pred axis 1 you can provide logits of classes as y pred since argmax of logits and probabilities are same ,include python markdown header co authored by mihai maruseac mihai maruseac gmail com , fix a bug in the docstring of the docstring of the new api change
1217,central storage strategy with gpu and cpu combinations nameddistribution gpu 0 cpu 0 required gpus 1 multi worker mirrored two workers combinations nameddistribution collective all reduce strategy collectiveallreducestrategy has chief false num workers 2 multi worker mirrored one chief one worker combinations nameddistribution collective all reduce strategy collectiveallreducestrategy has chief true num workers 1 ,typo fix in strategy combinations py piperorigin revid change id , tf data optimizer to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1218,bool random syscall struct childdata child parent int childret 0 int childstatus while ret 0 while childret 0 clock gettime clock monotonic child tp kill pid sigkill childret waitpid pid childstatus wuntraced wcontinued wnohang ,fix wrong variable name in childops wait , fix a bug in the syscall page
1219,status concatxy bindarguments for int i 0 i tensors count i return if error kernel setmemoryauto src i getmemoryptr return if error kernel setmemoryauto dst 0 getmemoryptr return if error kernel setmemoryauto dst 0 return if error kernel linked operations int max src width 0 int max src height 0 ,using image buffer as buffer for writing piperorigin revid , xla gpu support for the layout inference piperorigin revid change id ibadadadacbbbef
1220,void dirty mapping struct map map case 4 fault in map size pages some may be faulted once for i 0 i num pages i for i 0 i num pages i p rand num pages 1 rand break ,remove erroneous in maps dirtying , fix a bug in the syscall page
1221,def edit distance hypothesis truth normalize true name edit distance ops registergradient fakequantwithminmaxargs def op grad return fake quant with min max args gradient grad op inputs 0 return fake quant with min max args gradient grad op inputs 0 min op get attr min max op get attr max ops registergradient fakequantwithminmaxvars ,pass min and max attributes to fixes change , fix a bug in the docstring of the docstring of the docstring change
1222,package flatbuffers import java lang string import static flatbuffers constants import java nio bytebuffer import java nio charset charset all tables in the generated code derive from this class and add their own accessors public class table extends constants public class table protected int bb pos protected bytebuffer bb ,removed the use of b array to support also removed table extend constants change id , fix a bug in the parser test piperorigin revid
1223,def from proto fn v import scope none if v is resource return resourcevariable from proto v import scope import scope return variables refvariable from proto v import scope import scope return variables variable from proto v import scope import scope ops register proto function ,automated rollback of commit piperorigin revid , fix a bug in the docstring of the docstring of the keras model piperorigin revid
1224,test directsessiontest assert eq 2 outputs size assert eq 11 0 outputs 0 flat float 0 assert eq 22 0 outputs 1 flat float 0 feed first const first const s session run first const name value 11 first const name value 22 first identity name 0 second identity name 0 outputs expect true errors isinvalidargument s expect true stringpiece s error message contains fed more than once register op ,raise an error when a client attempts to feed two values for the same tensor this change makes tensorflow more robust to incorrect uses of the c and c apis but the python api already prevents duplicates fixes change , fix a bug in the test case piperorigin revid
1225,java org tensorflow lite tensor shape jnienv env jclass clazz jlong handle return result jniexport jintarray jnicall java org tensorflow lite tensor shapesignature jnienv env jclass clazz jlong handle tflitetensor tensor gettensorfromhandle env handle if tensor nullptr return nullptr int num dims 0 int const data nullptr if tensor dims signature nullptr tensor dims signature size 0 num dims tensor dims signature size data tensor dims signature data else num dims tensor dims size data tensor dims data jintarray result env newintarray num dims env setintarrayregion result 0 num dims data return result jniexport jint jnicall java org tensorflow lite tensor jnienv env jclass clazz jlong handle ,add shape signature to the java python tensor api piperorigin revid change id , add a new method to the new delegate piperorigin revid
1226,include shm h include utils h static unsigned long rand size void const unsigned long sizes 1 mb 2 mb 4 mb 10 mb 1 gb 2 gb return sizes rand array size sizes static void sanitise mremap int childno struct map map static void sanitise mremap int childno shm syscall childno a3 map size todo munge this if shm syscall childno a4 mremap fixed shm syscall childno a5 rand size shm syscall childno a5 rand 256 rand wordsize shm syscall childno a5 page size shm syscall childno a5 page mask else shm syscall childno a5 0 struct syscallentry syscall mremap values mremap maymove mremap fixed arg5name new addr arg5type arg address group group vm post post mremap ,mremap th arg is an address not a length make something up for now later we'll do something smarter , move the syscall page to the syscall process
1227,tflitestatus parseopdata const operator op builtinoperator op type builtin data reinterpret cast void params break case builtinoperator resize nearest neighbor large functions confuse macos builds with 8 so a lambda is required to minimize function size todo b simplify parseopdata function and reduce its length auto params allocator allocatepod tfliteresizenearestneighborparams if auto schema params op builtin options as resizenearestneighboroptions params align corners schema params align corners builtin data reinterpret cast void params break case builtinoperator reshape auto params allocator allocatepod tflitereshapeparams if auto schema params op builtin options as reshapeoptions ,add nearest neighbor resize op to tflite piperorigin revid , add support for int int piperorigin revid
1228,from future import absolute import from future import division from future import print function from six moves import range import functools import weakref class deffunctiontest test testcase with self assertraises valueerror fn 1 0 def testrange self def function function def f unused x return 1 0 self assertallequal f range 5 1 0 def self state ,nest shouldn't on ranges piperorigin revid , fix a bug in the test case piperorigin revid
1229,deathtest testrole fuchsiadeathtest assumerole zx status t status zx handle t child pipe handle int child pipe fd status fdio pipe half2 child pipe fd child pipe handle status fdio pipe half child pipe fd child pipe handle gtest death test check status zx ok set read fd child pipe fd ,googletest export fdio pipe half is now the same as fdio pipe half we can switch back to the cleaner name piperorigin revid , fix a bug in the parser build on the compiler warning on linux
1230,include linux if packet h include linux atmdev h include linux atm h include linux irda h include trinity h include sanitise h static int packet opts nr sol packet opts static int atm opts nr sol atm opts so setclp so cirange so atmqos so atmsap so atmpvc so multipoint define nr sol irda opts 11 static int irda opts nr sol irda opts irlmp enumdevices irlmp ias set irlmp ias query irlmp hints set irlmp qos set irlmp qos get irlmp max sdu size irlmp ias get irlmp ias del irlmp hint mask set irlmp waitdevice void sanitise setsockopt int childno void sanitise setsockopt int childno shm a3 childno atm opts val break case sol aal case sol aal no setsockopt break case sol irda val rand nr sol irda opts shm a3 childno irda opts val break case sol netbeui case sol llc case sol dccp ,irda support for setsockopt , move the dtrace proto to the dtrace provider to the dtrace process to the dtrace process to be used in the dtrace process to the dtrace process and dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
1231,extern c include tensorflow lite micro debug log h include tensorflow lite micro cortex m gcc generic debug log callback h include tensorflow lite micro cortex m generic debug log callback h static debuglogcallback debug log callback nullptr ,tflu update cortex m generic target from review comments , fix a bug in the new module of the new module of the dtrace module is not used by the dtrace dtrace is not used in the dtrace process and the dtrace is not used in the dtrace process and the dtrace dtrace is not used by the dtrace dtrace is not used
1232,normal end endif ifdef feat terminal don't go to insert mode from terminal job mode if term use loop restart edit 0 endif may restart edit if we got here with ctrl o in insert mode but not if still inside a mapping that started in visual mode ,patch entering terminal using c o c w c w goes to insert mode problem when in insert mode and using ctrl o ctrl w ctrl w to move to a window get in a weird insert mode solution don't go to insert mode in a terminal window closes , patch problem when using a terminal window is a bit solution add a few more tests to the new code
1233,tf call number types register scatter arithmetic cpu tf call all types register scatter update cpu registers gpu kernels if google cuda if google cuda tensorflow use rocm define register scatter arithmetic gpu type register scatter arithmetic type gpu tf call gpu number types no half register scatter arithmetic gpu tf call gpu number types register scatter minmax gpu tf call gpu number types no half register scatter update gpu endif google cuda endif google cuda tensorflow use rocm registers gpu kernels if tensorflow use sycl ,adding rocm support for scatter ops , fix a bug in the test case piperorigin revid
1234,def shared embedding columns categorical columns class tpubaseembeddingcolumn object def init self categorical column max sequence length 0 def init self categorical column max sequence length 0 learning rate fn none self tpu categorical column categorical column self max sequence length max sequence length self learning rate fn learning rate fn if self is sequence column and max sequence length 1 raise valueerror 'max sequence length must be greater than 0 for ' 'sequence columns got max sequence length for ' class tpubaseembeddingcolumn object def get max sequence length self return self max sequence length def get learning rate fn self return self learning rate fn def get sequence length feature key name self return get sequence length feature key name from feature key name ,support dynamic learning rate in tpuestimator for tpuembedding piperorigin revid , fix a bug in the docstring of the docstring of the keras model piperorigin revid
1235,register op depthtospace tensorformat data format formatfromstring data format str data format constexpr int num spatial dims 2 const int dims gettensordimsfromspatialdims num spatial dims data format shapehandle input tf return if error c withrank c input 0 4 input tf return if error c withrank c input 0 dims input int32 block size tf return if error c getattr block size block size constexpr int num spatial dims 2 dimensionhandle batch size c dim input gettensordimindex num spatial dims data format 'n' dimensionhandle input height ,implement nchw vect c support for tf depth to space on gpu piperorigin revid , fix a bug in the test case piperorigin revid
1236,limitations under the license namespace tfliteregistration static tfliteregistration registration const tfliteregistration static const tfliteregistration registration init nullptr free nullptr prepare nullptr ,add 'const' in a couple of places where it was missing piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
1237,static char features static int included patches add new patch number below this line 865 ,patch syntax is taken from the start of the line problem syntax is taken from the start of the line solution add syn to be able to use the minimal in the line brad king closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1238,int main int argc char argv if create shm exit exit failure if desired group group none ret setup syscall group desired group if ret false ret exit failure goto cleanup shm if show syscall list true dump syscall tables goto cleanup shm int main int argc char argv if logging 0 open logfiles if desired group group vm struct syscalltable newsyscalls int count 0 j 0 for i 0 i max nr syscalls i if syscalls i entry group group vm count newsyscalls malloc count sizeof struct syscalltable if newsyscalls null exit exit failure for i 0 i max nr syscalls i if syscalls i entry group group vm newsyscalls j entry syscalls i entry max nr syscalls count syscalls newsyscalls if do specific syscall if biarch true ,fix up the syscall group code on arch use the bit syscalls too , fix a bug in the watchdog process
1239,class replicatehelper return status ok void graph graph for const auto entry replicated nodes map for node replicated node entry second if replicated node isarg replicated node out edges empty graph removenode replicated node private map from original nodes to corresponding replicated nodes absl flat hash map const node std vector node replicated nodes map status replicateperreplicanodesinfunctiongraph for auto n cluster nodes graph removenode n helper graph return status ok ,remove dead replicated arg nodes piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id icfecdffaddccbded
1240,tensorflow status convertcalibgraphtoinfergraph cres thr join const auto calibration table cres calibrator if calibration table size if calibration table empty log error calibration table is empty return tensorflow errors unknown calibration table is missing this shouldn't have happened tensorflow status createtrtnode const std vector engineinfo infos int pos info use calibration convert successfully nullptr trtuniqueptrtype nvinfer1 ihostmemory engine data engine serialize segment string string const char engine data data engine data size segment string string static cast const char engine data data engine data size if calibrate int8 see above comment about why not putting this inside the 'else' branch segment string info segment graph def serializeasstring ,use empty instead of size based checks and replace c style casts by static cast piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id id icfecdffaddccbded
1241,static char features static int included patches add new patch number below this line 1842 1841 ,patch problem get works for partial but not for funcref solution accept funcref also return the function itself nikolai pavlov , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1242,class reshape shape reshape result return if auto cast dyn cast op only support fully dynamic sizes for now todo herhut fix once the op has that break this for unsigned int p 0 e cast p e p if cast p return cast sizes cast result return if auto alloc dyn cast allocop op smallvector 4 shape shapedtype type alloc getresult gettype cast shapedtype ,add support for memref reinterpret cast to the same shape and abi knowledge passes also add a test to ensure that optimization and analysis passes work for tanh input piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid
1243,class strategy object for example if running on a single replica with self scope fn autograph tf convert fn ag ctx control status ctx tf distribute supports eager functions so autograph should not be applied when when the caller is also in eager mode fn autograph tf convert fn ag ctx control status ctx convert by default false return self extended call for each replica fn args args kwargs kwargs def reduce self reduce op value axis ,avoid autograph ing functions when calling from default context piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
1244,class freezegraphtest test util tensorflowtestcase input binary input checkpoint path output node names restore op name filename tensor name output graph path clear devices clear devices now we make sure the variable is now a constant and that the graph still produces the expected result ,allow list of initializer nodes to run before freezing the graph change , fix a bug in the docstring of the test case piperorigin revid
1245,cluster cluster int timeout s timeout s timeout s disabledetailedstats false cluster cluster cluster cluster void cluster allowsoftplacement bool soft placement state options config set allow soft placement soft placement state ,cleanup ran clang format on all cc h in under grappler piperorigin revid , xla python add a test for the cpu backend piperorigin revid
1246,def get replica device setter config ps ops 'variable' 'variablev2' 'autoreloadvariable' 'mutablehashtable' 'mutablehashtableoftensors' 'mutabledensehashtable' 'mutablehashtablev2' 'mutablehashtableoftensors' 'mutablehashtableoftensorsv2' 'mutabledensehashtable' 'mutabledensehashtablev2' if config task type ,make tf contrib lookup python functions use the kernels v that uses the resource tensor as handler piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
1247,xla test f svdtest various size random matrix array2d float a val generaterandommatrix 512 512 xlaop a auto a data creater2parameter float a val 0 a builder a auto result svd a 100 1e 6 auto result svd a 100 1e 4 computematmuludvt result builder a builder computeandcomparer0 float builder 1e 3 a data get ,xla fix dot strength reduction to simply remove all degenerate dimensions and let the next pass of simplification handle the resulting dot that may have no contracting or non contracting dimensions also allow scalar dots in shape inference as it works piperorigin revid , xla gpu support for the xla client piperorigin revid
1248,class categorical distribution distribution the categorical distribution is closely related to the onehotcategorical and multinomial distributions the categorical distribution can be as generating samples according to argmax onehotcategorical probs itself being identical to argmax multinomial probs total count 1 being identical to argmax multinomial probs total count 1 mathematical details class categorical distribution distribution the number of classes k must not exceed the largest integer representable by self dtype i e 2 mantissa bits 1 2 mantissa bits 1 ieee 754 the maximum tensor index i e 2 31 1 in other words ,fix typos in the comment for the class categorical piperorigin revid , fix a typo in the docstring of the docstring change
1249,mlircontext context value val unsigned numdims unsigned numsymbols affineexpr d value nullptr auto constant val getdefininginst val getdefininginst dyn cast constantindexop nullptr auto inst val getdefininginst auto constant inst inst dyn cast constantindexop oppointer constantindexop if constant d getaffineconstantexpr constant getvalue context else if isvalidsymbol val isvaliddim val ,edsc hotfix avoid implicit oppointer optype conversion an implicit oppointer optype conversion results in triggering a stack use after scope error which may be a false positive avoid using such patterns to make life good again piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
1250,class variabledevicechooser object num tasks 0 job name 'ps' device type 'cpu' device index 0 device index 0 replica none initialize variabledevicechooser usage class variabledevicechooser object self job name job name self device type device type self device index device index self replica replica self num tasks num tasks self next task id 0 def call self op device spec tf device devicespec device type self device type device index self device index device spec tf device devicespec replica self replica device type self device type device index self device index if self num tasks 0 task id self next task id self next task id self next task id 1 self num tasks ,adds support for explicitly assigning the replica to the variabledevicechooser this is necessary for when the device with replica is set in a surrounding arg scope piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
1251,def indicator column categorical column python name indicator column categorical column with vocabulary list 'name' 'name' columns name features tf io parse example features make parse example spec columns dense tensor input layer features columns ,add a missing in the comment of indicator column piperorigin revid change id , fix a bug in the docstring of the documentation of the documentation of the example change
1252,class quantizev2op public opkernel divide by max range min range to get to 0 1 0 multiply by range of t after that shift left 1 2 range of t if t is signed note that std round is used to round the number before the cast std round implements round half away zero note that the number is rounded before the cast rounding follows the semantic of std round which implements round half away zero e g 5 5 gets rounded to 6 5 4 goes to 5 5 4 goes to 5 and 5 5 goes to 6 auto o output template flat t class quantizev2op public opkernel min range scale factor half range unaryexpr std function float float round round template cast t else the fast path that avoids unaryexpr ,use the native eigen round method instead of std function float float round which doesn't get vectorized and doesn't compile with gcc see change , fix a bug in the new delegate piperorigin revid
1253,class decodecsvoptest test testcase out sess run decode for i field in enumerate out if field dtype np float32 if field dtype np float32 or field dtype np float64 self assertallclose field expected out i else self assertallequal field expected out i class decodecsvoptest test testcase self test args expected out def testdouble self args records 1 0 1 308 ' 1 308 ' record defaults np array dtype np double expected out 1 0 1 308 1 308 self test args expected out def testint64 self args records 1 2 ' 2147483648 ' ,add test cases for double support of tf decode csv signed off by yong tang yong tang github outlook com , fix a bug in the documentation of the test case piperorigin revid
1254,class symbolicgradientbuilder gradients for the node associated with src status const output dst grad const output src adds a node to the graph returned in grad that sums the in bound adds a node to the graph returned in grad that sums the in bound gradients to src if there are more than one status const output src output grad ,add white spaces , fix a bug in the graph piperorigin revid change id iefadbcddfecfad
1255,status loadsavedmodel const sessionoptions session options set optimize for static graph true todo mrry consider the session creation to reduce peak ram consumption by using session create graphdef tf return if error loadsavedmodel session options run options export dir tf return if error loadsavedmodel rewritten options run options export dir tags legacy bundle bundle absl make unique std move legacy bundle session ,actually apply optimize for static graph in due to a typo we were not passing the rewritten session options to the session that creates even though session extend is prevented by the piperorigin revid , xla gpu support for the layout of the input shape inference piperorigin revid
1256,class testobjectvar basetestcase def testemptycollectionaslist self test getting an empty collection as a list typename pkg testnumberarrays udt numberlist typename udt array typeobj self connection gettype typename obj typeobj newobject self assertequal obj aslist ,use an object type that is supported in both and , patch problem when using a terminal window is a bit solution add a test for the file
1257,class tf test testcase with self assertraisesoperror is closed and has insufficient elements sess run take t 0 def self cancel with self test session as sess b data flow ops barrier tf float32 tf float32 shapes name b take t b take many 1 allow small batch true sess run b close cancel with self assertraisesoperror is closed and has insufficient elements sess run take t def self self cancel false self cancel true def self cancel with self test session as sess b data flow ops barrier ,fix an bug in sqss when the barrier is closed the user allows small batch and no elements are left anywhere in the barrier an exception should be raised the current buggy behavior is to simply return an output with elements change , fix a bug in the test case piperorigin revid
1258,const char get proto name unsigned int proto unsigned int i for i 0 i trinity pf max i for i 0 i array size protocols i if protocols i proto proto return protocols i name return null void find specific proto const char protoarg else we were passed a numeric arg for i 0 i trinity pf max i for i 0 i array size protocols i if specific proto protocols i proto break if i trinity pf max if i array size protocols outputerr protocol unknown pass a numeric value 0 d or one of trinity pf max for i 0 i array size protocols i outputerr s protocols i name ,net protocols use array size helper we're looking up over protocols array so use appropriate helper here instead of trinity pf max constant signed off by cyrill gorcunov gorcunov openvz org , patch problem when using a terminal window doesn't work solution add a test for the mouse event
1259,addtogroup flatbuffers javascript api cond flatbuffers internal const namespace var flatbuffers ,js add namespace annotation to namespaces , fix a bug in the parser test for the new code
1260,def defaultgradys grad ys def istrainable tensor dtype dtypes as dtype tensor dtype return dtype base dtype in dtypes float16 dtypes float32 dtypes float64 dtypes complex64 dtypes complex128 dtypes complex64 dtypes complex128 dtypes resource def isbackpropagatable tensor ,fix resource variable in cond gradient piperorigin revid , tf data dataset to tf data dataset piperorigin revid
1261,class memorystatsop public opkernel const allocatorstats allocator stats const 0 op that measures current memory in bytes class bytesinuseop public memorystatsop public explicit bytesinuseop opkernelconstruction context memorystatsop context private int64 const allocatorstats allocator stats const override return allocator stats bytes in use register this op on gpu only see comment for maxbytesinuse for reason register kernel builder name bytesinuse device device gpu hostmemory out bytesinuseop ifdef tensorflow use sycl register kernel builder name bytesinuse device device sycl hostmemory out maxbytesinuseop endif tensorflow use sycl op that measures the total memory in bytes of a device class byteslimitop public memorystatsop public ,add new op similar to maxbytesinuse add new op similar to maxbytesinuse incorporate pr suggestions improve test fix make test more strict , fix a bug in the test case piperorigin revid
1262,void opconvertertest test 3 1 2 2 1 1 2 1 3 3 4 3 5 5 6 5 true testparams 1 2 3 0 0 1 2 3 1 2 3 4 5 6 false testparams 3 2 2 0 1 0 1 2 2 1 2 3 4 false testparams 2 3 1 2 0 1 0 1 1 2 3 1 2 3 4 5 6 false testparams 1 2 3 0 0 2 3 1 2 3 4 5 6 false testparams 3 2 2 0 1 0 2 2 1 2 3 4 false testparams 2 3 1 2 0 1 0 1 2 3 1 2 3 4 5 6 false ok ,fixes for weights param input , fix a bug in the test case piperorigin revid
1263,void tensor checktypeandisaligned datatype expected dtype const check eq dtype expected dtype datatypestring expected dtype expected got datatypestring dtype check isaligned checktypeandisaligned check isaligned ptr base void void tensor checkisalignedandsingleelement const ,improve error message in tensor cc when isaligned test fails by logging offending ptr value piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id idadabbfadafcd
1264,limitations under the license include tensorflow core framework register types h include tensorflow core kernels reduction gpu kernels cu h include tensorflow core kernels reduction ops common h include tensorflow core kernels reduction ops gpu kernels h namespace tensorflow class gpudevice t public opkernel constants gpudevice constants functor t cub sum t inputitertype reductionaxes context t output flat t data input itr 1 input flat t size 1 1 0 constants kzero cub sum t 0 input flat t size 1 1 0 constants kzero cub sum ,switch the softmax to use the new deterministic reductions on the gpu results in a speed up of x on the existing imagenet benchmarks and x on the newly added transformer benchmarks update the benchmark to also run on the gpu remove duplicate cpu tests piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1265,public real s3 x x0 inv dx real ii floor s3 auto i static cast decltype y size ii real t s3 ii real t s3 ii velocity real v0 dy i ,consolidate cubic hermite hpp and cardinal cubic hermite hpp ci skip , fix a bug in the parser test piperorigin revid
1266,ml recover pp pb pointer idx line count pp pb pointer idx line count page count pp pb pointer idx page count idx 0 continue ,updated for version problem when recovering a file a range of lines is missing charles solution reset the index when advancing to the next pointer block add a test to verify recovery works , fix a bug in the parser test piperorigin revid
1267,from future import print function import numpy as np import tensorflow as tf from six moves import xrange pylint disable redefined builtin valid fft ranks 1 2 3 ,add xrange from six to fft ops test to fix python , fix a bug in the test case piperorigin revid
1268,class unittestrecordpropertytestenvironment public environment this will test property recording outside of any test or test case static environment record property env gtest attribute unused static environment record property env addglobaltestenvironment new unittestrecordpropertytestenvironment this group of tests is for predicate assertions assert pred etc ,googletest export internal change piperorigin revid , xla python fix a bug in the client client piperorigin revid
1269,void single sample find df double m double sm double sd calculate df for single sided test double df students t find degrees of freedom fabs m sm alpha i alpha i sd convert to sample size convert to sample size always one more than the degrees of freedom double size ceil df 1 print size cout fixed setprecision 0 setw 16 right size ,added a new section on building to the docs added explanatory note to example added examples to test jamfile v svn r , patch problem when using a terminal window is a bit slow solution add a test for the gui
1270,def create low latency conv model fingerprint input model settings first filter height input time size first filter count 186 first filter stride x 1 first filter stride y 4 first filter stride y 1 first weights tf variable tf truncated normal first filter height first filter width 1 first filter count ,clarify low latency model stride length , fix a bug in the documentation of the new code piperorigin revid
1271,def sparse column with integerized feature column name dtype dtypes int64 creates an integerized sparsecolumn use this when your features are already pre integerized into int64 ids output id input feature use this when your features are already pre integerized into int64 ids that is when the set of values to output is already coming in as what's desired in the output integerized means we can use the feature value itself as id typically this is used for reading contiguous ranges of integers indexes but it doesn't have to be the output value is simply copied from the input feature whatever it is just be aware however that if you have large of unused integers it might affect what you feed those in for instance if you make up a one hot tensor from these the unused integers will appear as values in the tensor which are always zero args column name a string defining sparse column name ,clarified ambiguous documentation on sparse column with feature change , fix a bug in the docstring of the docstring of the docstring change
1272,string strjoin const string separator const args args return absl strjoin args list separator merge the given args in the format of arg1 arg2 argn e g 1 2 3 1 2 3 string std initializer list stringpiece args returns the dataset op name e g opname map mapdataset ,add helper and refactor , xla python fix a bug in the hlo computation piperorigin revid
1273,class hlocomputation const string name const return name void set name const string name name name return a string representation of the computation string tostring const class hlocomputation internal helper to collect unreachable roots std vector hloinstruction collectunreachableroots const const string name string name hloinstruction root instruction module containing this computation ,xla hlo change hlomodule to ensure computation names are unique change , xla gpu support for the xla client piperorigin revid
1274,class fftshifttest test testcase parameterized testcase shifted 1 3 2 2 0 1 4 3 4 self assertallequal fft ops fftshift freqs axes 0 1 shifted self assertallequal fft ops ifftshift shifted axes 0 1 freqs self assertallequal fft ops fftshift freqs axes 1 fft ops fftshift freqs axes 1 self assertallequal fft ops ifftshift shifted axes 1 fft ops ifftshift shifted axes 1 if name main ,add additional test case of scalar e g axis negative axis support for tf signal ifftshift signed off by yong tang yong tang github outlook com , fix a bug in the test case piperorigin revid
1275,flags define string 'project' none 'name of gcp project with tpu ' flags define string 'zone' none 'name of gcp zone with tpu ' expected devices pre connect ' job localhost replica 0 task 0 device cpu 0' ' job localhost replica 0 task 0 device xla cpu 0' ' device cpu 0' ' device xla cpu 0' expected devices after connect ' job localhost replica 0 task 0 device cpu 0' ' job localhost replica 0 task 0 device xla cpu 0' ' device cpu 0' ' device xla cpu 0' ' job worker replica 0 task 0 device cpu 0' ' job worker replica 0 task 0 device xla cpu 0' ' job worker replica 0 task 0 device tpu system 0' ,update test device names piperorigin revid change id , fix a bug in the test case piperorigin revid
1276,def random flip up down image seed none example usage import numpy as np image np array 1 2 3 4 tf image random flip up down image 3 numpy tolist 3 4 1 2 randomly flip multiple images images np array 1 2 3 4 ,fix the docstring in random flip up down piperorigin revid change id , fix a bug in the docstring of the docstring of the new api change
1277,class warmstartsettings var name to vocab info optional dict of variable names strings to tf estimator vocabinfo the variable names should be full variables not the names of the partitions if not explicitly provided the variable is assumed to have no vocabulary is assumed to have no changes to vocabulary var name to prev var name optional dict of variable names strings to name of the previously trained variable in ckpt to initialize from if not explicitly provided the name of the variable is assumed to be same ,expose an axis argument for which allows for warm starting of the second axis of tensors through tf train warm start note that the underlying initializer already has this functionality for example for output layers piperorigin revid , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary solution add a test for the line
1278,static char features static int included patches add new patch number below this line 552 ,updated for version problem with double width characters and 'listchars' containing precedes the text is displayed one cell off solution check for double width character being overwritten by the precedes character yasuhiro matsumoto , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1279,def get tensor from tensor info tensor info graph none import scope none spec struct coder decode proto spec proto components get tensor component name for component in tensor info composite tensor components return spec from components components return spec from components components pylint disable protected access else raise valueerror invalid tensorinfo encoding s encoding ,kpl sequence template using ragged input piperorigin revid change id , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
1280,string summarizeattrvalue const attrvalue attr value std vector string pieces if attr value list s size 0 for int i 0 i attr value list s size i pieces push back attr value list s i pieces push back attr value list s i else if attr value list i size 0 for int i 0 i attr value list i size i ,restore escaping to string attribute list summaries accidentally removed by previous change piperorigin revid , fix a bug in the test case piperorigin revid
1281,class multigrpcchannelcache public cachinggrpcchannelcache void listworkers std vector string workers override void listworkers std vector string workers const override for grpcchannelcache cache caches cache listworkers workers class sparsegrpcchannelcache public cachinggrpcchannelcache sparsegrpcchannelcache override void listworkers std vector string workers override void listworkers std vector string workers const override workers reserve workers size host ports size for const auto id host port host ports workers emplace back makeaddress job id id host port first ,mark listworkers as const change , fix a bug in the new delegate piperorigin revid
1282,bool isprint const nodedef node return node op print bool isprod const nodedef node return node op prod bool const nodedef node return str util endswith node op bool israndomshuffle const nodedef node return node op randomshuffle ,simplified shape inference piperorigin revid , add a test for the graph and the graph piperorigin revid
1283,int dpiconn create const dpicontext context const char username return dpigen endpublicfn context dpi failure error newpassword and edition cannot be specified at the same time if createparams newpassword createparams 0 commonparams edition commonparams editionlength 0 dpierror set error check edition new password dpi err no edition with new password return dpigen endpublicfn context dpi failure error handle case where pool is specified if createparams pool if dpigen checkhandle createparams pool dpi htype pool ,edition is not supported effectively the edition value is ignored when specifying a new password so add a specific error for that situation to avoid potential confusion , fix a bug in the client client client client
1284,class mkllayoutrewritepass public graphoptimizationpass getconv2dbackpropfilterorbiasaddgrad the fusion patterns in finfo that show up first will get applied first for example graph a b c d and finfo is a b c to abc a b c d to abcd since the first gets applied first the final graph will be abc d first for example graph a b c d and finfo is a b c to abc a b c d to abcd since the first gets applied first the final graph will be abc d add rules to fuse sequences such as transpose nchw nhwc conv2d ,format a wired comment made by clang format , xla gpu support for the layout of the input dimension piperorigin revid
1285,apply autocmds group event fname fname io force group buf eap ifdef feat profile proftime twait time endif intdid save redobuff false quickly return if there are no autocommands for this event or apply autocmds group event fname fname io force group buf eap if autocmd busy save search patterns saveredobuff if ins compl active saveredobuff did save redobuff true did filetype keep filetype apply autocmds group event fname fname io force group buf eap if autocmd busy restore search patterns restoreredobuff if did save redobuff restoreredobuff did filetype false while au pending free buf null ,updated for version problem when using insert mode completion combined with autocommands the redo command may not work solution do not save the redo buffer when executing autocommands yasuhiro matsumoto , patch problem when using a terminal window is a bit slow solution add a test for the gui
1286,inline realtype quantile const fisher f distribution realtype policy dist co realtype df2 dist degrees of error check realtype error result 0 if false detail check df if false detail check df function df1 error result policy detail check df function df2 error result policy detail check probability function p error result policy function p error result policy return error result with optimizations turned on gcc wrongly warns about y being used ,add boilerplate code for testing most domain errors in the distributions update the non central distributions to make use of it svn r , fix a bug in the new parser test svn r
1287,ex cexpr exarg t eap evaluate the expression when the result is a string or a list we can use it to fill the errorlist tv eval expr eap arg null tv eval expr eap arg eap nextcmd if tv null if tv v type var string tv vval v string null ,patch cexpr does not handle in expression problem cexpr does not handle in expression solution remove ex and set pointer , patch problem when using a terminal window is a bit slow solution add a test for the test
1288,syscall define3 mincore unsigned long start size t len unsigned char user vec include stdlib h include arch h include maps h include sanitise h include shm h static void sanitise mincore int childno struct map map unsigned long len map common set mmap ptr len childno len map size page size 1 page size shm a3 childno unsigned long malloc len shm scratch childno shm a3 childno static void post mincore int childno free void shm a3 childno struct syscallentry syscall mincore name mincore num args 3 arg1name start arg1type arg address arg1type arg mmap arg2name len arg2type arg len arg3name vec arg3type arg address group group vm sanitise sanitise mincore post post mincore ,make mincore operate only on map structs and also alloc free a struct for the vec argument instead of randomly scribbling over something , make the syscall page we can be a bit more than the syscall process
1289,void benchmarkperformanceoptions createperformanceoptions if benchmark all hasoption gpu if defined android const std vector bool allow precision loss true false const std vector int32 t gl obj types tflite gl object type texture tflite gl object type buffer for const auto precision loss allow precision loss for const auto obj type gl obj types benchmarkparams params params addparam use gpu benchmarkparam create bool true params addparam gpu precision loss allowed benchmarkparam create bool precision loss all run params emplace back std move params benchmarkparams params params addparam use gpu benchmarkparam create bool true params addparam gpu precision loss allowed benchmarkparam create bool precision loss all run params emplace back std move params endif note by default gpu delegate allows to operate on lower precision and ,switch tflite benchmark from gl delegate to delegate that combines opencl and opengl piperorigin revid , xla python fix a bug in the graph piperorigin revid
1290,ex help exarg t eap intold keytyped keytyped endif if error if any popup window return if eap null a help command ends at the first lf or at a ' ' that is ,patch can use help in a terminal popup window problem can use help in a terminal popup window solution give an error closes , patch problem when using a terminal window is a bit slow solution add a test for the test
1291,class filestream public tensorflow protobuf io zerocopyinputstream pos count return true int64 bytecount const override return pos protobuf int64 bytecount const override return pos status status const return status bool next const void data int size override ,fix prototype mismatch of bytecount in env cc change , xla gpu support for the layout of the client backend piperorigin revid
1292,author wan google com zhanyong wan include gtest gtest h include h include gtest gtest h namespace tests the increment method test counter increment counter c test counter increment expect eq 1 c increment expect eq 2 c increment namespace ,small cleanups merge , fix a bug in the toy tutorial change id ibacfeebdbeaada
1293,status tensorformat format dimensionorconstant n if format format nchw vect c dims actual num dims format context makedim 4 else if format format nhwc vect w dims actual num dims format context makedim 4 for int spatial dim 0 spatial dim spatial size spatial dim dims actual gettensorspatialdimindex num dims format spatial dim ,support nhwc vect w in piperorigin revid , add a test for the new op op piperorigin revid
1294,class hparams object del self hparam types name def parse self values override existing hyperparameter values parsing new values from a string see parse values for more detail on the allowed format for values ,add to docstring , fix a bug in the documentation of the documentation of the documentation of the example to the new api change
1295,statusor xlacomputation xlabuilder build int64 root id return appendstatus first error backtrace todo b xla backend cannot handle dynamic dimensions yet remove all dynamic dimensions before building xla program until we have support in the backend std function void shapeproto remove dynamic dimension shapeproto shape if shape tuple shapes size 0 for int64 i 0 i shape tuple shapes size i remove dynamic dimension shape mutable tuple shapes i for int64 i 0 i shape dimensions size i shape set is dynamic dimension i false for auto instruction instructions remove dynamic dimension instruction mutable shape hlocomputationproto entry entry name knameseparator getnextid tf assign or return programshape program shape getprogramshape root id ,remove dynamic dynamic dimensions in xlabuilder build xla backend cannot handle dynamic dimension yet remove all dynamic dimensions before building xla program until we have support in the backend piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id iadbdbdeeebea
1296,import six from tensorflow python estimator export import export output as export output lib from tensorflow python framework import ops from tensorflow python framework import tensor shape from tensorflow python framework import tensor util from tensorflow python keras metrics import metric from tensorflow python ops import array ops from tensorflow python saved model import signature constants class tpuestimatorspec def check is tensor or operation x name if not isinstance x ops operation or isinstance x ops tensor if not isinstance x ops operation or tensor util is tensor x raise typeerror ' must be operation or tensor given ' format name x ,modified check is tensor or operation to check if x is tensor like , fix a bug in the docstring of the test piperorigin revid
1297,from future import print function import time from six moves import xrange from tensorflow contrib import rnn as contrib rnn from tensorflow contrib cudnn rnn python ops import cudnn rnn ops from tensorflow contrib rnn python ops import lstm ops ,from six moves import xrange , fix a bug in the test case piperorigin revid
1298,def train mnist estimator data dir num epochs use fake data false return tf estimator estimatorspec mode mode loss loss train op train op training hooks hooks run config tf estimator runconfig model dir tmp mnist save checkpoints steps 1 keep checkpoint max 100 train until input fn is empty with estimator this is a for tpu compatibility estimator tf estimator estimator model fn model fn estimator tf estimator estimator model fn model fn config run config estimator train input fn input fn ,k fac expose set global constants for tf contrib kfac utils piperorigin revid , update keras layers to keras piperorigin revid
1299,set ref in timer int copyid return abort if defined exitfree defined proto void timer free all timer t timer while first timer null timer first timer remove timer timer free timer timer endif endif if defined feat syn hl defined feat reltime defined feat float ,patch problem pending timers cause false memory leak reports solution free all timers on exit , patch problem when using a terminal window is a bit slow solution add a test for the command line
1300,std vector const nodedef computetransitivefanin const nodedef node name to node nodename root if node ill formed true vlog 2 computetransitivefanin problem with root node root return queue push back node std vector const nodedef computetransitivefanin for const string input node input const nodedef in name to node nodename input if in vlog 2 computetransitivefanin problem with node input ill formed true return ,log more info about the ill formed node in computetransitivefanin piperorigin revid , fix a bug in the graph piperorigin revid
1301,static char features static int included patches add new patch number below this line 1237 1236 ,patch set scroll often gives an error problem set scroll often gives an error solution don't use a fixed default value use half the window height add a test ozaki kiichi closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1302,static void environment raiseerror pyobject exceptiontype udt error error error error new environment context error error new environment context 1 if error switch error errornumber case 1 ,use a cx oracle error instance rather than a string to hold the error as requested by , fix a bug in the new client client client test
1303,static long mkcall int call else printf n void fflush stdout if the syscall doesn't exist don't bother calling it next time if ret enosys syscalls call flags avoid syscall return ret ,don't repeatedly call ni syscall , fix a bug in the watchdog process
1304,class quantizationmode object for node def in self graph def node if any op in node def name for op in training quant ops if node def op in training quant ops return true return false ,fix the check used to determine training quantization ops piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
1305,public moduletranslation override protected bool operation opinst llvm irbuilder builder override logicalresult operation opinst llvm irbuilder builder override include mlir llvmir inc ,translation to llvm ir use logicalresult instead of bool the translation code the introduction of logicalresult and was relying on the obsolete llvm convention of returning false on success change it to use mlir's logicalresult abstraction instead nfc piperorigin revid , xla gpu support for the hlo instruction piperorigin revid change id icabdabcccecababba
1306,int main int argc char argv exit exit failure if logging 0 open logfiles shm nr childs open logfiles max nr syscalls nr syscalls for i 0 i max nr syscalls i ,open logfiles doesn't take a parameter , make the watchdog process to be a child process
1307,static int cause abort false until the throw point for error messages has been reached that is during cancellation of an expression evaluation after an aborting function call or due to a parsing error aborting always returns the same value got int is also set by calling interrupt int aborting void ,patch not so easy to interrupt a script problem not so easy to interrupt a script solution add the interrupt function yasuhiro matsumoto closes , patch problem when using a terminal window is a bit solution add a test for the file
1308,boost auto test case template test non integral arithmetic relations t non int boost check equal a t 0 5 a t 2 boost auto test case template test cont and pp t integral test types polynomial t const a begin end boost check equal a content a primitive part a ,content and primitive part of a polynomial over a ufd , fix a bug in the parser test for the new code svn r
1309,class constantfoldingtest public testing test construct the following graph s1 s2 m1 m2 a b c s1 s2 m1 m2 a b c define simple graph reset graph g g get ,tensorflow fix a bunch of remaining warnings cpu linux change , fix a bug in the test case piperorigin revid
1310,from tensorflow python framework import tensor shape from tensorflow python ops import array ops from tensorflow python ops import gen array ops from tensorflow python ops import gen math ops from tensorflow python ops import gradients impl from tensorflow python ops import math ops from tensorflow python ops import resource variable ops from tensorflow python ops unconnected gradients import unconnectedgradients from tensorflow python platform import tf logging as logging from tensorflow python util import nest from tensorflow python util import tf contextlib class gradienttape object target sources output gradients none unconnected gradients gradients impl unconnectedgradients none unconnected gradients unconnectedgradients none computes the gradient using operations recorded in context of this tape args ,extract from gradients impl to simplify dependencies piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1311,from future import print function import numpy as np from tensorflow python framework import random seed from tensorflow python ops import linalg ops from tensorflow python ops linalg import linalg as linalg lib from tensorflow python ops linalg import linear operator addition from tensorflow python platform import test linalg linalg lib random seed set random seed 23 rng np random randomstate 0 add operators linear operator addition add operators ,avoid extra calls to set random seed as it is already called in tensorflowtestcase piperorigin revid , fix a bug in the test case piperorigin revid
1312,struct map common set mmap ptr len void rec a1 unsigned long map ptr rec a2 map size todo munge this rec a2 rand map size rec a2 page mask return map ,munge the size in common set mmap ptr len , fix a bug in the watchdog process
1313,static char features static int included patches add new patch number below this line 595 594 ,updated for version problem the x command server responds slowly solution change the loop that waits for brian burns , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1314,def make export strategy serving input fn an exportstrategy that can be passed to the experiment constructor exports the given estimator as a savedmodel args estimator the estimator to export export dir base a string containing a directory to write the exported graph and checkpoints checkpoint path the checkpoint path to export if none the default the most recent checkpoint found within the model directory is chosen returns the string path to the exported directory def make export strategy serving input fn serving input fn default output alternative key default output alternative key assets extra assets extra as text as text as text as text checkpoint path checkpoint path garbage collect exports export dir base exports to keep return export result ,allow gating export on eval result and export exactly the checkpoint this also enables use cases where the exportstrategy internally generates an updated checkpoint for export change , fix a bug in the docstring of the docstring of the docstring change
1315,test floatactivationsoptest prelu class public singleopmodel public const tensordata input float alpha input addinput input output addoutput input setbuiltinop builtinoperator leaky relu builtinoptions builder alpha union buildinterpreter getshape input void setinput std initializer list float data populatetensor input data std vector float getoutput return extractvector float output protected int input int output test floatactivationsoptest leakyrelu m tensortype float32 2 3 0 5f m setinput 0 0f 1 0f 3 0f row 1 1 0f 1 0f 2 0f row 2 m invoke expect that m getoutput elementsarearray 0 0f 1 0f 3 0f row 1 1 0f 0 5f 1 0f row 2 namespace namespace tflite ,add support for leakyrelu piperorigin revid , fix a bug in the graph piperorigin revid
1316,args done sleep 1 ia64 is retarde wspecial ifdef ia64 call 1024 endif some architectures ia64 mips start their linux syscalls at non zero and have other abis below call syscall offset ret do syscall childno sptr string ,support architectures with a non zero syscall base in a cleaner way , fix a bug in the watchdog page
1317,class mapdefuntest test base datasettestbase values 1 2 1 2 dense shape 2 3 4 actual self evaluate deserialized self assertsparsevaluesequal expected actual self expected actual def self class mapdefuntest test base datasettestbase values 1 2 1 2 dense shape 2 3 4 actual self evaluate deserialized self assertsparsevaluesequal expected actual self expected actual def self class mapdefuntest test base datasettestbase values 1 2 1 2 dense shape 2 3 4 actual self evaluate deserialized self assertsparsevaluesequal expected actual self expected actual if name main ,tf data consolidating testing utility piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1318,def flattentostrings nested strings tensor content types frozenset dtypes float32 dtypes float64 dtypes int32 dtypes uint8 dtypes int16 dtypes int8 dtypes int64 dtypes int8 dtypes int64 dtypes qint8 dtypes quint8 dtypes qint32 ,in tensor util py serialize quantized int values using tensor content instead of packed repeated fields change , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
1319,class trainingtest test testcase verbose 2 model train on batch input a np input b np output d np output e np test model with input data as a list of lists model fit np ndarray tolist input a np np ndarray tolist input b np output d np output e np epochs 2 batch size 5 verbose 2 test with validation data model fit input a np input b np output d np output e np class trainingtest test testcase with self assertraises valueerror model fit input a np input a np output d np epochs 1 test model on a list of floats input a np np random random 10 3 input b np np random random 10 4 model fit np ndarray tolist input a np np ndarray tolist input b np epochs 2 batch size 5 verbose 2 def test evaluate predict on arrays self with self test session a keras layers input shape 3 name 'input a' ,fix standardize input data function to allow users to use list of ints floats and list of lists as training and validation data input piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1320,def get regularization losses scope none scope an optional scope for filtering the losses to return returns a list of loss variables a list of regularization losses as tensors return ops get collection ops graphkeys regularization losses scope ,clarify documentation on a deprecated fn change , fix a bug in the docstring of the docstring of the docstring change
1321,default engines 'afl' 'honggfuzz' 'libfuzzer' default sanitizers 'address' 'undefined' languages from project yaml that have code coverage support languages with coverage support 'c' 'c ' languages with coverage support 'c' 'c ' 'go' def get changed files ,golang project uses compile go fuzzer script golang project uses compile go fuzzer script kubernetes project uses compile go fuzzer script adds golang to ci builds fixup golang coverage with go modules cf project , patch problem when using a terminal window is a bit solution add a test for the file
1322,static void do setsockopt struct sockopt so this should catch new options we don't know about and also maybe some missing bounds checks if rand 100 10 so optname 1 rand 32 so optname 1ul rand 32 optval should be nonzero to enable a boolean option or zero if the option is to be disabled let's disable it half the time ,fix yet another sign bit error , fix a bug in the watchdog process
1323,statusor bool reduceprecisioninsertion run hlomodule module equivalent behavior can be obtained by adding reduceprecision instructions after the instructions that pull the f32 arrays out of the tuples todo b 64093391 remove the isscalar check once this won't cause failures on the gpu backend if the reduceprecision instruction ends up inserted between a scalar constant and the init value argument of a reduce operation if instruction shape element type primitivetype f32 shapeutil isscalar instruction shape should reduce output precision instruction opcode ,xla add todo comment explaining why the isscalar check exists piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
1324,class eagertest xlatestcase grads backprop implicit grad f self assertequal 2 grads 0 0 numpy def self todo b currently whenever we read a variable by going through xla we create a copy this leads large memory usage self skiptest 'when variable is read through xla a copy is created ' with self test scope create 128mib variables var resource variable ops resourcevariable array ops ones 32 1024 1024 read the same variable 100 times if the underlying tensor is not copied this is a trivial operation if it is copied this will eat over 13gb and oom values for in range 100 values append var value class eagerfunctiontest xlatestcase ,add a test to reproduce copy on read bug for variables piperorigin revid , fix a bug in the test case piperorigin revid
1325,def get build results server for job in server get jobs 1 try name job if not name startswith 'targets ' if not name startswith 'projects ' continue print name library name len 'targets ' library name len 'projects ' info server get job info name last build number info 'lastcompletedbuild' 'number' ,infra using project instead of target , infra fix a bug in the documentation of the new version of the client client client piperorigin revid
1326,gpudriver contextgetsharedmemconfig gpucontext context uint64 bytes scopedactivatecontext activated context t result 0 hiperror t res tensorflow wrap result bytes hiperror t res tensorflow wrap result bytes if res hipsuccess log error failed to allocate port humanreadablenumbytes tostring bytes bytes gpudriver contextgetsharedmemconfig gpucontext context scopedactivatecontext activation context void host mem nullptr portable memory is visible to all rocm contexts safe for our use model hiperror t res tensorflow wrap hiperror t res tensorflow wrap host mem bytes if res hipsuccess log error failed to alloc bytes ,removing the workaround for , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
1327,memoryspaceassignment run void memoryspaceassignment allocation adduse hlouse use hloinstruction operand use instruction mutable operand use operand number if the use is a tuple look inside the tuple to find the actual use for int64 index use operand index if operand opcode hloopcode ktuple break operand operand mutable operand index when the operand of a use is a bitcast we place the bitcast in a separate data structure if operand opcode hloopcode kbitcast ,xla fix broken tuple bitcast pattern in memory space assignment piperorigin revid change id , xla gpu support for the hlo client client piperorigin revid change id icbbdbfafcdfcae
1328,ga grow gap n garray t gap intn size tlen size told len size tnew len char u pp if gap ga maxlen gap ga len n if n gap ga growsize n gap ga growsize len gap ga itemsize gap ga len n pp alloc clear unsigned len new len gap ga itemsize gap ga len n pp gap ga data null alloc new len vim realloc gap ga data new len if pp null return fail old len gap ga itemsize gap ga maxlen vim memset pp old len 0 new len old len gap ga maxlen gap ga len n if gap ga data null mch memmove pp gap ga data size t gap ga itemsize gap ga len vim free gap ga data gap ga data pp return ok ,updated for version problem re allocating memory slows vim down solution use realloc in ga grow dominique pelle , patch problem when using a terminal window is a bit solution add a test for the current buffer
1329,def convert image dtype image dtype saturate false name none note that converting from floating point inputs to integer types may lead to over underflow problems set saturate to true to avoid such problem in problematic conversions saturation will clip the output into the allowed range before performing a potentially dangerous cast i e when casting from a floating point to an integer type or when casting from an signed to an unsigned type problematic conversions if enabled saturation will clip the output into the allowed range before performing a potentially dangerous cast and only before performing such a cast i e when casting from a floating point to an integer type and when casting from a signed to an unsigned type saturate has no effect on casts between floats or on casts that increase the range args image an image ,make the behavior of convert image dtype more explicit in the docs change , fix a bug in the docstring of the docstring of the docstring change
1330,def model to dot model show shapes false show layer names true rankdir 'tb' rebuild the label as a table including input output shapes if show shapes def format shape shape return str shape replace str none ' ' try str layer output shape format shape layer output shape except attributeerror if hasattr layer 'input shape' str layer input shape format shape layer input shape elif hasattr layer 'input shapes' ' ' join str for in layer input shapes ' ' join format shape for in layer input shapes else label ' s n input output s s ' label ,compact rendering of layer i o shapes in plot model , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
1331,class cancellationmanager class graphdef class opkernel class resourcemgr class rendezvous class scopedstepcontainer class stepstatscollector class node class functionlibraryruntime does not take ownership of rets struct options cancellationmanager cancellation manager nullptr the id of the step that is calling this function int64 step id 0 per step container rendezvous rendezvous nullptr cancellationmanager cancellation manager nullptr scopedstepcontainer step container nullptr stepstatscollector stats collector nullptr ,plumbs rendezvous through function calls piperorigin revid , tf data service support for tf data dataset piperorigin revid
1332,struct task struct endif ifdef config dtrace uint32 t cycle t dtrace vtime cycle t dtrace start cycle t dtrace stop cycle t dtrace sig t dtrace vtime t dtrace start uint8 t dtrace stop uint8 t dtrace sig void dtrace helpers endif ,fix incorrect datatypes in the task structure and add initializer values to surpress warnings , fix a bug in the toy tutorial change id iccdafadfdbd
1333,static void u u entry t long static void corruption error char mesg char u file name static void u free uhp u header t uhp static int undo write bufinfo t bi char u ptr size t len ifdef feat crypt static int undo flush bufinfo t bi endif static int fwrite crypt bufinfo t bi char u ptr size t len static int undo write bytes bufinfo t bi long u nr int len static void put header ptr bufinfo t bi u header t uhp ,patch problem compiler warning when not building with crypt solution add ifdef john marriott , patch problem when using a terminal window is a bit slow solution add a test for the gui
1334,limitations under the license include mlir ir patternmatch h from llvm project include mlir pass pass h from llvm project include mlir transforms dialectconversion h from llvm project include tensorflow compiler mlir tools kernel gen transforms passes h namespace mlir namespace kernel gen ,add bufferization pass that transforms hlo and some standard ops this is good enough to do a tanh operation piperorigin revid change id , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
1335,status convertgather opconverterparams params the input axis must be zero when params is a weight if params input is tensor indices input batch size 1 return errors invalidargument only indices with batch 1 are supported when params is a tensor return errors unimplemented indices must have a batch size of 1 when params is a tensor both input are tensors and the tf gather result will have rank params nbdims 1 indices nbdims 1 1 ,add test case for when indices has a batch size and params is a tensor , fix a bug in the test case piperorigin revid
1336,static void parse args int argc char argv set syscall loop counter case 'n' syscallcount strtoll optarg null 10 syscallcount strtoll optarg null 10 1 break pause after each syscall ,fix another off by one this time in n , make the syscall page from the syscall process
1337,class word2vec object opts self options with open os path join opts save path vocab txt w as f for i in xrange opts vocab size f write s d n tf compat as text opts vocab words i vocab word tf compat as text opts vocab words i encode utf 8 f write s d n vocab word opts vocab counts i def train thread body self ,fix wordvec when words contain chinese fix wordvec when words contain unicode fix coding conventions , fix a bug in the documentation of the documentation of the new version of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value piperorigin revid
1338,set one cmd context 3 skip over the range to find the command cmd skip range cmd xp xp context cmd skip range cmd true xp xp context xp xp pattern cmd if cmd nul return null ,patch vim is not recognized as a range problem vim is not recognized as a range solution move recognizing into skip range closes , patch problem when using a terminal window is a bit slow solution add a test for the command line
1339,static char features static int included patches add new patch number below this line 1870 1869 ,patch vim no need to keep all script variables problem vim no need to keep all script variables solution only keep script variables when a function was defined that could use them fix freeing static string on exit , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1340,free all mem entered true ifdef feat autocmd block autocmds don't want to trigger autocommands here don't want to trigger autocommands from here on block autocmds endif ifdef feat windows ,updated for version problem in some situations when setting up an environment to trigger an autocommand the environment is not properly restored solution check the return value of switch win and call restore win always daniel hahler , updated for version problem when using a dictionary of a dictionary of a character of a character solution check for the current window
1341,namespace tfl pass namespace returns the first result type of the given op type operation op return op result type begin todo antiagainst we need overload functions of the above to facilitate changes by declarative rewrite rules remove this post variadic operand support is improved nolintnextline type tf transposeop op return op gettype nolintnextline type tf reshapeop op return op gettype nolintnextline type value val return val gettype prepare tf operations in functions for subsequent legalization struct preparetfpass public functionpass preparetfpass void runonfunction override ,various clean ups after mlir updates use upstream to replace removed unused function overloads piperorigin revid , xla gpu support for the layout of the input dimension piperorigin revid
1342,invoke popup filter win t wp int c void mouse comp pos wp row col lnum null set vim var nr vv mouse lnum lnum set vim var nr vv mouse col col 1 set vim var nr vv mouse winid wp w id ,patch v mouse winid not set on click in popup window problem v mouse winid not set on click in popup window solution set v mouse winid closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
1343,inline void infiniteloop fprintf stderr s x while 0 define tflite assert false assert false define tflite abort abort ifdef ndebug define tflite assert false static cast void 0 else define tflite assert false tflite abort endif endif tf lite mcu debug log define tf lite fatal msg ,work around clangtidy bug it wrongly reports that assert false should be replaced by static assert false piperorigin revid , fix a bug in the new delegate piperorigin revid
1344,def op grad gradient for each of the 4 input tensors sparse indices sparse values sparse shape dense tensor the gradients for indices and shape are none raises typeerror when the two operands don't have the same type sp t ops sparsetensor op inputs 3 adj a op get attr adjoint a adj b op get attr adjoint b a type sp t values dtype b type op inputs 3 dtype assert a type b type a type sp t values dtype base dtype b type op inputs 3 dtype base dtype if a type b type raise typeerror sparsetensordensematmul op received operands with different types a type and b type is complex a type ops dtypes complex64 if is complex raise notimplementederror sparsetensordensematmul op does not support ,allows variables to be used in sparse tensor dense matmul change , tf data vectorization optimization to be a single device piperorigin revid
1345,class sliceassigntest xla test xlatestcase def testuninitialized self with self assertraisesregexp errors failedpreconditionerror read variable failure uninitialized with self session as sess self test scope v resource variable ops resourcevariable 1 2 sess run v assign 1 2 ,tf xla update an error message to include the word uninitialized because many tests depend on that word being in the error message additional update tests that search for an outdated error message to just search for uninitialized piperorigin revid change id , xla python fix a bug in the graph piperorigin revid
1346,struct stridedsliceassign template typename device typename t struct void operator const device d typename ttypes t 1 tensor output typename ttypes t 1 consttensor input output device d input namespace functor namespace tensorflow ,create gpu implementation of stridedsliceassign change , fix a bug in the parser delegate piperorigin revid change id ibaecfeaba
1347,static void regenerate void if syscalls todo shm regenerate return shm regenerating true sleep 1 give children time to finish with fds ,revert microoptimisation to exit faster when n is near regeneration point this reverts commit this looks suspect and is probably unnecessary conflicts main c , make the syscall page we can be a bit more than the syscall process
1348,static char features static int included patches add new patch number below this line 284 283 ,patch vim assignment test fails problem vim assignment test fails solution avoid duplicating s , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1349,std string c if z dst size w b batch size return n c accum flt4 s accum flt4 0 0f n c for int i 0 i src size w i n c flt4 v src tensor 0 0 i b n c flt4 v src tensor 0 0 i b textureaddressmode dont care n c flt4 m0 read image filters smp none int2 z 4 0 i n c flt4 m1 read image filters smp none int2 z 4 1 i n c flt4 m2 read image filters smp none int2 z 4 2 i n ,overloaded readd writed to make transition to batch support and general code generation easier to read piperorigin revid , fix a bug in the parser test piperorigin revid
1350,limitations under the license include tensorflow compiler xla service llvm ir fused ir emitter h include tensorflow compiler xla service llvm ir llvm loop h include tensorflow compiler xla service llvm ir llvm util h include tensorflow compiler xla service llvm ir ops h include tensorflow compiler xla service llvm ir tuple ops h include tensorflow compiler xla shape util h include tensorflow compiler xla status macros h include tensorflow compiler xla types h ,xla llvm rename ops h to tuple ops h i would like to reclaim ops h for a different purpose in a later patch it doesn't make sense to it all in the same header because fusediremitter uses tuple ops h but my new functions will use fusediremitter piperorigin revid , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
1351,static char features static int included patches add new patch number below this line 1565 1564 ,patch ms windows no sound support problem ms windows no sound support solution add sound support for ms windows yasuhiro matsumoto ken takata closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1352,void printonedim int dim index const gtl inlinedvector int64 4 shape we have reached the right most dimension of the tensor if dim index shape size 1 for int64 i 0 i element count i if data index limit return if data index limit if not enough elements has been printed append if i element count strings strappend result return if i 0 strings strappend result strings strappend result printoneelement data data index void printonedim int dim index const gtl inlinedvector int64 4 shape result if data index limit flag strings strappend result if data index limit if not enough elements has been printed in this dim append strings strappend result flag false ,fix tf print format bug this fix fixes the issue raised in where tf print may miss at the end with summarize this fix fixes signed off by yong tang yong tang github outlook com , fix a bug in the graph piperorigin revid
1353,class dynamicrnnestimatortest test testcase prediction key predictionkey classes true prediction key predictionkey probabilities true dynamic rnn estimator get state name 0 true 'dynamic rnn output' constants problemtype classification prediction key predictionkey classes true prediction key predictionkey probabilities true class dynamicrnnestimatortest test testcase prediction key predictionkey scores true dynamic rnn estimator get state name 0 true dynamic rnn estimator get state name 1 true 'dynamic rnn output' constants problemtype linear regression prediction key predictionkey scores true ,small fix to test for dynamic rnn estimator test error introduced during cl touchups change , fix a bug in the docstring of the docstring of the docstring change
1354,static inline status const tensor boxes if boxes dim size 1 4 return errors invalidargument boxes must have 4 columns for int64 i 0 i num boxes i for int64 j 0 j 4 j if isfinite boxes tensor float 2 i j return errors invalidargument boxes values must be finite received boxes i boxes tensor float 2 i 0 boxes tensor float 2 i 1 boxes tensor float 2 i 2 boxes tensor float 2 i 3 eigen tensor bool 0 eigen rowmajor check boxes tensor float 2 isfinite all if check return errors invalidargument boxes values must be finite the shape of 'box index' is num boxes if box index dims 1 ,change to use eigen to allow the check working on gpu signed off by yong tang yong tang github outlook com , fix a bug in the new delegate piperorigin revid
1355,bool isfusible const hloinstruction instr instr opcode hloopcode kdynamicupdateslice instr opcode hloopcode kfusion instr opcode hloopcode kgather instr opcode hloopcode kiota instr opcode hloopcode kpad instr opcode hloopcode kiota instr opcode hloopcode kpad instr opcode hloopcode kreduce instr opcode hloopcode kreducewindow instr opcode hloopcode kreshape ,fix formatting issues in , xla gpu support for the xla client piperorigin revid change id idaceccfcbacfece
1356,f listener add typval t argvars typval t rettv return lnr listener t alloc clear sizeof listener t lnr listener t alloc clear sizeof listener t if lnr null free callback callback partial ,patch unessesary type casts for lalloc problem unessesary type casts for lalloc solution remove type casts change lalloc size true to alloc size , patch problem when using a terminal window is a bit slow solution add a test for the gui
1357,statusor llvm value iremitter status iremitter handlereducewindow hloinstruction reduce window tf return if error elementtypessameandsupported instruction reduce window operands reduce window operand 0 supported types f32 bf16 s32 f16 pseudo code for reduce window for coordinates o in the output ,xla cpu remove explicit type whitelist for reducewindow in cpu backend pretty much any type should work here and i have a use case for bit integer types piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
1358,getvcol state normal wp w p list virtual active visual active p sel 'e' ltoreq pos visual visual active p sel 'e' ltoreq pos pos visual cursor vcol incr 1 cursor at end else colnr if pos1 pos2 if lt posp pos1 pos2 getvvcol wp pos1 null getvvcol wp pos2 null ,patch some macros are in lower case problem some macros are in lower case which can be confusing solution make a few lower case macros upper case , patch problem when using a terminal window is a bit slow solution add a test for the gui
1359,bool alternatememorybestfitheap findallocation if defining position instruction parent use instruction parent use instruction called computations empty use instruction called computations empty use instruction opcode hloopcode kfusion vlog 3 use is in a different computation or calls a computation fail because we do not allow asynchronous copies while in the bodies of other computation ,xla allow async copies to be consumed by fusions this was previously to prevent async copies from crossing computation boundaries for ops like kcall but we don't need to do the same for piperorigin revid , xla gpu support for the layout interface piperorigin revid change id iaaeabfdfedfeacedf
1360,limitations under the license include tensorflow core platform logging h include tensorflow core platform test h include tensorflow python tools compiled model h include tensorflow python tools aot compiled x plus y h namespace tensorflow namespace ,tf saved model cli aot more cleanup on build rules and always inline functions piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1361,class buildenvsetter object raise valueerror does not exist or is not executable format gcc path gcc output subprocess check output gcc path stderr subprocess stdout gcc output subprocess check output gcc path stderr subprocess stdout strip handle python2 vs 3 bytes vs str type if isinstance gcc output bytes gcc output gcc output decode utf 8 ,intel mkl fix for mkl builds in ubuntu containers , fix a bug in the test case piperorigin revid
1362,f assert fails typval t argvars typval t rettv goto theend if error found argvars 3 v type var number if error found argvars 2 v type var unknown argvars 3 v type var number argvars 3 vval v number 0 argvars 3 vval v number emsg assert fails lnum ,patch flaky failure in assert fails problem flaky failure in assert fails solution only used fourth argument if there is a third argument , patch problem when using a terminal window is a bit slow solution add a test for the gui
1363,limitations under the license include tensorflow core profiler convert xplane to op metrics db h include tensorflow core profiler protobuf hardware types pb h include tensorflow core profiler utils hardware type utils h include tensorflow core profiler utils tf xplane visitor h include tensorflow core profiler utils xplane schema h include tensorflow core profiler utils xplane utils h include tensorflow core profiler utils xplane visitor h namespace tensorflow namespace profiler namespace const xplane device plane cap xplanevisitor plane device plane xplanevisitor plane createtfxplanevisitor device plane if auto clock rate plane getstats kdevcapclockratekhz cap set clock rate in ghz clock rate int64 value 1000000 0 ,add in xplanevisitor piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1364,limitations under the license include unordered map include absl types optional h include mlir ir attributes h tf llvm project include mlir ir builders h tf llvm project include mlir ir function h tf llvm project class hlofunctionimporter mlir namedattribute convertscatterdimensionnumbers const xla scatterdimensionnumbers dnums converts replica groups to attribute mlir namedattribute const std vector replicagroup replica groups converts channel id to attribute mlir namedattribute absl optional tensorflow int64 channel id converts channel handle to attribute mlir namedattribute const xla channelhandle channel converts xla instruction source target pairs to mlir attribute mlir namedattribute convertsourcetargetpairs const std vector std pair tensorflow int64 tensorflow int64 ,add import support for hlo allreduce op piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1365,include tables h include utils h static char render arg struct syscallrecord rec char buffer unsigned int argnum struct syscallentry entry static char render arg struct syscallrecord rec char sptr unsigned int argnum struct syscallentry entry char sptr buffer const char name null unsigned long reg 0 enum argtype type 0 ,remove duplicate variable , fix a bug in the file page
1366,class tpubaseembeddingcolumn return fc lib sharedembeddingcolumn get sequence dense tensor self transformation cache state manager tensor fc lib sharedembeddingcolumn dense tensor internal self transformation cache state manager tensor self get dense tensor internal transformation cache state manager tensor lengths transformation cache get self get sequence length feature key name state manager ,fix test for mod partitioning of embedding tables on cpu in tpuestimator fix bug with sequence columns in a shared embedding piperorigin revid , tf data service support for tf data dataset piperorigin revid
1367,class muloperationparser public tfliteoperationparser return if error node input input tensor1 graph reader else else the runtime input tensor must be bound to 1st input and the constant input tensor must be bound to 2nd input int runtime tensor 0 ,fixed to match coding conventions , xla gpu support for the layout of the layout is a bit piperorigin revid change id idddefebfaaab
1368,def run fuzzer args def reproduce args return reproduce impl args project name args fuzzer name args valgrind args env to add return reproduce impl args project name args fuzzer name args valgrind args e args fuzzer args args testcase path ,infra fix env variable in the helper py command , fix a bug in the documentation of the new module piperorigin revid
1369,bool stringpiece sp int64 out stringpiece match stringpiece remaining scan bool is negative false scan restartcapture if scan peek ' ' is negative true scan oneliteral if scan restartcapture many scanner digit if scan many scanner digit stopcapture getresult remaining match return false uint64 val 0 if str util consumeleadingdigits match val return false if is negative const int64 final val static cast int64 val 1 if final val 0 return false out final val else if val static cast uint64 std numeric limits int64 max return false out val int64 value 0 if strings safe strto64 match tostring c str value return false out value sp remaining return true ,change opdefbuilder to use safe for parsing numbers instead of doing it itself incorrectly on mac change , xla gpu support for the layout of the input shape inference piperorigin revid
1370,static char features static int included patches add new patch number below this line 2084 2083 ,patch problem new digraph test makes testing hang solution don't set nocp , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1371,static const struct child funcs child ops name rand syscalls func child random syscalls likelyhood 100 fixme when we have different child ops we're going to need to redo the progress detector static unsigned int handle sigreturn int childno static unsigned int handle sigreturn int childno count 0 last shm child op count childno if count 3 output 1 no progress for 3 tries exiting child n if count 10 output 1 no progress for 10 tries exiting child n return 0 ,bump child retry limit is a bit too easy to hit in some cases , fix a bug in the watchdog page
1372,ga concat garray t gap char u s int len if s null if s null s nul return len int strlen s if ga grow gap len ok ,patch undefined behavior when using backslash after empty line problem undefined behavior when using backslash after empty line solution check for an empty line dominique pelle closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
1373,public void walkopspostorder std function void operationinst callback private friend class operationinst friend class instruction explicit affineforop const operationinst state op state public void print opasmprinter p const private friend class operationinst friend class instruction explicit affineifop const operationinst state op state ,fold the functionality of operationinst into instruction operationinst still exists as a forward declaration and will be removed incrementally in a set of followup cleanup patches piperorigin revid , fix a bug in the parser parser test piperorigin revid
1374,def embedding lookup and transform params flat ids extras ids per partition emulate a conditional using a boolean indicator tensor is in first extras partitions math ops cast p assignments extras flat ids dtype new ids is in first extras partitions flat ids ids per partition 1 1 is in first extras partitions flat ids extras ids per partition new ids array ops where p assignments extras flat ids ids per partition 1 flat ids extras ids per partition else raise valueerror unrecognized partition strategy partition strategy ,used tf where to simplify conditional expression in div sharding piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
1375,see the license for the specific language governing permissions and limitations under the license package org tensorflow lite experimental package org tensorflow lite gpu import java io closeable import org tensorflow lite delegate ,move the into the lite gpu package also enable gpu support to the android classification demo by default using the new gpu nightly releases piperorigin revid , add a test for the new op op piperorigin revid
1376,struct unknownloc loc constexpr stringliteral dialectconversionrewriter ,fix debug build static constexpr data member must have a definition until c piperorigin revid , xla gpu support for the cpu backend piperorigin revid change id iaaffafbceeeafc
1377,xlaop xlabuilder crossreplicasum if channel id has value instr set all reduce id channel id handle instr set channel id channel id handle addcalledcomputation computation instr ,change all reduce id to use channel id piperorigin revid , xla gpu support for the xla client piperorigin revid
1378,tflitestatus imagenetmodelevaluator evaluatemodel const tflite evaluation getsortedfilenames data path image files std vector string ground truth image labels if tflite evaluation readfilelines params ground truth labels path ground truth image labels ground truth image labels log error unable to read ground truth labels from params ground truth labels path perhaps file doesn't exist or is return ktfliteerror if image files size ground truth image labels size log error images and ground truth labels don't match return ktfliteerror ,adds additional error logging otherwise this ends up producing opaque messages like failed to evaluate the model when the problem is just label file doesn't exist piperorigin revid change id , add support for int int piperorigin revid
1379,static char features static int included patches add new patch number below this line 1432 1431 ,patch various inconsistencies in test files problem various inconsistencies in test files solution add modelines where they were missing use check commands instead of silently skipping over tests adjust indents and comments ken takata closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1380,general beval cb beval state 0 char u bexpr buf t save curbuf size tlen ifdef feat windows win t endif general beval cb beval state vim free result result eval to string bexpr null true remove one trailing newline it is added when the result was a list and it's hardly every useful if the user really wants a trailing newline he can add two and one remains if result null len strlen result if len 0 result len 1 nl result len 1 nul if use sandbox sandbox textlock ,updated for version problem when 'balloonexpr' results in a list the text has a trailing newline lcd solution remove one trailing newline , patch problem when using a popup window with a popup window solution add the cursor to the current buffer when the cursor is set
1381,def image gradients image image tf reshape tf range image height image width channels delta 1 dtype tf float32 shape batch size image height image width channels dx dy tf image image gradients image dy dx tf image image gradients image print image 0 0 tf tensor 0 1 2 3 4 def image gradients image 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 shape 5 5 dtype float32 print dx 0 0 print dy 0 0 tf tensor 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 0 0 0 0 0 shape 5 5 dtype float32 print dy 0 0 print dx 0 0 tf tensor 1 1 1 1 0 1 1 1 1 0 ,fixed error in the example of image gradients documentation image gradients returns dy dx rather than dx dy , fix a bug in the docstring of the docstring of the test case piperorigin revid
1382,public inline real unchecked prime real x const return std numeric limits real quiet nan todo get the high accuracy approximation by differentiating the interpolant using std floor auto i static cast decltype y size floor x x0 dx real xi x0 i dx real t x xi dx velocity real v0 dydx i real v1 dydx i 1 return v0 v1 2 private ,move examples daubechies files cpp to examples daubechies some file cpp ci skip , fix a bug in the parser test piperorigin revid
1383,class opregistry public opregistryinterface const opregistrationdata op reg data const override fills ops with all registered opdefs except those with names starting with ' ' if include internal false starting with ' ' if include internal false sorted in ascending order void export bool include internal oplist ops const returns ascii format oplist for all registered opdefs except ,tensorflow base apidefs and tests to make sure they are kept in sync piperorigin revid , fix a bug in the new delegate piperorigin revid
1384,port statusor platform if it id map end return port status port error not found port printf could not find registered platform with id 0x p id port printf could not find registered platform with id p id return it second ,don't add a superfluous x prefix in error message the p includes an x piperorigin revid , xla python add a test for the xla client client piperorigin revid
1385,class xla test xlatestcase verifies the output values of the pooling function args pool func pooling function to be called e g tf nn max pool pool func pooling function to be called e g tf nn max pool2d pool grad func corresponding pooling gradient function input sizes input tensor dimensions ksize the kernel size dimensions ,apply tf tf name replaces to doc strings and comments in tensorflow no code changes only doc strings and comments i checked piperorigin revid , xla python fix a bug in the graph piperorigin revid
1386,static char features static int included patches add new patch number below this line 1967 1966 ,patch line only works for the current window problem line only works for the current window solution add an optional argument for the window to use , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1387,static char features static int included patches add new patch number below this line 1036 ,patch popupwin test fails sometimes problem popupwin test fails sometimes solution use waitforassert instead of a sleep , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1388,class testwholemodelsaving test testcase parameterized testcase evaluation results 'sparse categorical crossentropy' evaluation results 'custom loss' evaluation results 'loss' 1e 6 def test save uncompiled model with optimizer self saved model dir self save model dir save format testing utils get save format model keras models sequential keras layers dense 1 input shape 3 set the model's optimizer but don't compile this can happen if the model is trained with a custom training loop model optimizer keras optimizer v2 rmsprop rmsprop lr 0 0001 model save saved model dir save format save format if save format in 'tf' 'tensorflow' loaded keras models load model saved model dir self assertisinstance loaded optimizer keras optimizer v2 optimizer v2 optimizerv2 factory functions to create models that will be serialized inside a network def make graph network input size output size ,make saving the training config optional if model does not have all of the attributes saved from model compile piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
1389,ex spellinfo eap ex eap exarg t eap char u spl long dummy if no spell checking curwin return get option value char u spl dummy spl opt local create a new empty buffer by splitting the window create a new empty buffer in a new window do cmdline cmd char u new enable locally in the new window set option value char u spell true char u opt local set option value char u spl dummy spl opt local vim free spl if bufempty buf valid curbuf return ,updated for version problem when using setlocal for 'spell' and 'spellang' then doesn't work dimitar dimitrov solution copy the option variables to the new window used to show the dump christian brabandt , patch problem when using a terminal window is a bit slow solution add a test for the command line
1390,void resize t out uint8 t in int image height int image width auto output interpreter typed tensor float 2 auto output number of pixels wanted height wanted height wanted channels wanted height wanted width wanted channels for int i 0 i output number of pixels i if s input floating ,tflite fix calculating of output pixels fix an issue reported by issue , xla gpu support for the layout of the layout is a bit piperorigin revid
1391,public same operands in the same order bool matchingboundoperandlist const walk the operation instructions in the 'for' instruction in preorder calling the callback for each operation void walkops std function void operationinst callback walk the operation instructions in the 'for' instruction in postorder calling the callback for each operation void walkopspostorder std function void operationinst callback operands ,refactor dma generate walker nfc forinst walkops will also be used in an upcoming cl cl better to have this instead of deriving from the instwalker piperorigin revid , xla gpu support for the hlo instruction piperorigin revid change id icabdabcccecababba
1392,static char features static int included patches add new patch number below this line 867 866 ,patch cannot build python interface with python problem cannot build python interface with python tom g christensen solution define pybytes ken takata closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1393,def stack bidirectional dynamic rnn cells fw returns a tuple outputs output state fw output state bw where outputs output tensor shaped batch size max time layers output where layers output batch size max time layers output where layers output are depth concatenated forward and backward outputs output states fw is the final states one tensor per layer of the forward rnn ,add a missing left bracket in comments , fix a bug in the docstring of the docstring of the tf data strategy piperorigin revid
1394,static char features static int included patches add new patch number below this line 156 155 ,updated for version problem test file missing from distribution solution add new directory to file list , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1395,adjust prop columns u savesub lnum fail return false dirty true u savesub may have updated curbuf b ml fetch it again if curbuf b ml ml line lnum lnum get text props curbuf lnum props true if res can drop continue drop this text property ,patch text properties corrupted with substitute command problem text properties corrupted with substitute command filipe brandenburger solution get the changed line again after using u savesub closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
1396,nodedefbuilder nodedefbuilder device stringpiece device spec return this status nodedefbuilder finalize nodedef node def const status nodedefbuilder finalize nodedef node def bool consume const std vector string errors ptr errors std vector string errors storage if op def nullptr inputs specified op def input arg size status nodedefbuilder finalize nodedef node def const else nodedef node def backup if node def nullptr node def node def backup node def node def if consume node def std move node def else node def node def add control inputs after the regular inputs for const auto control input control inputs ,allow users of node def builder to avoid copying the created nodedef on by passing true as the optional consume argument we can move the constructed nodedef out of the which avoids a potentially large copy piperorigin revid , fix a bug in the test case piperorigin revid
1397,static file find logfile handle return parentlogfile i find pid slot pid if i no pidslot if i pidslot not found return shm logfiles i else try one more time fixme this is awful sleep 1 i find pid slot pid if i no pidslot if i pidslot not found return shm logfiles i printf d couldn't find logfile for pid d n getpid pid ,clean up some pid handling '' is no longer a valid pidslot state , patch problem when the popup window doesn't work properly solution add the option to the right line
1398,void mlfunctionstate print const stmtblock block void mlfunctionstate print const statement stmt switch stmt getkind case statement kind operation todo llvm unreachable operation statement is not yet implemented case statement kind operation return print cast operationstmt stmt case statement kind for return print cast forstmt stmt case statement kind if void mlfunctionstate print const operationstmt stmt void mlfunctionstate print const forstmt stmt os indent numspaces for n print static cast const stmtblock stmt os indent numspaces n os indent numspaces void mlfunctionstate print const ifstmt stmt void mlfunctionstate print const ifstmt stmt print stmt os indent numspaces os n ,parse operations in ml functions add builder class for ml functions refactors operation parsing to share functionality between cfg and ml functions ml function construction now goes through a builder similar to the way it is done for cfg functions piperorigin revid , xla python fix a bug in the test piperorigin revid
1399,class public randomaccessfile public writablefile return status ok if defined platform google status append const absl cord cord override data append cord char begin cord char end return status ok endif status close override return status ok status flush override return status ok status sync override return status ok ,add absl cord support to ram file system so that internal ops tests can use cords piperorigin revid change id , xla gpu support for the layout of the layout is a bit piperorigin revid change id icaffbdeceeacbabda
1400,def dict to str dictionary a str representing the dictionary return ' ' join ' s s' k v for k v in sorted six iteritems dictionary for k v in sorted six iteritems dictionary if not isinstance v six binary type def write dict to summary output dir ,change estimator to only log non binary eval metrics because logging binary metrics such as images will lead to crash piperorigin revid , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary solution add a test for the line
1401,static char features static int included patches add new patch number below this line 296 295 ,updated for version problem can't run tests on solaris solution change the way vimruntime is set laurent blume , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1402,class muloperationparser public tfliteoperationparser the larger input tensor must be bound to 1st input and the smaller input tensor mask must be bound to 2nd input if runtime runtime tensor1 if input0 input1 replace mul a a with pow a 2 0 todo b support the same inputs for operations node operation type tostring operationtype pow elementwiseattributes attr attr param 2 0f node operation attributes std move attr return if error reader addinput node 0 return reader addoutputs node bhwc shape0 return if error extracttensorshape input0 shape0 bhwc shape1 ,workaround for mul with the same runtime input a a piperorigin revid change id , xla gpu support for the layout of the layout is a bit piperorigin revid change id idddefebfaaab
1403,class add public nodeshader inputs 0 tensor shape inputs 1 tensor shape inputs 1 tensor shape h 1 inputs 1 tensor shape w 1 inputs 0 tensor shape c inputs 1 tensor shape c todo b investigate why input data 1 gid z worked before generated code parameters objects class add public nodeshader workload uint3 workgroup uint3 source code value 0 input data 1 gid z input data 0 gid x gid y gid z value 0 input data 0 gid x gid y gid z input data 1 gid z input iostructure only definitions output iostructure auto ,support a broadcast case of elementwise op and fix broadcast case of add op for android piperorigin revid change id , fix a bug in the test case piperorigin revid
1404,class network base layer layer def checkpoint dependencies self dependencies trackable trackablereference name name ref layer for name layer in self layer checkpoint dependencies items for name layer in sorted self layer checkpoint dependencies items dependencies extend super network self checkpoint dependencies return dependencies ,deterministic sort of keras network checkpoint dependencies to enable multiworkermirroredstrategy checkpointing and prevent different tensors being broadcast for the same collectiveops key piperorigin revid change id , update keras layers to keras piperorigin revid
1405,static pymemberdef g errormembers offset t int offsetof udt error offset readonly message t object offsetof udt error message readonly context t string offsetof udt error context readonly isrecoverable t bool offsetof udt error context readonly isrecoverable t bool offsetof udt error isrecoverable readonly null ,correct variable references , fix a bug in the file
1406,changed common endif relative numbering may require updating more cursor line highlighting probably needs to be updated if it's below the change change or is using screenline highlighting if wp w p rnu ifdef feat syn hl wp w p cul lnum wp w last cursorline wp w p cul lnum wp w last cursorline wp w p culopt flags culopt endif redraw win later wp some valid ,patch cannot control 'cursorline' highlighting well problem cannot control 'cursorline' highlighting well solution add christian brabandt closes , fix a bug in the new parser test piperorigin revid
1407,def gather cpu info cpu info cpu info info cpu info num cores info 'count' cpu info mhz per cpu info raw' 0 1 0e6 l2 cache size re match r' d ' str info 'l2 cache size' l2 cache size re match r' d ' str info get 'l2 cache size' '' if l2 cache size if a value is returned it's in kb cpu info cache size 'l2' int l2 cache size group 0 1024 ,fix get cpu info doesn't seem to include the l cache size key on some architectures piperorigin revid , fix a bug in the graph piperorigin revid
1408,class poolingtest tf test testcase def testshapefunctionedgecases self all shapes unknown for pool func in tf nn max pool tf nn avg pool p tf nn max pool tf placeholder tf float32 ksize 1 1 1 1 strides 1 1 1 1 padding same p pool func tf placeholder tf float32 ksize 1 1 1 1 strides 1 1 1 1 padding same self assertequal none none none none p get shape as list p am tf nn max pool with argmax tf placeholder tf float32 ,fix small typo in pooling ops test , fix a bug in the test case piperorigin revid
1409,class test stoppollingloop int queue size size t queue size mutex lock l em mu return em used events size int free size size t free size mutex lock l em mu return em free events size ,remove warning that only happening with config cuda change , fix a bug in the test case piperorigin revid
1410,static void decode main exiting void printf main exiting pid d reason s n mainmsg pid decode exit mainmsg reason static void decode child spawned void struct msg childspawned childmsg childmsg struct msg childspawned buf printf child spawned id d pid d n childmsg pid childmsg childno int main unused int argc unused char argv int ret int main unused int argc unused char argv decode main exiting break case child spawned decode child spawned break default unknown command yet just dump as hex printf rx d bytes ret ,decode child started messages , fix a bug in the watchdog page
1411,def slicegrad op grad return array ops pad grad paddings none none ops registergradient stridedslice def stridedslicegrad op grad x array ops shape op inputs 0 begin op inputs 1 end op inputs 2 strides op inputs 3 return array ops strided slice grad x begin end strides grad begin mask op get attr begin mask end mask op get attr end mask ellipse mask op get attr ellipse mask new axis mask op get attr new axis mask shrink axis mask op get attr shrink axis mask none none none ops registergradient split def splitgrad op grads return none array ops concat op inputs 0 list grads ,implement gradient for stridedslice op stridedslicegrad op implements the gradient of stridedslice also implement python benchmark for stridedslice and simple slice fix bugs in special case optimizations in stridedslice toward resolving bug change , tf data saveable shape inference for tf data dataset piperorigin revid
1412,class testdistributionstrategycorrectness test testcase are the same within some limits of tolerance for key in results with ds if key startswith 'training history' and isinstance distribution tpu strategy tpustrategy and isinstance distribution tpu strategy tpustrategyv1 and distribution extended steps per run 1 todo b enable this test for all cases once the underlying bug is fixed ,remove steps per run from the tpustrategy constructor in x piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1413,operatorproperty getoperatorproperty const builtinoperator op property version 2 break case builtinoperator mean property arbitrary inputs true property inputs 0 property outputs 0 property restrict same input output scale true property version 2 break case builtinoperator minimum ,automated rollback of commit piperorigin revid , add support for int int for int int piperorigin revid
1414,elif sys platform cygwin libdirs i os path join oraclehome libdirs i libs oci else libpath os path join oraclehome lib if struct calcsize p 4 alternatepath os path join oraclehome lib32 else alternatepath os path join oraclehome lib64 if os path exists alternatepath libpath alternatepath libdirs libpath oraclehome libdirs oraclelibdir libs clntsh possibleincludedirs rdbms demo rdbms public network public sdk include else if os path isdir path includedirs append path if not includedirs path os path join os path dirname libpath include path os path join oraclelibdir include if os path isdir path includedirs append path if not includedirs ,remove redundant code used for determining library path , fix a bug in the file
1415,static char features static int included patches add new patch number below this line 1310 ,patch problem sock t is defined too late solution move it up , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1416,class public tensorflow nullfilesystem data tensor test astensor double 1 2 3 4 2 2 tensorflow status newreadonlymemoryregionfromfile const string fname const string fname tensorflow transactiontoken token std unique ptr tensorflow readonlymemoryregion result override if fname return tensorflow errors unimplemented ,moving some filesystems to transactional api , xla gpu support for the layout inference piperorigin revid change id id icfecdffaddccbded
1417,tf call all types register register kernel builder name depthtospace device device gpu typeconstraint float t depthtospaceop gpudevice float register kernel builder name depthtospace device device gpu typeconstraint eigen half t depthtospaceop gpudevice eigen half register kernel builder name depthtospace device device gpu typeconstraint qint8 t depthtospaceop gpudevice qint8 ,add dt half support for depthtospace on gpu signed off by yong tang yong tang github outlook com , fix a bug in the test case piperorigin revid
1418,status xlacompileondemandop mustargumentbeconstant todo jmolloy this could be expensive so memoize std vector int constant input indices tf return if error getcompiletimeconstinputs op kernel constant input indices flib runtime op kernel constant input indices flib runtime cached arg indices nullptr result absl c binary search constant input indices argument idx return status ok ,const analysis should peek into partitionedcall and statefulpartitionedcall piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id iaaffafbceeeafc
1419,from future import absolute import from future import division from future import print function import os from tensorflow python keras import backend from tensorflow python keras applications import imagenet utils from tensorflow python keras engine import training from tensorflow python keras layers import from tensorflow python keras utils import data utils from tensorflow python keras utils import layer utils from tensorflow python lib io import file io from tensorflow python util tf export import keras export def densenet valueerror if classifier activation is not softmax or none when using a pretrained top layer if not weights in 'imagenet' none or os path exists weights if not weights in 'imagenet' none or file io file exists weights raise valueerror 'the weights argument should be either ' ' none random initialization imagenet ' ' pre training on imagenet ' ,use tf io instead of os for checking if paths exist in keras applications piperorigin revid change id , fix a bug in the test case piperorigin revid
1420,class controlflowtest tf test testcase r tf gradients rx x self assertallclose 64 0 r 0 eval def testwhilegrad self with self test session i tf constant 0 name i x tf constant 1 0 name x y tf constant 1 0 name y c lambda i tf less i 1 name cond less def b i xi return i 1 xi xi return tf add i 1 name inc tf identity xi name xi tf add xi name xi plus x f y f tf while loop c b i x y with tf control dependencies x f y f d tf identity y f name y f d self assertallclose 2 0 y f d eval y f d 1 0 1 0 g tf gradients y f d x 0 self asserttrue g is not none self assertallclose 1 0 g eval y f d x 1 0 dy f d dx 1 0 def simple self use gpu with self test session use gpu use gpu v tf constant 1 0 ,don't consider control inputs in gradient backprop graph construction i added it as a conservative implementation and always wanted to remove it it could introduce unnecessary overhead complexity as shown in change , fix a bug in the test case piperorigin revid
1421,const char kfrontendattributesattribute xlafrontendattributes namespace xla statusor absl optional xla frontendattributes getfrontendattributesfromnodedef const attrslice attrs getfrontendattributesfromattrslice const attrslice attrs auto attr attrs find kfrontendattributesattribute if attr nullptr return xla statusor absl optional xla frontendattributes ,renamed and added documentation , fix a bug in the test case piperorigin revid
1422,from tensorflow python framework import tensor spec from tensorflow python framework import tensor util from tensorflow python ops import resource variable ops from tensorflow python ops import tensor array ops from tensorflow python ops numpy ops import np arrays from tensorflow python ops ragged import ragged tensor from tensorflow python ops ragged import row partition from tensorflow python util import compat class object resource variable ops variablespec struct pb2 row partition spec row partition struct pb2 ndarray spec np arrays ndarrayspec mapping from type typespec subclass to enum value ,allow ndarrayspec to be written in saved model piperorigin revid change id , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1423,from future import print function import gast class unsupportedfeatureschecker gast nodetransformer class unsupportedfeatureschecker gast nodevisitor def visit attribute self node if node attr is not none and node attr startswith ' ' and not node attr endswith ' ' raise notimplementederror names are not yet supported by autograph' these checks could potentially be replaced with inspect isgeneratorfunction to avoid a getsource parse ast walk round trip def visit yield self node class unsupportedfeatureschecker gast nodetransformer def verify node unsupportedfeatureschecker visit node ,raise an explicit unsupported error when encountering mangled names note this triggers the automatic fallback piperorigin revid , fix a bug in the test case piperorigin revid
1424,namespace testing class message represents a failure message class test represents a test class testcase a collection of related tests class testpartresult result of a test part class testinfo information about a test class unittest a collection of test cases ,turns on exceptions when compiling gtest output test by vlad losev moves testcase to gtest h to prepare for the event listener api by vlad losev , fix a bug in the test case piperorigin revid
1425,def l2 normalize v2 x axis none epsilon 1e 12 name none with ops name scope name l2 normalize x as name x ops convert to tensor x name x if x dtype is complex square real math ops square math ops real x square imag math ops square math ops imag x square sum math ops real math ops reduce sum square real square imag axis keepdims true x inv norm math ops rsqrt math ops maximum square sum epsilon norm real math ops multiply math ops real x x inv norm norm imag math ops multiply math ops imag x x inv norm return math ops complex norm real norm imag name name square sum math ops reduce sum math ops square x axis keepdims true x inv norm math ops rsqrt math ops maximum square sum epsilon return math ops multiply x x inv norm name name ,add complex complex support for tf math l normalize this pr tries to address the issue raised in where there was no complex support for tf math l normalize this pr adds complex support for tf math l normalize this pr fixes signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the test case piperorigin revid
1426,boost math instrument lambert w small z series iterations show evaluation of define boost math instrument lambert w0 lookup show results from lookup table ifndef boost math sf lambert w hpp define boost math sf lambert w hpp ifndef boost math sf lambert w hpp define boost math sf lambert w hpp ifdef msc ver pragma warning disable 4127 warning c4127 conditional expression is constant if diff 0 exact result common namespace math namespace boost endif ifndef boost math sf lambert w hpp endif ifndef boost math sf lambert w hpp ,decimal digit precision values and tests ok , fix a bug in the new parser test svn r
1427,unsigned int nr sockets 0 static const char cachefilename trinity socketcache static void sso socket struct socket triplet triplet struct sockopt so int fd int ret unsigned int tries 0 skip over bluetooth due to weird linger bug if triplet family pf bluetooth return retry do setsockopt so ret setsockopt fd so level so optname void so optval so optlen if ret 0 output 2 setsockopt lx lx lx lx on fd d d d d n so level so optname so optval so optlen fd triplet family triplet type triplet protocol else tries if tries 100 return goto retry static int open socket unsigned int domain unsigned int type unsigned int protocol int fd ,move sso socket to fd sockets c as it's now the only user , make the syscall page we can be a bit more than the syscall process
1428,class vectorsupportlibrary less llvm value fcmpeqmask llvm value lhs llvm value rhs llvm value fcmpeqmask llvm value lhs const llvm apfloat rhs return fcmpeqmask lhs getconstantfloat lhs gettype rhs llvm value llvm value lhs llvm value rhs llvm value llvm value lhs llvm value rhs llvm value llvm value lhs const llvm apfloat rhs ,xla cpu check for inf in implementation of log previously we log inf log max float now log inf inf piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idfbdfbcdacfbeebb
1429,void applylayernorm const int16 t input const int16 t layer norm weights const int32 t bias int32 t layer norm scale a int32 t layer norm scale b int32 t variance limit int n batch int n input int16 t output portableapplylayernorm input layer norm weights bias layer norm scale a layer norm scale b variance limit n batch n input output neon or portable applylayernorm input layer norm weights bias layer norm scale a layer norm scale b variance limit n batch n input output void applysigmoid const int16 t input int32 t n batch int32 t n input ,fix neon version of method in tensor utils piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id idadabbfadafcd
1430,on success add key returns the serial number of the key it created or updated on error the value 1 will be returned and errno will have been set to an appropriate error include linux h include random h include sanitise h static void sanitise add key struct syscallrecord rec rec a1 unsigned long rand array keytypes static unsigned long key spec thread keyring key spec process keyring key spec session keyring key spec user keyring key spec user session keyring key spec group keyring key spec auth key key spec keyring struct syscallentry syscall add key name add key num args 5 struct syscallentry syscall add key arg4name arg4type arg len arg5name ringid arg5type arg op arg5list arglist rettype ret key serial t sanitise sanitise add key ,add the ring for , patch problem when using a channel to be a character of a character solution add a test for the cursor
1431,setup packages find packages exclude ext modules ext install requires 'numpy 1 12 1' 'numpy 1 16 0' cmdclass 'build ext' custombuildext ,change required numpy version to piperorigin revid change id , fix a bug in the test case for the test case
1432,static char features static int included patches add new patch number below this line 1765 ,patch vim some tests use var var problem vim some tests use var var solution use var name closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1433,def ast to source node indentation return astor source repr pretty source generator result lstrip def ast to object node indentation ' ' def ast to object node indentation ' ' source prefix none return the python objects represented by given ast compiling the ast code this way ensures that the source code is readable by def ast to object node indentation ' ' args node the code to compile as an ast object indentation the string to use for indentation source prefix optional string to print as is into the source file returns a module object containing the compiled source code def ast to object node indentation ' ' with tempfile namedtemporaryfile mode 'w' suffix ' py' delete false as f module name os path basename f name 3 if source prefix f write source prefix f write ' n' f write source return imp load source module name f name ,revise the decorator transformer and add tests that clarify when can decorator information appear in the ast piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the example
1434,class datasetv2 object filters this dataset according to predicate python note the following examples use to represent the contents of a dataset a 1 2 3 b 4 5 6 7 a filter lambda x x 3 1 2 d tf data dataset from tensor slices 1 2 3 d d filter lambda x x 3 1 2 tf math equal x y is required for equality comparison def filter fn x return tf math equal x 4 return tf math equal x 1 b filter filter fn 4 d d filter filter fn 1 args ,changed tensor pseudo code so that the example is runnable , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
1435,class unaryopstest xla test xlatestcase rtol rtol atol atol test util disable mlir bridge bf16 type not supported in createdenseelementsattrfromliteral def self for dtype in self float types dtypes float32 dtypes float64 self 2 0 8 dtype ,add tf softplus xla hlo legalization special handling of determining epsilon values for different float types is added piperorigin revid change id , xla gpu support for the xla client piperorigin revid
1436,def set server def server def context set server def server def def add function fdef context add function fdef not every user creates a context via context context for example enable eager execution in python framework ops py but they do all import this file note that is in graph mode and ,split up function py into multiple files this change adds func graph py and auto control deps py this is purely copy pasting code from function py and function test py to these new files plus changing imports and minor lint fixes piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
1437,class lite v2 test util modeltest np testing assert almost equal expected value numpy actual value 0 decimal 4 def self tf function input signature tf tensorspec shape 1 none 16 3 dtype tf float32 def model in tensor return in tensor in tensor concrete func model get concrete function test invalid shape none after 1st dimension run with toco in order to invoke shape checking code converter lite tfliteconverterv2 from concrete functions concrete func converter experimental new converter false with self assertraises valueerror as error converter convert self assertequal 'none is only supported in the 1st dimension tensor ' ' 'in tensor ' has invalid shape ' 1 none 16 3 ' ' str error exception if name ' main ' test main ,split merged tfliteconverter implementations into frozen graph converter and saved model converter piperorigin revid change id , fix a bug in the test case piperorigin revid
1438,static char features static int included patches add new patch number below this line 941 940 ,patch detecting terminal properties is problem detecting terminal properties is solution add a table with terminal properties set properties when a terminal is detected , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1439,xla test f dotoperationtest xlabuilder builder testname xlaop param auto param data createparameterandtransferliteral 0 literalutil literalutil creater2 float 1 2 3 4 literalutil creater2 float 5 6 7 8 arg0 builder param tf assert ok and assign auto param data createparameterandtransferliteral 0 literalutil literalutil creater2 float 1 2 3 4 literalutil creater2 float 5 6 7 8 arg0 builder param auto lhs gettupleelement param 0 auto rhs gettupleelement param 1 dot lhs rhs ,propagate test error to avoid crashes piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idaceccfcbacfece
1440,static inline long is err unsigned long x void sizeunit unsigned long size char buf void kill pid pid t pid ,move locking related stuff out of watchdog c to locks c , fix a bug in the watchdog page
1441,static char features static int included patches add new patch number below this line 328 327 ,updated for version problem selection of inner block is inconsistent solution skip indent not only for ' ' but all parens tom , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1442,boost auto test case test main test legendre p prime double test legendre p prime long double int distance test legendre p zeros double ulp 1 107 boost check distance 1 this test is very expensive the total runtime grows cubically with n distance test legendre p zeros double ulp 108 350 boost check distance 2 int ulp distance test legendre p zeros double ulp 1 100 boost check ulp distance 2 test legendre p zeros float test legendre p zeros double test legendre p zeros long double ,return all zeros of the legendre polynomial at once there seems to be no benefit to having the user calculate them one at a time , fix a bug in the parser test for the new code svn r
1443,class dartgenerator public basegenerator code bc numtostring field value offset if field value constant empty field value constant 0 code field value constant if field value type base type code true else code field value constant else code null if field value type base type code false else if isscalar field value type base type code 0 else code null code ,dart fix default values , fix a bug in the parser test piperorigin revid
1444,import tensorflow as tf class uniquetest tf test testcase def testint32 self x list np random randint 2 high 10 size 7000 x np random randint 2 high 10 size 7000 with self test session as sess y idx tf unique x tf y tf idx sess run y idx class uniquetest tf test testcase for i in range len x self assertequal x i tf y tf idx i class tf test testcase def testint32 self x np random randint 2 high 10 size 7000 with self test session as sess y idx count tf unique with counts x tf y tf idx tf count sess run y idx count self assertequal len x len tf idx self assertequal len tf y len np unique x for i in range len x self assertequal x i tf y tf idx i for value count in zip tf y tf count self assertequal count np sum x value if name main tf test main ,add the op this is the same as the unique op but has an additional output that returns the number of duplicate values change , tf data service support for tf data dataset piperorigin revid
1445,class constantfolding public graphoptimizer bool isones const nodedef node const bool iszeros const nodedef node const void int input to forward nodedef node void int input to forward nodedef node graphdef graph status replaceoperationwithconstant double value const tensorshapeproto shape nodedef node void replacedivisionofonesbyreciprocal nodedef node nodedef node graphdef graph void replacedivisionofonesbyreciprocal nodedef node graphdef graph status foldgraph graphdef output bool issimplifiablereduction const nodedef node const ,correctly connect control dependencies to switch nodes when doing arithmetic simplifications piperorigin revid , xla gpu support for the xla client piperorigin revid change id idaceccfcbacfece
1446,void createtpubridgepipeline oppassmanager pm pm addpass createtpushardingidentificationpass pm addpass tfdevice createannotateparameterreplicationpass pm addpass createtpurewritepass pm addpass createsymboldcepass pm addnestedpass funcop tfdevice createreplicateinvariantophoistingpass pm addnestedpass funcop createtpudynamiclayoutpass pm addnestedpass funcop createtpumergevariableswithexecutepass ,run symbol dce after tpu rewrite to remove unreachable functions after tpu rewrite encapsulates device cluster function into run symboldce to remove leftover unused functions piperorigin revid change id , tf data service support for tf data service piperorigin revid change id icbbdbfafcdfcae
1447,limitations under the license include llvm analysis targettransforminfo h include llvm bitcode bitcodereader h include llvm bitcode bitcodewriter h include llvm codegen commandflags def include llvm codegen commandflags inc include llvm ir llvmcontext h include llvm ir legacypassmanager h include llvm ir module h ,update for upstream llvm def inc rename piperorigin revid , xla python add a test for the xla client client piperorigin revid change id icbbdbfafcdfcae
1448,boost math ef e float bessel i0 boost math ef e float x else x in 15 infty boost math ef e float y 1 x 1 15 boost math ef e float y 1 x boost math ef e float 1 15 r evaluate polynomial p2 y evaluate polynomial y factor exp x sqrt x value factor r ,fix actual and potential integer divisions when using integer constants fixes svn r , fix a bug in the new parser test for the new code svn r
1449,namespace prepare tf operations in functions for subsequent legalization class preparetfpass public passwrapper preparetfpass functionpass public explicit preparetfpass unfold batch matmul true explicit preparetfpass bool unfold batch matmul unfold batch matmul unfold batch matmul preparetfpass default preparetfpass const preparetfpass explicit preparetfpass bool unfold batch matmul unfold batch matmul unfold batch matmul void runonfunction override void getdependentdialects dialectregistry registry const override class preparetfpass public passwrapper preparetfpass functionpass private bool unfold batch matmul option bool unfold batch matmul this tfl unfold batch matmul llvm cl desc unfold batchmatmul into individual matmul ops llvm cl init true template class ,make batch matmul into a command line option for the tfl prepare tf pass piperorigin revid change id , fix a bug in the test case piperorigin revid
1450,class deviceopmetricsdbbuilder public opmetricsdbbuilder picoseconds flops the number of floating point operations computed bytes accessed the sum of bytes read and bytes written by this op memory accessed breakdown the breakdown of memory accessed by operation type and memory space void enterop uint64 program id absl string view name absl string view category absl string view provenance bool is eager uint64 occurrences uint64 time ps uint64 children time ps int64 flops int64 bytes accessed uint64 children time ps int64 flops int64 bytes accessed const std vector opmetrics memoryaccessed memory accessed breakdown protected peak performance of a tensorcore or a gpu in s ,populate the memory access breakdown information in opmetrics piperorigin revid change id , xla gpu support for the layout interface piperorigin revid change id icccbcbdbcfaadbee
1451,waitforchar long msec dword ifdef feat channel check channel while waiting input if 100 100 endif ifdef feat mzscheme if allowed p 0 msec 0 long p ,patch problem ch read doesn't time out on ms windows solution instead of wm netbeans use select yukihiro nakadaira , patch problem when using a terminal window is a bit slow solution add a test for the gui
1452,protected unsigned index this template the operand iterators for the various ir classes this template implements the operand iterators for the various ir classes in terms of getoperand idx template typename objecttype typename elementtype class operanditerator final public this template the result iterators for the various ir classes this template implements the result iterators for the various ir classes in terms of getresult idx template typename objecttype typename elementtype class resultiterator final ,implement basic block successor iterators rename basicblockoperand to be more consistent with instoperand rename to to reduce confusion on their role piperorigin revid , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
1453,namespace boost namespace math typedef inverse uniform distribution double inverse uniform template class realtype class policy inline const std pair realtype realtype range const inverse uniform distribution realtype policy dist inline const std pair realtype realtype range const inverse uniform distribution realtype policy dist range of permissible values for random variable x using boost math tools max value return std pair realtype realtype dist lower dist upper 0 to 1 ,added concept checks for new distros and fixed resulting errors added mean and variance to non central beta svn r , fix a bug in the new parser test svn r
1454,int main int argc char argv progname argv 0 if logfilename null logfilename strdup trinity cpu0 log logfilename strdup trinity cpu0 log unlink logfilename logfile fopen logfilename a if logfile perror couldn't open logfile n exit exit failure parse args argc argv if argc 1 ,fix logging because we were closing the file with every logging attempt we ended up writing half of it to one dir and half to the other things will be a lot simpler if we just leave the file open the fflush fsync should ensure that things still hit the disk , fix a bug in the watchdog process
1455,class ftrloptimizertest test testcase val2 val3 self applyoptimizer adagrad adagradoptimizer 3 0 initial accumulator value 0 1 dtype self assertallcloseaccordingtotype val2 self assertallcloseaccordingtotype val1 val3 self assertallcloseaccordingtotype val2 half rtol 2e 3 self assertallcloseaccordingtotype val1 val3 half rtol 2e 3 test util run deprecated v1 def self ,tf xla slightly increase error tolerance of adagrad test piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1456,static char features static int included patches add new patch number below this line 1058 1057 ,updated for version problem call of funcref does not succeed in other script solution python patch add get expanded name zyx , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1457,std string getminimumruntimeversionformodel const model model operatortype ksum 2 1 15 0 operatortype kreducemax 1 1 11 0 operatortype kreducemax 2 1 14 0 operatortype kreducemax 3 kpendingreleaseopversion operatortype kreducemin 1 1 11 0 operatortype kreducemin 2 1 14 0 operatortype kreducemin 3 kpendingreleaseopversion operatortype 1 1 11 0 operatortype kany 1 1 11 0 operatortype krelu6 1 1 5 0 ,remove unnecessary version increment of and in deprecated file , fix a bug in the test case piperorigin revid
1458,include sanitise h get address include utils h static bool mark map rw struct map map int ret ret mprotect map ptr map size prot read prot write if ret 0 return false map prot prot read prot write return true static bool mark page rw struct map map void page int ret static void dirty whole mapping struct map map unsigned int i nr if mark map rw map false return nr nr pages map for i 0 i nr i char p map ptr i page size if mark page rw map p true p rnd p rnd ,optimize the case where we're dirtying a whole mapping , fix a bug in the file page
1459,class localcollectiveallreducestrategy self test all reduce mean gradient tape distribution combinations generate combinations combine mode 'graph' def testnumpyiterator self def testnumpydataset self num gpus 2 if context num gpus num gpus self skiptest 'not enough strategy self get test object none none num gpus num gpus self test numpy iterator strategy self test numpy dataset strategy if name ' main ' ,fix a broken test piperorigin revid , fix a bug in the test case piperorigin revid
1460,do join count insert space save undo use formatoptions char u new curr skip comment curr true insert space prev was comment comments t new curr curr comments t int new curr curr curr new curr else ,updated for version problem compiler warning on bit windows solution add type cast mike williams , patch problem when using a terminal window is a bit solution add a test for the test
1461,def reduce min input tensor axis none keepdims false name none for example a tf constant 1 2 3 4 tf reduce min a tf tensor id 2 shape dtype int32 numpy 1 tf tensor shape dtype int32 numpy 1 compatibility numpy equivalent to np min ,fixed failing doctest , fix a bug in the docstring of the test case piperorigin revid
1462,class loadtest test testcase self assertequal 2 imported variables b numpy self assertequal set a b set imported variables keys def test list self root tracking checkpointable root variables variables variable 1 root variables append 1 root variables append variables variable 3 imported self cycle root self assertequal 1 imported variables 0 numpy self assertequal 3 imported variables 2 numpy self assertis none imported variables 1 self assertequal 3 len imported variables if name main test main ,add a revived type for auto generated list wrappers adds a bit of plumbing for the proto and adds a bit of flexibility in listwrapper so that the restore process doesn't make it previously any setitem would mark the list as dirty piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1463,class verifier flatbuffers final class verify this whole buffer starting with root type t template typename t bool verifybuffer template typename t bool verifybuffer const char identifier if identifier size t end buf 2 sizeof flatbuffers uoffset t bufferhasidentifier buf identifier return false call t verify which must be in the generated code for this type return verify uoffset t buf reinterpret cast const t buf readscalar uoffset t buf ,verify everything in one shot , fix a bug in the parser test piperorigin revid
1464,static void const recordkeeper recordkeeper raw ostream os todo attributes are only documented by tablegen name with no further info this should be improved os n attributes n if op 0 os attribute mlir type description n n for auto op os getname attr getdescription attribute n os getname attr getstoragetype attr getdescription attribute n emit results ,doc use table to list all attributes for each attribute list its mlir type and description piperorigin revid , fix a bug in the parser build piperorigin revid
1465,popup create typval t argvars typval t rettv create type t type deal with options apply options wp argvars 1 vval v dict ifdef feat timers if type type notification wp w popup timer null popup add timeout wp 3000 endif popup adjust position wp ,patch cannot build with textprop but without timers problem cannot build with textprop but without timers solution add ifdef ola s√∂der closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
1466,status optimizegraph const graphdef graph def graphdef output graph def inline all functions graphdef inlined graph def graph def for int i 0 i inlined graph def library function size i functiondef fdef inlined graph def mutable library mutable function i setattrvalue false fdef mutable attr instantiate all variables for function library runtime creation std vector device devices tf return if error devicefactory adddevices ,don't force inlining of functions marked no inline piperorigin revid , tf data optimization for tf data service optimization piperorigin revid change id idadabbfadafcd
1467,class modeldatasetop public unarydatasetopkernel op requires ctx cpu budget 0 errors invalidargument cpu budget must be positive but is cpu budget ram budget port availableram if ctx hasattr ram budget op requires ok ctx ctx getattr ram budget ram budget else ram budget 0 if ram budget 0 ram budget port availableram op requires ctx ram budget 0 errors invalidargument ram budget must be positive but is ram budget void makedataset opkernelcontext ctx datasetbase input ,tf data give users the option to input ram budget in autotuning piperorigin revid change id , fix a bug in the graph piperorigin revid change id icffcefaccdfceeb
1468,def as dtype type value pass raise typeerror cannot convert value r to a tensorflow dtype type value cannot convert value r to a tensorflow dtype type value ,fix tf dtypes as dtypes error message when invalid argument is a multi element tuple previously the tuple would be unpacked in string formatting and if it had more than one element we would get an argument unpacking error instead of the intended typeerror piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
1469,void parser parseenum bool is union if prevsize enum def vals vec prevsize 1 value ev value error enum values must be specified in ascending order while isnext ' ' while isnext ' ' token ' ' expect ' ' if enum def attributes lookup bit flags for auto it enum def vals vec begin it enum def vals vec end ,the list of enum values is now allowed to end in a comma bug change id tested on os x , fix a bug in the parser test for the new code svn r
1470,class activationopbuilder public opbuilder private tensorid node output float input min input max float relu value 6 ,update other builders for hexagon delegate to use the method to compute and add min max to the op piperorigin revid change id , fix a bug in the new delegate piperorigin revid
1471,static unsigned long handle arg iovec int childno unsigned long call unsigned entry syscalls call entry num entries 1 rand 11 num entries rand 256 switch argnum case 1 if entry arg2type arg ioveclen ,limit the number of iovec entries to for now , fix a bug in the watchdog page
1472,suggest trie walk su lp soundfold normal byte go one level deeper if it's not equal to the byte in the bad word adjust the score but don't even try when the byte was already changed and don't try when we just deleted this byte accepting it is always cheaper then just deleted this byte accepting it is always cheaper than delete substitute if c sp ts ifdef feat mbyte ,updated for version problem typos in messages solution then than dominique pelle , fix a bug in the new parser test piperorigin revid
1473,class function object handle symbolic feed for x y in zip feed symbols symbol vals connection callable opts tensor connection add if x dtype y dtype y math ops cast y dtype x dtype from tensor ops as graph element y if from tensor is none from tensor y ,extend keras symbol feeding to dynamic length tensors and tensors of different dtypes from the target placeholders piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1474,status tensorstore addtensor const string name const tk return errors invalidargument failed to add a tensor with name ' name ' to the tensor store dirty true return status ok ,rollback of add dirty bit to the initial version had undefined behavior and will be fixed in a subsequent change piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
1475,memoryallocation memoryallocation const void ptr size t num bytes note that 64 bit arm may also suffer a performance impact but no crash that case is not checked error reporter report the supplied buffer is not 4 bytes aligned tf lite report error error reporter the supplied buffer is not 4 bytes aligned buffer nullptr buffer size bytes 0 return ,optionally strip error message strings to reduce binary size this initial change is limited to framework code i'll follow up with a version that stubs out kernel error reporting calls too piperorigin revid change id , xla gpu support for the layout interface piperorigin revid change id idacdededdbdcfbcdb
1476,xla test p tan run tan std tan xla test p round run round std round xla test p erf run erf std erf nativet x return errorspec 1e 20 1e 20 xla test p erfc run erfc std erfc nativet x return errorspec 1e 20 1e 20 if defined unary test target f64 if defined xla backend does not support float64 instantiate test suite p ,xla add double precision approximation for erf erfc piperorigin revid , xla gpu support for the xla client piperorigin revid
1477,static void main loop regenerate handle children sleep 1 nothing left to do sleep a while while pidmap empty false handle children ,make the main loop sleep when idle similar to what was removed in but a level up the stack where we have better visibility into what we're currently doing , fix a bug in the watchdog page
1478,static char features static int included patches add new patch number below this line 1526 1525 ,patch problem writing to file and not connecting a channel doesn't work for ms windows solution make it work yasuhiro matsumoto , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1479,trunc string if len n room half 0 break len n i half i int half else ,patch problem compiler warning for loss of data solution add a type cast christian brabandt , patch problem when using a terminal window is a bit slow solution add a test for the command line
1480,logicalresult verifyexportedfunc funcop func if auto attr func flatsymbolrefattr i tf saved model bound input if unique bound inputs insert attr getvalue second if module getattr tf saved model under construction continue return func emiterror duplicate 'tf saved model bound input' binding ,add compiler pass to remove duplicate 'tf saved model bound input' bindings consolidate identical bound inputs so that resource variables do not alias in modules with tf saved model semantics piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid
1481,class cpuelementaliremitter public elementaliremitter llvm ir elementgenerator makeelementgenerator const hloinstruction hlo const hlotoelementgeneratormap operand to generator const override const hlotoelementgeneratormap operand to generator override protected statusor llvm value emitatan2 primitivetype prim type llvm value lhs llvm value rhs const override llvm value rhs override statusor llvm value emittanh primitivetype prim type llvm value value const override llvm value value override iremitter ir emitter ,use a to reduce llvm related boilerplate piperorigin revid , xla gpu support for the hlo hlo instruction piperorigin revid change id idadedfddaccd
1482,inline void lstmstepwithauxinput forget gate scratch for each batch and cell update the cell tensor utils vectorvectorcwiseproduct forget gate scratch cell state ptr n batch n cell cell state ptr if is cell state all zeros tensor utils vectorvectorcwiseproduct forget gate scratch cell state ptr n batch n cell cell state ptr if is layer norm lstm tensor utils meanstddevnormalization cell scratch cell scratch n cell n batch ,skip when cell state is known to be all zeros piperorigin revid change id , fix a bug in the new delegate piperorigin revid change id icfcccdcbedbaacf
1483,mac lang init void if mch getenv char u lang null charbuf 20 charbuf 50 lang is not set either because it was unset or vim was started from the query the system locale if null sizeof buf buf buf sizeof buf 10 buf buf if buf utf 8 null strcat buf utf 8 vim setenv char u lang char u buf ifdef have locale h setlocale lc all ,patch mac default locale is lacking the encoding problem mac default locale is lacking the encoding solution add utf to the locale yee cheng chin closes , patch problem when using a popup window with a terminal window solution add a test for the mouse flag
1484,statusor hloinstruction groupshardingondims other sharding other group dims output grouped ignore group order true other other reshard other grouped todo yuanzx use reshard to replicate when ready partially replicated other other other grouped group dims other reshard hlo sharding util other sharding other grouped group dims hlo top level sharding to reset emplace back partially replicated other partially replicated other sharding partially replicated other set sharding other grouped sharding auto other p partitionedhlo partially replicated other other base shape ,xla spmd schedule aware all gather cse for spmd add an option so that all gather will not be reused during partitioning time but can be with a threshold of live ranges in order to control peak memory piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid
1485,limitations under the license include mlir ir builders h from llvm project include mlir ir module h from llvm project include mlir ir operation h from llvm project include mlir ir operationsupport h from llvm project include mlir ir standardtypes h from llvm project include mlir ir types h from llvm project include mlir pass pass h from llvm project logicalresult encapsulatefuncandserialize funcop entry func serialize module and return llvm raw string ostream os serialized func module module for func get print os opprintingflags print flags print flags module for func get print os print flags return success ,update tpu rewrite pass to serialize computation for compilation in generic form with debug information nfc piperorigin revid change id , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
1486,void sanitise socket int childno break case af unix protocol pf unix switch rand 3 case 0 type sock stream break ,unix sockets need protocol pf unix , make the syscall page we can be a bit more than the syscall process
1487,limitations under the license include tensorflow cc ops sendrecv ops h include tensorflow cc ops standard ops h include tensorflow compiler jit defs h include tensorflow compiler jit test util h include tensorflow compiler jit xla cluster util h include tensorflow compiler tf2xla cc ops xla ops h include tensorflow compiler tf2xla xla op kernel h status std unique ptr graph graph graphoptimizationpassoptions opt options opt options graph graph functiondeflibrary fdef lib functionlibrarydefinition flib def opregistry global fdef lib opt options flib def flib def sessionoptions session options session options env env default opt options session options session options wrapper graphoptimizationpassoptions opt options wrapper graph pass return pass run opt options ,tf xla bridge nfc reduce the amount of boilerplate required to create piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1488,llvm stringref tblgen typeconstraint getdescription const tblgen typeconstraint typeconstraint const llvm definit init def init getdef typeconstraint init getdef tblgen type type const llvm record record typeconstraint record assert def issubclassof type ,define in terms of attrconstraint matching an attribute and specifying a attribute constraint is the same thing so represent it such extract attrconstraint helper to match typeconstraint and use that where was previously used in rewritergen piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
1489,bool safe strtou64 stringpiece str uint64 value convert strings to floating point values leading and trailing spaces are allowed values may be rounded on over and underflow returns false on invalid input or if strlen value kfasttobuffersize bool safe strtof const char str float value convert strings to double precision floating point values leading and trailing spaces are allowed values may be rounded on over and underflow returns false on invalid input or if strlen value kfasttobuffersize bool safe strtod const char str double value inline bool protoparsenumeric stringpiece s int32 value ,speed up safe strtod and safe strtof functions by using double conversion library closes piperorigin revid , fix a bug in the graph piperorigin revid
1490,bool isopwithunderscoreprefix const string s fused batch norm histogram fixed width stack batch norm with global normalization todo annarev replace these ops in the next change broadcast gradient args ref identity broadcast gradient args return kunderscoreops count s 0 ,remove underscore prefix from ref identity op piperorigin revid , fix a bug in the graph piperorigin revid
1491,static char features static int included patches add new patch number below this line 399 398 ,updated for version problem cd doesn't work when the path contains wildcards yukihiro nakadaira solution ignore wildcard errors when the flag is used , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1492,namespacea namespaceb tableinnestedns function builder return offset param flatbuffers builder builder param number foo returns flatbuffers offset namespacea namespaceb tableinnestedns createtableinnestedns function builder foo namespacea namespaceb tableinnestedns builder namespacea namespaceb tableinnestedns builder foo return namespacea namespaceb tableinnestedns builder constructor ,changed the javascript generation to emit createx helper functions just like the typescript code generation i also added code so that the create methods have documentation in both javascript and typescript , fix a bug in the parser test piperorigin revid
1493,class layer model add cropping 2 2 4 4 input shape 28 28 3 now model output shape none 24 20 3 model add conv2d 64 3 3 padding 'same model add conv2d 64 3 3 padding 'same' model add cropping 2 2 2 2 now model output shape none 20 16 64 ,docs fix typo in example , fix a bug in the docstring of the docstring of the keras model piperorigin revid
1494,tflitestatus interpreterbuilder operator return cleanup and error interpreter set model model parse inputs outputs interpreter setinputs subgraph inputs interpreter setoutputs subgraph outputs ,removed the pointer to model from interpreter piperorigin revid , xla gpu support for the layout of the layout is a bit piperorigin revid
1495,def result type arrays and dtypes def maybe get dtype x don't put np ndarray in this list because np result type looks at the value not just dtype of np ndarray to decide the result type if isinstance x np arrays ndarray np arrays ops tensor if isinstance x np arrays ndarray ops tensor indexed slices indexedslices return to numpy type x dtype elif isinstance x dtypes dtype ,numpy ops remove convert to tensor and tensor to ndarray from the module piperorigin revid change id , tf data saveable dataset to be used for tf data dataset piperorigin revid
1496,inline void lstmstepquantized int32 t layer norm output scale a int32 t layer norm output scale b const int32 t input bias ptr const int32 t forget bias ptr const int32 t cell bias ptr const int32 t output bias ptr int32 quantized cell clip int32 quantized proj clip int32 t cell scale int16 t quantized cell clip int8 t quantized proj clip int32 t cell scale const int32 t inv large value const int32 t input to forget effective bias const int32 t recurrent to forget effective bias ,make the type of cell clip and projection clip more precise piperorigin revid , fix a bug in the parser test piperorigin revid
1497,status grpcserver init builder setoption std unique ptr grpc serverbuilderoption new noreuseportoption master impl createmaster master env master service newgrpcmasterservice master impl get config operation timeout in ms builder master service newgrpcmasterservice master impl get config builder worker impl worker func worker func worker env worker env worker service ,support override of device filters for grpc by overriding the requests with default session config piperorigin revid , fix a bug in the test case piperorigin revid
1498,bool kerneltestdelegateproviders initfromcmdlineargs int argc std vector tools tflitedelegateptr kerneltestdelegateproviders createalldelegates const kerneltestdelegateproviders createalldelegates const tools toolparams params const std vector tools tflitedelegateptr delegates for const auto one tools getregistereddelegateproviders auto ptr one createtflitedelegate params auto ptr one createtflitedelegate params it's possible that a delegate of certain type won't be created as user specified benchmark params tells not to if ptr nullptr continue ,provide a way to utilize delegate providers to create tflite delegates based on local only parameters piperorigin revid change id , xla gpu support for the same dimension of the same dimension piperorigin revid change id idddefebfaaab
1499,def zeros like v2 python tensor tf constant 1 2 3 4 5 6 tf zeros like tensor 0 0 0 0 0 0 tf zeros like tensor 0 0 0 0 0 0 with dtype int32 if dtype of input tensor is float32 then the output is also of float32 tensor tf constant 1 0 2 0 3 0 4 5 6 tf zeros like tensor 0 0 0 0 0 0 with dtype if you want to specify desired dtype of output tensor then specify it in the op tensor tf constant 1 0 2 0 3 0 4 5 6 tf zeros like tensor dtype tf int32 0 0 0 0 0 0 with dtype int32 args ,added couple of examples for tf zeros like , fix a bug in the docstring of the docstring of the docstring of the docstring change
1500,static char features static int included patches add new patch number below this line 1408 1407 ,patch hidden conflicts with system header file problem hidden conflicts with system header file solution rename to hidden , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1501,static bool region region region limit for block block pop back val for operation op block for value operand op getoperands operand should be non null here if the ir is well formed but we don't assert here as this function is called from the verifier and so could be called on invalid ir if operand if noteloc op emitoperror block's operand not defined attachnote noteloc return false check that any value that is used by an operation is defined in the same region as either an operation result or a block argument if operand getparentregion limit ,make to invalid ir this function is only called from the verifier piperorigin revid , xla gpu support for the hlo client backend piperorigin revid change id idadedfddaccd
1502,class bernoulli distribution self batch shape array ops shape self p self event shape array ops constant dtype dtypes int32 property def strict self return self strict property def name self return self name ,add strictness flag to all distributions default behavior does not change one todo for dirichletmultinomial change , fix a bug in the docstring of the test case piperorigin revid
1503,see readme txt for an overview of the vim source code include h ifdef have config h include auto config h endif ,patch make proto doesn't work well problem make proto doesn't work well solution define a few more types for cproto update proto files fix that workshop didn't build , patch problem when using a terminal window is a bit slow solution add a test for the gui
1504,class slidedataset dataset ops unarydataset none stride is deprecated use window shift instead stride deprecation deprecated none use tf data dataset window size window size shift window shift stride window stride flat map lambda x x batch window size stride window stride flat map lambda x x batch window size instead def sliding window batch window size stride none ,fix typo in deprecation warning string piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1505,static char features static int included patches add new patch number below this line 2022 ,patch no test for synidattr returning strikethrough problem no test for synidattr returning strikethrough solution extend the synidattr test singh closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1506,limitations under the license struct tfe contextoptions tf sessionoptions session options tfe contextdeviceplacementpolicy policy tfe device placement explicit struct tfe context explicit tfe context tf session s session s tfe contextdeviceplacementpolicy policy tfe context is an extension of tf session and tf session needs a tf graph tf session session tensorflow rendezvous rendezvous ,enables silent copies of eager tensors for specially constructed contexts piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1507,term start vim free curbuf b sfname curbuf b sfname vim strsave curbuf b ffname curbuf b fname curbuf b ffname if opt jo term opencmd null ,patch short name not set for terminal buffer problem short name not set for terminal buffer solution set the short name closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
1508,class mutablehashtableoptest test testcase output table lookup input string result output eval self assertallclose 0 1 1 1 5 result self assertallclose 0 1 1 default val result def self with self test session default val 1 0 keys constant op constant 3 7 0 dtypes int64 values constant op constant 7 5 1 2 9 9 dtypes float32 table lookup mutablehashtable dtypes int64 dtypes float32 default val self assertallequal 0 table size eval table insert keys values run self assertallequal 3 table size eval input string constant op constant 7 0 11 dtypes int64 output table lookup input string result output eval self assertallclose 1 2 9 9 default val result def self with self test session ,support int to float mapping in mutablehashtable change , fix a bug in the docstring of the test case piperorigin revid
1509,status s3filesystem fileexists const string fname status s3filesystem getchildren const string dir std vector string result string bucket prefix tf return if error parses3path dir false bucket prefix tf return if error parses3path dir true bucket prefix if prefix back ' ' prefix push back ' ' ,allow listing an bucket for s filesystem backend , xla gpu support for the layout interface piperorigin revid change id idacdededdbdcfbcdb
1510,export function return unknown let id renderinfo node name let tf id let tf graph util id let d3 select svg defs let select ' if the linear gradient is not there yet create it ,move tensorflow graph visualizer utility functions to a util ts file under a tf graph util namespace change , fix a bug in the documentation of the new op test piperorigin revid
1511,limitations under the license include tensorflow core framework op kernel h include tensorflow core framework tensor h include tensorflow core framework types h include tensorflow core lib core errors h include tensorflow core util stream executor util h namespace tensorflow status absl span variables cluster because we would not handle variable updates correctly any locks we have already acquired will be released when the objects are destroyed return errors unimplemented duplicate variable passed to xla cluster return errors internal duplicate variable passed to xla cluster vlog 4 acquiring lock for variable reinterpret cast void variable ,automated rollback of commit piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1512,static char features static int included patches add new patch number below this line 1258 1257 ,patch problem the channel test can fail if messages arrive later solution add a short sleep jun t , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1513,limitations under the license ifndef tensorflow kernels logistic loss h define tensorflow kernels logistic loss h include algorithm include cmath include tensorflow core kernels loss h ,refactor the common code in sdca ops cc out for multiclass sdca change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1514,status const uint64 op id tensorhandle packed handle else if h type tensorhandle remote only serialize the resource dtype and shape of the first handle since all handles are of the same resource dtype and shape if src device is on the same task of target device the handle is a local handle on the target device which means the resource dtype and shape are known on the target device device src device absl get device h device const bool serialize resource dtype and shape i 0 h dtype dt resource ctx src device target device ctx src device target device tf return if error ctx remotemgr serializeremotetensorhandle h wait until ready false op add handles mutable remote handle src device ,serialize the dtype and shape of a remote resource variable when the source device is not on the same task of the target device piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid
1515,statusor std vector std unique ptr globaldata client executeparallel for globaldata argument computation arguments single request add arguments argument handle if computation device handle nullptr single request mutable device handle computation device handle single request mutable execution options computation execution options request add requests single request ,extend the executeparallel service interface to allow multiple devices per computation piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1516,limitations under the license include tensorflow c experimental saved model public signature def function metadata h include tensorflow c experimental saved model internal signature def function metadata type h include tensorflow c experimental saved model internal signature def param list type h todo bmzhao add getter functions here as necessary extern c extern const tf tf const tf list return tensorflow wrap tensorflow unwrap list arguments extern const tf tf const tf list return tensorflow wrap tensorflow unwrap list returns end extern c ,plumbing and tensorspec through to the c api piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1517,opbuilder graphbuilder addbuilder int builtin code const tflitenode node return addbuilder createlogisticopbuilder node case ktflitebuiltinmaxpool2d return addbuilder createmaxpool2dopbuilder node case ktflitebuiltinmean return addbuilder node case ktflitebuiltinmirrorpad return addbuilder createmirrorpadopbuilder node case ktflitebuiltinmul ,support special case of mean op which can be treated as global average pooling a mean op that reduces d tensor in h and w dimension is identical to a global average pooling and it's sometimes observed in a tflite graph piperorigin revid change id , fix a bug in the delegate piperorigin revid
1518,costs combinecosts const costs left const costs right virtualscheduler virtualscheduler const grappleritem grappler item const bool use static shapes cluster cluster todo dyoon use a better way than fifo ready nodes new fifomanager use lifo instead of fifo lifo allows an output node of an node to follow it in execution saving addition memory time from having to write and read ready nodes new lifomanager graph costs costs zerocosts graph properties grappler item cluster cluster ,added to use approach of returning the next ready node piperorigin revid , add a test for the cost of the graph piperorigin revid
1519,set one cmd context xp buff while p if p ' ' argument starts after a space arg p 1 else if p ' ' p 1 nul p skip over escaped character mb ptr adv p else if p ' ' p 1 nul p skip over escaped character mb ptr adv p xp xp pattern arg ,updated for version problem hang on completion solution skip over the space yasuhiro matsumoto , patch problem when using a terminal window is a bit slow solution add a test for the command line
1520,test f mkllayoutpasstest noderewrite positive a control dmt 2 control a control dmt 3 control a control dmt 4 control a control dmt 5 control b h 1 c h 2 d h 3 dmt 0 h 6 dmt 1 h 7 dmt 2 h 8 dmt 3 h 9 dmt 4 h 10 dmt 5 h 11 e h 4 f h 5 g i h i 1 dmt 5 h 11 e h 4 f h 5 g i h i 1 ,update mkl layout pass test cc , fix a bug in the test case piperorigin revid
1521,without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license from future import absolute import from future import division from future import print function from sklearn import datasets cross validation metrics from sklearn import cross validation metrics from sklearn import preprocessing import tensorflow as tf from tensorflow contrib import learn from tensorflow contrib import learn def main unused argv load dataset boston datasets load boston boston learn datasets load dataset 'boston' x y boston data boston target split dataset into train test ,added a dropout layer to the iris custom model as well as some tests and more docstrings for example boston iris and iris custom model change , add a test for the new op op piperorigin revid
1522,static int deqoptions setmsgid udt deqoptions self pyobject if pybytes asstringandsize value valuelength 0 return 1 if dpideqoptions setmsgid self handle value valuelength 0 if dpideqoptions setmsgid self handle value uint32 t valuelength 0 return error raiseandreturnint return 0 ,eliminate compiler warnings with visual studio , fix a bug in the client client client client
1523,limitations under the license include tensorflow core platform mutex h include tensorflow core platform types h include tensorflow core public session h include tensorflow core distributed runtime server lib h namespace tensorflow class device struct tf apidefmap tensorflow mutex lock struct tf server tf server tensorflow serverinterface server tensorflow serverinterface server namespace tensorflow class tensorcapi ,add ability to start tensorflow server from java api , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1524,static struct vimoption options p term t ms t ms p term t nd t nd p term t op t op p term t rf t rfg p term t rb t rbg p term t rc t crc p term t ri t cri ,patch crash when t rf is not set problem crash when t rf is not set brian solution add t rf to the list of terminal options hirohito higashi , patch problem when using a terminal window is a bit slow solution add a test for the gui
1525,gpuexecutable resolveconstantglobals se streamexecutor executor se module spec module spec addcudacubininmemory cubin if cubin empty module spec addcudacubininmemory cubin module spec addcudaptxinmemory ptx c str tensorflow gtl flatmap int64 se devicememorybase globals ,xla gpu only add the cubin if it is available it's only non empty if we were able to run ptxas if the ptx is going to be by the driver it won't be around loading an empty cubin will result in a fatal error piperorigin revid , xla python add a xla hlo flag to the xla client client piperorigin revid
1526,limitations under the license include string h include tensorflow core platform profile utils cpu utils h include tensorflow stream executor host host platform id h include tensorflow stream executor host host stream h include tensorflow stream executor host host timer h devicedescription hostexecutor populatedevicedescription const doesn't result in thrashing or other badness 4gib chosen arbitrarily builder set device memory size static cast uint64 4 1024 1024 1024 builder set clock rate ghz static cast float clocks per sec 1e9 builder set clock rate ghz static cast float tensorflow profile utils cpuutils getcyclecounterfrequency 1e9 auto built builder build return built release ,set the clock rate for the host accurately we used per sec which is defined only in terms of the clock system call what we needed to use was the hardware clock rate change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1527,collection startc startc if startc emsg ret fail e invrange emsg ret fail e reverse range if startc 2 ,patch error for invalid regexp is not very informative problem the message invalid range is used for multiple errors solution add two more specific error messages itchyny ken , patch problem when using a popup window with a popup window solution add a test for the mouse command
1528,bool const edge edge const graphinfo info if src assigned device name dst assigned device name int src port edge src output int dst port edge dst input todo vrv shouldn't this be device cpu if info device types src id device gpu if info device types src id device cpu auto src it info output types find src id src port dcheck src it info output types end auto dst it info input types find dst id dst port bool const edge edge const graphinfo info bool const edge edge const graphinfo info node dst edge dst int dst port edge dst input if info device types dst id device gpu if info device types dst id device cpu if edge iscontroledge return false auto dst it info input types find dst id dst port dcheck dst it info input types end ,generalize logic in graph partition cc to handle device host memory copies for non gpu devices change , add a new method to the graph piperorigin revid
1529,status trtoptimizationpass init if params count use calibration use calibration params at use calibration b if params count use function backup use function backup params at use function backup b return status ok status trtoptimizationpass optimize grappler cluster cluster cp cached engine batches batches cp max cached engines max cached batches cp use calibration use calibration cp use function backup use function backup auto status convertaftershapes cp vlog 1 returning from name return status ,provide an option to allow user to disable fallback path calling native tf function in tf trt piperorigin revid , xla gpu support for the same dimension of the same dimension piperorigin revid
1530,inline bool serializetotstring const protobuf messagelite proto tstring output size t size proto bytesizelong output resize uninitialized size return proto serializetoarray output data static cast int size return proto reinterpret cast uint8 output data inline bool parsefromtstring const tstring input ,tstring in serializetotstring use this avoids the need to calculate the serialized size of the message twice and matches the behavior of messagelite piperorigin revid change id , fix a bug in the parser delegate piperorigin revid
1531,static int dpiconn get dpiconn conn const char username set things up for the call to acquire a session if pool if dpigen setrefcount pool error 1 0 return dpi failure dpigen setrefcount pool error 1 conn pool pool mode dpi oci sessget spool externalauth pool externalauth ,eliminate a race condition with reference counts and simplify the code for managing reference counts , patch problem when using a terminal window is a bit solution add a test for the cursor
1532,using reference ops select using reference ops spacetobatchnd using reference ops split using reference ops stridedslice using reference ops using reference ops transpose todo b remove this constant ,improve quantized uint int subtraction support subtraction always took the slow path on uint changed to support the non d activation path for non broadcast added support for int subtraction including broadcast and activation fns piperorigin revid , fix a bug in the toy latelowering piperorigin revid change id icfcccdcbedbaacf
1533,def extract features features feature columns use core columns make a shallow copy of features to ensure downstream usage is unaffected by modifications in the model function features copy copy features cache fc v2 features pylint disable protected access state manager fc v2 statemanagerimpl layer none trainable false if feature columns scope gbdt with variable scope variable scope scope feature columns list feature columns transformed features collections ordereddict for fc in feature columns pylint disable protected access if use core columns pylint disable protected access if isinstance fc fc v2 featurecolumn tensor fc v2 transform features v2 features fc cache fc tensor fc v2 transform features v2 features fc state manager fc else tensor fc core transform features features fc fc transformed features fc name tensor ,track lookup tables created in featurecolumn and add featurecolumn saving loading test piperorigin revid , updated for version problem when using a dictionary of a dictionary of a dictionary solution add a test for the test
1534,string printattrvalue string op const attrvalue attr value return attr value s case attrvalue ki return strings strcat attr value i case attrvalue return strings strcat attr value f case attrvalue const float f attr value f return strings strcat attr value f f f 0 f case attrvalue kb return attr value b true false case attrvalue ktype string printattrvalue string op const attrvalue attr value else if attr value list f size 0 for int i 0 i attr value list f size i if i 0 strings strappend ret strings strappend ret attr value list f i const float f attr value list f i strings strappend ret f f f 0 f else if attr value list b size 0 for int i 0 i attr value list b size i ,c code generator generate explicit float literals for default attr values change , xla gpu support for the cpu backend piperorigin revid change id idfbdfbcdacfbeebb
1535,public final class private static final string labels path tensorflow contrib lite java ovic src testdata coco labels txt private static final string model path external tflite ovic testdata detect lite external tflite ovic testdata quantized detect lite private static final string test image path external tflite ovic testdata test image 224 jpg private static final int groundtruth 1 person ,add a ms sample detection model for ovic piperorigin revid , fix a bug in the parser test piperorigin revid
1536,class implements metaedge compute the size of the tensor through this base edge this edge h h math max h this private static edge baseedge h hierarchy hierarchy class implements metaedge a lower bound for the total size return 1 h true sum the sizes of all output tensors return opnode outputshapes map shape if the shape is unknown treat it as 1 when computing function attr key string value any tensorshape we didn't find output shapes key in attributes so we don't know anything about the output tensors return result return null ,switch edge scale to linear when the graph has no shape information change , fix a bug in the test case piperorigin revid
1537,def parse func attrs attributes attrs key attr value pb2 attrvalue i value elif isinstance value float attrs key attr value pb2 attrvalue f value elif isinstance value str bytes elif isinstance value str bytes six text type attrs key attr value pb2 attrvalue s compat as bytes value else raise valueerror unsupported attribute type for s with type s ,add fine tune capabilities to object based saved model save load keep trainable bit of variables wire variables in restored funcgraphs so they are captured by piperorigin revid , fix a bug in the documentation of the documentation of the new api change
1538,status symbolicgradientbuilder addgradients gradient function to the src node output to which it should be maybe grad functions can return a vector of output pairs to make this association explicit size t dx index 0 for const edge e n in edges if e iscontroledge continue if dx index dx size int dx index e dst input if dx index dx size return errors internal invalid gradient output index dx index size dx size tf return if error dx dx index e src e src output dx dx index e src e src output ,fix a bug in addsymbolicgradients , tf data service support for tf data dataset piperorigin revid
1539,class tfapichangespec ast edits apichangespec input window shape pooling type padding dilation rate strides name data format tf nn depthwise conv2d input filter strides padding rate name data format tf multinomial logits num samples seed name output dtype ,reorder nn depthwise convd parameters for tf api piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1540,struct map get map void struct object obj struct map map bool global struct map get map void else global obj local map struct map get random object obj mmap global obj get random object obj mmap global map obj map return map ,make getmap get the map from the obj , fix a bug in the syscall page
1541,done dp fp difo dp dtdo if 0 continue goto setdata stab dt strtab create bufsiz dp dtdo dt calloc dtp sizeof dof t done dt strtab destroy stab setdata idp fp ident dt ident idp idp di kind dt difo dtp dt ident set data idp fp difo ,add bpf compiled functions even if no signed off by eugene loh eugene loh oracle com reviewed by kris van hees kris van hees oracle com , fix a bug in the new parser test piperorigin revid change id iaaeaebbe
1542,include trinity h include sanitise h void sanitise sendto unused unsigned long fd unused unsigned long buff unused unsigned long len unused unsigned long flags unused unsigned long addr unsigned long addr len addr len 128 max sock addr struct syscall syscall sendto name sendto num args 6 ,move sendto sanity into syscall def , move the syscall page to the syscall process
1543,u64 rand64 void rounds rand 4 for i 0 i rounds i r 1l wordsize rand 256 r 1l wordsize rand 8 randomly flip sign bit ,rand we want a bit number here not a value , make the syscall page from the syscall process
1544,class basesession sessioninterface raise runtimeerror 'the session graph is empty add operations to the ' 'graph before calling run ' if feeds is none feeds create request feed list ,test for partial run setup with no feeds passed test for partial run setup with no feeds passed update session py , fix a bug in the docstring of the docstring of the test case piperorigin revid
1545,nfa regmatch prog start submatch m bail out quickly when there can't be a match avoid the overhead of win linetabsize on long lines if op 1 col t state val if op 1 col t state val ifdef feat mbyte has mbyte mb maxbytes 1 endif break result false if op 1 col 1 t state val col 100 ,updated for version problem can't match v properly for multi byte characters solution multiply the character number by the maximum number of bytes in a character yasuhiro matsumoto , patch problem when using a terminal window is a bit slow solution add a test for the command line
1546,class network base layer layer optimizer self checkpointable saver save filepath session session record this checkpoint so it's visible from tf train latest checkpoint checkpoint management update checkpoint state checkpoint management update checkpoint state internal save dir os path dirname filepath model checkpoint path filepath save relative paths true all model checkpoint paths filepath def load weights self filepath by name false ,stop model save weights from printing a warning tf format also has it save relative paths in the checkpoint proto which removes a behavior difference between it and checkpointmanager piperorigin revid , update keras layers to keras piperorigin revid
1547,class summarywriter object and adds it to the event file you can pass the result of evaluating any summary op using session run client md session run or session run client md session run or tensor eval framework md tensor eval to this function alternatively you can pass a tf summary protocol buffer that you populate with your own data the latter is ,fix link in add summary docstring fix incorrect closing paren in link to session run in docstring for tf train summarywriter add summary , fix a bug in the docstring of the docstring of the new api change
1548,private template typename typename result type do apply visitor visitor const boost assert msg m type idx mpl size value type value boost log value reference is corrupted type index is out of bounds boost assert m type idx static cast unsigned int mpl size value type value return apply visitor dispatch value type call m ptr m type idx visitor ,resolved signed unsigned comparison mismatch svn r , fix a bug in the parser test piperorigin revid change id icfcccdcbedbaacf
1549,class test util tensorflowtestcase parameterized testcase p2 p2 pyformat disable def self params ragged factory ops constant 'a' 'b' p0 'c' 'd' 'e' 'f' p1 'g' p2 pyformat disable indices 1 2 0 1 2 2 0 0 1 2 0 1 self assertallequal ragged gather ops gather params indices b'c' b'e' p1 p2 b'a' b'b' b'c' b'e' p0 p1 p2 p2 b'a' b'b' b'a' b'b' p0 p0 b'c' b'e' p1 p2 b'a' b'b' b'c' b'e' p0 p1 pyformat disable def self indices ragged factory ops constant 3 4 0 6 2 1 1 0 2 5 2 3 ,fix bug in raggedgather kernel when indices is a dense tensor with at least dimensions the generated row splits corresponding to indices were too short piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
1550,gotoxy static void word g attrcurrent g attrcurrent 0xff setconsoletextattribute g hconout word static void word g attrcurrent g attrcurrent g attrcurrent g attrcurrent 0x0f setconsoletextattribute g hconout g attrcurrent word static void word g attrcurrent g attrcurrent 0x0f 4 g attrcurrent g attrcurrent 0x0f 0x0f 4 setconsoletextattribute g hconout g attrcurrent ,updated for version problem color values greater than cause problems on ms windows solution truncate to colors yasuhiro matsumoto , patch problem when using a popup window with a popup window solution add the cursor to the current buffer when the cursor is set
1551,std string stringfromgtestenv const char flag const char default val namespace internal returns a path to temporary directory tries to determine an appropriate directory for the platform gtest api std string tempdir namespace testing endif gtest include gtest internal gtest port h ,remove redundant declaration tempdir function is declared twice once in internal gtest port h and a second time in gtest h fixes a warning with gcc when is given , xla python fix a bug in the hlo evaluator piperorigin revid change id ibebfcffdcbdbdafeb
1552,status preparearguments xlaopkernelcontext ctx graph graph case xlaexpression kind kresource return errors unimplemented resource as function argument is not yet implemented case xlaexpression kind ktensorlist return errors unimplemented tensorlist as function argument is not yet implemented case xlaexpression kind kinvalid return errors invalidargument invalid function argument ,add kind to better support tensorlists rather than overloading tensorlists as we add kind this allows us to better specialize the behaviour of tensorlists such as the implementation of getshape piperorigin revid , xla gpu support for the xla client piperorigin revid
1553,tflitestatus delegatecopytobufferhandle tflitecontext context namespace gpu namespace tflite tfliteglcompileoptions defaulttfliteglcompileoptions tfliteglcompileoptions options options precision loss allowed 0 options preferred gl object type tflite gl object type fastest options dynamic batch enabled 0 return options tflitedelegate tflitegpudelegatecreate const tflitegpudelegateoptions options tflite log prod once tflite tflite log info ,introduce generator functions for default every new instance of should be populated through call to avoid breaking changes when new option is introduced piperorigin revid , xla gpu support for the layout of the layout is a tuple of the same dimension piperorigin revid
1554,ops registershape 'nonmaxsuppression' common shapes call cpp shape fn all make all name resizemethod is not documented but is documented in functions that use it all append todo skye per image whitening will be removed once all callers switch to per image standardization all append image ,add tf per image whitening back to module until callers are switched to tf per image standardization change , fix a bug in the test case piperorigin revid
1555,class class featureconfig collections namedtuple 'table id' 'max sequence length' 'table id' 'max sequence length' 'weight key' def new cls table id max sequence length 0 max sequence length 0 weight key none feature configuration args class featureconfig the corresponding maximum sequence length if the sequence is longer than this it will be truncated if 0 the feature is not a sequence feature weight key if using weights for the combiner this key specifies which input feature contains the weights returns featureconfig class featureconfig raise valueerror 'invalid max sequence length ' format max sequence length return super featureconfig cls new cls table id max sequence length return super featureconfig cls new cls table id max sequence length weight key class enqueuedata ,add alternative in high level tpu embedding api to not use feature columns but to use the mid level api and instead piperorigin revid , tf data saveable shape for tf data dataset piperorigin revid
1556,char floattobuffer float value char buffer float parsed value if safe strtof buffer parsed value parsed value value snprintf result snprintf buffer kfasttobuffersize g flt dig 2 value snprintf buffer kfasttobuffersize g flt dig 3 value should never overflow see above dcheck snprintf result 0 snprintf result kfasttobuffersize ,update protobuf to update protobuf to raise the number of digits used for floats , fix a bug in the new delegate test piperorigin revid
1557,int get new random fd void if num fd providers enabled 0 return 1 if nothing has initialized yet bail if num fd providers initialized 0 return 1 while fd 0 unsigned int i j retry ,make get new random fd bail early if no fd provider has finished yet another rare deadlock , make the watchdog process to be a child process
1558,class baseresourcevariable variables variablev1 def repr self if context executing eagerly and not self in graph mode if we cannot read the value for any reason still produce a repr try value text ops numpy text self read value is repr true except pylint disable bare except value text unavailable return tf variable ' s' shape s dtype s numpy s self name self get shape self dtype name ops numpy text self read value is repr true self name self get shape self dtype name value text else return tf variable ' s' shape s dtype s self name self get shape self dtype name ,make repr more reliable if the value is not available piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
1559,tf call uint8 declare type tf call int32 declare type tf call int16 declare type tf call int64 declare type tf call uint32 declare type tf call uint64 declare type tf call half declare type tf call complex64 declare type tf call complex128 declare type class tileop public opkernel tf call int32 handle type name tf call int16 handle type name tf call int64 handle type name tf call uint32 handle type name tf call uint64 handle type name tf call half handle type name tf call tstring handle type name when device cpudevice tf call complex64 handle type name tf call int8 handle type name cpu tf call int32 handle type name cpu tf call int16 handle type name cpu tf call int64 handle type name cpu tf call uint32 handle type name cpu tf call uint64 handle type name cpu tf call half handle type name cpu tf call complex64 handle type name cpu tf call complex128 handle type name cpu ,add uint uint support for tf tile this pr tries to address the issue raised in where there is no uint uint support for tf tile the related kernel impl for uint and uint has been added in this pr this pr fixes signed off by yong tang yong tang github outlook com , fix a bug in the test case piperorigin revid
1560,from future import division from future import print function import collections import warnings import numpy as np class rnn layer def trackable saved model saver self return layer serialization rnnsavedmodelsaver self property def weights self if self stateful warnings warn 'the internal states of stateful rnn layers are not included in ' ' layer weights please use layer states if you want to ' the internal states of the layer ' return super rnn self weights keras export 'keras layers class abstractrnncell layer ,add warnings for stateful rnn layer if layer weights is retrieved piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
1561,ex loadview exarg t eap if defined use gnome session if defined feat gui gnome defined gui may spawn defined experimental gui cmd defined proto ,patch can't build with gtk and feat gui gnome problem can't build with gtk and feat gui gnome tony mechelynck solution adjust the ifdef yegappan lakshmanan , patch problem when using a terminal window is a bit slow solution add a test for the gui
1562,static int get new random fd void retry i rand 6 if do specific proto true i 1 switch i case 0 fd get rand file fd ,remove the specific proto always use socket fds assumption , make the watchdog process to be a child process
1563,def assert shallow structure shallow tree input tree check types true structure has keys s while shallow structure has keys s list six iterkeys input tree list six iterkeys shallow tree input tree list six iteritems input tree shallow tree list six iteritems shallow tree input tree list sorted six iteritems input tree shallow tree list sorted six iteritems shallow tree for shallow branch input branch in zip shallow tree input tree assert shallow structure shallow branch input branch ,fix nest bug with different dictionary key piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
1564,test f tf check ok s tographdef expected dependencyoptimizer optimizer rewriterconfig aggressive dependencyoptimizer optimizer graphdef output tf expect ok optimizer optimize nullptr item output expected output ,enable cross device dependency grouping optimization in non aggressive modes piperorigin revid , fix a bug in the delegate test piperorigin revid
1565,class status session session log info new session discovered capturing devices op req op mutable new session std vector deviceattributes devices status status session listdevices devices if status ok log info found devices size devices for const deviceattributes dev devices req mutable devices add local device dev else log warning failed to list devices on session continuing req set session handle session return flush op ,remove device capture from replay logs piperorigin revid , tf data service support for tf data dataset piperorigin revid
1566,xla test f hloprofiletest profilesinglecomputation line no skip 'execution profile for ' assert lt line no profile output lines size tf assert ok profile output lines line no expect hlo false parsed profile lines assert lt line no profile output lines size tf assert ok profile output lines line no expect hlo true parsed profile lines assert lt line no profile output lines size tf assert ok profile output lines line no expect hlo true parsed profile lines ,xla add test assertions to xla hlo profile test these assertions help catch scenarios where the profile text is missing without these assertions the test would dereference memory locations that they should not piperorigin revid , xla gpu support for xla cpu piperorigin revid
1567,static udt environment environment new endif create the environment handle status ocienvcreate environment handle mode null null null null 0 null status ocienvnlscreate environment handle mode null null null null 0 null cxora charsetid cxora charsetid if environment handle py decref environment pyerr setstring g interfaceerrorexception static void environment raiseerror error error new environment context 1 if error switch error errornumber switch error code case 1 case 1400 case 2290 ,first cut at adding support for full unicode which is required by python but the code is structured so that this can be done with python x as well if desired the only thing currently working is the determination of error messages , patch problem when using a terminal window is a bit solution add a test for the cursor
1568,static void do extrafork struct syscallrecord rec int childstatus pid waitpid extrapid childstatus wuntraced wcontinued wnohang if pid 0 return if pid alive extrapid true kill extrapid sigkill ,remove unnecessary pid check if pid becomes non zero we bail the while loop and return anyway , fix a bug in the watchdog page
1569,class opsset enum enum and int16 activations specifying this will throw an error for operations that do not yet have quantized implementations tflite builtins activations int16 weights int8 tflite builtins activations int16 weights int8 experimental tflite builtins activations int16 weights int8 experimental tflite builtins activations int16 weights int8 def str self return self value ,renamed option with the prefix experimental change id , tf data dataset support for tf data dataset piperorigin revid
1570,class tensorarraytest xla test xlatestcase def fn ta tensor array ops tensorarray dtype dtypes float32 tensor array name foo size 3 return ta write 1 np int32 7 flow return ta write 1 constant op constant 7 flow test writing the wrong datatype with self assertraisesoperror tensorarray dtype is float but op has dtype int32 todo b remove invalidargumenterror second regexp after all callers provide proper init dtype with self assertraisesregexp valueerror errors invalidargumenterror r r conversion requested dtype float32 for tensor with dtype int32 r r tensorarray dtype is float but op has dtype int32 r xla compile fn 0 eval test util disable control flow v2 b verify dtype ,tf add support for tensorarrays to tf data dataset this includes adding support for tensorarray based aggregation in tf data experimental scan also fixes some bugs nits in tensorarray piperorigin revid , fix a bug in the graph piperorigin revid
1571,limitations under the license include string todo b 138799229 used to toggle until global presubmits pass define use tstring define use tstring ifdef use tstring ,enable tensorflow tstring stand in class after this cl tensorflow tstring will no longer be aliased to std string piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1572,test endif gtest has std tuple if gtest has absl test printoptionaltest basic absl optional int value expect eq nullopt printtostring value value 7 expect eq 7 printtostring value expect eq 1 1 printtostring absl optional double 1 1 expect eq a printtostring absl optional std string a endif gtest has absl namespace gtest printers test namespace testing ,ability to optionally depend on abseil plus upstream of , fix a bug in the parser test piperorigin revid change id icfcccdcbedbaacf
1573,eval7 else if flags eval constant ret fail else if evaluate get value of variable ret eval variable s len rettv null true false get the value of true false or a variable if len 4 in vim9script strncmp s true 4 0 rettv v type var bool rettv vval v number vval true else if len 5 in vim9script strncmp s false 4 0 rettv v type var bool rettv vval v number vval false else ret eval variable s len rettv null true false else skip the name ,patch vim true and false not recognized in vim script problem vim true and false not recognized in vim script solution recognize true and false , patch vim cannot use a function to be used problem vim cannot use a terminal window with a terminal window solution add a test for the terminal window
1574,void tfe opconsumeinput tfe op op tfe tensorhandle h tf status status op operation consumeinput h handle tfe profiler tfe newprofiler return new tfe profiler bool tfe profilerisok tfe profiler profiler return profiler profiler status ok void tfe deleteprofiler tfe profiler profiler delete profiler void tfe profilerserializetostring tfe profiler profiler tf buffer buf tf status status string content status status profiler profiler serializetostring content void data tensorflow port malloc content length content copy static cast char data content length 0 buf data data buf length content length buf data deallocator void data size t length tensorflow port free data void tfe startprofilerserver int port release child thread intentionally the child thread can be terminated by terminating the main thread ,decouple profilersession wrapper from pywrap tfe piperorigin revid change id , tf data service support for tf data experimental piperorigin revid change id idaceccfcbacfece
1575,void neonmatrixbatchvectormultiplyaccumulate const int8 t restrict vectors const float scaling factors int n batch float restrict result int result stride ifdef aarch64 if m cols 16 0 m rows 2 0 if m cols 16 0 m rows 2 0 m rows n batch if n batch 4 0 result stride 1 benchmarks suggest that it's always better to use the batch code when we can even on small matrices ,require that the batch size be less than or equal to the size of the row count before using the batch optimization piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id ibaaeabeded
1576,limitations under the license include tensorflow core lib strings numbers h include tensorflow core platform logging h include tensorflow core platform types h include tensorflow core protobuf config pb h nolint include tensorflow core protobuf config pb h nolint include tensorflow core protobuf device properties pb h nolint include tensorflow core protobuf rewriter config pb h nolint include tensorflow core protobuf rewriter config pb h nolint include tensorflow core util device name utils h if google cuda std pair int tensorflow allocator getdeviceandallocator devicenameutils parsedname parsed name if devicenameutils parsefullname engine device parsed name parsed name has id params cluster getdeviceset findmatchingdevices parsed name devices params cluster getdeviceset findmatchingdevices parsed name devices if devices empty ,fix formatting issues , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1577,class graphkeys object decorator utils classproperty def variables cls pylint disable no self argument logging warning variables collection name is deprecated please use global variables instead variables will be removed after 2017 03 02 logging log first n logging warn variables collection name is deprecated please use global variables instead variables will be removed after 2017 03 02 1 return cls global variables ,limit the amount of a use of graphkeys variables causes multiple copies of this warning next to each other often make logs unreadable piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
1578,status validateconfig const tf2xla config config tf return if error fetch fetch name names tf return if error fetch names if config feed empty config fetch empty return errors invalidargument feeds and fetches must be specified if config fetch empty return errors invalidargument fetches must be specified return status ok ,only require validation that a fetch is requested for tfxla config it is legitimate to convert a graph with only fetches eg in that case where the inputs to the graph are supplied by the infeed rather than by a feed node piperorigin revid , xla python fix a bug in the graph piperorigin revid
1579,class iteratorbase virtual status restoreinternal iteratorcontext ctx iteratorstatereader reader 0 returns a pointer to the node representing this iterator in the performance model it may be null if performance modeling is not enabled for this iterator std shared ptr model node model node const return node returns the number of elements produced by this iterator int64 num elements const if node return node num elements class iteratorbase const string output prefix std vector std function void cleanup fns std shared ptr model node node nullptr model node node nullptr not owned const iteratorbase parent nullptr not owned int64 id 0 int64 parent id 0 ,rollback of which causes tsan failures piperorigin revid change id , fix a bug in the test case piperorigin revid
1580,extern c int llvmfuzzertestoneinput const uint8 t data size t size dostuff str disregard the output return 0 ,example fix a typo in example project from , fix a bug in the new module of the new module piperorigin revid change id iaaeaebbe
1581,absl status inferencecontext initfromgraph if create info hints check modelhints kfasttuning tuning parameters tuning type tuningtype fast if tuning parameters info ismali const maliinfo info tuning parameters info mali info if info ismalit6xx mali t628 hangs forever in when used profiling queue tuningtype fast does not use profiling queue tuning parameters tuning type tuningtype fast return if error tune tuning parameters return absl okstatus ,created workaround for mali series mali t stuck in when used with profiling queue piperorigin revid change id , add a test for the graph and the graph piperorigin revid
1582,from future import print function import threading import platform from tensorflow python compiler tensorrt wrap conversion import is tensorrt enabled from tensorflow compiler tf2tensorrt wrap py utils import is tensorrt enabled from tensorflow python framework import errors tf trt so none ,rename wrap conversion to wrap py utils and move it to the tensorflow compiler directory piperorigin revid , fix a bug in the test case piperorigin revid
1583,void ax25 gen sockaddr struct sockaddr addr socklen t addrlen struct sockaddr ax25 ax25 ax25 malloc sizeof struct sockaddr ax25 if ax25 null return ax25 zmalloc sizeof struct sockaddr ax25 ax25 sax25 family pf ax25 memcpy ax25 sax25 call ax25 call page rand 7 ,proto ax zmalloc conversion , proto zmalloc conversion
1584,def concatenate tensors axis 1 python a tf constant 1 2 3 4 5 6 7 8 9 b tf constant 10 20 30 40 50 60 70 80 90 tf keras backend concatenate a b axis 1 tf keras backend concatenate a b axis 1 tf tensor id 14 shape 3 6 dtype int32 numpy array 1 2 3 10 20 30 4 5 6 40 50 60 def categorical crossentropy target output from logits false axis 1 raises valueerror if axis is neither 1 nor one of the axes of output example python import tensorflow as tf ,minor change to default behaviour of concatenate , fix a bug in the docstring of the test case piperorigin revid
1585,char avail void int retval ifdef feat eval when disable char avail for testing 1 was called pretend there is no when test disable char avail 1 was called pretend there is no typeahead if disable char avail for testing return false ,patch problem using old function name in comment more functions should start with test solution rename function in comment higashi higashi rename disable char avail for testing to test disable char avail and alloc fail to test alloc fail , patch problem when using a terminal window is a bit slow solution add a test for the gui
1586,update screen int type arg will reset clear cmdline type not valid must redraw may be set indirectly avoid another redraw later must redraw 0 if clear cmdline going to clear cmdline done below ,patch extra redraw when using ctrl l in second window problem when typing ctrl l in a window that's not the first one another redraw will happen later christian brabandt solution reset must redraw after calling , patch problem when using a popup window with a popup window solution add the cursor to the current buffer when the cursor is set
1587,int get random fd void unsigned int i unsigned int fd 0 i rand 3 if do specific proto 1 i 1 else i rand 3 switch i case 0 retry fd fds rand fd idx ,if we pass proto assume we only care about sockets , make the syscall page we can be a child process
1588,inline const char strerror int errnum return strerror errnum inline const char getenv const char name if gtest os windows mobile gtest os windows phone gtest os windows rt we are on windows ce which has no environment variables static cast void name to prevent 'unused argument' warning return null elif defined borlandc defined sunos 5 8 defined sunos 5 9 environment variables which we programmatically clear will be set to the ,noop changes to suppress compile time warnings in windows code paths , fix a bug in the parser test piperorigin revid
1589,def reduced shape input shape axes returns a 1 d tensor the output shape as if keepdims were set to true example cast needed for sparsetensor reductions if context executing eagerly input shape input shape numpy axes axes numpy input shape axes 1 return input shape example cast needed for sparsetensor reductions input shape cast input shape dtypes int32 2 3 5 7 axes cast axes dtypes int32 1 2 ,move misplaced comment piperorigin revid , fix a bug in the test case piperorigin revid
1590,class slicetest test testcase strides 1 1 1 1 1 padding valid slice t array ops slice conv t 0 1 1 1 0 1 1 1 1 8 result self evaluate slice t eval result self evaluate slice t expected 6 047066 1 1073351 1 4765838 4 126741 7 0414743 4 248739 0 9407949 3 58128 self assertallclose expected result flatten rtol 1e 6 ,fix test failure of python , tf data dataset dataset dataset to be used for tf data dataset piperorigin revid
1591,def load library library location loads a tensorflow plugin library location can be a path to a specific shared object or a folder if it is a folder all objects that are named will be if it is a folder all shared objects that are named will be loaded when the library is loaded kernels registered in the library via the register macros are made available in the tensorflow process ,fix typo shared in load library piperorigin revid , fix a bug in the docstring of the new module piperorigin revid
1592,void reflectiontest uint8 t flatbuf size t length test eq hp int64 80 auto hp double flatbuffers root hp field test eq hp double 80 0 auto hp string flatbuffers root hp field schema auto hp string flatbuffers root hp field schema test eq str hp string c str 80 we can also modify it ,reworked reflection h to be more general e g support generic reading writing from structs vectors etc change id tested on linux bug , fix a bug in the parser api piperorigin revid
1593,statusor std unique ptr pylocalbuffer pylocalbuffer copytodevice output buffer we hold on to the src device buffer until the transfer is finished src device thenrelease src device to device stream std move src device buffer write new tuple buffers the destination buffers have different addresses so we must construct tuple buffers from scratch instead of copying them if dst buffer on device shape istuple ,xla python fix potential issue in where source device buffer might get deallocated before transfer completes piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1594,import collections from tensorflow python util tf export import tf export tf export train sessionrunhook tf export v1 train sessionrunhook class sessionrunhook object ,export tf train session run hook py classes to tf estimator exporting to both v and v keep the existing only in v piperorigin revid , fix a bug in the docstring of the test piperorigin revid
1595,def make tuple of string x deprecated 2017 06 15 contrib learn dataframe is deprecated def parameter func return parameter func def parameter func tag functions annotated with parameter for later retrieval note that all parameter s are automatically property s as well ,turn off logging during transform instantiation piperorigin revid , fix a bug in the documentation of the test piperorigin revid
1596,public constructor with initialization of the stored value explicit attribute value impl boost rv ref value type v m value v explicit attribute value impl boost rv ref value type v m value boost move v attribute value dispatching method ,use move constructor when initializing an attribute value from an rvalue fixes , fix a bug in the parser test piperorigin revid
1597,bool copygraph tf graph src graph tf graph dst graph tf importgraphdefoptionsaddinputmapping opts get src first data src second dst inputs i opts get opts skip mapped nodes true we use the pivot node to control constants in src graph tf operation pivot dst inputs 0 oper tf importgraphdefoptionsaddcontroldependency opts get pivot ,don't create cond input and body input nodes when finishing while loop these nodes are not needed but they caused failures in functions with while loops because functions currently execute all ops in their bodies and these ops are placeholders without feeds piperorigin revid , add a test for the cost of the graph piperorigin revid
1598,expand shellcmd static void call user expand func void user expand func char u int char u int expand t xp int num file char u file call user expand func to invoke a user defined viml function and return the result either a string or a list call user expand func to invoke a user defined vim script function and return the result either a string or a list static void call user expand func ,patch sometimes viml is used instead of vim script problem sometimes viml is used which is confusing solution consistently use vim script hirohito higashi , patch problem when using a terminal window is a bit solution add a few more tests to the new code
1599,void buildopssubmodule py module m xlaop const xlacomputation absl span const replicagroup const absl optional channelhandle const absl optional shape allreduce py arg operand py arg computation py arg replica groups py arg operand py arg computation py arg replica groups py list py arg channel id absl nullopt py arg shape with layout absl nullopt ops def alltoall alltoall py arg operand py arg split dimension py arg concat dimension py arg split count py arg replica groups py arg replica groups py list ops def collectivepermute collectivepermute py arg operand py arg source target pairs ops def createtoken createtoken py arg builder ,xla python add default arguments to some collective ops update some tests to use xlabuilder instead of the computationbuilder wrapper piperorigin revid change id , xla python add a test for the xla client piperorigin revid
1600,class controlflowtest test testcase sess run r def testcondgrad 1 self with self test session graph ops graph with graph as default x constant op constant 10 0 name x pred math ops less 1 2 fn1 lambda array ops identity x class controlflowtest test testcase r control flow ops cond pred fn1 fn2 grad gradients impl gradients r x 0 result grad eval self assertallequal 1 0 result with self test session self assertallequal 1 0 grad eval the gradients computation creates a tensor with zeros by broadcasting a zeros constant to the required shape verify that the zero constant feeding into the fill is dominated by a switch zero graph get operation by name gradients zeros const self assertequal len zero control inputs 1 self assertequal zero control inputs 0 type switch def testcondgrad 2 self with self test session ,ensure zeros constant created is by switch node of cond context all values entering control flow context either has to be via a switch or by one piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1601,namespace tensorflow namespace internal status loadlibrary const char library filename void handle check to see if the library has been already loaded by the process if so return an error status note dlopen with rtld noload flag returns a non null pointer if the library has already been loaded and null otherwise handle dlopen library filename rtld now rtld local rtld noload if handle return errors alreadyexists library filename has already been loaded handle dlopen library filename rtld now rtld local if handle return errors notfound dlerror ,handle the case when the same custom op library is loaded twice via load op library in c check if the library is loaded and if so return an error status in python memoize library filename to module mapping if library already loaded return the module fixes change , xla python fix a bug in the hlo computation piperorigin revid change id id iefecfafdafabefecbd
1602,from future import absolute import from future import division from future import print function import basehttpserver from six moves import basehttpserver import functools import os import socket import socketserver from six moves import socketserver import tensorflow python platform def flag value return files class threadedhttpserver socketserver class threadedhttpserver socketserver basehttpserver httpserver daemon true ,updated tensorboard to work with python , fix a bug in the test case piperorigin revid
1603,class gtest api unittest internal unittestimpl impl return impl const internal unittestimpl impl const return impl these classes and are friends as they need to access private these classes and functions are friends as they need to access private members of unittest friend class test friend class internal asserthelper ,fixing typo in documentation this upstreams a google internal change , fix a bug in the parser test piperorigin revid
1604,static value forinst forinst replace all users of with assert replaceallmemrefuseswith oldmemref newmemref indexremap forinst getbody begin void indexremap return newmemref ,mark void to please compiler for unused variable check piperorigin revid , fix a bug in the new parser test for the new code
1605,std unique ptr absl flat hash set string avgpool3dgrad maxpoolgradgrad maxpoolgradgradv2 maxpool3dgradgrad if s fusible if s reducewindowpw fusible added true whitelist insert lrn lrngrad status markforcompilationpassimpl findcompilationcandidates auto vall ops xlaopregistry getallregisteredops absl flat hash set string all ops vall ops begin vall ops end check that user's provided tf operation really exists for auto s whitelist begin s whitelist end s if all ops contains string s return errors invalidargument status markforcompilationpassimpl findcompilationcandidates if whitelist size 0 whitelist contains node def op vlog 1 rejecting node name as is was not listed in tf xla supported ops as it is not listed in tf xla supported ops continue ,typo and add comment , xla gpu support for the xla client piperorigin revid change id idfbdfbcdacfbeebb
1606,void tf addgradients tf graph g tf output y int ny tf output x int nx tf session functions tf session tf session tensorflow session s tf graph g session s graph g last num graph nodes 0 device mgr nullptr extend before run true if s localdevicemanager device mgr ok devices device mgr listdevices session s graph g last num graph nodes 0 extend before run true tf session tf newsession tf graph graph const tf sessionoptions opt tf status status ,tfe context gets its local devices from the source instead of a session piperorigin revid , fix a bug in the graph optimizer piperorigin revid
1607,from tensorflow python keras engine import base layer utils from tensorflow python keras losses import binary crossentropy from tensorflow python keras losses import categorical crossentropy from tensorflow python keras losses import categorical hinge from tensorflow python keras losses import cosine similarity from tensorflow python keras losses import hinge from tensorflow python keras losses import kullback leibler divergence from tensorflow python keras losses import logcosh def sparse top k categorical accuracy y true y pred k 5 return math ops cast nn in top k y pred math ops cast y true 'int32' k k floatx def cosine similarity y true y pred axis 1 y true nn l2 normalize y true axis axis y pred nn l2 normalize y pred axis axis return math ops reduce sum y true y pred axis axis aliases mse mse mean squared error ,cosine similarity loss so that value gets minimized while training without needed a wrapper function piperorigin revid , tf data optimizer to use the keras api piperorigin revid
1608,win found hmm original window disappeared just use the first one curwin firstwin ifdef feat eval vars clear aucmd win w vars dv hashtab free all w variables hash init aucmd win w vars dv hashtab re use the hashtab vars clear aucmd win w vars dv hashtab free all w variables hash init aucmd win w vars dv hashtab re use the hashtab endif else curwin aco save curwin ,updated for version problem crash when using b w or t after closing the buffer window or tabpage solution allocate the dictionary instead of having it part of the buffer window tabpage struct yukihiro nakadaira , patch problem when using a terminal window is a bit complicated solution add a test for the cursor
1609,static char features static int included patches add new patch number below this line 1816 1815 ,patch vim another memory leak when using function reference problem vim another memory leak when using function reference solution temporarily disable the tests , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1610,from tensorflow python ops import constant op from tensorflow python ops import linalg ops from tensorflow python ops import math ops ops nogradient ops nogradient ops registergradient matrixinverse def op grad def batchmatrixdeterminantgrad op grad ops registergradient cholesky def cholesky grad op grad def op grad return linalg ops cholesky grad op outputs 0 grad ops registergradient def op grad return linalg ops batch cholesky grad op outputs 0 grad ops registergradient matrixsolve def matrixsolvegrad op grad ,add gradients for batch cholesky change , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1611,class resourcevariableopstest test util tensorflowtestcase resource variable ops assign variable op handle constant op constant 1 dtype dtypes float32 def testrepr self with context eager mode v resource variable ops resourcevariable 1 text r v self assertequal tf variable 'variable 0' shape dtype int32 numpy 1 text def self with context eager mode v resource variable ops resourcevariable 1 patch this variable to not have an available value def broken read raise valueerror this doesn't work v read value broken read text r v self assertequal tf variable 'variable 0' shape dtype int32 numpy unavailable text def self with context eager mode handle resource variable ops var handle op ,adding test for baseresourcevariable repr piperorigin revid change id , fix a bug in the test case piperorigin revid
1612,limitations under the license include tensorflow core framework device base h include tensorflow core framework op def pb h include tensorflow core lib strings scanner h include tensorflow core util ptr util h namespace tensorflow ,optimize and related functions since they are the most costly functions in grappler piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1613,class gradientcheckertest test testcase tf logging info x1 error f error self assertless error 1e 4 def testbfloat16 self x1 constant op constant 2 0 dtype bfloat16 x2 constant op constant 3 0 dtype bfloat16 bfloat16 is very so we use very large delta and error bar here error gradient checker max error gradient checker compute gradient lambda x1 math ops add x1 x2 x1 delta 0 1 tf logging info x1 error f error self assertless error 0 07 def self size 2 3 x1 constant op constant 2 0 shape size dtype dtypes float64 name x1 ,removes the special case for bfloat in gradient checker v which causes an infinite loop and doesn't help with anything if the function returns bfloat the precision has already been lost piperorigin revid change id , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the input piperorigin revid
1614,deviceinfo deviceinfo cl device id id supports fp16 true if vendor vendor powervr supports fp16 powervr doesn't have full support of fp16 and so doesn't list this extension but it can support fp16 in and as buffers textures types so we will use it supports fp16 true compute units count getdeviceinfo cl uint id cl device max compute units image2d max width getdeviceinfo size t id cl device image2d max height image2d max height getdeviceinfo size t id cl device image2d max width bool cldevice isadreno6xxorhigher const bool cldevice ispowervr const return info vendor vendor powervr bool cldevice isnvidia const return info vendor vendor nvidia bool cldevice ismali const return info vendor vendor mali bool cldevice supportsonelayertexturearray const return isadreno info adreno info support one layer texture array ,added functions to check vendor type piperorigin revid , xla python add a test for the cpu backend piperorigin revid
1615,static hm01b0 cfg t s hm01b0cfg pfngpioisr null static constexpr int 16 each byte takes two characters plus a space and the offset takes an additional 8 characters plus a space static constexpr int 3 9 bool g is camera initialized false void boost mode enable tflite errorreporter error reporter bool benable ,add sparkfun edge platform support for micro vision example piperorigin revid , fix a bug in the parser test piperorigin revid
1616,static int create shm void int main int argc char argv int ret exit success int childstatus unsigned int i printf trinity v stringify version dave jones davej redhat com 2012 n int main int argc char argv do main loop waitpid shm watchdog pid childstatus 0 printf nran ld syscalls successes ld failures ld n shm total syscalls done 1 shm successes shm failures ,wait for watchdog to exit before we exit main , make the syscall page from the syscall process
1617,status const hloinstruction instruction const hloinstruction token instruction operand operand no if shapeutil equal token shape shapeutil maketokenshape return internalerror expected operand lld to be token shaped actual shape is expected operand lld to be token shaped actual shape is s n s operand no shapeutil humanstring token shape c str instruction tostring c str ,add missing space in error message piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id iffcbbabfbaeecaeaa
1618,void mklpoolingfwdprimitive t execute const t src data const t dst data context dst mem set data handle static cast void const cast t dst data if context alg kind pooling max max pooling must have ws assert ws nullptr assert ws data nullptr context ws mem set data handle const cast void ws data context fwd stream submit context fwd primitives void mklpoolingfwdprimitive t execute const t src data const t dst data context src mem set data handle dummydata context dst mem set data handle dummydata if context alg kind pooling max max pooling must have ws assert ws nullptr assert ws data nullptr context ws mem set data handle dummydata ,fix a typo during code refactoring , fix a bug in the parser test piperorigin revid
1619,limitations under the license define eigen use threads include tensorflow core kernels sparse matmul op h include vector include third party eigen3 eigen core include third party eigen3 unsupported eigen cxx11 tensor include tensorflow core common runtime device h include tensorflow core framework op h ,adding new intrinsics to be used by sparsematmul change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1620,static char features static int included patches add new patch number below this line 129 128 ,patch ms windows installer doesn't use turkish translations problem ms windows installer doesn't use turkish translations solution enable the turkish translations and fix a few emir closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1621,class test testcase serialized concat dtype dtypes int32 with self assertraisesoperror r inconsistent rank across sparsetensors rank prior to r sparsetensor 1 was 3 but rank of sparsetensor 1 is 4 r inconsistent shape across sparsetensors rank prior to r sparsetensor 1 was 2 but rank of sparsetensor 1 is 3 sess run sp deserialized sp input0 input0 val sp input1 input1 val ,re using the more general deserializesparse kernel to implement and improving documentation piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1622,limitations under the license include tensorflow core distributed runtime rendezvous mgr interface h include tensorflow core distributed runtime rpc grpc util h include tensorflow core distributed runtime session mgr h include tensorflow core distributed runtime rpc grpc util h include tensorflow core framework rendezvous h include tensorflow core framework tensor h include tensorflow core lib core status h status rdmatensorresponse return errors aborted recvtensor expects a different device incarnation parsed src incarnation vs src dev attributes incarnation your worker job was probably restarted check your your worker job channel adapter worker env session mgr legacysession worker name was probably restarted check your worker job for the reason why it was restarted ,add the default worker name to messages this should help track down which worker is this worker in this worker has restarted errors piperorigin revid , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
1623,limitations under the license include functional include unordered map include utility include absl container flat hash map h include tensorflow core framework bounds check h include tensorflow core framework op kernel h include tensorflow core framework register types h class uniqueop public opkernel auto tin input flat t const int64 n static cast int64 tin size absl flat hash map t tindex uniq std unordered map t tindex uniq uniq reserve 2 n for eigen index i 0 j 0 i n i auto it uniq insert std make pair tin i j class uniqueop public opkernel return true absl flat hash map int64 int64 decltype hash fn decltype equal to fn std unordered map int64 int64 decltype hash fn decltype equal to fn uniq 0 hash fn equal to fn uniq reserve 2 tin dimension 1 ,automated rollback of commit revert piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1624,limitations under the license namespace xla when the hlo graph contains an allreduce followed by some simple linear operations followed by a crossreplicasum we can combine the ar and the crs to use an efficient crossreplicasum implementation that fully utilizes the interconnect bandwidth when the hlo graph contains a cross module allreduce followed by some simple linear operations followed by a cross replica allreduce we can combine the and the to use an efficient allreduce implementation that fully utilizes the interconnect bandwidth such sequences appear in spatially partitioned models this pass must run right after spatial partitioning class arcrscombiner public hlomodulepass ,rename crossreplicasum to allreduce throughout the xla compiler piperorigin revid , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
1625,limitations under the license namespace tensorflow namespace tpu todo henrytan remove this once tpucompilationcache migration to oss is completed if defined libtftpu static void tpucompilationcachemetrics incrementcachelookupcount bool is cache hit absl string view session name void tpucompilationcachemetrics incrementcachelookupcount void tpucompilationcachemetrics int64 count a placeholder for tracking metrics endif libtftpu namespace tpu namespace tensorflow ,add libtftpu macro qualifier to the definition of the tpucompilationcachemetrics piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1626,void mlir mhlo registeralldialects dependent dialects void mlir mhlo registerallmhlodialects mlir dialectregistry registry clang format off registry insert mlir chlo hloclientdialect mlir lmhlo lmhlodialect mlir mhlo mhlodialect clang format on ,update third party tensorflow compiler mlir tensorflow utils to not depend on the global dialect registry nfc piperorigin revid change id , xla gpu support for the hlo hlo dialect piperorigin revid change id idadedfddaccd
1627,static void read whole mapping struct map map static void read every other page struct map map char p map ptr unsigned int i nr unsigned int i nr first char buf page size nr nr pages map if rand bool x x x x for i 0 i nr i memcpy buf p i page size page size i else x x x x for i 0 i nr i i memcpy buf p i page size page size first rand bool for i first i nr i 2 memcpy buf p i page size page size static void read mapping reverse struct map map ,do the same simplification to read every other page , fix a bug in the watchdog process
1628,class xenttest test testcase op op def name for op in sess graph get operations if op op def self assertnotin batchmatmul op names self assertnotin batchmatmulv2 op names print cross entropy gradient err err self assertless err 5e 8 ,crossentropy batchmatmulv compat , fix a bug in the graph optimizer test piperorigin revid
1629,bool if op type operatortype ktanh tanh has the range 1 1 quantized data type arraydatatype kuint8 quantization params zero point 127 quantization params zero point 128 quantization params scale 1 128 0 should be exactly representable as values will typically be centered around 0 with many values near 0 ,adding support for standalone tanh operator piperorigin revid , fix a bug in the delegate piperorigin revid change id ibebfcffdcbdbdafeb
1630,pyobject cxotransform topython cxotransformnum transformnum if transformnum cxo transform int bytes ptr ' ' bytes length null result pynumber long stringobj py decref stringobj return result else if transformnum cxo transform decimal result pyobject callfunctionobjargs pyobject stringobj null ,remove redundant decrement and return from cxotransform topython signed off by alex henrie alexhenrie gmail com , patch problem when using a terminal window is a bit solution add a test for the job
1631,static bool handshake void char reply trinity server v stringify trinity udp version go ahead if strncmp buf hello strlen hello 0 printf incorrect message s n buf printf incorrect message s n buf return false static void decode child exited void printf child exited id d pid d n childmsg pid childmsg childno static void decode child signalled void struct msg childsignalled childmsg childmsg struct msg childsignalled buf printf child signal id d pid d signal s n childmsg pid childmsg childno strsignal childmsg sig int main unused int argc unused char argv int ret int main unused int argc unused char argv decode child exited break case child signalled decode child signalled break default unknown command yet just dump as hex printf rx d bytes ret ,decode child signal messages , fix a bug in the watchdog where the watchdog has been enabled
1632,static int open files void mmap fd fd filename sb st size flags dump objects obj global obj mmap dump objects obj global obj mmap return true ,remove debugging code , make the watchdog process to be a child process
1633,class sequential model else name none build input shape none layer configs config model cls name name for layer config in layer configs layer layer module deserialize layer config ,bugfix assign layer configs config to avoid uninitialized layer configs variable piperorigin revid , update keras layers to the keras model piperorigin revid
1634,class linearclassifiertest test testcase 'example id' constant op constant '1' '2' '3' 'price' constant op constant 0 4 0 6 0 3 constant op constant 0 4 0 6 0 3 sparse tensor sparsetensor values class linearregressortest test testcase 'example id' constant op constant '1' '2' '3' 'price' constant op constant 0 6 0 8 0 3 constant op constant 0 6 0 8 0 3 constant op constant 900 0 700 0 600 0 ,enables sdcaoptimizer work with dense vectors of rank by extension tf contrib learn svm tf contrib learn linearclassifier when using the sdca optimizer and can also work with dense vectors piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
1635,void bufferassignment print raw ostream os const a simple pass to print debug test information for the buffer assignment analysis struct mlir functionpass void runonfunction override llvm errs testing getfunction getname n getanalysis bufferassignment print llvm errs std unique ptr oppassbase funcop return absl make unique static passregistration buffer assignment test pass test buffer assignment outputs debug test information for the buffer assignment analysis namespace xla namespace mlir ,added test cases for new bufferassignment analysis , xla python add a test for the xla client client piperorigin revid
1636,std vector hlocomputation hlomodule makenonfusioncomputations const std unique ptr hlomodule hlomodule clone const string suffix const return clone config suffix std unique ptr hlomodule hlomodule clone const hlomoduleconfig config const string suffix const vlog 1 cloning module name suffix n auto module absl make unique hlomodule name suffix config auto module absl make unique hlomodule name suffix config hloclonecontext context module get suffix auto cloned computation entry computation clone suffix context ,add hlomodule clone overload which takes an hlomoduleconfig piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1637,int child process void unsigned int syscallnr unsigned int left to do syscalls per child void alarm 0 seed from tod while left to do 0 void do syscall from child output pid map full n exit exit failure void alarm 0 pid fork if pid 0 shm pids i pid ,revert some accidental debugging , make the syscall page we can be a child process
1638,public order followed by the constant offset to make indexing intuitive into the result static constexpr int64 t std numeric limits int64 t min logicalresult smallvector int64 t 4 strides const logicalresult smallvectorimpl int64 t strides const static bool kindof unsigned kind return kind standardtypes memref ,use smallvectorimpl in no need to force a particular size on the user of the api piperorigin revid , xla gpu support for the layout of the hlo evaluator piperorigin revid change id id iaaeabfdfedfeacedf
1639,status shapeverifier handleiota hloinstruction instruction return internalerror iota does not support scalars int64 iota dimension iota iota dimension if iota dimension rank if iota dimension rank iota dimension 0 return internalerror the iota dimension cannot go beyond the operation rank the iota dimension cannot go beyond the operation rank or be negative return status ok ,xla fix shapeverifier to not allow negative iota dimension piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1640,status iremitter kind const shape shape status iremitter handleoutfeed hloinstruction outfeed outfeed produces no useful result but it does return a token that can be threaded through to other side effecting operations to ensure ordering in the ir emitter we treat this token as a normal u8 and thus need to insert an entry for it in emitted value tf return if error emittargetaddressforop outfeed hloinstruction operand outfeed operands 0 const shape operand shape operand shape ,emit target address for outfeed this is necessary now that outfeed instructions return a token otherwise users of said token can't find it via piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id iffcbbabfbaeecaeaa
1641,class executablebuildoptions tensorflow thread threadpool compile thread pool nullptr creates an executionoptions based on a given executablebuildoptions and programshape executionoptions const executablebuildoptions build options const programshape program shape namespace xla endif tensorflow compiler xla client executable build options h ,move createmoduleconfig to a new hlo module util header move to xla client executable build options h piperorigin revid change id , xla python add a test for the xla client client piperorigin revid
1642,gui mch init void handlehicon null if mch icon load hicon ok hicon null sendmessage s hwnd wm seticon icon small hicon sendmessage s hwnd wm seticon icon small lparam hicon ifdef feat menu ,updated for version problem compiler warning solution add type cast ken takata , patch problem when using a terminal window is a bit slow solution add a test for the gui
1643,limitations under the license define tensorflow lite util h include vector include tensorflow lite c c api internal h namespace tflite struct tfliteintarraydeleter populates the size in bytes of a type into bytes returns ktfliteok for valid types and ktfliteerror otherwise tflitestatus getsizeoftype tflitecontext context const tflitetype type size t bytes namespace tflite endif tensorflow lite util h ,add pad v support to the nn api delegate piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1644,enum class memorystrategy greedy greedy by size strategy uses greedy algorithm iterating through all the tensors in non increasing of their size to reuse memory from tensors that tasks in non increasing of their breadth and calculating allocations for tensors used in these tasks by breadth of the task we understand sum of sizes of all tensors in its greedy by breadth greedy by size strategy uses greedy algorithm iterating through all the tensors in non increasing of their size to reuse memory from tensors that won't be used anymore for new ones greedy by size ,introduce two more memory management algorithms for objects to tensors assignment greedy by and greedy by size dist priority piperorigin revid , fix a bug in the new delegate piperorigin revid
1645,namespace tensorrt pull model for calibration when trt implements a means for a push calibration this class should be updated accordingly is for trt 5 1 if nv tensorrt major 5 nv tensorrt major 5 nv tensorrt minor 1 struct trtint8calibrator public nvinfer1 else struct trtint8calibrator public nvinfer1 iint8entropycalibrator endif public construct a calibrator for future calibration trtint8calibrator ,use for trt onward , fix a bug in the test case piperorigin revid
1646,static void print stats void static bool handled taint false static void taint check void if handled taint true return if is tainted true stop ftrace tainted postmortem handled taint true ,we only want to do the ftrace stop postmortem once , fix a bug in the syscall page
1647,status input buffer bytes k buffer size output buffer bytes k buffer size io zlibcompressionoptions gzip string decompressed pbtxt string tstring decompressed pbtxt string status s in readnbytes int max decompressed pbtxt string if s ok errors isoutofrange s outofrange is fine since we set the number of read bytes to int max ,updated and subclasses to use tstring this is a part of a larger migration effort for tensorflow tstring see https github com tensorflow community pull piperorigin revid , fix a bug in the test case piperorigin revid
1648,fill input buf int exit on error unused inbufcount endif unix or vms endif unix vms macos x endif defined unix defined feat gui defined vms endif use input buf exit because of an input read error ,patch endif comments do reflect corresponding ifdef problem endif comments do reflect corresponding ifdef solution update the comments rene nyffenegger closes , patch problem when using a terminal window doesn't work solution add a test for the command line
1649,static char features static int included patches add new patch number below this line 960 959 ,patch problem detecting every version of nmake is clumsy solution use a tiny c program to get the version of msc ver ken takata , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1650,buf write buf fname sfname start end eap append forceit else if reset changed whole if did cmd apply autocmds exarg event sfname sfname false curbuf eap int was changed curbufischanged did cmd apply autocmds exarg event sfname sfname false curbuf eap if did cmd if was changed curbufischanged written everything correctly and has reset 'modified' correct the undo information so that an undo now sets 'modified' u unchanged curbuf u update save nr curbuf else ifdef feat quickfix if overwriting bt nofile curbuf ,updated for version problem when a autocommand resets 'modified' this doesn't change older buffer states to be marked as 'modified' like write does yukihiro nakadaira solution when the resets 'modified' then adjust the undo information like write does , patch problem when using a terminal window is a bit slow solution add a test for the command line
1651,static pyobject module initialize void ifdef sqlt bfloat make variable type ready g nativefloatvartype endif make variable type ready g intervalvartype initialize module and retrieve the dictionary if py major version 3 static pyobject module initialize void add type object unicode g unicodevartype add type object nclob g nclobvartype endif add type object interval g intervalvartype add type object lob g externallobvartype add type object long binary g add type object long string g ,added support for interval day to second in oracle represented as python datetime objects , fix a bug in the client client client client
1652,class optimizerscompatibilitytest keras parameterized testcase hist 1 model v1 fit x y batch size 5 epochs 1 shuffle false hist 2 model v2 fit x y batch size 5 epochs 1 shuffle false self assertallclose model v1 get weights model v2 get weights self assertallclose hist 1 history 'loss' hist 2 history 'loss' self assertallclose model v1 get weights model v2 get weights rtol 1e 5 atol 1e 5 self assertallclose hist 1 history 'loss' hist 2 history 'loss' rtol 1e 5 atol 1e 5 def self opt v1 optimizers adadelta lr 0 01 ,make tolerance more reasonable on piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
1653,def local variables initializer returns an op that initializes all local variables in the graph if context in eager mode return control flow ops no op name local variables initializer return variables initializer local variables ,make sure local variables initializer returns a no op in eager mode piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the test py
1654,include mlir ir operation h include mlir support functional h include mlir support stlextras h include llvm adt setvector h include type traits implements analysis functions specific to slicing in function ,cleanups and simplifications to code noticed by inspection nfc piperorigin revid , fix a bug in the file file in the file
1655,except importerror class threadedtcprequesthandler socketserver baserequesthandler def setup self self request setsockopt socket ipproto tcp socket tcp nodelay 1 def handle self print socket opened while true ,patch channel test is flaky on freebsd problem channel test is flaky on freebsd solution set the tcp option adjust expected line count in netbeans test ozaki kiichi closes , patch problem when using a terminal window is a bit slow solution add a test for the text to the list of the line
1656,static char features static int included patches add new patch number below this line 1225 1224 ,patch linker errors when building with dynamic python problem linker errors when building with dynamic python solution add defined items closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1657,def reduce min input tensor axis none keepdims false name none returns the reduced tensor for example a tf constant 1 2 3 4 tf reduce min a tf tensor id 2 shape dtype int32 numpy 1 compatibility numpy equivalent to np min end compatibility ,add usage example to reduce min , fix a bug in the docstring of the test case piperorigin revid
1658,from tensorflow python ops import math ops class tf test testcase def testsimple self with self test session def check shape axes result output math ops reduced shape shape axes axes self assertallequal output eval result check 3 3 check 3 0 1 check 5 3 5 3 check 5 3 0 1 3 check 5 3 1 5 1 check 5 3 0 1 1 1 def self with self test session ,add more tests for math ops reduced shape change , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1659,def assert shapes shapes innermost dims false data none summarize none tuple list of size entries or a single size entry innermost dims bool if to apply constraints on the inner most dimensions only message a string to prefix to the default message data the tensors to print out if the condition is false defaults to error message and first few entries of the violating tensor summarize print this many entries of each tensor message a string to prefix to the default message name a name for this operation optional defaults to assert shapes returns ,add missing to docstring , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
1660,struct unpackparams struct leakyreluparams float alpha int32 input offset struct leakyreluparamsquant uint8 t q alpha uint8 t q identity int32 alpha offset int32 input offset int32 output offset int32 output multiplier int output shift ,fix quantized leaky relu tflite inference ops , fix a bug in the parser test piperorigin revid
1661,from future import print function from absl testing import parameterized import numpy as np from tensorflow python framework import test util from tensorflow python keras import backend as k from tensorflow python keras import combinations from tensorflow python keras import testing utils from tensorflow python keras engine import input layer from tensorflow python keras engine import training from tensorflow python keras layers convolutional import conv2d class traininggputest test testcase parameterized testcase return simple model if test is gpu available cuda only true with test util use gpu with testing utils use gpu losses to test 'sparse categorical crossentropy' 'categorical crossentropy' 'binary crossentropy' ,keras tf api usage cleanup copy test util use gpu into keras and replace the usage within keras piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
1662,void tflite builtinoperator op tflitetensor tensors const int outputs array data 1 2 tfliteintarray outputs array intarrayfromints outputs array data void user data nullptr if registration init user data registration init context buffer nullptr length 0 tflitenode node node inputs inputs array node outputs outputs array node user data nullptr node user data user data node builtin data nullptr node custom initial data nullptr node custom initial data size 0 ,store opdata from eval into a stored persistent buffer in the comparisons kernels the reference kernel currently quantized data every eval which is slow on device and does not match upcoming changes for ram savings piperorigin revid change id , fix a bug in the graph piperorigin revid
1663,statusor std unique ptr hlomoduleconfig service createmoduleconfig module config enable hlo profiling true module config set replica count execute backend replicas size todo fix this properly this value is wrong if we are creating a module for use with the compute constant backend however so long as the execute backend exists it works out because we always use a cpu backend for the compute constant backend and cpu backends ignore this value we do need to ensure that the execute backend exists however to avoid a segfault when computing constants in a compileonlyservice if execute backend module config set replica count execute backend replicas size module config set fast math disabled execution options disable fast math module config set seed execution options seed ,xla fix fallout from et al refactoring that change broke computation of constants in the bridge for a couple of reasons which are described in the comments adjacent to the fixes change , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1664,here https www tensorflow org code tensorflow core example feature proto fixedlensequencefeature parse example parse single example parse tensor decode json example queues ,add a new parse tensor op for parsing a serialized tensorproto into a tensor change , tf data saveable dataset to be used by default piperorigin revid
1665,class interpreter return op reg profiling string context node set the value of an external context void setexternalcontext tfliteexternalcontexttype type tfliteexternalcontext ctx private friend class interpreterbuilder friend class interpretertest class interpreter struct tflitecontext context tfliteexternalcontexttype type set the value of an external context void setexternalcontext tfliteexternalcontexttype type tfliteexternalcontext ctx static void setexternalcontext struct tflitecontext context tfliteexternalcontexttype type tfliteexternalcontext ctx ,extend external context for edge tpu piperorigin revid , xla python fix a bug in the new delegate piperorigin revid change id ibadadadacbbbef
1666,void init child struct childdata child int childno set seed this child init object lists obj local init child mappings dirty random mapping ,move initialization of child lists into init child , make the syscall page we can be a child process
1667,static struct builtin term builtin termcaps int ks ue 033 0m int ks czh 033 int ks czr 033 0m if defined morphos defined aros if defined amigaos4 defined morphos defined aros int ks 8 allow 8 colors ifdef terminfo int ks cab 033 4 p1 dm set background color ,patch amiga not all colors are used on os problem amiga not all colors are used on os solution adjust the ifdef to include ola s√∂der closes , patch problem when using a terminal window is a bit solution add a few more tests to the new code
1668,def fuse op graph def input nodes output nodes output dtypes def get placeholders graph get placeholders of a graph for example python a tf placeholder dtype tf float32 shape 2 2 name 'a' a tf placeholder dtype tf int32 shape 3 2 name 'b' tf contrib framework get placeholders tf get default graph returns tf tensor 'a 0' shape 2 2 dtype float32 tf tensor 'b 0' shape 3 2 dtype int32 args graph a tf graph returns ,make get placeholders accessible and add example make get placeholders accessible and add example add test revert add test this reverts commit update comment , tf data service support for tf data dataset piperorigin revid
1669,limitations under the license include freertos task h include tensorflow lite micro examples micro speech main functions h int tf main int argc char argv void tf main void setup while true loop ,esp build fix function prototype warning signed off by vikram dattu vikram dattu espressif com , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1670,static long syscall32 int num args unsigned int call return res todo 6 arg 32bit x86 syscall goes here else todo 32 bit syscall entry for non x86 archs goes here unused num args unused call unused a1 unused a2 unused a3 unused a4 unused a5 unused a6 endif todo 32 bit syscall entry for non x86 archs goes here return 0 ,supress unused param warnings in syscall arches that do not define any code for syscall are failing to compile because gcc complains about unused parameters supress these warnings signed off by jan stancek jstancek redhat com , fix a bug in the watchdog process
1671,status xlacompilationcache compilesingleop graphdebuginfo debug info std vector std string control rets if result dtypes empty control rets push back node def name return compilegraphtoxlahlo graph mlir xlacompiler argument args graph mlir xlacompiler argument args control rets options device type type string compile options use tuple arg options flib def debug info options shape representation fn result endif ,update compilegraphtoxlahlo to populate target control ret nodes this is in preparation of updating graph pruning to always prune imported function graphs piperorigin revid change id , xla python add a test for the xla client client piperorigin revid
1672,class pylocalclient protected std string platform name localclient client py ref manager must come after devices in the class destruction order i e appear first in the class destruction of devices waits for them to callbacks on device streams may refer to py ref manager and we must wait for them to complete pythonrefmanager py ref manager std vector std unique ptr device devices se devicememoryallocator allocator std unique ptr se devicememoryallocator owned allocator tensorflow thread threadpool transfer pool pythonrefmanager py ref manager holds a reference from python to one or more device buffers ,xla python fix destructor ordering problem wait for devices to quiesce before deleting the pythonrefmanager will fix the remaining problem in https github com google jax issues when deployed in jaxlib piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id iefecfafdafabefecbd
1673,public the file scan can be performed in two ways either all files in the target directory will be considered as log files or only those files that satisfy the file name pattern see documentation on tt file collector scan for files tt for more information see documentation on tt sinks file collector scan for files tt for more information pre file collector and the proper file name pattern have already been set ,removed more deprecated macros and worked around one more broken link in the generated docs svn r , fix a bug in the parser test piperorigin revid
1674,all blacklisted ops set async stateful ops set legacy random ops set order insensitive stateful ops op types that are marked as stateless but should be whitelisted to add auto control dependencies whitelist stateless ops as tpu collective ops are blocking if there are more than one collective op in the function we need to make sure different collectives ops are scheduled in certain orders otherwise if at the same time all the replicas are launching different collective ops programs it may cause deadlock alltoall crossreplicasum collectivepermute def op is stateful op pylint disable protected access return op is stateful and op type not in all blacklisted ops return op is stateful and op type not in all blacklisted ops or op type in whitelist stateless ops class automaticcontroldependencies object ,add auto control dependencies for tpu collective ops piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
1675,did set string option opt idx varp new value alloced oldval errbuf ifdef feat spell when or is set and there is a window for this buffer in which 'spell' is set load the else if varp curbuf b s b p spl varp curbuf b s b p spf else if varp curwin w s b p spl varp curwin w s b p spf win t wp int l if varp curbuf b s b p spf if varp curwin w s b p spf l int strlen curbuf b s b p spf if l 0 l 4 strcmp curbuf b s b p spf l 4 l int strlen curwin w s b p spf if l 0 l 4 strcmp curwin w s b p spf l 4 add 0 errmsg e invarg ,updated for version problem when using ownsyntax spell checking is messed up issue solution use the window local option values christian brabandt , patch problem when using a terminal window is a bit slow solution add a test for the gui
1676,from absl testing import parameterized from tensorflow python data experimental ops import testing from tensorflow python data kernel tests import test base from tensorflow python data ops import dataset ops from tensorflow python framework import combinations from tensorflow python framework import errors from tensorflow python framework import test util from tensorflow python platform import test test util run all in graph and eager modes class modeldatasettest test base datasettestbase parameterized testcase combinations generate test base default test combinations def self dataset dataset ops dataset from tensors 0 dataset dataset map lambda x x apply ,tf data migrating remaining experimental api tests to use tf combinations and performing various minor test cleanup piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
1677,class mirroredextended distribute lib distributionstrategyextended assert devices must specify at least one device devices tuple device util resolve d for d in devices assert len set devices len devices no duplicates allowed in devices argument s devices no duplicates allowed in devices argument s devices todo josh11b require at least 2 devices self device map values replicadevicemap devices self input workers input lib inputworkers self device map ,fix no duplicates allowed error message piperorigin revid , fix a bug in the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
1678,hloinstruction spmdbuilder b permutation i i tiled dims size split dims added else permutation i split dims added permutation i 1 i tiled dims size split dims added split dims added permutation i 1 i tiled dims size i ,xla spmd fix all gather transpose when there are more than one sharded dimensions piperorigin revid change id , xla gpu support for xla hlo ir piperorigin revid change id idadedfddaccd
1679,clear showcmd if visual mode ctrl v ifdef feat linebreak ifdef feat linebreak char u saved sbr p sbr make 'sbr' empty for a moment to get the correct size p sbr empty option endif endif curwin curwin w cursor visual leftcol ifdef feat linebreak ifdef feat linebreak p sbr saved sbr endif endif sprintf char showcmd buf ld lines long leftcol 1 clear showcmd while p sel 'e' s e s e ifdef feat mbyte l mb ptr2len s else l s nul 0 1 endif if l 0 bytes ,fix build broken without multi byte feature , patch problem when using a terminal window is a bit slow solution add a test for the gui
1680,static void decode this packet struct childdata child struct packet pkt static void decode one child struct childdata child struct list head node null tmp int childno unsigned int childno int n 0 pthread mutex lock child packetmutex static void decode one child struct childdata child if child packetcount 0 printf in queue for child u d n childno child packetcount printf in queue for child u u n childno child packetcount done pthread mutex unlock child packetmutex ,fix up cppcheck signedness warnings , make the syscall page we can be a child process
1681,static char features static int included patches add new patch number below this line 1157 ,updated for version problem new regexp engine fails on command solution fix rule for postponing match further tune estimating whether postponing works better add test , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1682,void pjrtclient std move buffers std move notifier transfer the given literal to the infeed queue of the given local device status pjrtdevice transfertoinfeed const literalslice literal const only support infeed to local device tf assign or return localdevicestate local device getlocaldevicestate return local device client transfertoinfeedlocal literal local device device ordinal statusor literal pjrtdevice transferfromoutfeed const shape shape const tf assign or return localdevicestate local device getlocaldevicestate return local device client transferfromoutfeedlocal shape local device device ordinal pjrtbuffer pjrtbuffer shape on host shape shape on device shape std shared ptr trackeddevicebuffer device buffer pjrtclient client pjrtdevice device ,refactor pjrt add and to methods piperorigin revid change id , xla gpu support for the hlo client client piperorigin revid change id icbbdbfafcdfcae
1683,public class implements classifier final arraylist recognition recognitions new arraylist recognition for int i 0 i math min pq size max results i int math min pq size max results for int i 0 i i recognitions add pq poll trace endsection recognizeimage ,fix a potential bug for android demo fix bug for android demo fix bug for android demo fix bug for android demo , fix a bug in the parser test piperorigin revid
1684,gtest api assertionresult doublele const char expr1 const char expr2 of the dummy variable name thus allowing multiple scoped trace s to appear in the same block as long as they are on different lines assuming that each thread maintains its own stack of traces therefore a scoped trace would correctly only affect the assertions in its own thread define scoped trace message testing internal scopedtrace gtest concat token gtest trace line file line testing message message file line message compile time assertion for type equality staticasserttypeeq type1 type2 compiles iff type1 and type2 are ,upstream cl , fix a bug in the new parser test piperorigin revid
1685,codepage invalid enc dbcs enc dbcs new has mbyte enc dbcs 0 enc utf8 ifdef win3264 if defined win3264 defined feat cygwin win32 clipboard enc codepage encname2codepage p enc enc strcmp p enc iso 8859 15 0 endif enc locale return enc char u buf if defined win3264 defined proto if defined win3264 defined proto defined feat cygwin win32 clipboard convert an encoding name to an ms windows codepage returns zero if no codepage can be out ,updated for version problem clipboard does not work on win when compiled with cygwin solution move the win clipboard code to a separate file and use it when building with os unix c ken takata , patch problem when using a terminal window is a bit slow solution add a few more tests to the new code
1686,class qroptest test testcase val self evaluate all ops for i in range 8 q 4 i self assertallequal val q val q 2 q1 self assertallequal val q 1 val q 3 r1 r2 self assertallclose val q val q 2 q1 self assertallclose val q 1 val q 3 r1 r2 def dtype shape full matrices use static shape ,tf xla remove floating point equality check in qr op test instead check if the values are close this test exists to check concurrency exists without error so the equality is not necessary and fails with xla due to to autotuning piperorigin revid , fix a bug in the test case piperorigin revid
1687,void output syscall prefix int childno exit if should not continue at all if logging true find the log file handle log handle robust find logfile handle todo strip out ascii control symbols in buffer for files void output syscall postfix int childno render syscall postfix rec buffer if logging true find the log file handle log handle robust find logfile handle if log handle null flushbuffer buffer log handle ,remove obvious comments , make the syscall page we can be a bit more than the syscall process
1688,win update win t wp endif if mod top 0 wp w topline mod top if mod top 0 wp w topline mod top wp w lines 0 wl valid wp w topline wp w lines 0 wl lnum w topline is the first changed line the scrolling will be done further down w topline is the first changed line and window is not scrolled the scrolling from changed lines will be done further down else if wp w lines 0 wl valid wp w topline wp w lines 0 wl lnum ,patch redraw error when using visual block and scroll problem redraw error when using visual block and scroll solution add check for w topline closes , patch problem when using a popup window with a terminal window solution add the option to the current buffer when the cursor is set
1689,class expression is true for example you could use it to verify the size of a static array gtest compile assert arraysize content type names content num types content type names incorrect size gtest compile assert gtest array size names num names names incorrect size or to make sure a struct is smaller than a certain size struct staticasserttypeeqhelper template typename t struct staticasserttypeeqhelper t t evaluates to the number of elements in define gtest array size array sizeof array sizeof array 0 if gtest has global string typedef string string else ,fix warnings encountered with clang wall , fix a bug in the new delegate test piperorigin revid
1690,f ch open typval t argvars typval t rettv channel channel open char address port waittime null if channel null rettv vval v channel channel channel set json mode channel ch mode channel set timeout channel timeout if callback null callback nul channel set callback channel callback rettv vval v channel channel ,patch problem channel with pipes doesn't work in gui solution register input handlers for pipes , patch problem when using a popup window with a terminal window solution add the option to the list of the buffer
1691,static long mkcall unsigned int call int ret 0 char string 512 sptr string sptr sprintf sptr lu shm execcount sptr sprintf sptr d lu getpid shm execcount switch opmode case mode rotate ,log the pid of the child making the syscall , fix a bug in the watchdog process
1692,std string getconcatkernelcode const std string offset name dst offset std to string i const std string size name src size std to string i c if x size name x y size name y n c flt4 result srcs i read3d x y z n c flt4 result srcs i read3d x y z textureaddressmode dont care n c int dst x x offset name x n c int dst y y offset name y n c dst getaddress dst adr dst x dst y z ,added textureaddressmode dont care in kernels where we don't read out of tensor piperorigin revid , xla gpu support for the hlo client piperorigin revid change id id ieffeabbcfbfbfadcee
1693,limitations under the license ifndef tensorflow lite delegates gpu cl kernels softmax h define tensorflow lite delegates gpu cl kernels softmax h include tensorflow lite delegates gpu cl arguments h include tensorflow lite delegates gpu cl cl kernel h include tensorflow lite delegates gpu cl kernels gpu operation h include tensorflow lite delegates gpu cl precision h class softmax public gpuoperation private absl status bindarguments int3 getgridsize const arguments args clkernel kernel int3 work group size int3 8 4 1 ,added state to support batch automatically in new architecture softmax rewritten piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
1694,static char features static int included patches add new patch number below this line 182 181 ,patch unicode standard was updated problem unicode standard was updated solution include the changes christian brabandt , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1695,class queuerunnertest tf test testcase the queue to be closed and the enqueue to terminate coord join stop grace period secs 0 05 def self with self test session as sess with tf session as other sess zero64 tf constant 0 dtype tf int64 var tf variable zero64 count up to var count up to 3 queue tf fifoqueue 10 tf float32 tf initialize all variables run coord tf train coordinator qr tf train queuerunner queue count up to note that this test does not actually start the threads threads qr create threads sess coord coord other threads qr create threads other sess coord coord self assertequal len threads len other threads def self with self test session as sess countupto will raise out of range when it reaches the count ,allow a queuerunner to create threads on multiple sessions change , fix a bug in the docstring of the test piperorigin revid
1696,test batchtospacendoptest 4 8 11 15 12 16 ifdef gtest has death test test batchtospacendoptest expect death batchtospacendopconstmodel 3 2 2 1 2 2 0 0 0 0 cannot allocate tensors test batchtospacendoptest invalidcropsdynamictest m 0 0 1 0 expect death m invoke crops 2 0 was not true endif namespace namespace tflite ,enable kernel tests for ios piperorigin revid , xla python fix a bug in the test piperorigin revid
1697,class opkernelcontext allocatorattributes input alloc attr int index const dcheck ge index 0 dcheck lt index params input alloc attrs size return params input alloc attrs index if params input alloc attrs nullptr return allocatorattributes else dcheck ge index 0 dcheck lt index params input alloc attrs size return params input alloc attrs index allocatorattributes output alloc attr int index const ,bug fix don't dereference nullptr in opkernelcontext input alloc attr piperorigin revid , fix a bug in the test case piperorigin revid
1698,def is the check for code below is because isgeneratorfunction crashes without one if hasattr o ' code ' and tf inspect isgeneratorfunction o logging warn 'entity s appears to be a generator function it will not be converted' ' by autograph ' o logging log 2 s generator functions are not converted' o return true ,suppress the warning on generator functions they are rare and when they occur it's usually in library code that the user has no control over piperorigin revid change id , fix a bug in the docstring of the new api piperorigin revid
1699,class test testcase def self module1 self test constant 123 export decorator tf export tf export 'name a' 'name b' export decorator export constant test constant self assertequals 'name a' 'name b' 123 export decorator export constant 'test constant' self assertequals 'name a' 'name b' 'test constant' module1 tf api constants def self ,update tf export py to take constant name as an argument instead of a constant piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1700,static void const recordkeeper recordkeeper emitopclasses defs os static void const recordkeeper recordkeeper raw ostream os op def file os const auto defs recordkeeper getallderiveddefinitions op os ifndef all ops n define all ops op name n endif n for const auto def defs os all ops def getname def getvalueasstring opname n os undef all ops static mlir genregistration gen op definitions generate op definitions const recordkeeper records raw ostream os ,delete dead function can reintroduce when needed piperorigin revid , fix a bug in the parser build piperorigin revid
1701,tflitestatus prepare tflitecontext context tflitenode node if data is mli applicable data mli in reinterpret cast mli tensor data mli in static cast mli tensor context allocatepersistentbuffer context sizeof mli tensor data mli out reinterpret cast mli tensor data mli out static cast mli tensor context allocatepersistentbuffer context sizeof mli tensor data cfg reinterpret cast mli pool cfg data cfg static cast mli pool cfg context allocatepersistentbuffer context sizeof mli pool cfg ops micro converttomlitensor input data mli in ,fixed pooling according to review comments , add support for int int piperorigin revid
1702,int this child 0 static void setup page maps void struct map map unsigned long page unsigned int i page void page maps for i 0 i page size sizeof unsigned long i struct map map map get map page i unsigned long map ptr ,cppcheck variable scoping reductions , make the watchdog process to the syscall process
1703,chk modeline ifdef feat eval save current sctx current sctx current sctx sc sid sid modeline current sctx sc seq 0 current sctx sc lnum 0 endif retval do set s opt modeline opt local flags ,patch reloading a script gives errors for existing functions problem reloading a script gives errors for existing functions solution allow redefining a function once when reloading a script , patch vim cannot use a function to be used problem vim cannot use a terminal window with a terminal window solution add a test for the terminal window
1704,void arithmeticoptimizer simplifyarithmeticops for nodedef consumer consumers update consumer 's use of node to input 's operand for int i 0 i consumer input size i if nodename consumer input i node name consumer mutable input i simplified tensor int operand pos string operand node name parsenodename consumer input i operand pos if operand node name node name consumer mutable input i operand pos 0 ascontroldependency nodename simplified tensor simplified tensor vlog 2 update input consumer input i of consumer name to simplified tensor vlog 2 update input node name of consumer name to simplified tensor node map updateinput consumer name node name simplified tensor if nodes to simplify exists consumer nodes to simplify pushback consumer ,grappler correctly replace control dependency uses when redirecting the use of node a to node b old code incorrectly replace control dependencies with data dependencies piperorigin revid , xla python fix a bug in the graph piperorigin revid change id id icfecdffaddccbded
1705,ml recover void attr hl attr hlf e if the file name ends in s a z we assume this is the swap file if the file name ends in s a w a z we assume this is the swap file otherwise a search is done to find the swap file s fname curbuf b fname ml recover void strnicmp fname len 4 s 2 endif 0 vim strchr char u fname len 2 null vim strchr char u tolower asc fname len 2 null ascii isalpha fname len 1 directly true ,patch recovering does not work when swap file ends in problem recovering does not work when swap file ends in solution check for all possible swap file names closes closes , updated for version problem when using a character of a character of a character of the line line is not used solution add the option to the end of the line
1706,class generatordatasetop dataset public datasetbase tf return if error dataset init func instantiate ctx tf return if error dataset next func instantiate ctx tf return if error dataset finalize func instantiate ctx tf return if error dataset init func runwithborrowedargs ctx state return status ok class generatordatasetop dataset public datasetbase bool end of sequence override mutex lock l mu if initialized tf return if error dataset init func runwithborrowedargs ctx state initialized true if finalized end of sequence true return status ok class generatordatasetop dataset public datasetbase private mutex mu bool initialized guarded by mu false bool finalized guarded by mu false std vector tensor state guarded by mu ,the generatordataset init function was being run during initialization which is a blocking op moving it to the getnext call which is a non blocking async op this means we can now revert back to the default of threads per gpu piperorigin revid , fix a bug in the test case piperorigin revid
1707,class eagertensorarray object if len tensors len self tensor array and not self dynamic size raise valueerror cannot unstack d tensors into a tensorarray of static size d len tensors len self tensors len tensors len self tensor array ta self identity without array ta implementation tensor array tensors pylint disable protected access return ta ,tiny bugfix to eager tensorarray error message piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1708,from tensorflow python util import nest def inputs compatible args function todo vbardiovsky the compatibility check should be about the signature not the flattened version of it flattened inputs nest flatten args if len flattened inputs len function inputs expected input count len function inputs len function captured inputs if len flattened inputs expected input count return false for a b in zip flattened inputs function inputs if a dtype b dtype or not b shape is compatible with a shape ,object savedmodel initial support for serializing functions that depend on other serialized nodes piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental keras piperorigin revid
1709,test f bfloat16conversionfoldingtest foldcrossreplicasumtupleoutput hloinstruction crs builder addinstruction hloinstruction createcrossreplicasum shapeutil maketupleshape f32 shape f32 shape convert a b sum replica group ids barrier sum replica group ids barrier all reduce id tensorflow gtl nullopt hloinstruction gte a builder addinstruction hloinstruction creategettupleelement f32 shape crs 0 hloinstruction gte b builder addinstruction ,xla cleanup remove the default value of all reduce id in the declaration default value could be error prone e g some hlo passes might forget to handle it piperorigin revid , xla gpu support for the xla client piperorigin revid change id id ibebfcffdcbdbdafeb
1710,def py zip iterables return zip iterables supported builtins abs float int len print range enumerate zip def map fn iterables if all isinstance x dataset ops datasetv2 for x in iterables return tf dataset map fn iterables return py map fn iterables def tf dataset map fn iterables return dataset ops datasetv2 zip iterables map fn def py map fn iterables return map fn iterables supported builtins abs float int len print range enumerate zip map if six py2 supported builtins xrange builtin fuinctions map 'xrange' range 'enumerate' enumerate 'zip' zip map ,override map on autograph , fix a bug in the docstring of the docstring of the test case piperorigin revid
1711,test test testsettype 1 1 todo b clarify what's the max allowed matrix size testsettype 1 32767 1 testsettype 5 4 testsettype 9 1025 10 ,fix ubsan error in test that was testing accumulation depth piperorigin revid , fix a bug in the test case piperorigin revid
1712,from tensorflow python estimator import util as estimator util from tensorflow python framework import dtypes from tensorflow python framework import ops from tensorflow python framework import tensor shape from tensorflow python framework import tensor util from tensorflow python keras impl keras import backend from tensorflow python keras impl keras import constraints from tensorflow python keras impl keras import initializers class layer checkpointable checkpointablebase raise runtimeerror 'layer add loss not supported in eager mode ' losses generic utils to list losses losses ops convert to tensor loss dtype backend floatx if not tensor util is tensor loss else loss for loss in losses self losses losses if inputs is none for loss in losses ,allow layer add loss to receive non tensor fixes error triggered when using a weight regularizer of factor piperorigin revid , compat update forward compatibility horizon to piperorigin revid change id ifdfeefacdfaaacaec
1713,build stl str hl ifdef feat eval win t save curwin buf t save curbuf intsave visual active endif intempty line colnr build stl str hl save curbuf curbuf save curwin curwin save visual active visual active curwin wp curbuf wp w buffer visual mode is only valid in the current window if curwin save curwin visual active false str eval to string safe p t use sandbox curwin save curwin curbuf save curbuf visual active save visual active do unlet char u g actual curbuf true do unlet char u g actual curwin true ,patch ml get error when accessing visual area in 'statusline' problem ml get error when accessing visual area in 'statusline' solution disable visual mode when using another window closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
1714,int main int argc char argv for i 0 i 20 i int arg i if ioctl fd 128 arg 0 perror req ioctl fd 128 arg close fd ,don't emit output on stderr from the trigger this output would go to stderr messing up the printed test output , fix a bug in the watchdog process
1715,dosinst h common code for dosinst c and uninstall c visual studio 2005 has 'deprecated' many of the standard crt functions if msc ver 1400 define crt secure no deprecate define crt no deprecate endif include stdio h include stdlib h include string h include fcntl h ifndef unix lint include vimio h include io h include ctype h include direct h ,patch ms windows dealing with deprecation is too complicated problem ms windows dealing with deprecation is too complicated solution use io h directly move crt secure no deprecate to the build file suppress c warning by setting win winnt ken takata closes , patch problem when using a terminal window is a bit solution add a test for the mouse engine
1716,namespace functor declare gpu spec index t int64 tf call gpu number types declare gpu spec tf call bool declare gpu spec tf call int32 declare gpu spec tf call int64 declare gpu spec tf call int64 declare gpu spec register one hot gpu index type int64 tf call gpu number types register one hot gpu tf call bool register one hot gpu tf call int32 register one hot gpu tf call int64 register one hot gpu ,add gpu kernel for bool onehot piperorigin revid , add support for int ops piperorigin revid
1717,delete recursive char u name a symbolic link to a directory itself is deleted not the directory it points to if if defined win32 mch isdir name mch is symbolic link name else ifdef unix if defined unix defined win32 mch name else else mch isdir name endif endif ,patch problem ms windows delete does not recognize solution add mch for ms windows update mch is symbolic link ken takata , patch problem when using a terminal window is a bit slow solution add a test for the test
1718,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 9 6 forward compatibility horizon datetime date 2020 9 7 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
1719,static char features static int included patches add new patch number below this line 1068 1067 ,patch cannot get all the information about current completion problem cannot get all the information about current completion solution add complete info shougo hirohito higashi closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1720,class rangeop public xlaopkernel datatypestring type op requires ok ctx output status if type dt int32 type dt int64 if input has dynamic dimension value is 1 propagate the dynamic dimension to output using set dimension size ctx set dynamic dimension is minus one true op requires ok ctx ctx constantinput 1 limit if type dt int32 if limit get int32 1 output xla setdimensionsize output valueordie ctx input 1 0 else if limit get int64 1 output xla setdimensionsize output valueordie xla convertelementtype ctx input 1 xla s32 0 ctx setoutput 0 output valueordie ,xla respect set dimension size in dynamic dimension inference the output of set dimension size will have a dynamic dimension set which follows the meaning of the op use set dimension size in tf range and topk previously we don't support cases like that piperorigin revid , xla gpu support for the hlo evaluator piperorigin revid change id id icabdabcccecababba
1721,class rangetest test util tensorflowtestcase self assertallequal values self evaluate tensor test util run all in graph and eager modes class test util tensorflowtestcase def self values np random uniform 0 1 1 9 size int 1e4 astype np float32 approx id math ops erfc math ops erfcinv values self assertallclose values self evaluate approx id if name main googletest main ,add tf math erfcinv the inverse to tf math erfc piperorigin revid change id , tf data vectorization test for tf data dataset piperorigin revid
1722,limitations under the license include mlir ir operation h include mlir ir standardtypes h include mlir ir types h include mlir interfaces h include mlir interfaces sideeffectinterfaces h include mlir interfaces viewlikeinterface h ,mlir lhlo replace lhlo copy removal pass with mlir copy removal pass , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
1723,limitations under the license include tensorflow lite kernels internal tensor ctypes h include tensorflow lite kernels internal types h include tensorflow lite kernels kernel util h include tensorflow lite kernels op macros h namespace tflite namespace ops namespace builtin namespace add this file has three implementation of add enum kerneltype kreference tflitestatus eval tflitecontext context tflitenode node evaladdquantized kernel type context node params data input1 input2 output else context reporterror context inputs and outputs not all float uint8 int16 types return ktfliteerror tf lite unsupported type context output type add return ktfliteok ,update error message for add op for supported ops add override for and which takes context also updated the functions to report error when the output requires broadcasting more than d d piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1724,class basic novalue ' name map allows renaming symbols ' def getanno node key field name ' pyct anno' return getattr node field name key fail object def getanno node key default fail field name ' pyct anno' if default is fail or hasattr node field name and getattr node field name key return getattr node field name key else return default def hasanno node key field name ' pyct anno' def node key field name ' pyct anno' def copyanno from node to node key field name ' pyct anno' if hasanno from node key field name setanno to node key getanno from node key field name field name if hasanno from node key field name field name setanno to node key getanno from node key field name field name field name field name ,allow calling getanno with a default value failure is still the default behavior piperorigin revid , fix a bug in the test case piperorigin revid
1725,public returns the total number of arguments int getnumargs const return arguments size using arg iterator const argument using arg range llvm iterator range arg iterator op argument attribute or operand iterators arg iterator arg begin const arg iterator arg end const arg range getargs const op argument attribute or operand accessors argument getarg int index const stringref int index const ,drr allow interleaved operands and attributes previously drr assumes attributes to appear after operands this was the previous requirements on ods but that has changed some time ago fix drr to also support interleaved operands and attributes piperorigin revid change id , fix a bug in the parser test piperorigin revid
1726,void test spots realtype t int test main int char check that can construct weibull distribution using the two convenience methods using namespace boost math weibull 2 using typedef weibull distribution 2 using default realtype double basic sanity check spot values parameter value arbitrarily zero only communicates the floating point type test spots 0 0f test float ok at decdigits 0 tolerance 0 0001 ,added check on constructors svn r , fix a bug in the previous commit piperorigin revid
1727,void cancellationmanager startcancel cancelled notification notify cancellationtoken cancellationmanager get cancellation token mutex lock l mu return next cancellation token bool cancellationmanager registercallback cancellationtoken token callback dcheck lt token next cancellation token invalid cancellation token mutex lock l mu check lt token next cancellation token invalid cancellation token bool should register is cancelled is cancelling if should register std swap callbacks token callback ,use std atomic to store the next token in cancellationmanager this avoids a lock acquisition for each token in addition the method is moved to the header to enable inlining and a check is replaced with a dcheck piperorigin revid change id , fix a bug in the parser test piperorigin revid
1728,class tf test testcase target np asarray 0 2 astype np int64 self predictions target 2 false true def self predictions 0 1 float nan 0 2 0 4 0 1 0 2 0 3 float inf target 0 2 self predictions target 2 false false if name main tf test main ,make return false if any of the predictions are nan or non finite change , tf data dataset to tf data dataset piperorigin revid
1729,from future import print function import os force enable none def enabled if force enable is none return os getenv tf2 behavior 0 0 else return force enable return force enable ,remove the redundant else condition piperorigin revid change id , fix a bug in the test case piperorigin revid
1730,class fromsavedmodeltest testmodels self assertin 'this converter can only convert a single str error exception test util run v2 only def self self skiptest 'b input data constant op constant 1 shape 1 1 x np array 1 2 ,automated rollback of commit piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1731,inline void printto absl string view sp std ostream os endif gtest has absl if gtest lang cxx11 inline void printto std nullptr t std ostream os os nullptr template typename t void printto std reference wrapper t ref std ostream os delegate to wrapped value printto ref get os endif gtest lang cxx11 if gtest has tr1 tuple gtest has std tuple ,googletest export support printing std reference wrapper t in gunit piperorigin revid , fix a bug in the parser test piperorigin revid
1732,class convertlstmcellsimpletofusedlstm rewrite the func body with constructed fused lstm void rewritefunc int getnuminputs return n input protected void updatefuncsignature void ,add a helper to lstm utils to return number of inputs in the fused tfl op piperorigin revid , fix a bug in the graph piperorigin revid
1733,int dpigen setrefcount void ptr dpierror error int increment value ptr unsigned localrefcount sword status if threaded need to protect modification of the refcount with a mutex if value env threaded status value env handle error handle value env mutex if dpierror check error status null acquire mutex 0 if dpioci threadmutexacquire value env error 0 return dpi failure value refcount increment localrefcount value refcount status value env handle error handle value env mutex if dpierror check error status null release mutex 0 if dpioci threadmutexrelease value env error 0 return dpi failure otherwise the count can be incremented normally ,remove requirement for oci header files at compilation and load oci libraries dynamically at run time this makes building drivers that depend on odpi c much easier to build it also means that only one driver is needed for all versions of the oracle client libraries , patch problem when using a terminal window is a bit solution add a test for the cursor
1734,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2019 11 29 forward compatibility horizon datetime date 2019 11 30 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
1735,bool cudablas cublas gemm tensor op cublas gemm tensor op cublas gemm tensor op endif if cuda version cublas gemm cublas gemm cublas gemm cublas gemm cublas gemm cublas gemm cublas gemm tensor op cublas gemm tensor op cublas gemm tensor op cublas gemm tensor op cublas gemm tensor op cublas gemm tensor op cublas gemm tensor op cublas gemm algo12 tensor op cublas gemm algo13 tensor op cublas gemm tensor op cublas gemm tensor op endif return true ,se add new cublas algorithms from cuda i verified that cuda did not introduce any new algorithms piperorigin revid , add a new method to the graph piperorigin revid
1736,bool that information from the input file flag input arrays parsed flags input arrays bind parsed flags input arrays default value names of the output arrays comma separated if not specified names of the input arrays comma separated if not specified will try to read that information from the input file flag output array parsed flags output array bind parsed flags output array default value ,fix a typo in toco flags description piperorigin revid , fix a bug in the test case piperorigin revid
1737,def clip by global norm t list clip norm use norm none name none calculate l2 norm clip elements by ratio of clip norm to l2 norm scale clip norm math ops minimum 1 0 use norm constant op constant 1 0 clip norm dtype use norm dtype constant op constant 1 0 dtype use norm dtype clip norm values ops convert to tensor def clip by average norm t clip norm name none math ops reduce sum t t math ops range array ops rank t tclip array ops identity t clip norm math ops minimum l2norm inv n element constant op constant 1 0 clip norm l2norm inv n element constant op constant 1 0 clip norm name name return tclip ,fix typeerror in gradient clipping ops fix typeerror in gradient clipping ops fix whitespace issue , fix a bug in the docstring of the docstring of the documentation of the example change
1738,static void bm validatestridedsliceop int iters const int32 new axis mask 0 const int32 shrink axis mask 0 shapereadwritefromtensorshape wrapped processing shape processing shape shapereadwritefromtensorshape wrapped final shape final shape tf check ok validatestridedsliceop begin end strides shapereadwritefromtensorshape input shape begin mask end mask ellipsis mask new axis mask shrink axis mask wrapped processing shape wrapped final shape is identity is simple slice slice dim0 begin out end out strides out begin end strides input shape begin mask end mask ellipsis mask new axis mask shrink axis mask processing shape final shape is identity is simple slice slice dim0 begin out end out strides out ,simplify strided slice's shape handling now that tensorshape and partialtensorshape share memory representations there's no need for an abstract class that makes tensorshape and look the same relnotes n a piperorigin revid , fix a bug in the graph piperorigin revid
1739,public class extends cameraactivity implements everything else is 0 so just pick a suitable to push up when the selected one goes down if adapter items 1 num 1 num adapter items setvalue 1 0f value ,fixed tf crash after reaching the end , fix a bug in the new delegate piperorigin revid
1740,def constantvalue tensor partial return np full fill shape as list fill value dtype fill value dtype else return none elif tensor op type equal value1 constant value tensor op inputs 0 if value1 is none return none value2 constant value tensor op inputs 1 if value2 is none return none return np equal value1 value2 elif tensor op type notequal value1 constant value tensor op inputs 0 if value1 is none return none value2 constant value tensor op inputs 1 if value2 is none return none return np not equal value1 value2 else return none ,add support for equal and not equal to tf contrib util constant value piperorigin revid , fix a bug in the graph piperorigin revid
1741,from future import absolute import from future import division from future import print function from tensorflow python distribute import distribution strategy context from tensorflow python framework import dtypes from tensorflow python framework import ops from tensorflow python ops import array ops from tensorflow python ops import math ops from tensorflow python ops import metrics impl from tensorflow python ops import variable scope from tensorflow python training import distribution strategy context todo nsilberman move into metrics python ops ,update imports to point to new location of distribution strategy context py piperorigin revid , fix a bug in the test case piperorigin revid
1742,bool isflexop const char custom name strlen kflexcustomcodeprefix 0 std unique ptr tfliteintarray tfliteintarraydeleter const std vector int data std unique ptr tfliteintarray tfliteintarraydeleter result tfliteintarraycreate data size std copy data begin data end result data return result tfliteintarray convertvectortotfliteintarray const std vector int input return convertarraytotfliteintarray static cast int input size input data ,replace usage of with this removes common logic to iterate through partitions and flattening supported nodes into one vector piperorigin revid change id , fix a bug in the new delegate piperorigin revid
1743,static void do syscall from child int cl if fork 0 printf i cl seed from tod ret do syscall cl if intelligence 1 close fds ,duh we don't need to do it twice , fix a bug in the watchdog page
1744,test f quantizemodeltest expect eq dequant op outputs 0 output idx the input and output types should be float expect eq subgraph tensors input idx type tensortype float32 expect eq subgraph tensors input idx name input quantize expect eq subgraph tensors output idx type tensortype float32 expect eq subgraph tensors output idx name output dequantize for int tensor idx 0 tensor idx subgraph tensors size tensor idx const auto tensor subgraph tensors tensor idx ,add test on tensor name piperorigin revid , xla gpu support for the layout inference piperorigin revid change id icccbcbdbcfaadbee
1745,limitations under the license include algorithm include complex include cuda include cuda h include cuda include device functions h include tensorflow core platform types h if cuda version 7050 ,delete device functions h include , xla python add a test for the client client client piperorigin revid change id icbbdbfafcdfcae
1746,status iremitterunnested emitconstantglobals llvm globalvalue notthreadlocal global address space false global for const setalignment global for const setalignment llvm align ir emitter context llvm module push back global for const ,xla stop using deprecated overloads of llvm they're going away in https github com llvm llvm project commit piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1747,limitations under the license ifndef tensorflow core platform windows windows file system h define tensorflow core platform windows windows file system h include tensorflow core lib io path h include tensorflow core platform file system h ifdef platform windows class localwinfilesystem public windowsfilesystem public string translatename const string name const override stringpiece scheme host path parseuri name scheme host path io parseuri name scheme host path return path tostring ,fix windows build change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1748,buf spname buf t buf ifdef feat job channel if bt prompt buf return char u prompt endif ifdef feat text prop if bt popup buf return char u popup endif return char u scratch ,patch popup window listed as scratch problem popup window listed as scratch solution list them as popup , patch problem when using a terminal window is a bit slow solution add a test for the command line
1749,namespace tensorflow namespace profiler namespace internal std atomic bool g annotation enabled std atomic bool g annotation enabled false g annotation enabled implementation must be lock free for faster execution of the scopedannotation api this can be commented if compilation is failing but execution might be slow even when tracing is disabled static assert atomic bool lock free 2 assumed atomic bool was lock free namespace internal ,add traceme to profiler test and fix odr violations in windows piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id icbbdbfafcdfcae
1750,limitations under the license include pybind11 pybind11 h include pybind11 pytypes h include pybind11 stl h include tensorflow compiler xla python types h namespace xla ,xla python add missing type caster registration for absl optional to jax pytree module piperorigin revid change id , xla python add a test for the client client client piperorigin revid change id icbbdbfafcdfcae
1751,test f grappleritem item check fake input item std unique ptr customgraphoptimizer optimizer std unique ptr customgraphoptimizer optimizer new assert ne nullptr optimizer tf assert ok optimizer init ,update the grappler plugin to support the defun generated function and ops piperorigin revid , fix a bug in the test piperorigin revid
1752,wait for single object return waitforsingleobject endif endif endif static void ,patch problem merge left extra endif behind solution remove the endif , fix a bug in the documentation of the new module change
1753,static llvm cl opt float error tolerance tfl error tolerance llvm cl value desc float llvm cl desc error tolerance for numeric verify valid when tfl numeric verify is set llvm cl init 1e 1f llvm cl init 5 0 nolintnextline static llvm cl opt bool enable single layer verify tfl single layer verify llvm cl value desc bool llvm cl desc whether verify layer by layer valid when tfl numeric verify is set llvm cl init false llvm cl init true namespace mlir namespace tfl ,improve the tolerance and check methods in the numeric verify piperorigin revid change id , xla gpu support for the hlo ir piperorigin revid
1754,f expandcmd typval t argvars typval t rettv memset eap 0 sizeof eap eap cmd eap arg eap argt nospc eap argt ex nospc eap usefilter false eap nextcmd null eap cmdidx cmd user ,patch flags for ex commands may clash with other symbols problem flags for ex commands may clash with other symbols solution prepend with ex , patch problem when using a terminal window is a bit slow solution add a test for the gui
1755,struct will be used to indicate errors by op constructor functions called on any child scope the op constructor functions have to check the scope's status by calling the ok method before proceeding to construct the op thread safety a scope object is not thread safe threads cannot concurrently call op constructor functions on the same scope object class scope public the following functions are for users making graphs they return new class scope graph graph const return graph get std shared ptr graph graph as shared ptr const return graph status status const return status if status is status ok convert the graph object stored in this scope ,wraps a session object and provides run methods that operate on the c api's output operation object instead of strings change , fix a bug in the new delegate test piperorigin revid
1756,ex call exarg t eap if eap skip eap addr count 0 if lnum curbuf b ml ml line count if the function deleted lines or switched to another buffer the line number may become invalid emsg e invrange break curwin w cursor lnum lnum curwin w cursor col 0 ifdef feat virtualedit ,patch ml get error when calling a function with a range problem ml get error when calling a function with a range solution don't position the cursor after the last line , patch problem when using a terminal window is a bit slow solution add a test for the test
1757,static char features static int included patches add new patch number below this line 2238 ,patch problem warning for missing declaration of skip vimgrep pat john marriott solution move it to another file , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1758,tensor auto result desc mlir function tf op mlir type ctx input desc free input desc descriptor tensorflow allocatorattributes attrs auto allocator ctx get allocator attrs tensor result tensor data type result desc tf data type allocator compare data pointers to detect forwarding void result data ptr static cast void result desc descriptor 0 if input data result data ptr ctx set output 0 input else tensorflow allocatorattributes attrs auto allocator ctx get allocator attrs tensor result tensor data type result desc tf data type allocator ctx set output 0 result tensor free result desc descriptor ctx set output 0 result tensor ,mlir kernel gen enable forwarding in unranked op gpu base for unary ops piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id idaceccfcbacfece
1759,def in functional construction mode inputs args kwargs input list if context executing eagerly return all tf utils is symbolic tensor t for t in input list else return base layer utils is in keras graph return base layer utils is in keras graph or all hasattr t ' keras history' for t in input list def convert numpy or python types x ,fix to allow functional models to be constructed inside a tf function if is guarded so as to only happen on first trace piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring change
1760,def create in process cluster num workers 2 there is something global in cuda such that if we initialize cuda in the parent process the child process cannot initialize it again and thus cannot use gpus https stackoverflow com questions return create cluster num workers num ps num ps has chief has chief has eval has eval worker config worker config ps config ps config eval config eval config protocol rpc layer cluster none try cluster create cluster num workers num ps num ps has chief has chief has eval has eval worker config worker config ps config ps config eval config eval config protocol rpc layer except errors unknownerror as e if 'could not start grpc server' in e message test testcase skiptest 'cannot start std servers ' else raise return cluster todo rchao remove test obj once estimator repo picks up the updated ,skip test if tensorflow std server could not be started piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
1761,class verifier flatbuffers final class return true supress ubsan unsigned integer overflow bool verifytablestart const uint8 t table check the vtable offset auto static cast size t table buf ,avoid unsigned integer overflow getting caught by sanitizers avoid unsigned integer overflow getting caught by sanitizers adapt from suggested compiler compatible solution and a third way , fix a bug in the parser test piperorigin revid
1762,inline value maplhlooptostdscalarop lmhlo notop location loc return nullptr template inline value maplhlooptostdscalarop lmhlo orop location loc arrayref type result types arrayref value args opbuilder b return maplhlooptostdscalaropimpl integertype mlir orop loc result types args b template inline value maplhlooptostdscalarop lmhlo rsqrtop location loc arrayref type result types inline value maplhlooptostdscalarop lmhlo tanhop location loc loc result types args b template inline value maplhlooptostdscalarop lmhlo xorop location loc arrayref type result types arrayref value args opbuilder b return maplhlooptostdscalaropimpl integertype mlir xorop loc result types args b namespace impl struct ,add plumbing for or and xor to hlo to lhlo and linalg lowerings piperorigin revid change id , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
1763,class reinforcesimpleexample tf test testcase with self test session as sess use sampling to train reinforce with st value type st sampleandreshapevalue n 1 with st value type st route selection routing loss final loss build split apply merge model ,bayesflow replace with change , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid change id iafeaeadbafaddecdc
1764,static int gen dof helper generation extern dof hdr t sunw dof dof defined in the sunw dof section static boolean t dof init debug b false from dtrace dof init debug static void dprintf int debug const char fmt va list ap if debug dof init debug return va start ap fmt if modname null void fprintf stderr dtrace dof else void fprintf stderr dtrace dof s modname void vfprintf stderr fmt ap if fmt strlen fmt 1 ' n' void fprintf stderr s n strerror errno va end ap pragma init dtrace dof init static void dtrace dof init void ,oracle com libdtrace c dprintf remove , fix a bug in the watchdog page we can be used in the syscall process
1765,class strategybase object require cross replica or default context extended self extended dst device util current or self extended default device or device cpu 0 if isinstance value ops indexedslices raise notimplementederror gather all gather does not support indexedslices return self extended local results self extended gather to value dst axis 0 ,implement gather all gather for mirroredstrategy piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
1766,class test testcase err gradient checker compute gradient error in val in shape out val out shape print image patches gradient err err self assertless err 1e 4 test util run deprecated v1 class test testcase err gradient checker compute gradient error in val in shape out val out shape print image patches gradient err err self assertless err 1e 4 test util run deprecated v1 ,remove debug print from unit test , fix a bug in the docstring of the test case piperorigin revid
1767,static void post shmget int struct shmid ds shmid ds if 1 return shmid ds malloc sizeof struct shmid ds shmctl ipc rmid shmid ds free shmid ds shmctl ipc rmid 0 struct syscall syscall shmget ,remove unnecessary allocation , fix a bug in the previous commit
1768,class trt test tftrtintegrationtestbase return array ops identity q name output 0 def getparams self the input has 1 as a first dimension which is removed by the squeeze op in the graph in explicit batch mode tensorrt can convert the whole graph in this mode it is possible to the batch dimension using the squeeze op class trt test tftrtintegrationtestbase def expectedenginestobuild self run params return the expected engines to build the first squeeze op is not converted by tensorrt in implicit batch mode the squeeze op is not converted by tensorrt in implicit batch mode because of this we have two trtengineop in the graphs one for the subgraph before q 0 ' and another one for the rest of the ops after the q 0 ' ,update description of explicit batch test , fix a bug in the graph piperorigin revid
1769,class rnn layer full input spec none for in range len nest flatten inputs additional specs perform the call with temporarily replaced input spec original input spec self input spec self input spec full input spec output super rnn self call full input kwargs self input spec original input spec remove the additional specs from input spec and keep the rest it is important to keep since the input spec was populated by build and will be reused in the stateful true self input spec self input spec len additional specs return output else if initial state is not none ,fix the input spec for rnn when stateful true the inputs spec was populated by rnn build but was overwritten when initial state was provided during call we will need the populated input spec since it might be used when stateful true see more details in piperorigin revid , fix a bug in the docstring of the docstring of the keras model piperorigin revid
1770,bool hloparserimpl if computation return false log info parsed computation computation name vlog 3 parsed computation computation name result push back computation return true bool hloparserimpl ffttype result bool hloparserimpl comparisondirection result vlog 1 vlog 3 if lexer getkind tokkind return tokenerror expects comparison direction ,drop log level for a few log lines in the hlo parser the goal is to make it consistent with other logs in the same file piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id icabdabcccecababba
1771,def main help 'the default is address ' parser add argument ' default 'x86 64' args parser parse args build data build specified commit builddata build data project name args project name build data engine args engine build data sanitizer args sanitizer build data architecture args architecture build data build specified commit builddata project name args project name engine args engine sanitizer args sanitizer architecture args architecture error sha bisect args commit old args commit new args testcase args fuzz target build data if not error sha ,cifuzz bisection make a namedtuple , fix a bug in the documentation of the new module change
1772,def truncated normal shape mean a 0 d tensor or python value of type dtype the mean of the truncated normal distribution stddev a 0 d tensor or python value of type dtype the standard deviation of the truncated normal distribution of the normal distribution before truncation dtype the type of the output seed a python integer used to create a random seed for the distribution see ,fixing wording in truncated normal as per github bug request piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
1773,class dotopemitter value or std tuple int64 int64 int64 getgemmtilesize const const std tuple int64 int64 int64 kdefaulttilesize std tuple int64 int64 int64 3 5 1 return options llvmirgemmtilesize hlo module config value or kdefaulttilesize returns true if we should use an experimental implementation of gemm general matrix matrix multiplication if possible bool const ,make the llvm ir gemm tile size configurable nfc piperorigin revid , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
1774,void device t operatenotemplate opkernelcontext context tf call float types register kernels undef register kernels if google cuda if google cuda tensorflow use rocm forward declarations of the functor specializations for gpu namespace functor define declare gpu spec t tf call gpu number types declare gpu spec tf call gpu number types register gpu kernels undef register gpu kernels endif google cuda endif google cuda tensorflow use rocm namespace tensorflow ,adding rocm support for the softsign op , add a test for the new op op piperorigin revid
1775,class gcsrandomaccessfile public randomaccessfile std unique ptr httprequest request http request factory create tf return if error request init tf return if error request seturi strings strcat https bucket request seturi strings strcat https bucket request escapestring object tf return if error request addauthbearerheader auth token tf return if error request setrange ,support for domain buckets e g gs domain example com change , fix a bug in the test case piperorigin revid
1776,void lstmblockcellfpropwithcuda use 2d blocks the number of threads per block is equal to x y where x min batch size 8 and y 32 see above for guidance on number of threads dim3 block dim 2d min batch size 8 32 dim3 block dim 2d std min batch size 8 32 dim3 grid dim 2d eigen divup batch size static cast int block dim 2d x eigen divup cell size static cast int block dim 2d y void lstmblockcellbpropwithcuda const bool use peephole const cudastream t cu stream getcudastream ctx dim3 block dim 2d min batch size 8 32 dim3 block dim 2d std min batch size 8 32 dim3 grid dim 2d eigen divup batch size static cast int block dim 2d x eigen divup cell size static cast int block dim 2d y ,replace min for std min to avoid issues with clang compilation e g http ci tensorflow org job nightly matrix linux gpu clang console piperorigin revid , xla python fix a bug in the hlo parser pass to the hlo module piperorigin revid
1777,void const int size const t output data std numeric limits t min 3 0f input min input scale for int i quantized input negative three i quantized input positive three i i size i quantized input positive three i float input values i input min i std numeric limits t min input scale ,fix index out of bounds quantized input positive three is there but array size is piperorigin revid change id , xla python fix a bug in the hlo evaluator piperorigin revid change id id iaaeabfdfedfeacedf
1778,status copysubgraph const graph graph const frame frame stack push back src node src copy node map e src id int src output squash src outputs e src id 0 e src output int src output squash src outputs e src id e iscontroledge 0 e src output node dst copy node map e dst id output addedge src copy src output dst copy e dst input ,tfxla don't change output port for control dependency in if the output is being squashed then we want control output except where the input is a control dependency piperorigin revid , add a test for the graph and the graph piperorigin revid
1779,ins bs endif delete newline delete newline if curwin w cursor col 0 ins bs linenr t curwin w cursor lnum 1 fail return false insstart lnum insstart col maxcol insstart col strlen ml get insstart lnum in replace mode ,patch abbreviation doesn't work after backspacing newline problem abbreviation doesn't work after backspacing newline solution set the insert start column closes , patch problem when using a popup window with a popup window solution add the option to the current buffer when the cursor is set
1780,std string memorytype type return std string memorytype type switch type case memorytype global return device case memorytype constant return constant break case memorytype local return threadgroup return namespace gpu namespace tflite ,using common gpuobjectdescriptor for metal backend piperorigin revid change id , xla gpu support for the layout interface piperorigin revid change id ibadadadacbbbef
1781,def tensor pool adjusted model model tensor pool fn generator inputs pooled generator inputs generated data pooled generated data discriminator gen outputs pooled discriminator gen outputs discriminator gen classification logits pooled discriminator gen classification logits discriminator gen classification logits pooled discriminator gen classification logits pylint disable line too long elif isinstance model namedtuples pooled generator inputs pooled generated data pooled structured input ,fix lint error piperorigin revid , tf data dataset to tf data dataset dataset piperorigin revid
1782,msg puts printf char u str int maxlen if defined feat mbyte defined feat gui mswin if enc codepage 0 int enc codepage intlen wchar wchar enc to utf16 str len strlen str wchar wchar enc to utf16 str if null widechartomultibyte alloc 0 len lpstr ccp len 0 0 widechartomultibyte alloc 0 lpstr ccp outlen 0 0 vim free s str ccp ,patch ms windows possible crash when giving a message on startup problem ms windows possible crash when giving a message on startup solution initialize length yasuhiro matsumoto closes , patch problem when using a terminal window is a bit solution add a few more tests to the new code
1783,def crossgrad op grad u op inputs 0 v op inputs 1 return math ops cross v grad math ops cross grad u ops nogradient ops nogradient sparsedensecwisediv ,override and for sparse op dense in python usage in python result sparse t sparse t dense t cwise div result sparse t sparse t dense t cwise mul these are counterparts of tf true div and tf mul respectively change , tf data dataset dataset dataset dataset to be used for tf data dataset piperorigin revid change id idaaceadaccee
1784,attribute type result type attribute operand1 const calculate auto lhs operand1 cast denseelementsattr todo support broadcast behavior todo b support broadcast behavior if lhs gettype result type operand2 gettype result type return ,fold multiplier even the operands are not broadcast compatible we have observed that the tfl mul folder couldn't fold the two operands even they are broadcast compatible since we can guarantee the tf mul kernel can fold this we switch to use tf mul instead piperorigin revid , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
1785,void dump pid slots void unsigned int i j 0 char string 512 sptr string sptr sprintf sptr pids d active n shm running childs sptr sprintf sptr pids u active n shm running childs for i 0 i max children i 8 sptr sprintf sptr d d i i 7 sptr sprintf sptr u u i i 7 for j 0 j 8 j if shm pids i j empty pidslot if pid alive shm pids i j 1 ,cppcheck format string corrections , fix a bug in the syscall page
1786,test combinetest combinewithmaxnumberofparameters class nondefaultconstructassignstring public nondefaultconstructassignstring const std string s str s nondefaultconstructassignstring delete nondefaultconstructassignstring const nondefaultconstructassignstring default nondefaultconstructassignstring operator const nondefaultconstructassignstring delete nondefaultconstructassignstring default const std string str const return str private std string str not default constructible nondefaultconstructassignstring not void operator const nondefaultconstructassignstring test combinetest ,fix a wdeprecated warning googletest param test test cc error definition of implicit copy constructor for is deprecated because it has a user declared copy assignment operator werror wdeprecated void operator const , fix a bug in the parser test piperorigin revid
1787,static char features static int included patches add new patch number below this line 1482 ,patch skipped tests are not properly listed problem skipped tests are not properly listed solution throw a skipped exception instead of using finish or return , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1788,copyright 2019 google inc all rights reserved licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license you may obtain a copy of the license at http www apache org licenses license 2 0 unless required by applicable law or agreed to in writing software distributed under the license is distributed on an as is basis without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license import uikit uikit h import appdelegate h int main int argc char argv autoreleasepool return uiapplicationmain argc argv nil nsstringfromclass appdelegate class ,add a test app for tflite objc api piperorigin revid , fix a bug in the new module of the dtrace kernel is not used in the dtrace hdl piperorigin revid change id ibcaccabdeabcbbeae
1789,test f s3filesystemtest hasatomicmove const string fname tmpdir hasatomicmove tf assert ok writestring fname test bool has atomic move true tf expect ok s3fs fname has atomic move code tf expect ok s3fs hasatomicmove fname has atomic move code expect eq has atomic move false ,fix s test on windows , fix a bug in the test case piperorigin revid
1790,logicalresult verify forop op check that the body defines as single block argument for the induction variable auto body op body auto body op getbody if body getnumarguments 1 body getargument 0 gettype isindex return op emitoperror expected body to have a single index argument for ,move affine for and affine if to ods as the move to ods is made body and region names across affine and loop dialects are piperorigin revid , xla gpu support for the hlo hlo instruction piperorigin revid change id idadedfddaccd
1791,limitations under the license namespace tensorflow namespace functor template typename device typename t bool isbilinear template typename device typename t struct cropandresize we assume that the tensor sizes are correct bool operator const opkernelcontext context typename ttypes t 4 consttensor image typename ttypes float 2 consttensor boxes typename ttypes int32 1 consttensor box ind float extrapolation value const string method name float extrapolation value typename ttypes float 4 tensor crops ,further modification , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1792,status lowerfunctionalopspass run if lowerusingswitchmergeison n if n isifnode tf return if error rewriteifnode n g flib def keep lowered nodes fetchable tf return if error rewriteifnode n g keep lowered nodes fetchable else if n type string case tf return if error rewritecasenode n g flib def keep lowered nodes fetchable tf return if error rewritecasenode n g keep lowered nodes fetchable else if n iswhilenode tf return if error rewritewhilenode n g keep lowered nodes fetchable ,remove unused def from and piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id iefecfafdafabefecbd
1793,limitations under the license include tensorflow compiler xla status h namespace xla namespace mlir namespace mlir gpu implementation for the translation of hlo instructions to a thunksequence via mlir using the lhlo dialect class lhlodialectemitter public dfshlovisitorwithdefault tf disallow copy and assign lhlodialectemitter namespace mlir namespace mlir gpu namespace xla endif tensorflow compiler xla service mlir gpu lhlo dialect emitter h ,rename xla mlir to xla mlir gpu piperorigin revid , xla python add a test for the xla client client piperorigin revid change id icbbdbfafcdfcae
1794,tflitestatus quantizemodel apply quantization passes passmanager pm module getcontext tfl quantizationspecs pass config pass config inference type tensorflow dt qint8 pass config post training quantization true tfl quantizationspecs quant specs quant specs inference type tensorflow dt qint8 quant specs post training quantization true bool emit adaptor false auto input tf type tflite tfltypetotftype input type if input tf type tensorflow dt float emit adaptor true else if input tf type tensorflow dt uint8 pass config inference type tensorflow dt quint8 quant specs inference type tensorflow dt quint8 pm addpass tfl pass config pm addpass tfl quant specs pm addpass tfl pm addpass tfl emit adaptor ,tflite nfc fix local variable name to be more specific piperorigin revid change id , add support for int int for int piperorigin revid
1795,class tfconfigclusterresolver clusterresolver def rpc layer self rpc layer self rpc layer rpc layer def num accelerators self task type none task id none config proto none task type self task type if task type is none else task type task id self task id if task id is none else task id return super tfconfigclusterresolver self num accelerators task type task id config proto def cluster spec self returns a clusterspec based on the tf config environment variable ,automatically pick up task type and task index for num accelerators in piperorigin revid , fix a bug in the test case piperorigin revid
1796,class boolvector boolvector const boolvector other copyfrom other boolvector boolvector default boolvector operator const boolvector other copyfrom other return this boolvector operator boolvector default void push back const bool value resize size 1 class literal literal literal const literal other default literal literal default explicit literal const literalproto other copyfromproto other literal operator const literal other default literal operator literal default literalproto toproto const ,make xla literal piperorigin revid , fix a bug in the test piperorigin revid
1797,def create file writer logdir if logdir is none return summarywriter none none logdir str logdir with ops device cpu 0 if max queue is none max queue constant op constant 10 ,convert logdir paths to strings this supports pathlib and other non string path types piperorigin revid , fix a bug in the documentation of the new module piperorigin revid
1798,def constantvalue tensor return none values append value return np concatenate values axis dim elif tensor op type pack values for x in tensor op inputs value constant value x if value is none return none values append value return np array values else return none ,improve shape inference for tf slice propagate constants through tf pack in shape functions handle partially known values for the begin vector change , fix a bug in the graph piperorigin revid
1799,inline int digits boost math explicit template type t typedef mpl bool std numeric limits t is specialized tag type return detail digits imp t policy tag type template class t class policy inline int digits base10 boost math explicit template type t return boost math policies digits t policy 1000l 301 template class policy inline unsigned long get max series iterations ,polygamma fix real concept compilation and runtime add digits base support function to policies , fix a bug in the parser test svn r
1800,namespace class public envtime public uint64 nowmicros override return now uint64 nownanos override return now micros kmicrostonanos void settime uint64 now micros now now micros void settime uint64 now micros now micros now micros void int64 secs now secs 1000000l void int64 secs now micros secs private uint64 now uint64 now micros class public testing test ,adding nownanos to tensorflow env piperorigin revid , xla gpu support for the layout interface piperorigin revid change id idacdededdbdcfbcdb
1801,struct idloptions bool generate name strings bool escape proto identifiers bool generate object based api bool union value namespacing possible options for the more general generator below enum language kjava kcsharp kgo kmax struct idloptions generate name strings false escape proto identifiers false generate object based api false union value namespacing true lang idloptions kjava ,added backwards compatible no union value namespacing change id tested on linux , fix a bug in the parser test for the new delegate piperorigin revid
1802,from tensorflow python autograph pyct static analysis import annos from tensorflow python autograph pyct static analysis import liveness from tensorflow python autograph pyct static analysis import reaching definitions from tensorflow python autograph pyct static analysis import reaching from tensorflow python autograph utils import compat util todo mdan refactor functions to make them smaller class function object def transform node ctx node controlflowtransformer ctx visit node return node compat util deprecated py2 support name ,more cleanup of dead python code piperorigin revid change id , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1803,struct collinstanceparams task name prefix of corresponding device name std vector string task names true if every task has the same number of devices bool same num devices per task bool same num devices per task false impl details string tostring const collinstanceparams operator const struct collinstanceparams other struct collectiveparams collinstanceparams instance task string name node name used only for log or error messages int default rank index of this op within device names bool is source broadcast only string name node name used only for log or error messages int default rank index of this op within device names bool is source false broadcast only rank of this device in each permutation std vector int subdiv rank std unique ptr opkernel merge op reduction only ,init struct bools to false to prevent warnings by dynamic type checking programs when an uninitialized value is read by operator piperorigin revid , xla gpu support for the hlo client piperorigin revid
1804,int dpicontext initsubscrcreateparams const dpicontext context return dpigen endpublicfn context dpi failure error dpi check ptr not null context params size changed in version 3 2 can be dropped once version 4 released if context dpiminorversion 1 size changed in versions 3 2 and 3 3 changes can be dropped once version 4 released if context dpiminorversion 3 dpicontext initsubscrcreateparams params else dpicontext initsubscrcreateparams localparams memcpy params localparams sizeof dpisubscrcreateparams if context dpiminorversion 1 memcpy params localparams sizeof dpisubscrcreateparams else memcpy params localparams sizeof dpisubscrcreateparams return dpigen endpublicfn context dpi success error ,added support for client connections for subscriptions , fix a bug in the test case
1805,class arraytest pfortestcase self test loop fn loop fn 3 def test conjugate transpose self x math ops complex random ops random uniform 3 2 3 4 random ops random uniform 3 2 3 4 def loop fn i x i array ops gather x i return array ops conjugate transpose x i 2 1 0 self test loop fn loop fn 3 def test zeros like self x random ops random uniform 3 2 3 class arraytest pfortestcase self test loop fn loop fn 7 def test check numerics self x random ops random uniform 2 3 4 def loop fn i x i array ops gather x i return array ops check numerics x i test message self test loop fn loop fn 2 if name main test main ,pfor add converters for bucketize checknumerics clipbyvalue piperorigin revid change id , fix a bug in the test case piperorigin revid
1806,def input pylint disable invalid name kwargs deprecated arguments support returns a tensor a tensor example python this is a logistic regression in keras x input shape 32 y dense 16 activation 'softmax' x model model x y note that even if eager execution is enabled input produces a symbolic tensor i e a placeholder this symbolic tensor can be used with other tensorflow ops as such python x input shape 32 y tf square x python this is a logistic regression in keras x input shape 32 y dense 16 activation 'softmax' x model model x y note that even if eager execution is enabled input produces a symbolic tensor i e a placeholder this symbolic tensor can be used with other tensorflow ops as such python x input shape 32 y tf square x raises valueerror in case of invalid arguments ,fix indent for python formatting fix indent for python formatting , fix a bug in the docstring of the docstring of the docstring of the docstring change
1807,status readbinaryproto env env const string fname return status ok status writetextproto env env const string fname const tensorflow protobuf message proto if defined tensorflow lite protos string serialized if tensorflow protobuf textformat printtostring proto serialized return errors failedprecondition unable to convert proto to text return writestringtofile env fname serialized else return errors unimplemented can't write text protos with protolite endif status readtextproto env env const string fname tensorflow protobuf message proto if defined tensorflow lite protos ,add a writetextproto method that is analogous to writebinaryproto but for textual protobufs change , fix a bug in the test case piperorigin revid
1808,def converted call f owner options args kwargs in particular we may want to avoid renaming functions altogether if not options force conversion and conversion is whitelisted for graph f todo mdan this may be inconsistent in certain situations if the function had already been annotated with tf function it may be bound to the incorrect object it's unclear if those situations are possible but if they happen we need to check if f is bound to a shim like and unpack it args typically include self as required by the conversion process when conversion is skipped self is not necessary because the original bound method is being executed this code removes it ,obey the semantics of tf function even if the target is whitelisted the implementation relies on this assumption this triggered autograph on a number of internal functions where it will be disabled for now piperorigin revid , fix a bug in the docstring of the docstring of the new api change
1809,status attrvaluehastype const attrvalue attr value stringpiece type attrvalue had value with unexpected type 'placeholder if the attr type is 'list' we expect attr value has list to be true however attr value has list can be false when set to an empty list so we simply check if has list is false and some other field in attr value is set to flag the error if the attr type is 'list' we expect attr value has list to be true however attr value has list can be false when set to an empty list for graphdef versions 4 so we simply check if has list is false and some other field in attr value is set to flag the error this test can be made more strict once support for graphdef versions 4 is dropped if stringpiece type starts with list attr value has list if num set return errors invalidargument ,add note regarding when we can make parsing of holding an empty list more strict we had some convenient graphdef version bumps at the relevant time change , fix a bug in the graph piperorigin revid
1810,struct r2reducewindowtestdata strides 1 1 pad low 0 130 pad high 0 0 layout 1 0 reducer reducer kadd todo b 76025683 these tests fail on tpu if defined xla test backend cpu defined xla test backend gpu base bounds 4096 4096 window bounds 1 4 strides 1 1024 pad low 0 0 pad high 0 0 layout 1 0 reducer reducer kadd base bounds 8 256 window bounds 1 4 strides 1 64 pad low 0 0 pad high 0 0 layout 1 0 reducer reducer kadd endif string r2reducewindowtestdatatostring ,xla adding more tests for reducewindow piperorigin revid , add a test for the new op api piperorigin revid
1811,std string gethandleshapeandtype tf graph graph tf output output auto out shape and type handle data add shape and type ic shapehandletoproto p shape out shape and type mutable shape out shape and type set dtype p dtype out shape and type set specialized type p specialized type string result void tf graph graph tf output output const void proto status status ic makeshapefromshapeproto shape and type proto shape shape if tf getcode status tf ok return shapes and types emplace back shape shape and type proto dtype shapes and types emplace back shape shape and type proto dtype shape and type proto specialized type ic set output handle shapes and types output index shapes and types ,record the type of a variant tensor with its handle data only used for tensorlist at the moment but we'll likely need to add similar information for other variants as they'll also need special cases in tf vectorized map piperorigin revid change id , add a test for the tf data optimizer piperorigin revid
1812,limitations under the license include tensorflow compiler xla client executable build options h include tensorflow compiler xla client xla builder h include tensorflow compiler xla pjrt nvidia gpu device h include tensorflow compiler xla pjrt gpu device h include tensorflow compiler xla pjrt pjrt client h include tensorflow compiler xla test h include tensorflow compiler xla tests literal test util h ,nvidia gpu device gpu device , xla python add a test for the xla client client piperorigin revid
1813,status buildcomputation const xlacompiler argument arg args resource arg num const int core arg cores resource arg num dcheck lt resource arg num arg cores size bool modified resource value resource initial value bool modified resource value isidenticalto resource initial value tensorarray gradients were modified if their values changed or there are any newly created gradients for const auto grad resource tensor array gradients modified modified grad second value grad second initial value arg tensor array gradients count grad first 0 modified modified grad second value isidenticalto grad second initial value arg tensor array gradients count grad first 0 if return updated values for all resources modified resource updates emplace back ,xla add operator overloads for arithmetic and bitwise operations on xlaop remove operator and operator and replace their uses with and methods to avoid potential confusion between equality and the hlo eq ne operators piperorigin revid , xla python add a test for the xla cpu backend piperorigin revid
1814,pyobject self pyobject args if paths vim self return null spec pyobject callfunction py find spec fullname paths target spec pyobject callfunction py find spec fullname paths target py decref paths ,patch function reference count wrong in python code problem function reference count wrong in python code solution use o instead of n for the arguments ben jackson closes , fix a bug in the test case
1815,class oplevelcostestimator costs predictfusedbatchnormgrad const opcontext op context const costs predicteinsum const opcontext op context const costs predictassignvariableops const opcontext op context const costs predictpurememoryop const opcontext op context const generic cost prediction method for fused operations costs predictfusedop const opcontext op context ,added reshape op cost computation to the estimator piperorigin revid change id , tf data service support for tf data experimental piperorigin revid
1816,class public nodeshader case operationtype rsqrt source r const float nan normalize vec4 0 0 0 0 x value 0 x value 0 x 0 0 1 0 sqrt value 0 x nan value 0 y value 0 y 0 0 1 0 sqrt value 0 y nan value 0 z value 0 z 0 0 1 0 sqrt value 0 z nan value 0 w value 0 w 0 0 1 0 sqrt value 0 w nan value 0 x value 0 x 0 0 1 0 sqrt value 0 x nan value 0 y value 0 y 0 0 1 0 sqrt value 0 y nan value 0 z value 0 z 0 0 1 0 sqrt value 0 z nan value 0 w value 0 w 0 0 1 0 sqrt value 0 w nan break case operationtype sigmoid ,fix division by zero in rsqrt piperorigin revid change id , xla gpu support for the layout of the layout is a bit piperorigin revid
1817,databyexample key databyexample makekey const string example id hash64 example id data example id size kseed2 0xffffffff databyexample data databyexample get const key key mutex lock l mu return data by key key void databyexample set const key key const data data mutex lock l mu data by key key data status databyexample visit std function void const data data visitor const struct state ,minor code cleanups change , fix a bug in the docstring of the new api api piperorigin revid change id ieedaecadfaccdddeec
1818,test p here we instantiate our tests with a list of two primetable object factory functions instantiate test case p values 1000 instantiate test suite p values 1000 namespace ,googletest export change remaining samples to use new test suite api piperorigin revid , fix a bug in the test case piperorigin revid
1819,see the license for the specific language governing permissions and limitations under the license import runasynctask from ' async' import runasynctask updatemessage from ' async' import kmin from ' import as vector from ' vector' export type nearestentry allocation limit we can freeze the graphics of the whole os const optimal gpu block size 256 id of message box used for knn gpu progress bar const knn gpu msg id gpu' returns the k nearest neighbors for each vector where the distance export function t progress offset b piece then knn gpu msg id then if piece step resolve else updatemessage null knn gpu msg id delete resolve nearest ,allow for overwriting existing ui message boxes e g knn progress message should use the same box also fix a bug by making sure we call after not before moving and to data ts where they really belong change , add a test for the new op op piperorigin revid
1820,t beta imp t a t b const l caution this is slow template class t t beta imp t a t b const lanczos undefined lanczos l t beta imp t a t b const lanczos undefined lanczos l using namespace std ,another unused parameter to l svn r , patch problem when using a popup window with a popup window solution add the cursor to the cursor when the cursor is set
1821,string formatnodeforerror const node node string formatnodedefforerror const nodedef node def log error error in the node summarizenodedef node def vlog 1 error in the node summarizenodedef node def return errors formatnodenameforerror node def name ,replace log error with vlog in node def util piperorigin revid , xla python fix a bug in the graph piperorigin revid
1822,def model to dot model sub w first node sub w last node layers model layers if not model is graph network node pydot node str id model label model name dot add node node def model to dot model elif isinstance model sequential sequential if not model built model build layers model layers layers super sequential sequential model layers create graph nodes for i layer in enumerate layers ,fix issue where calling plot model on functional model that uses add loss would crash due to model layers containing dictwrapper objects piperorigin revid change id , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
1823,static int lobvar prefetch static void lobvar finalize udt lobvar var variable to free boolean istemporary ub4 i for i 0 i var allocatedelements i if var data i if var data i var environment handle var environment errorhandle var data i istemporary if istemporary py begin allow threads var connection handle var environment errorhandle var data i py end allow threads ocidescriptorfree var data i oci dtype lob py decref var connection ,ensure that the temporary lob is freed before freeing the descriptor it seems logical that freeing the descriptor should free the temporary lob as well but apparently that is not the case , patch problem when using a terminal window doesn't work solution add a test for the mouse event
1824,statusor bool dotdecomposer run hlomodule module non canonical dots push back instruction continue a dot is not canonical if it has more than one non contracting dimension if dnums lhs batch dimensions size 2 instruction operand 0 shape rank dnums rhs batch dimensions size 2 instruction operand 1 shape rank non canonical dots push back instruction continue if dnums lhs batch dimensions empty dnums lhs contracting dimensions empty non canonical dots push back instruction ,xla canonicalize dots to have only one non contracting dimension this makes sure we select a fast algorithm on cpu and gpu gemms generally don't support extra non contracting dims piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1825,ops nogradient ops nogradient ops nogradient hashtable ops nogradient ops nogradient initializetablefromtextfile ops registershape common shapes scalar shape def op keys shape op inputs 1 get shape with rank 1 op inputs 2 get shape merge with keys shape return ops registershape initializetablefromtextfile def op unused table shape op inputs 0 get shape merge with tensor shape scalar unused filename op inputs 1 get shape merge with tensor shape scalar return ,add lookup table initializer from text file change , tf data service support for tf data service piperorigin revid change id idaceccfcbacfece
1826,def cumprod x axis 0 exclusive false reverse false name none performed instead prettyprint tf cumprod a b c exclusive true 0 a a b tf cumprod a b c exclusive true 1 a a b by setting the reverse kwarg to true the cumprod is performed in the def cumprod x axis 0 exclusive false reverse false name none the reverse and exclusive kwargs can also be combined prettyprint tf cumprod a b c exclusive true reverse true b c c 0 tf cumprod a b c exclusive true reverse true b c c 1 args ,doc fix possible copy paste error in cumprod docs , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
1827,static char features static int included patches add new patch number below this line 917 916 ,patch quickfix entries do not suport a note type problem quickfix entries do not suport a note type solution add support for note partly by yegappan lakshmanan closes closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1828,typedef gemmlowp meta gemmlowp template typename context typename params void context context const params params if params m 4 gemmlowp meta gemm gemmlowp meta params 1 8 8 params gemmlowp meta context gemmlowp meta params 1 8 8 context params else if params m params n gemmlowp meta ,for the m gemm that would call into meta lib change the single thread invoking to multi threads invoking because for the fc layers multi thread would improve the memory accessing of the relatively large weights matrix , add a new method to the dialect to the dialect of the dialect piperorigin revid change id ifcabdcdffbdfaaf
1829,class expectationimportancesampletest test testcase n 1000 with self test session p distributions multivariatenormaldiag mu 0 0 0 0 diag stddev 1 0 1 0 loc 0 0 0 0 scale diag 1 0 1 0 q distributions multivariatenormaldiag mu 0 5 0 5 diag stddev 3 3 loc 0 5 0 5 scale diag 3 3 compute e p x 1 x 2 0 with x i the ith component of x p x should equal 1 2 because p is a spherical gaussian centered at 0 0 ,breaking change rename mvn usage of and refactor to use bijector change , tf data saveable shape for tf data dataset piperorigin revid
1830,status return status ok anonymous namespace status const string function name attrslice attrs const functiondef fdef const functionlibrarydefinition lib def std unique ptr graph graph status return status ok anonymous namespace status processfunctionlibraryruntime instantiatemultidevice const string function name attrslice attrs const functionlibraryruntime instantiateoptions options ,internal change piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id idaceccfcbacfece
1831,def minimize strategy tape optimizer loss trainable variables trainable variables if isinstance optimizer lso lossscaleoptimizer gradients optimizer get unscaled gradients gradients gradients optimizer clip gradients gradients pylint disable protected access if trainable variables if aggregate grads outside optimizer optimizer apply gradients ,enable clipnorm and clipvalue arguments in optimizer with tf distribute strategy apply gradient clipping after aggregation centralstoragestrategy is still not supported with these arguments piperorigin revid change id , fix a bug in the docstring of the docstring of the keras model piperorigin revid
1832,class timedistributed wrapper def build self input shape input shape tensor shape tensorshape input shape as list assert len input shape 3 self input spec inputspec shape input shape if len input shape 3 raise valueerror ' timedistributed layer should be passed an input shape ' 'with at least 3 dimensions received ' str input shape don't enforce the batch or time dimension self input spec inputspec shape none none input shape 2 child input shape input shape 0 input shape 2 if not self layer built the base layer class calls a conversion function on the input shape to ,do not enforce the time dimension in timedistributed 's inputspec piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
1833,class batchnormtest test testcase with self assertraisesregexp valueerror 'undefined' layers batch norm inputs data format 'nchw' def testweightedmomentsfused self with ops graph as default as g self test session g inputs array ops placeholder dtype dtypes float32 shape 5 3 3 7 batch weights array ops placeholder dtype dtypes float32 with self assertraisesregexp valueerror 'weighted mean and variance' layers batch norm inputs batch weights batch weights fused true def testcreateop self fused height width 3 3 with self test session ,add an environment variable to test fused batch norm before we enable it by default piperorigin revid , fix a bug in the docstring of the test piperorigin revid
1834,class test testcase for x y in zip compiled direct self assertallclose x y rtol 1e 1 else self assertallclose compiled direct self assertallclose compiled direct rtol 1e 2 def self with session lib session as sess ,tf xla gpu relax test tolerance due to flakiness piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1835,def gather nd params indices name none batch dims 0 if batch dims is not none batch dims int batch dims if batch dims 0 todo lespeholt use resourcevariable gather nd when params is a resourcevariable faster and more memory efficient return gen array ops gather nd params indices name name try todo apassos find a less bad way of detecting resource variables without introducing a circular dependency return params gather nd indices name name except attributeerror return gen array ops gather nd params indices name name else return batch gather nd params indices batch dims batch dims name name ,tf gather nd now uses when 'params' is a resourcevariable this prevents a full copy snapshot of the variable add abstract variable sparse read piperorigin revid , tf data service support for tf data dataset piperorigin revid
1836,test ffmpeglibtest testinstalled namespace ffmpeg tensorflow namespace ffmpeg namespace tensorflow int main int argc char argv tensorflow ffmpeg parsetestflags argc argv ,creating a tf contrib ffmpeg decode audio file op so far it supports mp wav and files change , fix a bug in the docstring of the test case piperorigin revid
1837,limitations under the license include tensorflow lite delegates gpu gl egl context h include cstring include tensorflow lite delegates gpu common status h include tensorflow lite delegates gpu gl gl call h include tensorflow lite delegates gpu gl gl errors h status createcontext egldisplay display eglcontext shared context bool egldisplay display const char name return strstr display egl extensions name return std strstr display egl extensions name namespace ,compatibility compile fix piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1838,static char features static int included patches add new patch number below this line 574 573 ,patch not used when adding fold marker in c problem not used when adding fold marker in c solution require white space before middle comment part mostly by hirohito higashi , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1839,class mklfusedconv2doptest public opstestbase if std find fused ops begin fused ops end elu fused ops end last op with elu todo intel tf correct typo relu to elu after fixing conv and elu fusion next op ops relu root withopname last op next op ,add comment for known conv and elu fusion , fix a bug in the test piperorigin revid
1840,public template typename opty typename args void replaceopwithnewop operationinst op args args auto newop create opty op getloc args op newop getoperation op newop getinstruction replaces the result op with a new op that is created without verification public arrayref value valuestoremoveifdead args args auto newop create opty op getloc args op newop getoperation op newop getinstruction valuestoremoveifdead ,rename blockargument op getoperation op stmtoperand instoperand and remove the old names this is step n towards merging instructions and statements nfc piperorigin revid , fix a bug in the parser parser test piperorigin revid
1841,tflitestatus prepare tflitecontext context tflitenode node todo ahentz these are limitations of our implementation that could be removed with a bit of effort tf lite ensure context t0 dims size 4 tf lite ensure eq context params activation ktfliteactnone tf lite ensure context input type ktflitefloat32 input type ktfliteuint8 ,lite concatenate op d restriction removed , add support for int int piperorigin revid
1842,set init 1 int clean arg len strlen p 3 two quotes and a trailing nul cmd alloc len vim snprintf char cmd len s p set string default sh cmd vim free cmd if cmd null vim snprintf char cmd len s p set string default sh cmd vim free cmd else set string default sh p ,patch no check for out of memory problem no check for out of memory solution check for null pointer , patch problem when using a terminal window is a bit slow solution add a test for the gui
1843,class adamoptimizertest xlatestcase def testbasic self for dtype in self float types if dtype np float16 continue with self test session self test scope variable scope get variable scope set use resource true class adamoptimizertest xlatestcase def testtensorlearningrate self for dtype in self float types if dtype np float16 continue with self test session self test scope variable scope get variable scope set use resource true class adamoptimizertest xlatestcase def testsharing self for dtype in self float types if dtype np float16 continue with self test session self test scope variable scope get variable scope set use resource true ,xla skip float adam tests adam tests compare the output of the computation against a hand numpy solution which does not take into account the precision and hence fail for float , fix a bug in the test case piperorigin revid
1844,static char u uc fun cmd void static char u find ucmd exarg t eap char u p int full expand t xp int compl endif ifdef feat ex extra static voidex normal exarg t eap static voidex startinsert exarg t eap static voidex stopinsert exarg t eap else update topline cursor void update curswant ifdef feat ex extra if defined feat ex extra defined proto normal commands execute normal mode commands static void void ex normal exarg t eap intsave msg scroll msg scroll ,patch problem execution of command on channel doesn't work yet solution implement the ex and normal commands , patch problem when using a channel to be a bit a bit slow solution add a test for the gui
1845,register kernel builder name nonmaxsuppressionv2 hostmemory iou threshold hostmemory max output size register kernel builder name nonmaxsuppressionv3 typeconstraint float t device device gpu hostmemory iou threshold hostmemory max output size hostmemory score threshold todo laigd enable the op once b is fixed register kernel builder name nonmaxsuppressionv3 typeconstraint float t device device gpu hostmemory iou threshold hostmemory max output size hostmemory score threshold namespace tensorflow endif ,disable gpu op since it broke the test piperorigin revid , fix a bug in the test case piperorigin revid
1846,class slicestest test testcase with self test session as sess self assertequal sess run t b b initial list str constant op constant abcd t slices get item initial list str 1 slices getitemopts element dtype initial str dtype with self test session as sess self assertequal sess run t b if name ' main ' test main ,use get item tensor string for string with rank , fix a bug in the test case piperorigin revid
1847,class gatherop public opkernel registration of the cpu implementations tf call all types register gather cpu tf call quantized types register gather cpu tf call quint16 register gather cpu tf call qint16 register gather cpu undef register gather cpu ,register quint qint for gatherop piperorigin revid , tf data dataset support for tf data dataset piperorigin revid
1848,def l2 normalize x dim epsilon 1e 12 name none args x a tensor dim dimension along which to normalize dim dimension along which to normalize a scalar or a vector of integers epsilon a lower bound value for the norm will use sqrt epsilon as the divisor if norm sqrt epsilon name a name for this operation optional def l2 normalize x dim epsilon 1e 12 name none with ops name scope name l2 normalize x as name x ops convert to tensor x name x square sum math ops reduce sum math ops square x dim keep dims true square sum math ops reduce sum math ops square x dim keep dims true x inv norm math ops rsqrt math ops maximum square sum epsilon return math ops mul x x inv norm name name ,fix when passing a list of dims fixes change , fix a bug in the docstring of the test case piperorigin revid
1849,void open logfiles char logfilename logfilename malloc 64 sprintf logfilename trinity d log shm parentpid sprintf logfilename trinity log unlink logfilename parentlogfile fopen logfilename a if parentlogfile void open logfiles for i 0 i shm max children i sprintf logfilename trinity d child d log shm parentpid i sprintf logfilename trinity child d log i unlink logfilename shm logfiles i fopen logfilename a if shm logfiles i ,remove pids from log file names this just causes way too much clutter , fix a bug in the syscall page
1850,namespace math while iterations min iterations do minimum iterations iterations max iterations absolute max limit during testing iterations max iterations absolute max limit during testing unexpected looping if need this return w1 ,math lambertw fix halley termination condition , fix a bug in the test case piperorigin revid
1851,struct return re2 partialmatch string module name pattern else if opts xla dump hlo pass re empty output format specified opts xla dump to empty output format specified should dump module string view return true else should dump module string view return false ,xla dump as text if only xla dump to is specified this was the intended behavior but it wasn't working instead we'd dump nothing piperorigin revid , fix a bug in the parser test piperorigin revid
1852,class servinginputreceiver collections namedtuple raise valueerror 'feature keys must be strings ' format name if not isinstance tensor ops tensor or isinstance tensor sparse tensor sparsetensor raise valueerror value error valueerror 'feature must be a tensor or sparsetensor ' format name note this if else block is a specific out for labeledtensor which has a tensor attribute and which is convertible to tf tensor via ops convert to tensor allowing all types convertible to tf tensor is considered by soergel to be too permissive if hasattr tensor 'tensor' try ops convert to tensor tensor except typeerror raise value error else raise value error if receiver tensors is none raise valueerror tensors must be defined ' ,relaxes the type constraints for the features in servinginputreceiver so it will accept anything convertible to a tensor or sparsetensor this makes it possible to use with tf contrib labeled tensor piperorigin revid , fix a bug in the docstring of the new api api piperorigin revid change id iacffbebafbeeadcfbaca
1853,tf tensor tf allocatetemp tf opkernelcontext context tf datatype dtype tensorflow tensor tensor tf tensor tf tensor s cc ctx allocate temp static cast tensorflow datatype dtype shape tensor temp allocator attr tensor allocator attr if s ok tensorflow set tf status status s tensorflow set tf status from status status s return nullptr tf tensor tf tensorfromtensor tensor s ,added device memory test for allocate temp , add a test for the gradient of the graph piperorigin revid
1854,class replicacontext object return self strategy property deprecation deprecated none please avoid relying on devices property def devices self require replica context self return device util current ,clarify replicacontext devices returns a nested list for ms and mwms piperorigin revid change id , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
1855,include mlir ir identifier h include mlir ir location h include mlir ir mlircontext h include mlir ir operation h include mlir ir types h include llvm adt smallstring h include llvm adt stringmap h void diagnosticargument print raw ostream os const case diagnosticargumentkind integer os break case diagnosticargumentkind operation os break case diagnosticargumentkind string os getasstring break ,add support for streaming operations into diagnostics piperorigin revid , xla gpu support for the hlo dialect piperorigin revid change id iaadafbbedfccccbd
1856,t binomial t n t k t x t y we'll have to sum the terms the old way for unsigned i start 1 i k i result pow x i pow y n i boost math binomial coefficient t itrunc n itrunc i result pow x int i pow y n i boost math binomial coefficient t itrunc n itrunc i else ,beta gamma fix concept failures caused by previous commit , fix a bug in the previous commit piperorigin revid
1857,ex cbuffer exarg t eap if res 0 qf list changed qi qi qf curlist if au name null buf t curbuf old curbuf apply autocmds event quickfixcmdpost au name curbuf b fname true curbuf if curbuf curbuf old autocommands changed buffer don't jump now qi may be invalid res 0 if res 0 eap cmdidx cmd cbuffer eap cmdidx cmd lbuffer qf jump qi 0 0 eap forceit display first error ,patch crash when autocommands delete the current buffer problem crash when autocommands delete the current buffer dominique pelle solution check that autocommands don't change the buffer , patch problem when using a terminal window is a bit slow solution add a test for the test
1858,qf parse multiline if qfprev qf lnum qfprev qf lnum fields lnum if qfprev qf col qfprev qf col fields col qfprev qf viscol fields use viscol qfprev qf viscol fields use viscol if qfprev qf fnum qfprev qf fnum qf get fnum qfl qfl qf directory ,patch using v in 'errorformat' may fail before z problem using v in 'errorformat' may fail before z solution set qf only when qf col is set closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
1859,status segmentgraph const graph tf graph std vector node segments for int i 0 i graph num node ids i node graph findnodeid i if node vlog 1 node i doesn't exist in the graph continue auto exclude node absl string view reason vlog 1 not a tf trt candidate op type node tf node type string ,compiler fix segmentation in segment graph signed off by gaurav singh gaurav gmail com change the log message signed off by gaurav singh gaurav gmail com , add a test for the graph and the graph piperorigin revid
1860,hlo matcher convolution hlo matcher copy hlo matcher crossreplicasum hlo matcher divide hlo matcher domain hlo matcher dynamicslice hlo matcher dynamicupdateslice hlo matcher eq ,support kdomain instructions in the hlomatcher framework piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
1861,void check all locks void check lock shm children i syscall lock static void set dontkillme pid t pid bool state int childno childno find childno pid if childno child not found possible we might be the watchdog for example return shm children childno dontkillme state void lock lock t lock pid t pid getpid while lock lock locked if lock owner pid int childno debugf lol already have lock n childno find childno pid shm children childno dontkillme true set dontkillme pid true sleep 3 show backtrace shm children childno dontkillme false set dontkillme pid false return ,make sure lock only sets dontkillme in child context , fix a bug in the watchdog page
1862,class indexlookup base preprocessing layer combinerpreprocessinglayer counting code in the model object doesn't throw an attribute error tracked table shape tensor shape tensorshape 0 this is a workaround for saving not working yet for by replacing the existing function call by an explicit failure we can provide a more user friendly error message def fail raise notimplementederror saving is not yet supported for indexlookup layers self table list extra dependencies for serialization fail pylint disable protected access self inverse table none if vocabulary is not none ,allow indexlookup preprocessing layer to be saved and loaded from savedmodel some of the fixes are copied from cl piperorigin revid change id , fix a bug in the docstring of the test piperorigin revid
1863,const tensorobjectdef input def absl status convert const tensorobject input obj const tensorobject output obj if absl get if openglbuffer input obj if absl holds alternative openglbuffer input obj auto absl get if openglbuffer input obj auto cl mem absl get if openclbuffer output obj return if error ,nit use holds alternative t instead of get if t on variants when the result is only used as a bool piperorigin revid change id , fix a bug in the test case piperorigin revid
1864,def get build steps project dir if run tests build steps append test binaries 'name' 'gcr io oss fuzz base base runner' 'env' env 'args' 'bash' ' c' 'test all' if sanitizer 'memory' patch dynamic libraries to use instrumented ones build steps append def get build steps project dir if run tests build steps append test binaries 'name' 'gcr io oss fuzz base base runner' 'env' env 'args' 'bash' ' c' 'test all' if project yaml 'labels' write target labels build steps append ,infra run tests on the builder after patching msan libraries work in progress debug travis failure when doing build check for msan build change order of msan patch libraries and build check steps , infra fix a bug in the documentation of the new module change
1865,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2019 12 6 forward compatibility horizon datetime date 2019 12 7 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
1866,limitations under the license see docs in ops nn ops cc this opkernel uses mkl library create mkl layout and primitives use mkl dnn primitives to compute local response normalization undef intel mkl ifdef intel mkl define eigen use threads ,mkl adding mkl dnn pooling ops adding mkl dnn pooling ops disabling lrn mkl path forcing to eigen using the real undef preprocessor command , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
1867,static unsigned long handle arg list unsigned long call unsigned long argnum break default break if num 0 bug arg list with 0 args what n bits rand num num of bits to or for i 0 i bits i mask values rand num ,fix potential div in arg list handling appease coverity in theory there's a divide by zero here if we ever had syscall arg annotated as arg list with elements hopefully i'm not dumb enough to create such an entry but just in case , fix a bug in the watchdog page
1868,exe path gtest test utils gettestexecutablepath utilities environ os environ copy def setenvvar env var value if value is not none os environ env var value elif env var in os environ del os environ env var environ env var value elif env var in environ del environ env var def run command p gtest test utils subprocess command p gtest test utils subprocess command env environ if p terminated by signal return 1 else ,google test's python tests now pass on solaris , patch problem when using a channel to be a newline solution add a test for the gui
1869,static char features static int included patches add new patch number below this line 753 752 ,patch no size reports to a job running in a terminal problem a job running in a terminal does not get notified of changes in the terminal size solution use ioctl and sigwinch to report the terminal size , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1870,normal cmd oap toplevel else c 'c' msg nowait true don't delay going to insert mode old mapped len 0 do go to insert mode endif ,updated for version problem a visual mapping that uses ctrl g works differently when started from insert mode ein brown solution reset old mapped len when handling typed text in select mode , patch problem when using a terminal window is a bit slow solution add a test for the command line
1871,unsigned long find previous arg address unsigned int argnum unsigned int call are just special cases of the arg struct iovec alloc iovec unsigned int num struct iovec iov ,bump up the max size of iovecs that we create , make the syscall page we can be a child process
1872,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 4 4 forward compatibility horizon datetime date 2020 4 5 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
1873,gui get wide font else endif gui wide font font ifdef feat gui mswin gui mch wide font changed endif return ok endif ,updated for version problem windows ime composition may use a wrong font solution use 'guifontwide' for ime when it is set taro muraoka , patch problem when using a terminal window is a bit complicated solution add a test for the gui
1874,void do syscall from child case sigkill case sigalrm case sigpipe case sigabrt debugf child got a signal d n wtermsig childstatus reap child childpid break ,ignore sigabrt glibc can send us this if we corrupt the malloc pool with an mmap , fix a bug in the watchdog page
1875,limitations under the license include absl strings ascii h include absl strings numbers h include tensorflow compiler xla util h include tensorflow compiler xla xla data pb h include tensorflow core platform logging h namespace xla namespace primitive util int primitivetype type switch type case f32 return std numeric limits float digits case f64 return std numeric limits double digits case bf16 return 1 case f16 return 11 default log fatal not a floating data type type bool isfloatingpointtype primitivetype type return type f16 type f32 type f64 type bf16 ,support previously added attribute on floating datatype casts to apply in tfxla as well piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
1876,include sys types h if defined android android api 0 21 include sys syscall h until android api version 21 there is no getpwuid r if defined until android api version 21 google ndk does not provide getpwuid r define boost log no getpwuid r endif endif if defined boost log no getpwuid r include pwd h endif ,disabled the getpwuid r workaround for ndk as apparently it provides the function , fix a bunch of the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
1877,module tf backend if datadir datadir length 1 ' ' datadir datadir slice 0 datadir length 1 function standardroute route string function standardroute route string ' json' tag string run string string return function tag string run string string var url datadir ' ' route clean queryencoder tag tag run run if demomode url ' json' url return url module tf backend compressedhistograms standardroute images standardroute 'images' audio standardroute 'audio' runmetadata standardroute 'run metadata' runmetadata standardroute 'run metadata' ' pbtxt' ,update code to understand run metadata and update the serialize tensorboard script to write run metadata to a separate file change , fix a bug in the test case piperorigin revid
1878,class baseestimator sklearn baseestimator create a run configuration if config is none self config baseestimator config logging warning 'using default config ' else self config config logging info 'using config s' str vars self config set device function depending if there are replicas or not if self config num ps replicas 0 ,log values of the config used by the estimator change , update docstring for dask
1879,status bufferassigner assignbuffersforcomputation continue if is thread local instruction opcode hloopcode kcustomcall custom call operations never have reusable buffers also we do not reuse thread local buffers for now because they are dynamically allocated and their lifetimes are hard to compute if is thread local we do not reuse thread local buffers for now because they are dynamically allocated and their lifetimes are hard to compute bufferallocation allocation assignment newallocation buffer buffer size is thread local is reusable false vlog 3 new allocation allocation index for thread local customcall buffer for thread local buffer continue ,xla allow buffers for customcalls to be reused piperorigin revid , xla gpu support for xla client piperorigin revid change id idfbdfbcdacfbeebb
1880,threadpooldevice threadpooldevice const sessionoptions options const int mkl intra op port numschedulablecpus const int ht port numhyperthreadspercore std call once omp setting flag omp set num threads mkl intra op ht 1 ht mkl intra op ht 1 ht endif openmp endif defined enable mkldnn threadpool defined intel mkl ,apply code format signed off by vishakha agrawal vishakha agrawal intel com , xla gpu support for the xla client piperorigin revid
1881,class microbenchmarks test benchmark self benchmark tf random uniform 2 by 2 dtype dtypes float32 device gpu def benchmark tf random uniform 2 by 2 default setting cpu self with context device cpu func lambda random ops random uniform 2 2 self run func num iters self num iters 2 by 2 def benchmark tf random uniform 2 by 2 default setting gpu self with context device gpu func lambda random ops random uniform 2 2 self run func num iters self num iters 2 by 2 def benchmark transpose self m num iters ,add random uniform benchmark for default setting the default setting of range on float is commonly used add a benchmark for it piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
1882,emsg e nesting return disallow sourcing a file in the sandbox the commands would be executed later possibly outside of the sandbox if check secure return ifdef feat eval if ignore script not reading from script also don't open one warning message ,patch source command doesn't check for the sandbox problem source command doesn't check for the sandbox solution check for the sandbox when sourcing a file , patch problem when using a terminal window is a bit slow solution add a test for the gui
1883,static bool arrayref int64 t shape1 auto iscompatible int64 t dim1 int64 t dim2 return dim1 dim2 dim1 1 dim2 1 return std equal shape1 begin shape1 end shape2 begin shape2 end iscompatible if shape1 size shape2 size return false for const auto p llvm zip shape1 shape2 if iscompatible std get 0 p std get 1 p return false return true logicalresult optrait impl verifycompatibleoperandbroadcast operation op ,switch c std equal usage to for loop version of std equal used required c switching to for loop for now just a direct change from std equal to the equivalent using for loop piperorigin revid , xla gpu support for the hlo client piperorigin revid change id icabdabcccecababba
1884,bool isnodesupportedbyhexagon const tfliteregistration registration reinterpret cast const tflitefullyconnectedparams node builtin data return bias const or no bias matmul params activation ktfliteactnone isactivationreluornone matmul params activation matmul params keep num dims false matmul params weights format ktflitefullyconnectedweightsformatdefault ,enable fullyconnected with activation function in hexagon delegate since we use requantize to this op does clamping to the range so we rely on output tensor min max to have values that are in the bounds of the specified min max piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id ibdacdecbebffaefddaf
1885,static pytypeobject g ifndef with unicode static pytypeobject g nclobvartype pyvarobject head init null 0 cx oracle nclob tp name static pytypeobject g nclobvartype py tpflags default tp flags 0 tp doc endif static pytypeobject g static udt variabletype vt clob ifndef with unicode static udt variabletype vt nclob initializeproc lobvar initialize finalizeproc lobvar finalize static udt variabletype vt nclob 0 can be copied 0 can be in array endif static udt variabletype vt blob ,nclob variables need to be retained even in unicode mode as oracle will not allow you to read write those type of lob values with implicit for reasons known only to itself , patch problem when using a popup window with a terminal window solution add the option to the current line
1886,status consumeprefix absl string view str absl string view prefix proto status absl string view text proto absl string view prefix to strip protobuf messagelite parsed proto protobuf message parsed proto inline status absl string view text proto absl string view prefix to strip protobuf messagelite parsed proto return errors unavailable cannot parse text protos on mobile namespace tensorflow ,remove all uses of tensorflow lite protos piperorigin revid change id , add a test for the tf data service piperorigin revid
1887,using testing returnref using testing returnrefofcopy using testing setargpointee using testing setargumentpointee using testing unused using testing using testing get using testing internal builtindefaultvalue ,merging gmock actions test , fix a bug in the parser test piperorigin revid
1888,class estimator object pylint disable protected access local init op estimator spec scaffold local init op or monitored session scaffold default local init op monitored session scaffold default local init op pylint enable protected access perform the export ,expose scaffold default local init op as a public static method expose scaffold default local init op as a public static method update api add a docstring add a returns section , update docstring for tf nn rnn py
1889,static char features static int included patches add new patch number below this line 1504 1503 ,patch sound test still fails on travis problem sound test still fails on travis solution add more lines to the install section , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1890,status metaoptimizer optimize cluster cluster const grappleritem item optimizers push back std unique ptr graphoptimizer new arithmeticoptimizer cfg arithmetic optimization if cfg dependency optimization rewriterconfig off if cfg dependency optimization rewriterconfig on optimizers push back std unique ptr graphoptimizer new dependencyoptimizer cfg dependency optimization bool metaoptimizerenabled const rewriterconfig cfg return cfg disable model pruning cfg layout optimizer rewriterconfig on cfg constant folding rewriterconfig off cfg dependency optimization rewriterconfig on cfg arithmetic optimization rewriterconfig off cfg auto parallel enable cfg memory optimization 1 cfg optimizers empty ,don't enable dependency optimizer by default piperorigin revid , add a function to the graph piperorigin revid
1891,set init 3 ifndef os2 always use shell style redirection if we reach this if fnamecmp p sh 0 fnamecmp p 0 fnamecmp p 0 fnamecmp p 0 fnamecmp p 0 fnamecmp p beta 0 fnamecmp p bash 0 set init 3 fnamecmp p cmd 0 fnamecmp p sh exe 0 fnamecmp p exe 0 fnamecmp p exe 0 fnamecmp p exe 0 fnamecmp p exe 0 fnamecmp p beta exe 0 fnamecmp p bash exe 0 ,updated for version problem for the default of and are not recognized solution recognize these shell names , patch problem when using a terminal window doesn't work solution add a test for the gui
1892,class compressionopstest test base datasettestbase parameterized testcase dataset dataset map lambda x compression ops uncompress x element spec self assertdatasetproduces dataset element class test base datasettestbase parameterized testcase def testcompression self def self for test case in test ragged based objects element test case test input compressed compression ops compress element class test base datasettestbase parameterized testcase compressed structure type spec from value element self element self evaluate uncompressed def testdatasetcompression self def self for test case in test ragged based objects element test case test input dataset dataset ops dataset from tensors element ,removed additional test class , fix a bug in the test case piperorigin revid
1893,class dnn testing utils basednnmodelfntest test testcase dnn testing utils basednnmodelfntest init self dnn dnn model fn class dnn testing utils test testcase def init self methodname 'runtest' pylint disable invalid name test testcase init self methodname dnn testing utils init self dnn dnn logit fn builder class dnn testing utils test testcase ,refactoring canned estimators to use a logit fn piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1894,struct tensorflowunsupportedoperator operator string tensorflow node def a boolean indicating if the unsupported op should be treated as quantized bool quantized false a boolean indicating if the unsupported op output should allow float values in quantized mode bool support output type float in quantized op false output data types std vector arraydatatype output data types output shapes ,add support for float output arrays in quantized custom operators custom ops only piperorigin revid , add a test for the new op api piperorigin revid
1895,static void add to child queue void data int len if childhdr tp tv sec tp tv sec if childhdr tp tv nsec tp tv nsec goto tail add if childhdr tp tv nsec tp tv nsec goto drop crap we've got something out of order scan the list for the right place static void add to child queue void data int len continue if childhdr tp tv nsec tp tv nsec continue if childhdr tp tv nsec tp tv nsec goto drop list add pkt list node prev goto done tail add done child packetcount pthread mutex unlock child packetmutex return drop free pkt data free pkt pthread mutex unlock child packetmutex static void queue object msg struct trinity msgobjhdr obj int len ,drop duplicate packets instead of adding them to the list , fix a bug in the watchdog process
1896,def check build args if args fuzzer name run args 'bad build check' 'test one' os path join ' out' args fuzzer name else ,reland make bad build check more likely to catch hardcoding out this reverts commit , patch problem when using a terminal window is a bit slow solution add a test for the text to the list of the line
1897,void raise error const char function const char message message cause unknown std string msg error in function ifndef boost no rtti msg boost format function typeid t name str else msg function endif msg msg message void raise error const char function const char message const t val message cause unknown error caused by bad argument with value 1 std string msg error in function ifndef boost no rtti msg boost format function typeid t name str else msg function endif msg msg message ,allow boost math to be used without rtti fixes svn r , fix a bug in the file file
1898,xla statusor xla xlaop cholesky xla xlabuilder builder xla xlaop a lower true transpose a true conjugate a false block size 8 block size block size tf assign or return l builder l update i k i ,change the block size used in the triangular system solve step of the cholesky decomposition algorithm to be the same block size as the cholesky blocks speeds up compilation time with affect on runtime piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1899,static char features static int included patches add new patch number below this line 829 ,updated for version problem mksession confuses bytes columns and characters when positioning the cursor solution use w virtcol with instead of w cursor col with l , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1900,def softmax x axis 1 keras export 'keras activations elu' def elu x alpha 1 0 exponential linear unit the exponential linear unit elu with alpha 0 is x if x 0 and alpha exp x 1 if x 0 the elu hyperparameter alpha Œ± controls the value to which an ,retain title acc to kyscg , fix a bug in the docstring of the documentation of the documentation of the tf nn rnn api to the test piperorigin revid
1901,def conv1d value returned to the caller args value a 3d tensor must be of type float16 or float32 value a 3d tensor must be of type float16 float32 or float64 filters a 3d tensor must have the same type as value stride an integer the number of entries by which the filter is moved right at each step ,fix documentation issue with tf nn convd the tf nn convd supports float float and float though in tf nn convd doc only float and float are mentioned this fix updates the doc string to add float as the supported data type signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
1902,class lossscale trackable trackable grads a list of unscaled gradients each which is the gradient of the loss with respect to a weight the gradients should have already been divided by the loss scale being before passed to this function 'none' gradients are accepted and should be ignored gradients are accepted and are ignored returns update op in eager mode none in graph mode an op to update the loss ,update docstring , fix a bug in the docstring of the keras model piperorigin revid
1903,class autosharddatasettest reader dataset ops test base tfrecorddatasettestbase tests that rebatch is a passthrough op dataset dataset ops dataset list files self test filenames shuffle false dataset dataset apply testing assert next shard flatmap batchv2 rebatch testing assert next shard flatmap batchv2 map rebatch dataset dataset flat map core readers tfrecorddataset dataset dataset batch 5 dataset distribute rebatchdataset dataset num replicas 1 ,tf data better handling of raggedtensors with rebatchdataset piperorigin revid change id , tf data service support for tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental
1904,limitations under the license include tensorflow core lib core errors h include tensorflow core platform errors h include tensorflow core platform path h include tensorflow core protobuf data experimental service config pb h include tensorflow core protobuf service config pb h include tensorflow core public session options h namespace tensorflow ,move the data experimental proto files into the proto top level directory this effort is a part of the build file and package cleanup piperorigin revid change id , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
1905,tensorflow status convertcalibgraphtoinfergraph need to run graph with calibration data first if cres calibrator cres calibrator cres calibrator cres thr join const auto calibration table cres calibrator ,let wait until the last batch is consumed before terminating the calibrator , xla python add a test for the xla client client piperorigin revid
1906,public return impl integrate f these are just for debugging unit tests std vector std vector real const big nodes const return impl big nodes private endif ,explain purpose of nodes weights ci skip , fix a bug in the parser parser test for the parser and the parser can be used by the parser change id tested
1907,limitations under the license include tensorflow core grappler optimizers data vectorization vectorizer registry h include tensorflow core framework node def pb h include tensorflow core lib core status test util h include tensorflow core platform test h namespace tensorflow test nodedef node def status s node node g addnode node def s tf assert ok s std vector wrappedtensor inputs outputs expect true vectorizer vectorize node g std move inputs outputs ok ,verify addnode status and disable vectorizer registry test piperorigin revid change id , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
1908,static char features static int included patches add new patch number below this line 2308 2307 ,patch problem old test still listed in makefile solution remove the line , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1909,struct binaryfunctor sycldevice functor ndims has errors void operator const sycldevice d typename functor tout type out typename functor tin type in0 typename functor tin type in1 bool error to32bit out device d to32bit in0 binaryexpr in1 typename functor func to32bit out device d to32bit in0 binaryexpr to32bit in1 typename functor func void left const sycldevice d typename functor tout type out ,use bit indexing for all the tensors involved in cwise operations , fix a bug in the graph piperorigin revid
1910,class mklsoftmaxop public opkernel auto src dims tfshapetomkldnndims src tf shape auto output dims src dims memory format layout type in mkl data format passed to mkl softmax op depends on dimension of the input tensor here x data format in mkl is used for 1 dim tensor nc for 2 dim tensor tnc for 3 dim tensor nchw for 4 dim tensor and ncdhw for 5 dim tensor each of the simbols has the following meaning n batch c channels t sequence lenght h hight w width d depth switch input dims case 1 layout type memory format x ,adding comment for mkl dnn data format in softmax , fix a bug in the new delegate piperorigin revid
1911,def do eval sess labels placeholder true count sess run eval correct feed dict feed dict precision float true count num examples print ' num examples d num correct d precision 1 0 04f' print 'num examples d num correct d precision 1 0 04f' num examples true count precision ,typo fix in file connected feed typo fix in file connected feed minor edits to coding style , fix a bug in the docstring of the documentation of the documentation of the example to the new api change
1912,import java io inputstream import java nio mappedbytebuffer import java nio channels import java text import org tensorflow ovic import org tensorflow ovic ovicsingleimageresult class that benchmark image classifier models public class ovicbenchmarkeractivity extends activity tag for the link log ,move class from app folder to source folder piperorigin revid , xla python fix a bug in the client client piperorigin revid
1913,from tensorflow python lib io import file io def write graph graph or graph def logdir name as text true writes a graph proto to a file the graph is written as a binary proto unless as text is true the graph is written as a text proto unless as text is false python v tf variable 0 name 'my variable' ,update graph io py , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1914,class fileiotest test testcase i for i in info items def self self assertfalse file io has atomic move x y' self asserttrue file io has atomic move ' a b c' ,remove s test in file io , fix a bug in the docstring of the test case piperorigin revid
1915,class timelinetest tf test testcase show dataflow false self validatetrace ctf def self metadata tf runmetadata step stats metadata step stats dev stats step stats dev stats add dev stats device ' job worker replica 0 task 0 cpu 0' node stats dev stats node stats add node stats node name node stats all start micros 12345 node stats op end rel micros 42 node stats timeline label ' edge 160 conv2 biases read from ' ' job ps replica 0 task 3 cpu 0 to ' ' job worker replica 0 task 0 cpu 0' tl timeline timeline step stats ctf tl generate chrome trace format self validatetrace ctf def testanalysisandallocations self run options tf runoptions trace level tf runoptions full trace run metadata tf runmetadata ,fixes label parsing bug in timeline change , tf data dataset dataset to tf data dataset piperorigin revid
1916,static struct pymethoddef outputmethods static pyobject outputwrite pyobject self pyobject args int len py ssize t len char str null int error outputobject self error if pyarg parsetuple args et enc opt str len return null todo this works around a gcc optimizer problem and avoids vim from crashing should find a real solution if str null return null py begin allow threads python lock vim writer writefn error emsg msg char u str len ,updated for version problem workaround for python crash isn't perfect solution change the type of the length argument , patch problem when using a terminal window is a bit slow solution add a test for the cursor
1917,t cyl bessel i imp t v t x const policy pol return bessel i1 x if x v 0 25 v 0 if v 0 x v 0 25 return bessel i small z series v x pol t i k bessel ik v x i k need i pol ,begin refactoring math lib test cases as template so they can used by other numerical types change constant declarations in the math lib headers to give full digits when used with udt's that are from strings svn r , fix a bug in the previous commit case the previous commit is not used by the number of the number of the number of the number of the number of the number of the number of the number of the number of the number of the number of the number of the number
1918,test f gettrtbroadcastshape operand 2 shape operand 2 is tensor operand 2 batch size operand 1 broadcast operand 2 expectstatus this converter gettrtbroadcastshape expectstatus gettrtbroadcastshape operand 1 operand 2 operand 1 new dims operand 2 new dims expected code expected error msg substr if expected code error ok test f gettrtbroadcastshape expecttrtdimsequalsarray expected operand 2 shape operand 2 new dims operand 2 broadcast operand 1 expectstatus this converter gettrtbroadcastshape expectstatus gettrtbroadcastshape operand 2 operand 1 operand 2 new dims operand 1 new dims expected code expected error msg substr if expected code error ok ,make a standalone function small improvements to , fix a bug in the graph piperorigin revid
1919,tflitestatus flatbuffers flatbufferbuilder builder for int i 0 i subgraph operators size i operatort op subgraph operators i get for auto tensor idx op inputs skip optional tensors if tensor idx ktfliteoptionaltensor continue tensort tensor subgraph tensors tensor idx get buffert buffer model buffers tensor buffer get if buffer nullptr ,skip optional tensors for float quantization piperorigin revid change id , fix a bug in the parser test piperorigin revid
1920,tflitestatus arc scratch buffer calc slice size io out capacity out height line size out if fit in case both tensors completely fit in the capacity there is no need for slicing in slice height in height slicing as padding can affect effective input region we also derive it from output height and rely on a clipping logic which intend to reduce last smaller slice i e the only slice is a kind of smaller last slice that need to be corrected in slice height std max in height out height stride height out slice height out height else first compute how many lines fit into the input tensor and compute how ,fix height slicing in fit branch for odd input , fix a bug in the delegate of the delegate piperorigin revid
1921,status loadlibrary const char library filename void result if env getsymbolfromlibrary library handle tftpu initialize unused symbol ok tf return if error tensorflow tpu initializetpulibrary library handle tf return if error tensorflow tpu initializetpulibrary library handle endif is mobile platform ,add a rudimentary library loader implementation for some tpu related functions piperorigin revid change id , fix a bug in the graph piperorigin revid
1922,status cpucompiler runhlopassesthroughlayoutassn pass addpass tuplesimplifier pass addpass whileloopconstantsinking pass addpass whileloopsimplifier pass addpass slicesinker todo b re enable after b is fixed pass addpass slicesinker pass addpass hlodce pass addpass reshapemover pass addpass hloconstantfolding ,disable while we investigate b piperorigin revid , xla gpu support for xla cpu piperorigin revid change id idfbdfbcdacfbeebb
1923,int main int argc char argv vt vterm new rows cols vterm set utf8 vt true vterm set utf8 vt true vts vterm obtain screen vt vterm screen set callbacks vts cb screen null ,patch other stdbool h dependencies in libvterm problem other stdbool h dependencies in libvterm solution remove the dependency and use true false int ken takata , fix a bug in the watchdog process
1924,see the license for the specific language governing permissions and limitations under the license include tensorflow compiler xla service hlo parser h include tensorflow compiler xla tests hlo test base h namespace xla class gpuconvolutionregressiontest public hlotestbase hlomoduleconfig config config set debug options getdebugoptionsfromflags void backend compiler runhlopasses parseandreturnverifiedmodule hlo string config consumevalueordie parseandreturnunverifiedmodule hlo string config consumevalueordie backend default stream executor backend memory allocator ,also use for piperorigin revid change id , add a test for the new op op piperorigin revid
1925,status dynamicdimensioninferencevisitor handlescatter hloinstruction hlo int64 operand index hloinstruction operand dynamic size dimensionconstraint constraint if operand index 0 return unimplemented detects a dynamic dimension on the data input of scatter which is not supported s hlo tostring const scatterdimensionnumbers scatter dims hlo scatter dimension numbers if operand index 1 parent setdynamicsize hlo dimension operand dynamic size constraint return status ok const scatterdimensionnumbers scatter dims hlo scatter dimension numbers if operand index 2 absl c linear search scatter dims update window dims dimension ,xla dynamicpadder support dynamic dimension in scatter indices pad indices to which is a no op when applied add execution test to make sure the result is the same as if not padded piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1926,def check bazel version min version max version check installed bazel version is between min version and max version args min version string for minimum bazel version max version string for maximum bazel version min version string for minimum bazel version must exist max version string for maximum bazel version must exist returns the bazel version detected def main environment variables environ cp dict os environ current bazel version check bazel version '0 24 1' '0 25 0' current bazel version check bazel version '0 24 1' '0 24 1' tf current bazel version convert version to int current bazel version reset tf configure bazelrc ,set max bazel version to the latest existing piperorigin revid , fix a bug in the documentation of the new module piperorigin revid
1927,except from distutils extension import extension define build constants build version 6 0b2 build version 6 0rc1 define the list of files to be included as documentation for windows datafiles none ,preparing to release cx oracle rc , patch problem when using a terminal window is a bit solution add a test for the file
1928,class tensorflowtestcase googletest testcase self fail exception type name not raised except exception as e pylint disable broad except if not isinstance e exception type or not predicate e raise assertionerror e raise assertionerror exception of type s s str type e str e pylint enable g doc return or yield def assertraisesoperror self expected err re or predicate ,move gather op's cpu implementation out of the kernel file test util py print the actual exception type when there is a mismatch between actual exception and expected exception change , fix a bug in the documentation of the test case piperorigin revid
1929,void graphoptimizer optimize functionlibraryruntime runtime graph graph if opts do constant folding constantfoldingoptions cf opts if doconstantfolding cf opts g removedeadnodes g dumpgraph g changed true ,make function public also fixes two small bugs evaluating source node during constant folding if reachable by a control edge remove dead nodes after constant folding change , xla python add a test for the cpu backend piperorigin revid
1930,static char features static int included patches add new patch number below this line 1631 1630 ,patch displaying signs is inefficient problem displaying signs is inefficient solution avoid making multiple calls to get information about a placed sign yegappan lakshmanan closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1931,status oauthclient parseoauthresponse stringpiece response return errors failedprecondition unexpected oauth token type token type int64 expires in int64 expires in 0 tf return if error root expires in expires in expiration timestamp sec request timestamp sec expires in tf return if error root access token token ,update client cc warning fixed , xla python fix a bug in the test piperorigin revid
1932,func b builder endobject uoffsett doubles the size of the and copies the old data towards the end of the new since we build the buffer backwards func b builder growbytebuffer if len b bytes 0xc0000000 0 if int64 len b bytes int64 0xc0000000 0 panic cannot grow buffer beyond 2 gigabytes newsize len b bytes 2 ,fix a build error on bit go change id , patch problem when using a terminal window is a bit slow solution add a test for the file
1933,static char features static int included patches add new patch number below this line 790 789 ,patch vim list index not well tested problem vim list index not well tested solution add a few more tests , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1934,limitations under the license include llvm adt triple h include tensorflow compiler xla ptr util h include tensorflow compiler xla service llvm ir llvm util h include tensorflow compiler xla status macros h namespace xla compileonlyclient compileaheadoftime int64 compileonlyclient pointersizefortriple tensorflow stringpiece target triple llvm triple triple llvm triple normalize llvm ir asstringref target triple llvm triple triple llvm triple normalize llvm stringref target triple data target triple size if triple isarch64bit return 8 else if triple isarch32bit ,cut dependencies between xla client service and cpu gpu backends piperorigin revid , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
1935,status processfunctionlibraryruntime instantiate currently don't support instantiating functions on device options target string function key canonicalize function name attrs vlog 1 instantiate function name on options target string function key canonicalize function name attrs options functiondata f mutex lock l mu status processfunctionlibraryruntime instantiate tf return if error f distributedinit parent function name lib def attrs options vlog 1 instantiate success function name on options target with handle handle this this return status ok ,procflr include the remote function target in the function key piperorigin revid , xla gpu support for the layout inference piperorigin revid change id idaceccfcbacfece
1936,struct public modulepass this is a symbol test pass that tests the symbol use replacement functionality provided by the symbol table struct public modulepass void runonmodule override auto module getmodule for funcop func module getops funcop stringattr newname func getattroftype stringattr sym new name if newname continue if succeeded func replaceallsymboluses newname getvalue module func setname newname getvalue end anonymous namespace static passregistration pass test symbol uses test detection of symbol uses static passregistration test symbol test replacement of symbol uses ,add support for replacing all uses of a symbol this requires reconstructing the attribute dictionary of each operation containing a use piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id icabdabcccecababba
1937,class tfmodulewrapper types moduletype return self tfmw wrapped module repr def reduce self return import self name return importlib import module self name ,use importlib import module instead of import when unpickling import only returns the top level package so import 'tensorflow compat v' will return tensorflow not tensorflow compat v piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
1938,class testtrainingwithdataset keras parameterized testcase 'the steps argument' model predict dataset verbose 0 todo b include tests using dataset v1 keras parameterized run with all model types exclude models 'sequential' keras parameterized run all keras modes always skip v1 true keras parameterized run all keras modes def test training and eval methods on multi input output dataset self input a keras layers input shape 3 name 'input 1' input b keras layers input shape 3 name 'input 2' ,re enable v multi io dataset test piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid change id iffafdbbcddfebbeac
1939,from tensorflow python framework import function from tensorflow python framework import op def registry from tensorflow python framework import ops from tensorflow python framework import random seed from tensorflow python framework import test util from tensorflow python ops import gradients from tensorflow python ops import init ops from tensorflow python ops import math ops class jittest test testcase self assertequal b jit scope 0 func attrs xlascope s test util with c api class test testcase def self class test testcase for cg in c grad ops self asserttrue cg get attr xlacompile for in nc grad ops with self assertraisesregexp valueerror no attr named with self assertraisesregexp valueerror nn o attr named get attr xlacompile d dx x 4 4 x 3 ,make jit test py work with c api enabled piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1940,include limits h endif define num executables 8 define num executables 10 static const char dpitestnames num executables testcontext static const char dpitestnames num executables testqueries testtransactions testtransactions testmisccases testvariables ,add more functional test cases , patch problem when using a popup window with a terminal window solution add the option to the list of the buffer
1941,copyright 2018 the tensorflow authors all rights reserved copyright 2019 the tensorflow authors all rights reserved licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license limitations under the license define tensorflow compiler xla service depthwise convolution converter h include absl strings string view h include functional include tensorflow compiler xla service hlo module h include tensorflow compiler xla service hlo pass interface h include tensorflow compiler xla status macros h class depthwiseconvolutionconverter public hlomodulepass namespace xla endif tensorflow compiler xla service depthwise convolution converter h no newline at end of file endif tensorflow compiler xla service depthwise convolution converter h ,address few of adrian's comments , fix a bug in the new module piperorigin revid
1942,include boost math tools precision hpp include boost math policies error handling hpp include boost math special functions math fwd hpp include boost math special functions log1p hpp this is the inverse of the hyperbolic cosine function ,fixes for gcc compilation added sanity checks to tests svn r , fix a bug in the new parser test svn r
1943,class sdcafprinttest sdcamodeltest def testfprint self with self single threaded test session in data constant op constant 'abc' 'very looooooong string' 'def' out data gen sdca ops sdca fprint in data out data gen sdca ops sdca fprint in data self assertallequal ,add sdca ops to tf train this adds tf train sdca optimizer tf train sdca fprint tf train sdca shrink l which were previously documented and prior to in tf sdca in they were absent from tf sdca so this does not break compatibility the module tf sdca is removed change , fix a bug in the test case piperorigin revid
1944,ops registershape applyadagradda common shapes call cpp shape fn ops registershape common shapes call cpp shape fn ops registershape common shapes call cpp shape fn ops registershape common shapes call cpp shape fn ops registershape applycenteredrmsprop common shapes call cpp shape fn ops registershape applygradientdescent common shapes call cpp shape fn ops registershape common shapes call cpp shape fn ops registershape common shapes call cpp shape fn ops registershape common shapes call cpp shape fn ops registershape common shapes call cpp shape fn ops registershape common shapes call cpp shape fn ops registershape common shapes call cpp shape fn ops registershape common shapes call cpp shape fn ,add option to when set to false gradients are normalized by the estimated second moment of the gradient when set to true gradients are normalized by the estimated variance which often works better but is slightly more costly to compute change , fix a bug in the test case piperorigin revid
1945,uint8 t floattoasymmetricquantizeduint8 const float value const float scale return result uint8 t floattosymmetricquantizeduint8 const float value const float scale const int zero point int32 t result round value scale zero point uint8 t floattosymmetricquantizeduint8 const float value const float scale int32 t result round value scale if result result int8 t floattoasymmetricquantizedint8 const float value const float scale int8 t floattosymmetricquantizedint8 const float value const float scale const int zero point return floattosymmetricquantizeduint8 value scale zero point kasymmetricint8min kasymmetricint8min return floattosymmetricquantizeduint8 value scale kasymmetricint8min int32 t floattosymmetricquantizedint32 const float value const float scale ,fix symmetric quantization to remove zero point argument it appears that was copied to create without making the necessary changes piperorigin revid , fix a bug in the new delegate piperorigin revid
1946,gui gtk3 should draw cursor void static gboolean draw event gtkwidget widget draw event gtkwidget widget unused cairo t cr gpointer user data unused draw event gtkwidget widget cairo rectangle list t list null gui gtk window clear gtk widget get window widget list cairo copy clip rectangle list cr if list status cairo status clip not representable draw event gtkwidget widget for i 0 i list num i const cairo rectangle t rect list i gui mch clear block y 2 row rect y 1 y 2 row rect y rect height 1 columns if blink mode gui gtk3 redraw rect x rect y rect width rect height else ,patch problem gtk cursor blinking doesn't work well solution instead of gui gtk window clear use gui mch clear block kazunobu kuriyama , patch problem when using a terminal window is a bit solution add a test for the gui
1947,profilerequest populateprofilerequest int duration ms request add tools op profile request add tools input pipeline request add tools memory viewer request add tools overview page request mutable opts opts std cout limiting the number of trace events to kmaxevents ,tpu profiler capture the data for generating a memory viewer of the profiling results piperorigin revid , add a test for the tpu api piperorigin revid
1948,limitations under the license include tensorflow core grappler optimizers custom graph optimizer registry h include tensorflow core grappler optimizers data graph utils h include tensorflow core grappler utils h include tensorflow core kernels data stats utils h include tensorflow core lib strings str util h include tensorflow core platform logging h include tensorflow core platform protobuf h nodedef makelatencynode const nodedef node mutablegraphview graph set the input of node as node new node add input node name string tag name strings strcat record latency data stats utils kdelimiter node name nodedef tag graph utils addscalarconstnode stringpiece stringpiece record latency node name graph stringpiece tag name graph new node add input tag name set output types and output shapes attributes ,tag for tfstreamz metrics in statsaggregator this change is to have more consistent name for tensorboard statistics and tfstreamz metrics piperorigin revid , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
1949,void const opdef op def apidef api def auto endpoint api def add endpoint endpoint set name op def name if op def has deprecation endpoint set deprecation version op def deprecation version for const auto op in arg op def input arg auto api in arg api def add in arg ,change deprecation version field in api def proto to a string piperorigin revid , fix a bug in the graph piperorigin revid
1950,static char features static int included patches add new patch number below this line 968 967 ,patch no proper testing of the 'cpoptions' flags problem no proper testing of the 'cpoptions' flags solution add tests yegappan lakshmanan closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1951,statusor shape computationbuilder getreturnvalueshape return program shape result localop computationbuilder replicaid return xla replicaid builder localop computationbuilder infeed const shape shape return xla infeed builder shape ,xla plumb replicaid into local python client piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
1952,t lgamma imp t z const policy pol const lanczos l int sign 0 t zgh static cast t z lanczos g boost math constants half t result log zgh 1 result z 0 5f result log lanczos lanczos sum expg scaled z only add on the lanczos sum part if we're going to need it if result tools epsilon t 20 result log lanczos lanczos sum expg scaled z if sign ,lgamma correct spurious overflow in sse optimized code only evaluate the lanczos part if it will make a difference add tests fixes https github com boostorg math issues , fix a bug in the previous commit case the previous commit is not used by the number of the number of the number of the number of the number of the number of the number of the number of the number of the number of the same value
1953,example python decode an image and convert it to hsv rgb image tf decode png channels 3 rgb image float tf convert image dtype rgb image tf float32 hsv image tf rgb to hsv rgb image rgb image tf image decode png channels 3 rgb image float tf image convert image dtype rgb image tf float32 hsv image tf image rgb to hsv rgb image rgb to grayscale def adjust contrast images contrast factor contrast factor a float multiplier for contrast returns the adjusted image or images the contrast adjusted image or images with ops op scope images contrast factor none 'adjust contrast' as name remember original dtype to so we can convert back if needed ,example code uses tf image for image ops instead of tf , fix a bug in the docstring of the docstring of the new api change
1954,required packages 'absl py 0 1 6' 'astor 0 6 0' 'gast 0 2 0' 'google pasta 0 1 0' 'google pasta 0 1 1' 'keras applications 1 0 6' 'keras preprocessing 1 0 5' 'numpy 1 13 3' ,increase version of google pasta to for byte string fix piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
1955,unsigned int fds left to create max fds void open pipes void int pipes 2 int pipes max pipe fds 2 unsigned int i for i 0 i max pipe fds i for i 0 i max pipe fds i 2 if pipe pipes 0 perror pipe fail n exit exit failure ,fix pipe buffer setup , make the syscall page we can be a bit more than the syscall process
1956,set completion startcol list compl curr match compl first match if compl no insert if compl no select ins complete k down ins complete k down else ins complete ctrl n if compl no select ins complete ctrl p if compl no select ins complete ctrl p out flush ,patch problem using both noinsert and in 'completeopt' does not work properly solution change the ins complete calls ozaki kiichi , fix a bug in the new delegate piperorigin revid
1957,ex diffoff exarg t eap wp w p fen save foldupdateall wp make sure topline is not halfway a fold changed window setting win wp endif remove filler lines wp w topfill 0 make sure topline is not halfway a fold and cursor is invalidated changed window setting win wp note is not restored it's a global option diff buf adjust wp ,patch problem diffoff does not remove filler lines solution force a redraw and invalidate the cursor closes , patch problem when using a terminal window is a bit slow solution add a test for the test
1958,pybind11 module pybind m return pythonvaluehandle nullptr m def index cast pythonvaluehandle element pythontype type pythonvaluehandle return valuehandle create indexcastop element value type getfromopaquepointer type type m def select pythonvaluehandle condition pythonvaluehandle truevalue pythonvaluehandle falsevalue pythonvaluehandle ,python bindings export index cast we are now properly enforcing the absence of index elements in memrefs and tensors instead users are expected to store sized integers and cast them to index type if necessary expose the respective operation to python bindings piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id iefecfafdafabefecbd
1959,statusor std unique ptr globaldata client execute request mutable execution options execution options for globaldata argument arguments check argument nullptr argument pointers must not be null request add arguments argument handle ,xla fix a bug in computationbuilder collapse and add more tests docs also updated test infrastructure so a shape mismatch does not cause a fatal crash in index util but rather reports an appropriate test failure message piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
1960,class controlflowtest tf test testcase result exit i eval self assertallequal 10 result def self with self test session data tf placeholder tf float32 shape enter 1 control flow ops enter data foo 1 false enter 2 control flow ops enter data foo 2 false res tf add enter 1 enter 2 with self assertraisesoperror has inputs from different frames res eval feed dict data 1 0 def testcondbool self values tf constant 10 fn1 lambda tf add values 1 ,small improvement of error messages change , fix a bug in the test case piperorigin revid
1961,invoke callback channel t channel char u callback partial t partial intdummy if safe to invoke callback 0 emsg internal invoking callback when it is not safe iemsg internal invoking callback when it is not safe argv 0 v type var channel argv 0 vval v channel channel ,patch emsg is sometimes used where it should be iemsg problem emsg is sometimes used for internal errors solution change them to iemsg dominique pelle and a few more , patch problem when using a terminal window is a bit slow solution add a test for the command line
1962,static char features static int included patches add new patch number below this line ,patch cannot use two global runtime dirs with configure problem cannot use two global runtime dirs with configure solution support a comma in with global runtime james mccoy closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1963,class variablestestcase test testcase return fibonacci 1 measurements for depth in range 15 25 with ops graph as default tensor build tensor depth start time time time variables has cycle tensor op end time time time measurements append end time start time with self cached session for depth in range 15 25 with ops graph as default tensor build tensor depth start time time time variables has cycle tensor op end time time time measurements append end time start time self assertless max measurements min measurements 10 ,automated rollback of commit piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1964,class test testcase self assertallequal variables got def test tf module self self skiptest with tf module is not added yet ' class model module module ,enable tf module sharded variable test given the integration is in place piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
1965,def cudnn rnn inputs args num proj 0 if num proj is none else num proj outputs output h output c gen cudnn rnn ops cudnn args elif time major is false or num proj batch size array ops shape inputs 0 max time array ops shape inputs 1 batch id 1 if time major else 0 time id 0 if time major else 1 batch size array ops shape inputs batch id max time array ops shape inputs time id sequence lengths array ops fill batch size max time args sequence lengths sequence lengths args time major time major ,use cell instead of c add back commented out tests , fix a bug in the docstring of the docstring of the tf data strategy piperorigin revid change id iafeaeadbafaddecdc
1966,undo read 4c bi intn undo read bi buf size t 4 n buf 0 24 buf 1 16 buf 2 8 buf 3 n unsigned buf 0 24 buf 1 16 buf 2 8 buf 3 return n endif ,updated for version problem error reported by ubsan when running test solution add type cast to unsigned dominique pelle , patch problem when using a terminal window doesn't work solution add a test for the job
1967,ex vimgrep eap parse the list of arguments if get arglist exp p fcount fnames fail if get arglist exp p fcount fnames true fail goto theend if fcount 0 ,updated for version problem vimgrep does not obey 'wildignore' solution apply 'wildignore' and to vimgrep ingo karkat , patch problem when using a terminal window is a bit slow solution add a test for the gui
1968,int main const double 0 2 1 5 3 0 hyperexponential add boost math hyperexponential distribution probs2 2 2 1 0 3 0 1 0 3 0 1 0 3 0 0 2 1 5 3 0 hyperexponential plot exponential vs hyperexponential distribution pdf hyperexponential pdf svg hyperexponential plot hyperexponential distribution pdf different number of phases same mean hyperexponential pdf svg int main ,distributions hyper exponential added two more graphs one with different and same rates and another one with different number of but same mean , fix a bug in the new code of the new code
1969,fn serialized example is accessible and correct bytes u8 identifier require ok test fn builder initializes with maximum buffer size flatbuffers flatbufferbuilder new with capacity flatbuffers flatbuffers max buffer size disabled due to windows ci limitations test fn builder initializes with maximum buffer size flatbuffers flatbufferbuilder new with capacity flatbuffers flatbuffers max buffer size should panic test ,disable ram heavy test b c windows , fix a bug in the docstring of the test case piperorigin revid
1970,class test util tensorflowtestcase texts hi there u ragged rank 0 texts hi there u ragged rank 1 texts u u u ragged rank 2 texts u u u ragged rank 1 texts u u u u ragged rank 0 texts pyformat disable def self texts ragged rank none ,fixed bug in tf strings unicode decode where rank ragged rank piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
1971,builtinopresolver builtinopresolver addbuiltin builtinoperator relu n1 to 1 register relu n1 to 1 addbuiltin builtinoperator relu6 register relu6 addbuiltin builtinoperator tanh register tanh addbuiltin builtinoperator logistic register logistic addbuiltin builtinoperator logistic register logistic min version 1 max version 2 addbuiltin builtinoperator average pool 2d register average pool 2d min version 1 max version 2 ,create int logistic piperorigin revid , add support for int int piperorigin revid
1972,struct gpudevice extern template struct gpudevice todo ebrevdo write a custom batch friendly impl of this to update the sparsetensor indices directly template status gpudevice operator opkernelcontext c ttypes const int unalignedvec csr row ptr ttypes int unalignedvec coo row ind cuda sparse c const int nnz coo row ind size tf return if error cuda sparse initialize const int m csr row ptr size 1 rows return cuda sparse csr row ptr data nnz m coo row ind data struct gpudevice status operator opkernelcontext c ttypes const int unalignedvec csr row ptr ttypes int unalignedvec coo row ind extern template struct gpudevice namespace functor ,de duplicate the functor in the library piperorigin revid , fix a bug in the graph piperorigin revid
1973,class tensorflowestimator baseestimator if not os path exists saver filename raise valueerror restore folder doesn't contain saver defintion with open saver filename as fsaver saver def tf python training saver pb2 saverdef saver def tf python training saver saver pb2 saverdef text format merge fsaver read saver def self saver tf train saver saver def saver def ,fix path to allow for restoring saved models , fix a bug in the docstring of the docstring of the docstring change
1974,static const dpioracletype dpi native type int64 default native type dpi sqlt int internal oracle type dpi sqlcs implicit charset form sizeof int32 t buffer size sizeof int64 t buffer size 0 is character data 1 can be in array 0 requires pre fetch ,fetched native integers support bit revert part of previous change , fix a bug in the client client client client
1975,class filterdatasetparams public datasetparams return other arguments status getinputnames std vector string input placeholder const override input placeholder reserve input dataset params size other arguments size input placeholder emplace back filterdatasetop kinputdataset status getinputnames std vector string input names const override input names clear input names reserve input dataset params size other arguments size input names emplace back filterdatasetop kinputdataset for int i 0 i other arguments size i input placeholder emplace back input names emplace back absl strcat filterdatasetop kotherarguments i ,refactor , fix a bug in the test case piperorigin revid
1976,ex pedit exarg t eap win t curwin save curwin open the preview window or popup and make it the current window g do tagpreview p pvh prepare tagpreview true keep help flag bt help curwin save w buffer edit the file do exedit eap null keep help flag false if curwin curwin save win valid curwin save return cursor to where we were return cursor to where we were validate cursor redraw later valid win enter curwin save true ,patch using pedit from a help file sets help filetype problem using pedit from a help file sets the preview window to help filetype wang shidong solution do not set keep help flag closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
1977,struct resort to this hack string pattern opts xla dump hlo module re should dump module pattern string view module name return re2 partialmatch string module name pattern return re2 partialmatch module name pattern else if opts xla dump hlo pass re empty opts xla dump to empty output format specified struct if opts xla dump hlo pass re empty string pattern opts xla dump hlo pass re should dump pass pattern string view pass name return re2 partialmatch string pass name pattern return re2 partialmatch pass name pattern else should dump pass string view return false ,lsc no new code piperorigin revid change id , xla gpu support for the hlo client client piperorigin revid change id idfcceffddcfacee
1978,import static org junit assert fail import java io file import java nio bytebuffer import java nio byteorder import java nio floatbuffer import java nio doublebuffer import java util hashmap import java util map import org junit test public final class interpretertest test public void floatbuffer floatbuffer floatbuffer allocate 10 doublebuffer doublebuffer doublebuffer allocate 10 float new float 2 8 8 3 try interpreter interpreter new interpreter model buffer interpreter run floatbuffer interpreter run doublebuffer fail catch illegalargumentexception e assertthat e hasmessagethat contains datatype error cannot resolve datatype of ,add support for typed java buffers as inputs outputs this includes and support piperorigin revid , fix a bug in the documentation of the new code change
1979,import numpy as np from pil import image from tensorflow lite python interpreter import interpreter import tensorflow as tf tf2 def load labels filename if name ' main ' help 'input standard deviation' args parser parse args interpreter interpreter model path args model file interpreter tf lite interpreter model path args model file interpreter allocate tensors input details interpreter get input details ,fix tf lite import to use recommended 'tf' symbols instead of deep imports piperorigin revid , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1980,bool unittestimpl runalltests when we are inside the subprocess of a death test const int repeat in subprocess for death test 1 gtest flag repeat repeats forever if the repeat count is negative const bool forever repeat 0 for int i 0 forever i repeat i const bool gtest repeat forever repeat 0 for int i 0 gtest repeat forever i repeat i we want to preserve failures generated by ad hoc test assertions executed before run all tests ,googletest export fixes https github com google googletest issues piperorigin revid , fix a bug in the parser test piperorigin revid
1981,void dtrace anon property void 32 enough for dof data digits assert mutex is locked dtrace lock fixme assert mutex is locked cpu lock assert mutex is locked cpu lock for i 0 i snprintf c sizeof c dof data d i ,latest changes to implement arch and os specific functions for the dtrace core , fix a bug in the new dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
1982,class listview object todo fkp very generic code it should be moved in a more generic place def is iterable obj if isinstance obj tf ops tensor return false try iter obj except exception pylint disable broad except ,allowing iter over dimensional tensors with known shapes piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
1983,inline void rungraphtransformations list of all graph transformations declare graph transformation convertexpanddimstoreshape declare graph transformation convertmatrixdiagv2tov1 declare graph transformation convertpureconvtodepthwise declare graph transformation convertreorderaxes declare graph transformation declare graph transformation converttrivialaddntoadd declare graph transformation declare graph transformation declare graph transformation converttrivialtransposetoreshape declare graph transformation convertreorderaxes declare graph transformation ensurebiasvectors declare graph transformation fuseactivationfunctions declare graph transformation fusebinaryintofollowingaffine ,support op piperorigin revid , fix a bug in the parser test piperorigin revid
1984,trunc string else for i int strlen s len n ptr2cells s i 1 room i for i int strlen s i 1 0 len n ptr2cells s i 1 room i len n ,patch message test only runs with one encoding problem message test only runs with one encoding dominique pelle solution run the test with utf and latin fix underflow related to , patch problem when using a terminal window is a bit slow solution add a test for the file
1985,def create train op total loss is inf or nan' ensure the train tensor computes grad updates return control flow ops with dependencies grad updates total loss train op control flow ops with dependencies grad updates total loss add the operation used for training to the 'train op' collection train ops ops get collection ref ops graphkeys train op if train op not in train ops train ops append train op return train op def train train op ,redirecting slim create train op to tf contrib training create train op change , fix a bug in the docstring of the docstring of the docstring change
1986,bool recursivecompilabilitychecker opisslow const node node bool recursivecompilabilitychecker iscompilablenode const node node int depth functionlibraryruntime lib runtime if node issource node issink return lognotcompilableandreturn node source or sink node arg nodes in a top level function represent feeds and retval nodes in a top level function represent fetches if depth 0 ,tpu cpu graph auto partition prototype piperorigin revid , xla gpu support for the xla client piperorigin revid change id iaaeabfdfedfeacedf
1987,static char features static int included patches add new patch number below this line 1368 1367 ,patch vim no error for missing white space around operator problem vim no error for missing white space around operator solution check for white space around etc , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1988,class tensorflowdialect public dialect public tensorflowdialect mlircontext context static stringref getdialectnamespace return tf gradient attribute tf gradient in the list of in a function references to its gradient function this attribute in tensorflow dialect is used to model tf gradientdef getgradientattrname returns the ,define getdialectnamespace method for the tensorflow dialect required to register tensorflow ops in for dialectconversion piperorigin revid , xla python add a xla hlo flag to the xla client backend piperorigin revid change id iceccdaaaceaedbfcabaddcb
1989,bool isrestore const nodedef node bool issend const nodedef node return node op send bool isshape const nodedef node return node op shape bool isshapen const nodedef node return node op shapen bool isslice const nodedef node return node op slice bool issplit const nodedef node return node op split ,support shape and shapen ops piperorigin revid , add a test for the graph and the graph piperorigin revid
1990,def add argument transformer parent node full name name logs node keywords append ast keyword arg arg name value arg value ast logs append ast edits info node lineno node col offset adding argument ' s' to call to s pasta dump node keywords 1 full name or name adding argument ' s' to call to s pasta dump node keywords 1 full name or name return node ,bug fix for tf upgrade v piperorigin revid , fix a bug in the docstring of the docstring of the test case piperorigin revid
1991,from tensorflow python framework import dtypes from tensorflow python framework import ops from tensorflow python ops import array ops from tensorflow python ops import control flow ops from tensorflow python ops import resource variable ops from tensorflow python ops import variable scope from tensorflow python platform import resource loader from tensorflow python platform import tf logging as logging def zero initializer ref use locking true name zero initializer loader load op library resource loader get path to datafile variable ops so return gen variable ops zero initializer ref name name if resource variable ops is resource variable ref return gen variable ops zero var initializer ref handle shape ref shape dtype ref dtype name name else return gen variable ops zero initializer ref name name deprecated none please switch to tf train assert global step def assert global step global step tensor ,make tf contrib framework zero initializer work with resourcevariable piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
1992,boost software license version 1 0 see accompanying file license 1 0 txt or copy at http www boost org license 1 0 txt include pch hpp define boost math overflow error policy ignore error include boost test included test exec monitor hpp include boost test floating point comparison hpp ,improve pch support move configuration tests to their own directory so they're only run when required svn r , fix a bug in the new parser test svn r
1993,def largest export versions n def keep paths heap for idx path in enumerate paths if path export version if path export version is not none heap path export version idx paths i for i in n heap return sorted ,fix gc largest export versions so it doesn't delete the export folder change , fix a bug in the docstring of the new api change
1994,static char features static int included patches add new patch number below this line ,updated for version problem ms windows when using wide font italic and bold are not included solution support wide bold wide italic and wide bold italic ken takata taro muraoka , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1995,inline to down cast from f so we only accept pointers return static cast to f the gmock compile assert macro can be used to verify that a compile time the gmock compile assert macro can be used to verify that a compile time expression is true for example you could use it to verify the size of a static array gmock compile assert arraysize content type names content num types content type names incorrect size gmock compile assert arraysize content type names content num types content type names incorrect size or to make sure a struct is smaller than a certain size gmock compile assert sizeof foo 128 foo too large gmock compile assert sizeof foo 128 foo too large the second argument to the macro is the name of the variable if the expression is false most compilers will issue a warning error ,improves the error message for leaked mocks to include the test name by zhanyong wan , fix a bug in the parser test piperorigin revid
1996,public mlircontext context rewritepattern getoperationname 1 context rewritepattern quantizecastop getoperationname 1 context patternmatchresult match operation op const override void rewrite operation op std unique ptr patternstate basestate patternmatchresult match operation op const state state is the operand a constant auto op cast auto op cast quantizecastop if matchpattern arg m constant state value return matchfailure ,bring naming of some quant ops in alignment with docs and introduce a few necessary additional ops stats ref stats coupled ref piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id iebdeaedebeebedaa
1997,void preparequantizepass funcop func quant in qa would introduce less quantization noise the cause is an minor error in constructing the original network model that introduced back to back fake quantization operations hence emit a warning n b at this point we≈ïe in the quantization dialect re use in xla etc quant quantizecastop we≈ïe matching here warning n b at this point we're in the quantization dialect enable re use in xla etc quant quantizecastop we're matching here func walk quant quantizecastop q op if up with end up with ,fix minor typos piperorigin revid change id , add a new method to the new dialect piperorigin revid
1998,static char features static int included patches add new patch number below this line ,patch no testing for registers problem no testing for registers solution add more test cases yegappan lakshmanan closes fix that p on last virtual column of tab inserts spaces , patch problem when using a channel to be a bit a bit slow solution add a test for the test
1999,static void do extrafork struct syscallrecord rec if pid alive extrapid true usleep 100 we take the rec lock here even though we don't obviously use it the reason is that the grandchild is using it lock rec lock while pid 0 int childstatus ,document why we take that rec lock in the extrafork path , fix a bug in the watchdog page
2000,from tensorflow python platform import app from tensorflow python platform import gfile from tensorflow python summary import summary try importing tensorrt ops if available pylint disable unused import trailing whitespace try import tensorflow contrib tensorrt as trt except importerror pass pylint enable unused import trailing whitespace def import to tensorboard model dir log dir view an imported protobuf model pb file as a graph in tensorboard ,import tensorrt if available to import pb to tensorboard py for displaying tensorrt ops , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2001,int numiterations const rewriterconfig cfg check if optimizer is allowed to run only once bool isrunonceoptimizer const string name return name layout name memory optimizer name loop optimizer name auto mixed precision name loop optimizer name auto mixed precision name auto mixed precision mkl bool const functiondef func ,add auto mixed precision mkl to run once optimizer list , fix a bug in the test case piperorigin revid
2002,class gtest test utils testcase def testenvvaraffectsflag self setenvvar output file' none testflag on failure' '1' '0' testflag 'color' 'yes' 'auto' testflag 'filter' 'footest bar' ' ' ,fix env var test to ignore xml output file if already set , fix a bug in the test case piperorigin revid
2003,bool hloinstruction isfusible const switch opcode case hloopcode kdomain case hloopcode kparameter case hloopcode kwhile case hloopcode kconditional case hloopcode kcall return false side effecting cannot be fused default ,add a fast check in for while and conditionals otherwise this check may take too long as it goes through all instructions in the computation we may reenable this and i look forward to it piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2004,include netinet in h include linux irda h include linux dn h include linux if ether h include compat h include log h include net h void sanitise socket int childno break case af packet protocol htons eth p all if rand 8 0 protocol rand if rand 2 0 protocol uint16 t rand switch rand 3 case 0 type sock dgram break ,socket packet mostly use eth p all protocol but also randomize it probably that's minor but mostly use eth p all as a protocol and in some minor cases allow to randomize it signed off by daniel borkmann dborkman redhat com , move the dtrace proto to the dtrace process to the dtrace process to the dtrace process to be used in the dtrace process to the dtrace process and dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
2005,class checkpointmanager object configure a checkpointmanager for use in directory if a checkpointmanager was previously used in directory its class checkpointmanager object self max to keep max to keep self keep checkpoint every n hours keep checkpoint every n hours self directory directory self checkpoint prefix os path join directory checkpoint name or ckpt self checkpoint prefix os path join directory checkpoint name recovered state get checkpoint state directory current clock time time self maybe delete collections ordereddict ,training checkpoint management py give parameter default value instead of none checkpoint name ckpt , fix a bug in the docstring of the new api api piperorigin revid change id iacffbebafbeeadcfbaca
2006,status hostcompare se stream stream se devicememorybase lhs const auto canonicalize comparisontype a comparisontype if std is same elementtype eigen half value a constexpr float kmaxfp16value if std isnan a return a if a 0 return kmaxfp16value 1 ,xla gpu fix host conv checker canonicalization for f and nans the gpu side checker is correct but the host side checker was canonicalizing nan to f max the effect of this is that you'd get a conv mismatch error but no description of exactly what mismatched piperorigin revid , xla gpu support for the same shape inference piperorigin revid
2007,test convertxplanetoopstats expect near 156 67 perf env ridge point test convertxplanetoopstats runenvironment xspace space xplanebuilder device space add planes device setname absl strcat kgpuplaneprefix 0 xplanebuilder device space add planes device setname absl strcat kgpuplaneprefix 1 opstats op stats convertxspacetoopstats space const runenvironment run env op stats run environment expect eq gpu run env device type expect eq 1 run env host count expect eq 1 run env task count expect eq 2 run env device core count namespace namespace profiler namespace tensorflow ,add xspace to converter for gpu and cpu piperorigin revid change id , xla gpu support for the client client piperorigin revid
2008,flush buffers int flush typeahead typebuf tb off maxmaplen typebuf tb len 0 if defined feat clientserver defined feat eval reset the flag that text received from a client or from feedkeys was inserted in the typeahead buffer typebuf was filled false endif else remove mapped characters at the start only ,patch hang when typing ctrl c in confirm in timer problem when a function invoked from a timer calls confirm and the user types ctrl c then vim hangs solution reset typebuf was filled ozaki kiichi closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
2009,see the license for the specific language governing permissions and limitations under the license from future import absolute import from future import division from future import print function from tensorflow contrib distributions python ops import conditional bijector from tensorflow contrib distributions python ops bijectors import conditional bijector from tensorflow python framework import dtypes from tensorflow python platform import test ,move bijectors into distinct files change , add a test for the new op op piperorigin revid
2010,def hann window window length periodic true dtype dtypes float32 name none raises valueerror if dtype is not a floating point type hann https en wikipedia org wiki window function hann window hann https en wikipedia org wiki window function hann and windows return raised cosine window name window length periodic dtype 0 54 0 46 ,update two wikipedia links , fix a bug in the docstring of the documentation of the tf data dataset piperorigin revid
2011,class tpuestimator estimator lib estimator if is export mode if mode rewrite for inference mode params 'use tpu' true add item to params params use tpu key true mode model fn lib modekeys predict else params 'use tpu' false add item to params params use tpu key false with self ctx with mode mode as ctx model fn wrapper modelfnwrapper model fn config params ctx ,fix breakage related to hparam in tpu estimator py piperorigin revid , update keras layers to keras piperorigin revid
2012,namespace mygame struct monsterextra struct struct bool operator const lhs const rhs inline bool operator const lhs const rhs struct monsterextra flatbuffers final class private flatbuffers table typedef typedef builder static const flatbuffers typetable minireflecttypetable return struct monsterextra flatbuffers final class private flatbuffers table struct typedef monsterextra table flatbuffers flatbufferbuilder fbb flatbuffers uoffset t start void add d0 double d0 ,c add builder and table typedefs add builder and table typedefs this gives us a way to use templates to go from a builder to a table and back again without having to pass both types in fix tests cpp generated cpp monster test generated h , fix a bug in the parser test piperorigin revid
2013,set var return else if v di tv v type tv v type emsg2 setting s to value with wrong type name return clear tv v di tv ,patch setting v errors to wrong type still possible problem setting v errors to wrong type still possible solution return after giving an error message christian brabandt , patch problem when using a terminal window is a bit slow solution add a test for the command line
2014,namespace fuzzing class fuzzchecknumerics public fuzzsession void buildgraph const scope scope override auto input tensorflow ops placeholder scope withopname input1 dt float tensorflow ops placeholder scope withopname input dt float auto prefix error void tensorflow ops checknumerics scope withopname output input prefix class fuzzchecknumerics public fuzzsession for size t i 0 i num floats i flat tensor i float data i input tensor ignoreerror runinputs input input tensor ignoreerror ,make all fuzzers use a fixed runinputs api piperorigin revid , fix a bug in the test case piperorigin revid
2015,class tensor typename ttypes t ndims consttensor flat outer dims const template typename t size t ndims 3 typename ttypes t ndims tensor flat inner outer dims int64 begin const typename ttypes t ndims consttensor flat inner outer dims int64 begin const render the first max entries values in this into a string string summarizevalue int64 max entries const typename ttypes t ndims consttensor tensor flat outer dims const template typename t size t ndims typename ttypes t ndims tensor tensor flat inner outer dims int64 begin const typename ttypes t ndims consttensor tensor flat inner outer dims int64 begin const gtl inlinedvector int64 4 flat outer computeflatouterdims shape dim sizes begin ndims return shaped t ndims computeflatinnerdims flat outer ndims ,fix const tensor in flat inner outer dims , fix a bug in the graph piperorigin revid
2016,test nnapidelegate expect that m getoutput elementsarearray 1 9 0 4 1 0 1 3 sanity check for the state ful nnapi delegate with accelerator name specified test nnapidelegate statefulnnapidelegate options options options execution preference statefulnnapidelegate options executionpreference options accelerator name nnapi reference floataddopmodel m options tensortype float32 1 2 2 1 tensortype float32 1 2 2 1 tensortype float32 activationfunctiontype none m populatetensor float m input1 2 0 0 2 0 7 0 8 m populatetensor float m input2 0 1 0 2 0 3 0 5 m invoke expect that m getoutput elementsarearray 1 9 0 4 1 0 1 3 class public singleopmodelwithnnapi public const tensordata input1 const tensordata input2 ,allow users specific a nnapi accelerator when using nnapi delegate piperorigin revid , xla gpu support for the layout of the layout is a bit piperorigin revid
2017,int dpivar getvalue dpivar var dpivarbuffer buffer uint32 t pos case dpi oracle type native double data value asdouble buffer data asdouble pos return dpi success case dpi oracle type date return dpidatabuffer fromoracledateasdouble data value var env error buffer data asdate pos case dpi oracle type timestamp case dpi oracle type timestamp tz case dpi oracle type timestamp ltz ,added support for returning a date value as a native double number of milliseconds since january as used by environments like node js , fix for the error message when the connection is a bit long
2018,class targettest test util tensorflowtestcase self assertequal len events 2 self assertequal events 1 summary value 0 tag 'scalar' def testsummaryglobalstep self global step training util get or create global step logdir tempfile mkdtemp with summary ops create summary file writer logdir max queue 0 name 't2' as default summary ops always record summaries summary ops scalar 'scalar' 2 0 global step global step events summary test util events from file logdir self assertequal len events 2 self assertequal events 1 summary value 0 tag 'scalar' if name ' main ' test main ,allow passing other global steps to summaries piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2019,def expand and tile tensor multiple dim 0 name none tiled multiple times along the new dimension args tensor input tensor tensor input tensor or sparsetensor multiple integer number of times to tile dim integer dimension along which to tile name name of operation ,add comment that argument can be either dense tensor or sparsetensor change , fix a bug in the docstring of the documentation of the tf nn entropy with logits piperorigin revid
2020,handle viminfo mark garray t values int force if idx 0 curwin w jumplistlen jumplistsize insert as the oldest entry idx 0 else if idx 0 curwin w jumplistlen jumplistsize no space to insert as the oldest entry idx 1 else if curwin w jumplistlen jumplistsize insert as oldest entry handle viminfo mark garray t values int force if curwin w jumplistlen jumplistsize drop the oldest entry idx vim free curwin w jumplist 0 fname for i 0 i idx i curwin w jumplist i curwin w jumplist i 1 ,patch problem memory access error when reading viminfo dominique pelle solution correct index in jumplist when at the end , patch problem when using a terminal window is a bit slow solution add a test for the gui
2021,nfa regtry prog col tm cleanup zsubexpr re extmatch out make extmatch for i 0 i subs in use i loop over z1 z2 etc there is no z0 for i 1 i subs in use i if reg multi ,patch problem segfault reading unitialized memory solution do not read match z it does not exist marius gedminas closes , patch problem when using a terminal window is a bit slow solution add a test for the command line
2022,profilerequest populateprofilerequest int duration ms request set repository root repository root request set session id session id request add tools trace viewer request add tools op profile request add tools input pipeline request add tools kernel stats status profile const string service addr const string logdir tf return if error fromgrpcstatus stub profile context request response if response encoded trace empty if response empty trace tf check ok savetensorboardprofile logdir session id response std cout print this at the end so that it's not buried in irrelevant log messages status profile const string service addr const string logdir std endl if response encoded trace empty if response empty trace return status error code unavailable no trace event is collected return status ok ,remove encoded traces in piperorigin revid change id , add a test for the tpu api piperorigin revid
2023,struct quantizationspecs dt half and dt qint8 inference type bool weight quantization false whether the quantization passes are triggered for post training quantization if it is true the model input doesn't require user specified input ranges todo fengliuai the weight quantization is just a special case of post training quantization we need to deprecate the weight quantization bool post training quantization false the node type when the model is exported currently this is limited to dt float dt half dt qint8 and dt quint8 when dt half is used the weight quantization flag needs to set to true when dt quint8 is used ,add a flag to the to indicate post training quantization workflow comparing to quantization aware training conversion the doesn't need to take input range arguments piperorigin revid change id , fix a bug in the parser build piperorigin revid
2024,class eagersavedmodelloader loader impl savedmodelloader signature fn wrapped prune feeds wrapped graph as graph element inp name for inp in input specs fetches name wrapped graph as graph element out name for name out in signature def outputs items fetches name out for name out in signature def outputs items pylint disable protected access signature fn arg keywords input names if len input names 1 ,restore output shapes when loading v savedmodels , fix a bug in the docstring of the keras model piperorigin revid
2025,class forloopnest const shape shape tensorflow gtl arrayslice int64 dimensions tensorflow stringpiece suffix emits a series of nested loops for iterating over an operand array loops are constructed in major to minor dimension layout order no loop is emitted for the given to the function returns an irarray index for the given operand array containing the indvars of the loops all dimensions of the index are filled except for to name suffix is the string to append to the names of llvm constructs eg basic blocks constructed by this method irarray index emitoperandarrayloopnest const llvm ir irarray operand array int64 dimension to skip tensorflow stringpiece name suffix convenience methods which return particular basic blocks of the outermost or innermost loops these methods return nullptr if no loops have been added yet ,move sort emitter logic into a helper file this will allow to reuse it for the cpu backend also move the method emitoperandarrayloopnest to the class this makes more sense than having it as part of iremitter piperorigin revid , tf data service support for tf data experimental piperorigin revid
2026,limitations under the license include tensorflow lite delegates gpu cl buffer h include tensorflow lite delegates gpu cl cl device h include tensorflow lite delegates gpu cl kernels gpu operation h include tensorflow lite delegates gpu cl model hints h include tensorflow lite delegates gpu cl selectors operation selector h include tensorflow lite delegates gpu cl selectors special selector h include tensorflow lite delegates gpu cl storage type util h ,moved to gpu common piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
2027,pyobject self unused pyobject args if pyarg parsetuple args s expr return null return pylong fromlong mb string2cells char u expr int strlen expr return pylong fromlong ifdef feat mbyte mb string2cells char u expr int strlen expr else strlen expr endif ,updated for version problem python interface doesn't build without the multi byte feature solution add ifdef ken takata , fix a bug in the documentation of the test case
2028,undo time when target is 0 back to origin if target 0 goto found mark avoid that gcc complains goto target zero may do this twice undo time above true stop above the header found target zero if we found it follow the path to go to where we want to be if uhp null target 0 ,patch compiler complains about uninitialized variable problem compiler complains about uninitialized variable tony mechelynck solution assign a value to the variable , patch problem when using a terminal window doesn't work solution add a test for the job
2029,do one cmd cmdlinep sourcing is equal to the lower if ea cmdidx cmd user ea cmdidx cmd size if ea cmdidx cmd size ifdef feat usr cmds ea cmdidx cmd user endif ea addr type cmdnames int ea cmdidx cmd addr type else ea addr type addr lines ,updated for version problem cannot build with tiny and small features taro muraoka solution add ifdef around cmd user , patch problem when using a terminal window is a bit slow solution add a test for the command line
2030,translatefrommlirregistration translatefrommlirregistration end llvm report fatal error attempting to overwrite an existing from function assert function attempting to register an empty translate to function assert function attempting to register an empty translate from function name function ,fix a typo in error message piperorigin revid , fix a bug in the parser test piperorigin revid
2031,class public opkernel values shape set dim 0 num values tf return if error context allocate output values index values shape values out int64 value size params dense values in numelements params dense values in dim size 0 const int64 num elements params dense values in numelements const int64 value size num elements 0 0 num elements params dense values in dim size 0 params dense values in value slices value size values out return tensorflow status ok ,fix sigfpe when concatenating two empty ragged tensors piperorigin revid , add support for int ops piperorigin revid
2032,clang format off dont't remove format off it prevent reordering of win includes if defined mingw32 defined mingw64 defined cygwin defined define posix c source 200809l define xopen source endif ifdef win32 ifndef win32 lean and mean ,remove posix c source and xopen source definitions when compiling remove posix c source and xopen source definitions when compiling on openbsd only define posix c source and xopen source for mingw cygwin platforms only define posix statements for mingw cygwin qnx platforms , fix a bug in the test case piperorigin revid
2033,def device device name or function returns a context manager that specifies the default device to use for newly created ops raises runtimeerror if eager execution is enabled and a function is passed in if context in graph mode return get default graph device device name or function else todo agarwal support device functions in eager mode if callable device name or function raise runtimeerror tf device does not support functions when eager execution is enabled return context device device name or function ,add check to tf device when called with a function in eager mode piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the input piperorigin revid
2034,class layer def init self unconditional kwargs pass autocast false as there is no reason to cast loss to a different dtype kwargs 'autocast' false super self init kwargs self unconditional unconditional ,do not cast inputs to layers this means tensors passed to model add loss will no longer be cast to floatx piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
2035,from tensorflow python training import training ops from tensorflow python util tf export import tf export tf export train tf export v1 train class optimizer optimizer pylint disable line too long optimizer that implements the proximal gradient descent algorithm ,remove tf train from the v api i believe this was an oversight during api qa efforts piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2036,void executorstate process taggednode tagged node int64 scheduled usec params device device track allocations if and only if we are collecting statistics params track allocations stats collector nullptr params log memory log memory params rendezvous rendezvous params session state session state params tensor store tensor store ,avoid calling logmemory isenabled in allocate tensor this saves a couple function calls on each allocation change , add a test for the tf data service piperorigin revid
2037,limitations under the license include tensorflow compiler jit xla tensor h include tensorflow compiler tf2xla xla compiler h include tensorflow compiler xla client local client h include tensorflow compiler xla service shaped buffer h include tensorflow core framework allocation description pb h include tensorflow core framework resource var h include tensorflow core framework tensor h class xlacomputationlaunchcontext const std vector xla shapedbuffer arguments const return arg ptrs private tensor datatype type const tensorshape shape se devicememorybase buffer int output num const xla hloinputoutputaliasconfig input output alias allocator allocator xla localclient client se devicememoryallocator xla allocator bool allocate xla tensors ,xla support aliasing resource variables piperorigin revid , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
2038,boost assert leading a shift 1 boost assert a b shift 1 boost uintmax t max iter 200 t first second first boost math detail hypergeometric 1f1 imp t a a shift t b b shift z pol log scaling ,f apply backwards recurrence relations for in large a b z approximation ci skip , fix a bug in the new parser test svn r
2039,void const intptr t sizes size t n void bufs uintptr t pos reinterpret cast uintptr t contiguous for size t i 0 i n i if sizes i 0 bufs i is either a constant an entry parameter or a thread local allocation if sizes i 1 bufs i nullptr else bufs i reinterpret cast void pos ,automated rollback of commit piperorigin revid , xla gpu support for the hlo client piperorigin revid change id icabdabcccecababba
2040,static char features static int included patches add new patch number below this line 842 841 ,patch getchar zero test fails on ms windows problem getchar zero test fails on ms windows solution disable the test for now , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2041,limitations under the license namespace tensorflow class sessionoptions struct sessionoptions this class is shared by threadpooldevice and gpudevice and initializes a shared eigen compute device used by both this ,sessionoptions is defined ad struct it should be declared the same , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2042,namespace tflite namespace optimize namespace calibration tflitestatus minmax update const float values size t tensor size tflitestatus minmax update const float values size t tensor size errorreporter error reporter if tensor size 0 return ktfliteok todo make it possible to use weighted moving average for size t i 0 i tensor size i if std isnan values i todo suharshs propagate errorreporter here tflite log tflite tflite log error model resulted in nan value during calibration please make sure model results in all real values during inference with provided dataset error reporter report model resulted in nan value during calibration please make sure model results in all real values during inference with provided dataset return ktfliteerror ,propagate nan value error through errorreporter piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id id ibdacdecbebffaefddaf
2043,class linearalgebraop public opkernel eigen matrix scalar eigen dynamic eigen dynamic eigen rowmajor using constmatrixmap eigen map const matrix using matrixmap eigen map matrix using eigen map const eigen matrix scalar 1 eigen dynamic using constmatrixmaps gtl inlinedvector constmatrixmap 4 using matrixmaps gtl inlinedvector matrixmap 4 using realscalar typename eigen numtraits scalar real extern template class linearalgebraop complex128 using matrixmaps typename base matrixmaps using constmatrixmap typename base constmatrixmap using constmatrixmaps typename base constmatrixmaps using typename base using tensorshapes typename base tensorshapes define register linalg op cpu opname opclass scalar ,add tf linalg tridiagonal mul op for a tridiagonal matrix by a dense matrix cpu implementation only piperorigin revid , fix a bug in the test case piperorigin revid
2044,class mapfntest test testcase def testmapsparsetensor self with self cached session with self assertraises typeerror map fn map fn lambda x x sparse tensor sparsetensor indices 0 0 0 1 1 0 values constant op constant 0 1 2 dense shape 2 2 st sparse tensor sparsetensor indices 0 0 0 1 1 0 values constant op constant 0 1 2 dense shape 2 2 result map fn map fn lambda x x st self assertallequal result indices st indices self assertallequal result values st values self assertallequal result dense shape st dense shape test util run in graph and eager modes def testmapoverscalarerrors self ,update tf map fn to support raggedtensors and sparsetensors piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
2045,win redr status matches displayed static void win redr status win t wp int ignore pum win redr status win t wp int ignore pum unused introw char u p ,patch compiler warning for unused variable problem compiler warning for unused variable yegappan lakshmanan solution add unused christian brabandt , patch problem when using a terminal window is a bit slow solution add a few more tests to the new code
2046,limitations under the license include tensorflow core kernels fill functor h if google cuda include third party gpus cuda include cuda h include tensorflow core platform stream executor h endif google cuda register cpu float register cpu double register cpu int32 register cpu complex64 register cpu eigen half if google cuda register gpu float register gpu double if cuda version 7050 register gpu eigen half endif endif google cuda namespace tensorflow ,enable fp support for matmul via cublas gated on compilation with cuda or higher if not the gpu tests will also not be run so that the tests as a whole will keep passing on cuda change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2047,limitations under the license ifndef tensorflow core kernels cwise ops h define tensorflow core kernels cwise ops h define use math defines include cmath include functional include type traits ,fix compilation with math constants with msvc piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2048,dtrace close dtrace hdl t dtp elf end dtp dt ctf elf free dtp dt mods free dtp dt module path free dtp dt free dtp dt free dtp ,free the dt module path on dtrace close we were leaking it , dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
2049,def convert to graph tensor value dtype none name none as ref false tensor map scoped captures tensors if tensor map is none capturing is not enabled if value dtype dtypes module resource return value return constant op constant value numpy if type value ops tensor and value graph is default graph the tensor has already been converted and captured the type check ,handling resource captures when defining functions piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
2050,export class scatterplotwebgl implements scatterplot this highlightedpoints filter id i this favorlabels i let selection this nearestpoint null only call event handlers if the click originated from the scatter plot if e this isdragsequence if this isdragsequence this foreach l l selection selection this isdragsequence false ,when loading a bookmark call on the first point also call this method when clicking in the nearest neighbors list this allows all listeners to fire showing the associated trace of a point if traces are enabled change , fix a bug in the documentation of the new version of the client client client piperorigin revid
2051,status functionalizecontrolflowpass run multiple times and we want to avoid functionalize it again static std map string string new std map string string tpureplicate ops are generated by tpureplicate computation tpureplicate ops are generated by tpureplicate computation xlalaunch ops are generated by encapsulatexlacomputationspass xlalaunch function ,rename tpureplicate op to tpureplicate so it won't be accidentally serialized renaming this op is fine because it's only a transient op occurring in graphoptimizationpass and it's never serialized in graphdef piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id iefecfafdafabefecbd
2052,skip add sub list multi subidx start col colnr t reginput regline off sub list multi subidx end lnum 1 else ,patch problem using uninitialized memory for regexp with back reference dominique pelle solution initialize end lnum , patch problem when using a terminal window is a bit slow solution add a test for the gui
2053,class nnapidelegatekernel break case if version 1 todo relax the constraint after tests on the drivers if android sdk version kminsdkversionfornnapi12 some nnapi 1 1 drivers don't support this operator properly return nullptr const auto input context tensors node inputs data 0 if input dims size 4 return nullptr if input type ktflitefloat32 input type ktfliteuint8 return nullptr if android sdk version kminsdkversionfornnapi12 input type ktflitefloat32 nnapi 1 0 11 only supports float input return nullptr return const nnapiopmappingargs mapping args aneuralnetworksoperationtype const int output id mapping args node outputs data 0 ,relax nnapi delegate to be able to delegate resize bilinear to pre q devices piperorigin revid , fix a bug in the new delegate piperorigin revid
2054,class basesaverbuilder object with ops name scope name save saveable op for saveable in saveables as name add the constant string tensor for the filename filename tensor constant op constant filename or model add a placeholder string tensor for the filename keep the name const for backwards compatibility filename tensor array ops placeholder with default filename or model shape name const add the save ops if sharded ,avoid creating constant nodes in cases where we know we'll end up feeding actual data this makes debugging constant folding easier piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
2055,def eager metrics fn model outputs targets sample weights none masks none for m in model metrics if m not in model compile metric functions return backend mean t for t in metric results return metric results def model loss model def model loss model total loss model loss weights list i output loss if loss fns total loss backend mean total loss add regularization losses custom losses model losses if custom losses ,remove backend mean from result tensors in eager mode piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
2056,class literal template typename nativet std unique ptr literal replicate int64 times const converts this literal to another primitive type returns an error if the conversion is not possible this literal must be array shaped converts this literal to another primitive type using static cast returns an error if the conversion is not possible this literal must be array shaped statusor std unique ptr literal convert primitivetype primitive dest type const converts this literal to another primitive type using a bitcast conversion the to and from primitive types must have the same bit width returns an error if the conversion is not possible this literal must be array shaped statusor std unique ptr literal bitcastconvert primitivetype primitive dest type const converts this literal to the given shape returns an error is the conversion is not possible ,add bitcast convert support to the evaluator and as a method on literal piperorigin revid , xla gpu support for the xla client piperorigin revid
2057,bool issplitv const nodedef node return node op splitv bool issqrtgrad const nodedef node return node op sqrtgrad bool issquare const nodedef node return node op square bool issquareddifference const nodedef node return node op squareddifference ,add bool to the grappler op types piperorigin revid , add a new method to the graph piperorigin revid
2058,emsg char u s return true called emsg true if emsg silent 0 ex exitval 1 if emsg severe is true when an error exception is to be thrown emsg char u s return true ex exitval 1 reset msg silent an error causes messages to be switched back on msg silent 0 cmd silent false ,patch when an error is caught vim still exits with non zero result problem when in ex mode and an error is caught by try catch vim still exits with a non zero exit code solution don't set ex exitval when inside a try catch partly by christian brabandt , patch problem when using a terminal window is a bit slow solution add a test for the test
2059,struct cropandresizebackpropimage cpudevice t including calculation cost in the depth loop and pixel loop const double cost per pixel method name bilinear depth eigen tensoropcost addcost float 4 depth eigen tensoropcost addcost float 7 eigen tensoropcost mulcost float 6 eigen tensoropcost t float 4 eigen tensoropcost addcost float 4 eigen tensoropcost addcost float 4 depth eigen tensoropcost addcost float eigen tensoropcost t float eigen tensoropcost t float eigen tensoropcost addcost float 3 const double cost per box crop height crop width cost per pixel const devicebase cpuworkerthreads worker threads ,update cost estimation for bilinear depth multiplication cast depth cast , fix a bug in the parser test piperorigin revid
2060,static void reenable coredumps static void set make it fail static char failed 0 static char failed false int fd const char buf 1 if we failed last time don't bother trying in future if failed 1 if failed true return fd open proc self make it fail o wronly static void set make it fail if errno eperm printf writing to proc self make it fail failed s n strerror errno else failed 1 failed true close fd ,change boolean tests to use true false instead of , fix a bug in the watchdog page
2061,static int ax25 protocols nr ax25 protos no layer 3 protocol impl void ax25 rand socket struct socket triplet st static void ax25 rand socket struct socket triplet st switch rnd 3 case 0 st type sock dgram void ax25 setsockopt struct sockopt so so optname rand array ax25 opts struct netproto proto ax25 name ax25 socket ax25 rand socket ,convert af ax to use netproto struct , fix a bug in the watchdog process
2062,void dump syscall tables void unsigned int i if biarch true printf 32bit syscalls d n max nr 32bit syscalls printf 64bit syscalls d n max nr 64bit syscalls for i 0 i max nr 32bit syscalls i printf 32 bit entrypoint d s syscalls 32bit i entry number syscalls 32bit i entry name if syscalls 32bit i entry flags active void dump syscall tables void printf disabled n else printf syscalls d n max nr syscalls for i 0 i max nr syscalls i printf s syscalls i entry name if syscalls i entry flags active ,output number of syscalls , make the syscall page we can be a bit more than the syscall process
2063,static struct fst term getattr 2 2 f term getattr term getcursor 1 1 f term getcursor term getjob 1 1 f term getjob term getline 1 2 f term getline term getline 2 2 f term getline term getsize 1 1 f term getsize term getstatus 1 1 f term getstatus term gettitle 1 1 f term gettitle term gettty 1 1 f term gettty term list 0 0 f term list term scrape 1 2 f term scrape term scrape 2 2 f term scrape term sendkeys 2 2 f term sendkeys term start 1 2 f term start term wait 1 1 f term wait ,patch term scrape and term getline require two arguments problem term scrape and term getline require two arguments but it is not enforced solution correct minimal number of arguments hirohito higashi update documentation ken takata , patch problem when using a terminal window is a bit slow solution add a test for the gui
2064,from future import print function from tensorflow python ops import gen risc ops go tf wildcard import pylint disable wildcard import from tensorflow python ops risc ops gen import pylint enable wildcard import def risc add input lhs ,add lowering from tf op to hlo add piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
2065,class cluster const std vector string fetch runmetadata metadata 0 run the specified grappleritem and return the corresponding metadata virtual status run const grappleritem item runmetadata metadata return run item graph item feed item fetch metadata protected std unordered map string deviceproperties devices const int timeout s ,get rid of a number of gratuitous graph copies in grappler code piperorigin revid , tf data service support for tf data experimental piperorigin revid
2066,class private shape getsubshape shape shape const xla shape getsubshape xla shape shape const return shapeutil getmutablesubshape shape index const shape getsubshape const shape shape const const xla shape getsubshape const xla shape shape const return shapeutil getsubshape shape index ,to avoid confusing certain compilers be more explicit in types in otherwise msvc gets confused piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id id icfecdffaddccbded
2067,do cmdline if p verbose 15 sourcing name null if p verbose 15 sourcing name null p verbose 16 msg verbose cmd sourcing lnum cmdline copy do one cmd if cmdlinep 0 ' ' cmdlinep 1 ' ' goto doend if p verbose 16 msg verbose cmd 0 cmdlinep 1 skip comment lines and leading white space and colons 2 handle command modifiers ,patch 'verbose' value causes duplicate output problem 'verbose' value causes duplicate output solution combine levels and into one message christian brabandt closes , patch problem when using a terminal window is a bit slow solution add a test for the command line
2068,class conv2dcustombackpropfilterop public opkernel tf call half register cpu kernels tf call float register cpu kernels tf call double register cpu kernels undef register cpu kernels gpu definitions namespace functor typename ttypes t 4 int tensor out tensorformat data format extern template struct padinput gpudevice t int 4 declare gpu spec double declare gpu spec float declare gpu spec eigen half undef declare gpu spec namespace functor register kernel builder name conv2dbackpropfilter device device gpu typeconstraint double t hostmemory filter sizes conv2dslowbackpropfilterop gpudevice double register kernel builder name conv2dbackpropfilter device device gpu typeconstraint float t ,adds float support for convd convdbackpropinput and convdbackpropfilter piperorigin revid , fix a bug in the test case piperorigin revid
2069,static char features static int included patches add new patch number below this line 1763 ,patch vim no error when assigning to script var with wrong type problem vim no error when assigning to script var with wrong type solution fix off by one error closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2070,ex quit exarg t eap wp curwin ifdef feat autocmd apply autocmds event quitpre null null false curbuf refuse to quit when locked or when the buffer in the last window is being closed can only happen in autocommands if curbuf locked win valid wp refuse to quit when locked if curbuf locked return apply autocmds event quitpre null null false wp w buffer bail out when autocommands closed the window refuse to quit when the buffer in the last window is being closed can only happen in autocommands if win valid wp wp w buffer b nwindows 1 wp w buffer b locked 0 return endif ,patch a quitpre autocommand may get the wrong file name problem a quitpre autocommand may get the wrong file name solution pass the buffer being closed to apply autocmds howe , patch problem when using a channel to be a list of a terminal window solution add a test for the command line
2071,test f sessiondebugminusaxtest assert eq 1 debug nan count tensor vals 0 scalar int64 ifndef google cuda todo cais the following test for concurrent debugged runs on a gpu once the root cause of the 0 5 flakiness has been addressed b test f sessiondebugminusaxtest test concurrent run calls on a graph with different debug watches test f sessiondebugminusaxtest outputs run metadata tf assert ok s if google cuda assert eq 2 run metadata partition graphs size else assert eq 1 run metadata partition graphs size endif assert eq 1 outputs size assert true outputs 0 isinitialized test f sessiondebugminusaxtest assert eq 1 0 y mat identity 1 0 endif class public testing test public ,tfdbg core temporarily disable flaky test on gpu in debug test has been flaky on gpu at a rate of this cl restrict this test method to cpu only until the underlying root cause of the flakiness is addressed change , fix a bug in the new delegate piperorigin revid
2072,tflitestatus microallocator initializeruntimetensor quantization scale reinterpret cast tflitefloatarray scale array quantization zero point reinterpret cast tfliteintarray zero point array todo rocky need to add a micro allocator test case that fails when this is not copied quantization quantized dimension src quantization quantized dimension result quantization ktfliteaffinequantization quantization ,add quantized dimension to data copied to runtime tensor from flatbuffer piperorigin revid change id , add support for int ops piperorigin revid
2073,class clarguments public argumentsbinder public clarguments default absl status init const deviceinfo device info absl status init const gpuinfo gpu info const std map std string std string linkables clcontext context arguments args std string code absl status init const deviceinfo device info arguments args absl status init const gpuinfo gpu info arguments args clcontext context temporary will be resolved later ,deviceinfo renamed into gpuinfo piperorigin revid change id , fix a bug in the new delegate test piperorigin revid
2074,status convertxspacetoprofileresponse const xspace xspace response set empty trace true return status ok tf return if error tf return if error req repository root req session id req host name ktraceviewer traceeventstojson trace trace viewer is the only tool skip opstats conversion status convertxspacetoprofileresponse const xspace xspace if tools contains kmemoryprofile std string json output tf return if error xspace json output tf return if error tf return if error req repository root req session id req host name kmemoryprofile json output ,make the semantics of repository root more consistent piperorigin revid change id , xla python fix a bug in the graph piperorigin revid
2075,static funcentry t global functions inputrestore 0 0 0 ret number f inputrestore inputsave 0 0 0 ret number f inputsave inputsecret 1 2 fearg 1 ret string f inputsecret insert 2 3 fearg 1 ret any f insert insert 2 3 fearg 1 ret first arg f insert interrupt 0 0 0 ret void f interrupt invert 1 1 fearg 1 ret number f invert isdirectory 1 1 fearg 1 ret number f isdirectory ,patch vim return type of insert is any problem vim return type of insert is any solution use type of the first argument , patch problem when using a terminal window is a bit slow solution add a test for the test
2076,import random import skflow import tensorflow as tf from sklearn import datasets metrics from sklearn import datasets metrics cross validation iris datasets load iris x train x test y train y test cross validation train test split iris data iris target ,added missing import in multiple gpu example , fix a bug in the test case piperorigin revid
2077,static int trytoreadnumanode const string pci bus id int device ordinal log info successful numa node read from sysfs had negative value value but there must be at least one numa node so returning numa node zero fclose file return 0 fclose file return value static int trytoreadnumanode const string pci bus id int device ordinal could not convert sysfs file contents to integral numa node value content fclose f return kunknownnumanode endif ,resource leak file tensorflow stream executor cuda cuda gpu executor cc error resource leak file tensorflow stream executor cuda cuda gpu executor cc error resource leak file tensorflow stream executor cuda cuda gpu executor cc error resource leak file , fix a bug in the new version of the client client client
2078,class memoryspaceassignment allocationsequence allocation sequence statistics of asynchronous copies struct int64 max outstanding async copies int64 num prefetches int64 prefetch bytes int64 num int64 eviction bytes virtual memoryspaceassignment default runs the memoryspaceassignment pass class memoryspaceassignment hlomodule module const hloliverange hlo live range const hloaliasanalysis alias analysis const options options returns the maximum number of outstanding asynchronous copies in the module static int64 const hlomodule module calculates asynchronous copy statistics statusor const static bufferintervalcompare getmemoryboundednessbufferintervalcompare const memoryspaceassignmentcostanalysis cost analysis ,xla calculate and print statistics about prefetches and piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id iefaaedbcfceefdda
2079,extern void item set behavior item ifdef have x11 h include x11 h static clipboard event time endif static clipboard event time easy to use macro for multihead support gui mch wait for chars long wtime if defined feat netbeans intg process the queued netbeans messages process any queued netbeans messages netbeans parse messages endif ,updated for version problem variable misplaced in ifdef solution move clipboard event time outside of ifdef , fix a bug in the new parser test for the new code svn r
2080,forward binop min forward binop and forward binop or forward binop xor forward binop shiftleft forward binop shiftrightarithmetic forward binop shiftrightlogical forward unop not forward unop abs forward unop exp ,xla add bit shift operators to local python client piperorigin revid , fix a bug in the test case piperorigin revid
2081,static void open fds char dir return while de readdir d memset buf 0 sizeof struct stat snprintf b sizeof b s s dir de d name if ignore files de d name continue everything that's not a regular file or directory static void open sockets int fd int nr to create 500 int domain type protocol if fd idx 500 nr to create fd idx static void open sockets printf creating sockets n while socks nr to create fd socket rand pf max rand type max rand proto max domain rand pf max type rand type max protocol rand proto max fd socket domain type protocol if fd 1 socket fds socks fd socks int get random fd void should never get here printf oops s d n file line exit 1 exit exit failure ,a bunch of dumb bugs found with including a missing syscall on x duh , fix a bug in the watchdog process
2082,class testcursor basetestcase value next self cursor execute insert into testtemptable intcol values 1 if sys version info 0 3 self assertraises cx oracle interfaceerror next self assertraises cx oracle interfaceerror next else self assertraises cx oracle interfaceerror next self assertraises cx oracle interfaceerror next def self self assertraises cx oracle programmingerror self cursor bindnames self assertraises cx oracle programmingerror self cursor bindnames self cursor prepare begin null end self assertequal self cursor bindnames self cursor prepare begin retval inval 5 end ,adjusted test cases to make use of encoding and nencoding parameters to both standalone connection and session pool creation added test cases for binding and fetching supplemental characters as well as fetching temporary lobs tidied up a few test cases as well , fix a bug in the test case for the test case
2083,def assert is image data data shape 1 assert is fully defined def add gan model image summaries gan model grid size 4 def add gan model image summaries gan model grid size 4 model summaries true adds image summaries for real and fake images args gan model a tuple grid size the size of an image grid model summaries also add summaries of the model raises valueerror if real and generated data aren't images def add gan model image summaries gan model grid size 4 image shape generated image shape num channels generated channels max outputs 1 add gan model summaries gan model if model summaries add gan model summaries gan model def add image comparison summaries gan model num comparisons 2 ,add option to not include histograms add option to not include histograms add test for model summaries false , fix a bug in the docstring of the docstring of the docstring change
2084,std map string string kbrokentests strided slice chooses the wrong dimension r strided slice buggy 119786029 r conv2d transpose filter shape 1 4 8 3 122735908 allows test data to be unarchived into a temporary directory and makes ,test to show errors in convd transpose piperorigin revid , fix a bug in the graph piperorigin revid
2085,register op input table handle ref string output size int64 setshapefn whitelist stateful op for dataset functions register op lookuptablesizev2 input table handle resource output size int64 setshapefn whitelist stateful op for dataset functions lookuptablesizev2 register op input table handle ref string ,add lookup table size ops to checkpointing whitelist reading the size doesn't actually alter the state of the lookup table so it's safe to checkpoint piperorigin revid , fix a bug in the test case piperorigin revid
2086,class public baserecvtensorcall and it always sets this wi to null when a call object is released to it we can assert that this wi is always null at the point of deletion check eq nullptr wi check eq static cast workerinterface nullptr wi leaking workerinterface in destructor ,fix build error on windows msvc cannot resolve the type of nullptr in check eq nullptr so we use a static cast to make it explicit , xla gpu support for the layout interface piperorigin revid change id icccbcbdbcfaadbee
2087,vgetorpeek int advance if gui in use shape changed gui update cursor true false endif if timedout c esc char u nop buf 3 when recording there will be no timeout add a nop after the esc to avoid that it forms a key code with following characters nop buf 0 k special nop buf 1 ks extra nop buf 2 ke nop nop buf 3 vgetc busy ,patch back recorded key sequence mistakes key code problem back recorded key sequence mistakes key code solution insert a nop after the esc closes , patch problem when using a terminal window doesn't work solution add a test for the cursor
2088,limitations under the license include algorithm include deque include ostream include set include unordered set include utility string tostring hloinstruction fusionkind kind std ostream operator std ostream os hloinstruction fusionkind kind return os tostring kind string hloinstruction convolutiondimensionnumberstostring const string result if convolution dimension numbers nullptr ,internal only changes change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2089,from tensorflow python keras engine import base layer utils from tensorflow python keras losses import binary crossentropy from tensorflow python keras losses import categorical crossentropy from tensorflow python keras losses import categorical hinge from tensorflow python keras losses import cosine similarity from tensorflow python keras losses import hinge from tensorflow python keras losses import kullback leibler divergence from tensorflow python keras losses import logcosh def sparse top k categorical accuracy y true y pred k 5 return math ops cast nn in top k y pred math ops cast y true 'int32' k k floatx def cosine similarity y true y pred axis 1 y true nn l2 normalize y true axis axis y pred nn l2 normalize y pred axis axis return math ops reduce sum y true y pred axis axis aliases mse mse mean squared error ,automated rollback of commit piperorigin revid , tf data optimizer to use the keras api piperorigin revid
2090,class builder object return self endvector len x def self x self assertnotnested cond flatbuffers internal self nested true endcond if not isinstance x compat binary types raise typeerror non byte vector passed to self prep n uoffsettflags bytewidth len x n uint8flags bytewidth l uoffsettflags py type len x cond flatbuffers internal self head uoffsettflags py type self head l endcond self bytes self head self head l x return self endvector len x cond flatbuffers internal def self ,python function in builder , fix a bug in the test piperorigin revid
2091,limitations under the license include mlir analysis loopanalysis h from llvm project include mlir dialect standardops ir ops h from llvm project include mlir ir attributes h from llvm project include mlir ir builtintypes h from llvm project include mlir ir opimplementation h from llvm project include mlir ir patternmatch h from llvm project include mlir ir standardtypes h from llvm project include mlir pass pass h from llvm project include mlir support llvm h from llvm project include mlir support logicalresult h from llvm project ,mlir nfc replace usages or mlir ir standardtypes h with mlir ir builtintypes h standardtypes h was moved to builtintypes h and is being removed piperorigin revid change id , xla python add a test for the xla client client piperorigin revid change id icbbdbfafcdfcae
2092,from tensorflow contrib boosted trees estimator batch import estimator utils from tensorflow contrib boosted trees estimator batch import trainer hooks from tensorflow contrib boosted trees python ops import model ops from tensorflow contrib boosted trees python training functions import gbdt batch from tensorflow core protobuf import config pb2 from tensorflow python framework import ops from tensorflow python ops import state ops from tensorflow python training import training util def model builder features if config is none raise valueerror missing estimator runconfig if config session config is not none session config config session config session config allow soft placement true else session config config pb2 configproto allow soft placement true config config replace session config session config center bias params center bias ,force soft placement assignment piperorigin revid , tf data service support for tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2093,from future import print function import threading import platform from tensorflow python compiler tensorrt wrap conversion import is tensorrt enabled from tensorflow python framework import errors tf trt so none def load trt ops global tf trt so if not is tensorrt enabled return if platform system windows raise runtimeerror windows platforms are not supported ,imports trt library when tf trt module is imported piperorigin revid , fix a bug in the test case piperorigin revid
2094,ex help eap arg eap arg if eap forceit arg nul if eap forceit arg nul curbuf b help emsg don't panic return ,updated for version problem help in a help file does not work as document solution when in a help file don't give an error message thinca , patch problem when using a terminal window is a bit slow solution add a test for the command line
2095,class whilecontext controlflowcontext else value op inputs 0 if self outer context forward ctxt self grad state forward ctxt forward ctxt self grad state forward context forward ctxt outer context enter zeros shape array ops shape internal value optimize false forward ctxt outer context exit history zeros shape grad state addforwardaccumulator zeros shape outer grad state self grad state outer grad state history zeros shape outer grad state addforwardaccumulator zeros shape self outer context enter real shape outer grad state addbackpropaccumulatedvalue history zeros shape zeros shape ,fix a bug in the gradient of nested loop the bug is a typo change , fix a bug in the test case piperorigin revid
2096,class cudnnrnnsequencetensordescriptor static port statusor cudnnrnnsequencetensordescriptor create cudaexecutor parent int max seq length int batch size int data size const absl span const int seq lengths cudnndatatype t data type if cudnn version check gt max seq length 0 int dims batch size data size 1 int strides dims 1 dims 2 dims 2 1 class cudnnrnnsequencetensordescriptor nbdims sizeof dims sizeof dims 0 dims strides const int seq lengths array seq lengths data if cudnn version data desc float padding fill 0 0f return if cudnn error ,fix build after previous change broke when cudnn version piperorigin revid , tf data service support for tf data dataset piperorigin revid
2097,class fromconcretefunctiontest testmodels root self getsimplevariablemodel with self assertraises valueerror as error lite tfliteconverterv2 from concrete functions root f self assertin from concrete function' str error exception self assertin get concrete function' str error exception parameterized named parameters true enable mlir ,fix internal unittest , fix a bug in the test case piperorigin revid
2098,class testinfo returns the test comment const char comment const returns true if this test should run returns true if this test matches the user specified filter bool matches filter const returns true if this test should run that is if the test is not disabled or it is disabled but the also run disabled tests flag has been specified and its full name matches the user specified filter google test allows the user to filter the tests by their full names the full name of a test bar in test case foo is defined as ,makes gtest list tests honor the test filter by jay , xla python fix a bug in the hlo evaluator piperorigin revid change id icccbcbdbcfaadbee
2099,do ecmd fnum ffname sfname eap newlnum flags oldwin close the link to the current buffer u sync false close buffer oldwin curbuf flags ecmd hide 0 dobuf unload flags ecmd hide 0 dobuf unload false ifdef feat autocmd autocommands may open a new window and leave oldwin open ,updated for version problem crash when a bufwinleave autocommand closes the only other window daniel solution abort closing a buffer when it becomes the only one , patch problem when using a terminal window is a bit slow solution add a test for the gui
2100,class binaryopstest xla test xlatestcase self assertallcloseaccordingtotype result i expected i rtol rtol atol atol test util disable mlir bridge f16 type is not supported in createdenseelementsattrfromliteral def testfloatops self for dtype in self float types if dtype dtypes bfloat16 as numpy dtype ,whitelist a few more unary and binary tensorflow ops for the fallback path enabled the passing tests also fixed the lowering for tensorflow round op which is not directly map to the hlo round op this is correctly handled by the fallback path piperorigin revid change id , xla gpu support for the xla client piperorigin revid
2101,class baseestimator loss none while not mon sess should stop loss mon sess run model fn ops train op model fn ops loss core summary filewritercache clear return loss ,don't clear summary filewritercache on each call to estimator fit piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
2102,statusor xlacomputation xlabuilder builddynamicinferencegraph xlaop root op seen item key stacktop id worklist pop back else visit and process operand if an operand doesn't need rewrite predicate of kselect or indices of kgather we also don't rewrite its ancestors workitem next item instr proto operand ids next operand item need rewrite visit and process operand workitem next item instr proto operand ids next operand true if opcode hloopcode kselect next operand 0 next item need rewrite false ,don't rewrite operand's ancestors into predicates in dynamism inference we don't rewrite predicates of kselect and indices of kgather into predicates and we also don't want to rewrite their ancestors into predicates piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id iadbdbdeeebea
2103,name none list dataset as numpy iterator 1 2 3 1 2 1 2 3 4 note unbatch requires a data copy to slice up the batched tensor into smaller unbatched tensors when optimizing performance try to avoid unnecessary usage of unbatch returns a dataset ,tf data add note about performance cost of dataset unbatch piperorigin revid change id , fix a bug in the documentation of the documentation of the documentation of the example
2104,tflitestatus evalquantized int16 t cell ptr gettensordata int16 t cell state int8 t activation ptr gettensordata int8 t activation state int8 t output ptr gettensordata int8 t output zero points int input zp 0 tflitestatus evalquantized for int t 0 t max time t const int t rel t output ptr output ptr t rel output step int8 t output ptr gettensordata int8 t output t rel output step input can be int8 asymmetric or int16 symmetric const int8 t input ptr gettensordata int8 t input t rel input step ,update output pointer move logic piperorigin revid change id , add support for int int piperorigin revid
2105,static char features static int included patches add new patch number below this line 860 859 ,updated for version problem when using remote expr try catch does not work andrey radev solution set emsg silent instead of emsg off , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2106,def on builder inited app if app builder name html app builder search false app builder script files clear ,remove blank lines at the end of all files in order to match whitespace standard , fix a bug in the documentation of the documentation of the new version of the default value of the default value of the same value of the same value piperorigin revid
2107,static void check children void output 0 syscall lock is held by d n shm syscall lock owner if diff 30 if we're still around after 40s repeatedly send sigkills every second if diff 40 if shm kill count i 1 output 0 sending another sigkill to pid d kill count d diff d n pid shm kill count i diff ,increase time for follow up sigkills sending one at s and then at s next time round the loop might not be a long enough delta if we're swapping like crazy and taking a while to page stuff in out bump it up to s , fix a bug in the watchdog page
2108,static unsigned long rept byte void unsigned short rand16 void unsigned short r 0 unsigned short r 0 r2 switch rnd 4 case 0 r rand single bit 16 unsigned short rand16 void break case 2 r rnd break case 3 r rnd rnd 8 case 3 r2 rnd 0xff r r2 r2 8 break ,fix rand to not shift out of range it also didn't match the original intent of this case , fix a bug in the watchdog page
2109,struct tensordescriptor public gpuobjectdescriptor void uploaddata const tflite gpu tensor hwc datatype float32 src void uploaddata const tflite gpu tensor linear datatype float32 src bool const axis axis const bool const axis axis const bool const applicable only for types that true in this case for address we have 1d component addr int if for addr 1 this linear storage type returns flt4 0 0 this function returns true otherwise false bool const datatype data type datatype unknown tensorstoragetype storage type tensorstoragetype unknown this field describes logical layout actual physical gpu layout can be ,added new utility functions to tensordescriptor for codegen simplification and generalization used in convolutiontransposed generation piperorigin revid change id , fix a bug in the parser test piperorigin revid
2110,from tensorflow python ops import math ops from tensorflow python platform import test test util run v1 only b 120545219 test util run v1 only incompatible with 2 0 class converttest test util tensorflowtestcase def testbasic self class converttest test util tensorflowtestcase quantized uint8 str error exception test util run v1 only b 120545219 test util run v1 only incompatible with 2 0 class converttestophint test util tensorflowtestcase ,clean up testing for tflite python code piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2111,def register dense tensor like type tensor type class tensor object represents one of the outputs of an operation note the tensor class will be replaced by output in the future currently these two are aliases for each other a tensor is a symbolic handle to one of the outputs of an operation it does not hold the values of that operation's output class tensor object return eval using default session self feed dict self graph session todo josh11b switch everyone from tensor to output to match c api output tensor def t dtype none name none as ref false name as ref if dtype and not dtype is compatible with t dtype ,create a type alias output for tensor plan is to eventually switch to output and delete tensor to match the c api change , fix a bug in the docstring of the test case piperorigin revid
2112,class function object assert not include tensor ranks only hashable input signature self hashable input signature if cache key context is none cache key context self cache key context parent graph device functions colocation stack in cross replica context variable policy xla context id cache key context ,remove cache key context none case , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
2113,int dpivar allocate dpiconn conn dpioracletypenum oracletypenum return dpierror set error check can be in array dpi err not supported if oracletypenum dpi oracle type boolean conn env versioninfo versionnum 12 return dpierror set error check boolean dpi err not supported dpiutils checkclientversion conn env versioninfo 12 1 error 0 return dpi failure if nativetypenum type defaultnativetypenum if dpivar validatetypes type nativetypenum error 0 return dpi failure ,added support for verifying that the client and database versions are at a minimum version , fix for the issue with the same value of the same value of the same value of the same value of the same value of the same value
2114,buflist new buffer number grows buf reuse ga len buf b fnum int buf reuse ga data buf reuse ga len move buffer to the right place in the buffer list while buf b prev null buf b fnum buf b prev b fnum buf t prev buf b prev prev b next buf b next if prev b next null prev b next b prev prev buf b next prev buf b prev prev b prev if buf b prev null buf b prev b next buf prev b prev buf if buf prev if firstbuf prev firstbuf buf else buf b fnum top file num ,patch bufnr ' ' is wrong after recycling popup buffer problem bufnr ' ' is wrong after recycling popup buffer solution sort the buffer list by buffer number closes , patch problem when using a popup window with a popup window solution add the cursor to the cursor when the cursor is set
2115,public static void build builder builder operationstate result stringref name functiontype type arrayref namedattribute attrs parsing printing methods operation hooks static parseresult parse opasmparser parser operationstate result void print opasmprinter p logicalresult verify returns the name of this function stringref getname return getattroftype stringattr name getvalue ,add a verify method to funcop and check that the type signature matches the signature of the entry block piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id icabdabcccecababba
2116,ins compl prep int c if prev col 0 dec cursor only format when something was inserted if arrow used ins need undo if arrow used ins need undo c ctrl e insertchar nul 0 1 if prev col 0 ml get curline curwin w cursor col nul ,patch problem cancelling completion still inserts text when formatting is done for 'textwidth' lacygoill solution don't format when ctrl e was typed hirohito higashi closes , patch problem when using a terminal window is a bit solution add a few more tests to the new code
2117,gpuexecutable resolveconstantglobals se streamexecutor executor module spec addcudaptxinmemory text c str absl flat hash map int64 se devicememorybase globals if module spec cuda ptx in memory nullptr no custom ptx no globals return module globals emplace executor std move globals first second se module handle executor module spec module handle tf return if error executor module spec module handle for bufferallocation index i 0 i assignment allocations size i ,se change streamexecutor and streamexecutor methods to return status returning bool is error prone as boolean values are ambiguous and can be ignored piperorigin revid , xla python add a xla hlo flag to the xla client client piperorigin revid
2118,class windowdatasetop public unarydatasetopkernel const datatypevector output dtypes const override static datatypevector output dtypes new datatypevector dt variant static datatypevector output dtypes new datatypevector input output dtypes size dt variant return output dtypes const std vector partialtensorshape output shapes const override static std vector partialtensorshape output shapes new std vector partialtensorshape tensorshape new std vector partialtensorshape input output shapes size tensorshape return output shapes ,tf data fix support for nested outputs of tf data dataset window piperorigin revid , fix a bug in the test case piperorigin revid
2119,class resizebilineartest parameterized testcase xla test xlatestcase def test self src y src x dst y dst x if test is built with rocm self skiptest 'disabled on rocm because it runs out of memory' max y max src y 1 1 dst y 1 1 max x max src x 1 1 dst x 1 1 ,rocm disable in image ops test , fix a bug in the test case piperorigin revid
2120,class colocationgraph status std unordered set node inspection required updates this colocationgraph by making sure that all nodes having inputs of a dt variant data type with a host only underlying types e g strings can be placed only on cpu device we do that by reverse dfs traversal from all nodes that take variant inputs to the node that produces that variant todo ezhulenev this function does not yet support deep op inspection that we have for dt resource edges status status const std unordered set node inspection required ,force cpu placement for ops that has dt variant inputs with host only underlying data type fix for piperorigin revid change id , add a test for the graph and the graph piperorigin revid
2121,opfoldresult reshapeop fold arrayref attribute operands first tensor dimension is dynamic auto arg ty tensor gettype dyn cast shapedtype if arg ty arg ty getnumdynamicdims 1 arg ty isdynamicdim 0 if arg ty arg ty hasrank arg ty getnumdynamicdims 1 arg ty isdynamicdim 0 return argument tensor rank is equal to the number of packed dimensions ,fix an assertion failure in the tf reshape op folder previously asserts when arg has a dynamic rank piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2122,class conversiontest test testcase def test object to graph unsupported types self with self assertraises valueerror conversion object to graph 'dummy' conversion object to graph 'dummy' none def test object to graph callable self def f a return a conversion map conversion conversionmap conversion map conversion conversionmap true ast new name conversion object to graph f conversion map self asserttrue isinstance ast gast functiondef ast self assertequal 'tf f' new name class conversiontest test testcase def f a return g a conversion map conversion conversionmap conversion map conversion conversionmap true conversion object to graph f conversion map self asserttrue f in conversion map dependency cache ,extend the api with a pair of decorators that can convert functions inline add logic to detect these decorators and treat them appropriately e g when converting recursively do all decorated functions as they are piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2123,static void read last page struct map map char p map ptr char buf page size memcpy buf p map size 1 page size page size memcpy buf p map size page size page size static const struct faultfn read faultfns ,page align the page that read last page writes to copying the similar change from , fix a bug in the watchdog process
2124,class testcursorvar basetestcase self assertequal cursor fetchall 1 'string 1' 2 'string 2' def self test that binding the cursor itself is not supported cursor self connection cursor sql self assertraises cx oracle databaseerror cursor execute sql pcursor cursor def testfetchcursor self test fetching a cursor self cursor execute ,prevent attempts from binding the cursor being executed to itself , fix a bug in the file
2125,from future import print function pylint disable invalid import order g bad import order unused import from tensorflow python import pywrap tensorflow from tensorflow core data service python import pywrap server lib from tensorflow python data service import pywrap server lib class object ,move server lib under tensorflow python to fix nightly pip build tf python pybind extension requires that it be used under the tensorflow python directory piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
2126,class interpreterbuilder subgraph subgraph tflitestatus applydelegates interpreter interpreter tflitestatus parsequantization const quantizationparameters src quantization tflitequantization quantization tflitequantization quantization const std vector int dims const tflite model model const opresolver op resolver ,remove a wrong check piperorigin revid , xla gpu support for the layout inference piperorigin revid change id icccbcbdbcfaadbee
2127,class test util tensorflowtestcase output lines def self if test util is gpu available self skiptest b this causes a segfault on gpu with stepper nodestepper self sess self e as node stepper cli stepper cli nodesteppercli node stepper class test util tensorflowtestcase self assertin stepper cli nodesteppercli state cont stat labels index d def self if test util is gpu available self skiptest b this causes a segfault on gpu with stepper nodestepper self sess self e as node stepper cli stepper cli nodesteppercli node stepper ,tf streamexecutor better checks of device vs host pointer location check whether source dest pointers really on the device being requested during memcpy piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2128,static void ruby process options int char endif ifdef ruby19 or later signed value rb num2long stub value x static signed value rb num2long stub value x return dll rb num2long x value rb int2big stub signed value x static value rb int2big stub signed value x return dll rb int2big x ,updated for version problem ruby interface defines local functions globally solution make the functions static , patch problem when using a popup window with a popup window solution add a test for the mouse event
2129,void moduleprinter printattributeoptionaltype attribute attr bool issigned intattr gettype isindex intattr gettype getintorfloatbitwidth 1 intattr getvalue print os issigned print type unless i64 parser defaults i64 in absence of type if includetype intattr gettype isinteger 64 print the type if includetype os printtype intattr gettype void moduleprinter printattributeoptionaltype attribute attr case attribute kind float auto floatattr attr cast floatattr printfloatvalue floatattr getvalue os print type unless f64 parser defaults to f64 in absence of type if includetype floatattr gettype isf64 print the type if includetype os printtype floatattr gettype ,simplify the parser printer of constantop now that all attributes have types this has the added benefit of removing type redundancy from the pretty form as a consequence floatattr will now always print the type even if it is i f piperorigin revid , fix a bug in the toy tutorial piperorigin revid change id icfcccdcbedbaacf
2130,class lossscaleoptimizertest test testcase parameterized testcase class gradient descent sgd def apply gradients self grads and vars name none def apply gradients self grads and vars name none all reduce sum gradients true for grad in grads and vars outer self assertisinstance grad ops tensor return super self apply gradients grads and vars name return super self apply gradients grads and vars name all reduce sum gradients with create mirrored strategy scope as strategy var variables variable 5 0 ,support all reduce sum gradients in lossscaleoptimizer piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
2131,const model buildmodel else a non zero value of num subgraph inputs means that some of the operator input tensors are not subgraph inputs tflite dcheck num subgraph inputs inputs size tflite dcheck num subgraph inputs inputs size const flatbuffers offset subgraph subgraphs subgraphs size ,tflu fix bug in micro allocator test and update review comments , tf data vectorization test for tf data dataset piperorigin revid
2132,class singleoptest computationtest for src dtype dst dtype in itertools product xla types xla types x src dtype dst dtype xla types dst dtype todo b re enable when shape check is resolved todo b implement alltoall on cpu def disabled self samples numpyarrayf32 97 0 ,mark alltoall as explicitly not implemented on cpu the default action does the wrong thing resulting in a strange assertion error piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id iffcbbabfbaeecaeaa
2133,class profiler object python typical use case currently we are only allowed to create 1 profiler per process profiler profile sess graph profiler profiler sess graph for i in xrange total steps if i 10000 0 class profiler object ,fix typo clarify argument type in comment , tf data service support for tf data dataset piperorigin revid
2134,static char features static int included patches add new patch number below this line 198 197 ,updated for version problem can't build vim with perl when is not specified for building perl and building vim with enable dynamic solution adjust ifdefs yasuhiro matsumoto , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2135,class pandasiotest test testcase x y self with self assertraisesregexp typeerror 'target column must be a string or none' 'target column must be a string type' pandas io pandas input fn x y batch size 2 shuffle false num epochs 1 ,fix test for target column type , fix a bug in the docstring of the docstring of the test case piperorigin revid
2136,string const collectiveparams col params opkernelcontext ctx opkernelcontext params params opkernel op tensor output tensor input sub params params sub inputs output input sub inputs tensorvalue output tensorvalue input sub input attr ctx input alloc attr 0 ctx input alloc attr 0 sub input dc ctx input device context 0 ctx input device context 0 ,make tensorvalue constructor explicit piperorigin revid , fix a bug in the graph piperorigin revid
2137,string filterdescriptor toshortstring const switch layout case filterlayout koutputinputyx return port strcat od id spatial case filterlayout koutputyxinput return port strcat od spatial id case filterlayout koutputinputyx4 return port strcat od id spatial vect c case filterlayout kinputyxoutput ,handle koutputyxinput in toshortstring this fixes an error when running resnet batch fp with v piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id id iefecfafdafabefecbd
2138,class cluster explicit cluster int timeout s virtual cluster returns a string that represent the type of cluster that was instantiated virtual string type const 0 provision the hardware resources needed to run tensorflow and start a tensorflow session that can take advantage of these resources the actual resources that are depend on the type of cluster ,extract placement restrictions for a graph piperorigin revid , xla python fix a bug in the graph piperorigin revid
2139,limitations under the license include tensorflow compiler xla python py buffer h include absl base casts h include tensorflow compiler xla pjrt pjrt client h include tensorflow compiler xla python python ref manager h include tensorflow compiler xla python types h ,add absl base casts h header to py cc piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2140,static void checkstats allocator a int64 num allocs int64 bytes in use int64 max bytes in use int64 max alloc size allocatorstats stats a getstats stats log info alloc stats endl stats debugstring log info alloc stats std endl stats debugstring expect eq stats bytes in use bytes in use expect eq stats max bytes in use max bytes in use expect eq stats num allocs num allocs ,fixed a small mistake that prevents the gpu bfc allocator test from compiling change , fix a bug in the new code of the new code piperorigin revid
2141,def convert version to int version version version split ' ' 0 version segments version split ' ' treat 0 24 as 0 24 0 if len version segments 2 version segments append '0' for seg in version segments if not seg isdigit return none ,fix configure py to properly compare x y z with x y right now is treated as lower than because of the odd comparison method that adds digits to each existing section this change converts to to fix that this will probably need to be pulled into r piperorigin revid , fix a bug in the docstring of the docstring of the new api change
2142,test gcsfilesystemtest newrandomaccessfile uri https storage googleapis com bucket random access txt n auth token fake token n range 18 26 n new fakehttprequest uri https storage googleapis com bucket random access txt n auth token fake token n range 0 8 n gcsfilesystem fs std unique ptr authprovider new fakeauthprovider std unique ptr httprequest factory test gcsfilesystemtest newrandomaccessfile file read 20 10 result scratch code expect true result empty the beginning of the file has been evicted from the lru cache this will result in another request the buffer size is still 15 the beginning of the file should still be in the lru cache there should not be another request the buffer size is still 15 tf expect ok file read 0 4 result scratch ,improve caching behavior of gcs filesystem on a number of cloud tpu related workloads these changes improve the time to restore from a checkpoint by x piperorigin revid , fix a bug in the test case piperorigin revid
2143,namespace tensorflow namespace tensorforest namespace const int32 sparse default 0 bool const decision trees inequalitytest test float value float bias test threshold float value ,remove dead code piperorigin revid , fix a bug in the graph piperorigin revid
2144,void bfcallocator splitchunk bfcallocator chunkhandle h size t num bytes void bfcallocator deallocateraw void ptr vlog 1 deallocateraw name requestedsize ptr deallocaterawinternal ptr retry helper notifydealloc ,add vloging for similar to piperorigin revid , xla gpu support for the hlo client piperorigin revid change id icabdabcccecababba
2145,def model builder features labels mode params config feature columns params feature columns weight column name params weight column name num trees params num trees logits modifier function params logits modifier function if features is none raise valueerror at least one feature must be specified def model builder features labels mode params config with ops name scope gbdt gbdt optimizer predictions dict gbdt model predict mode logits predictions dict predictions if logits modifier function logits logits modifier function logits features mode def train op fn loss ,add logit modifiers to allow boosting of previously trained models etc piperorigin revid , fix a bug in the docstring of the documentation of the tf nn rnn api piperorigin revid
2146,n start visual mode c virtualedit recalculate curwin w cursor to avoid bad if c ctrl v ve flags ve block gchar cursor tab validate virtcol coladvance curwin w virtcol endif visual curwin w cursor ,updated for version problem does not behave correctly when 'virtualedit' is set solution call validate virtcol david b√ºrgin , fix a bug in the parser test piperorigin revid
2147,from tensorflow python saved model import model utils from tensorflow python training import training as training module test util run deprecated v1 removed in v2 test util run v1 only 'keras experimental load from saved model is supported only in v1 ' class parameterized testcase test testcase def save model dir self dirname 'saved model' def load model sess path mode return inputs outputs meta graph def test util run deprecated v1 removed in v2 test util run v1 only 'keras experimental export saved model is supported only in v1 ' class testmodelsavedmodelexport test testcase parameterized testcase def save model dir self dirname 'saved model' ,update v only saved model experimental test test with proper reason piperorigin revid change id , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2148,tflitestatus parseopdata const operator op builtinoperator op type case builtinoperator zeros like case builtinoperator fill case builtinoperator floor mod case builtinoperator range break return ktfliteok ,add range to schema piperorigin revid , add support for int int piperorigin revid
2149,tensorslicer tensorslicer const mli tensor full tensor int slice dim int slice size int padding pre int padding post int overlap bool interleave mode full tensor full tensor sub tensor sub cfg done false slice dim pad pre padding pre pad post padding post overlap overlap sub cfg sub tensor done false overlap overlap in the interleave mode the slicing happens from the dimension up to the slice dim for example in an hwc layout this can mode can be used to slice in the c in this mode the data is not contiguous in memory ,switch conv depthwise conv and fully connected kernels to flat namespace fixed code to options wreorder wunused function fixed filters for new default linker options this is incremental progress towards a flat namespace for tflm see https abseil io tips for more context , fix a bug in the new delegate test piperorigin revid
2150,class adadelta optimizer v2 optimizerv2 def init self learning rate 0 001 rho 0 95 epsilon 1e 8 epsilon 1e 7 name construct a new adadelta optimizer ,implement keras v adagrad optimizer several notes regarding this change initial accumulator value and is kept from the public signature since internal search suggested many people use that included new argument epsilon from keras just the same as other optimizers piperorigin revid , update keras layers to keras piperorigin revid
2151,register op generateboundingboxproposals return status ok todo ringwalt add a fill mode attr with constant mirror etc todo ringwalt add a fill constant argument for constant mode default 0 v2 op supports output shape v1 op is in contrib register op imageprojectivetransformv2 register op imageprojectivetransformv2 input output shape int32 attr dtype uint8 int32 int64 float16 float32 float64 attr interpolation string attr fill mode string 'constant' output transformed images dtype setshapefn inferencecontext c shapehandle input ,support reflect constant and wrap mode in image transform op using the generator interface piperorigin revid change id , add support for int ops piperorigin revid
2152,class generatetest googletest testcase output dir tempfile mkdtemp base dir os path dirname file generate write docs output dir base dir duplicate of duplicates index tree reverse index guide index generate write docs output dir base dir duplicate of duplicates index tree reverse index doc index guide index make sure that the right files are written to disk self asserttrue os path exists os path join output dir 'index md' ,more doc generator changes change , fix a bug in the docstring of the docstring of the docstring change
2153,class profilebuffer returns the profile event at the given index if the index is invalid a nullptr is returned the return event may get overwritten if more events are added to buffer const struct profileevent const at int index const const struct profileevent const at size t index const size t size size if index size return nullptr ,updated profile buffer h fixed the warning in the file , xla python fix a bug in the hlo evaluator piperorigin revid change id ibebfcffdcbdbdafeb
2154,static int open testfile fds void int fd fd open testfile i 1 if fd 1 shm testfile fds i fd output 2 fd d testfile d n fd i 1 i if fd 1 return false shm testfile fds i fd output 2 fd d testfile d n fd i 1 i return true ,if opening one testfile fails don't keep trying , make the watchdog process to the syscall process
2155,class mklrequantizationrangeperchannelop public opkernel auto input matrix input flat inner dims qint32 todo verify performance of not transposing and finding the min max directly from input matrix vs the one below of transposing and using the transposed matrix as the transpose operation might be more directly from input matrix vs the one presented below of transposing and using the transposed matrix as the transposing operation in itself might be more note that this operation is a calibration step for quantization and will cease to exist in the final inference graph as it will exist as a const node cease to exist in the final inference graph will exist as a const node auto transposed input input matrix shuffle shuffling find the ranges of each channel in parallel ,review comments changes , fix a bug in the new delegate piperorigin revid
2156,class gatherop public opkernel int64 min params dim axis 0 axis axis 1 op requires c axis params dims axis params dims errors invalidargument expected axis in the range params dims params dims but got axis c params dims min params dim errors invalidargument shape must be at least rank min params dim but is rank params dims if axis 0 axis params dims axis ,fixing run v decorator for gather op test py also moving it to an array ops folder piperorigin revid change id , tf data dataset support for tf data dataset piperorigin revid
2157,static void call inet sso ptr struct sockopt so struct socket triplet triplet void do setsockopt struct sockopt so struct socket triplet triplet so optname 0 get a page for the optval to live in todo push this down into the per proto func calls ,clear on each do setsockopt invocation , fix a bug in the watchdog page we can be a bit more than the child process
2158,const nodedef arithmeticoptimizer trysimplifyandreplaceuses if node op reshape reshape reshape input becomes reshape reshape input nodedef reshape node map getnode node name const nodedef input node map getnode node input 0 if input op reshape reshape set input 0 input input 0 node map updateinput reshape name input name input input 0 new nodes push back reshape return reshape fold a multiply of a scalar into the following convolution this folding can jump across nodes that merely reorders data such as reshape and transpose for example we can optimize ,grappler fold chains of reshapes reshape reshape input shape shape is equivalent to reshape input shape piperorigin revid , tf data optimization for tf data experimental tf data experimental tf data experimental piperorigin revid change id idaceccfcbacfece
2159,class maxnorm constraint def call self w norms k sqrt k sum k square w axis self axis keepdims true desired k clip norms 0 self max value w desired k epsilon norms return w return w desired k epsilon norms def get config self return 'max value' self max value 'axis' self axis class constraint def call self w w k cast k greater equal w 0 k floatx return w return w k cast k greater equal w 0 k floatx class constraint class constraint desired self rate k clip norms self min value self max value 1 self rate norms w desired k epsilon norms return w return w desired k epsilon norms def get config self return ,switch to using resourcevariable in keras for full eager mode compatibility piperorigin revid , fix a bug in the docstring of the docstring of the new api change
2160,pybind11 module pybind m lhs rhs return lhs get rhs get def compose self map return self get compose map def get constant value self py object auto const expr self get dyn cast affineconstantexpr if const expr return py cast const expr getvalue return py none returns the constant value for the affine expression if any or returns none def str str py class m affinemap ,add py api for composing an affine expression with a map also allows extracting constant values for const expressions piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id iefecfafdafabefecbd
2161,def convert multinomial pfor input registerpfor statelessmultinomial registerpfor statelessparameterizedtruncatednormal registerpfor statelessrandombinomial registerpfor statelessrandomgammav2 registerpfor statelessrandomnormal ,add pfor strategy for stateless truncated normal piperorigin revid change id , tf data saveable shape for tf data dataset piperorigin revid
2162,tflitestatus comparisonprepare tflitecontext context tflitenode node const tflitetensor input2 getinput context node kinputtensor2 tflitetensor output getoutput context node koutputtensor don't support string and bool tf lite ensure context input1 type ktflitestring input1 type ktflitebool don't support string tf lite ensure context input1 type ktflitestring currently only support tensors have the same type tf lite ensure types eq context input1 type input2 type output type ktflitebool ,lite compare op bug fix , add support for int int piperorigin revid
2163,status foldbatchnorms const graphdef input graph def make sure all the inputs really are vectors with as many entries as there are columns in the weights const int weights cols index conv node op conv2d 3 conv node op depthwiseconv2dnative 2 1 const int64 weights cols weights shape dim size weights cols index int64 weights cols if conv node op conv2d weights cols weights shape dim size 3 else if conv node op depthwiseconv2dnative weights cols weights shape dim size 2 weights shape dim size 3 else weights cols weights shape dim size 1 if mul values shape dims 1 mul values shape dim size 0 weights cols return errors invalidargument ,take channel multiplier into thanks to , xla gpu support for the cpu backend piperorigin revid change id idaceccfcbacfece
2164,int dpilob copy dpilob lob dpilob copiedlob dpilob flushbuffer public no longer supported will be dropped in version 3 should not be called int dpilob flushbuffer dpilob lob dpierror error if dpilob check lob func 0 error 0 return dpi failure dpierror set error not supported dpi err not supported return dpigen endpublicfn lob dpi failure error dpilob getbuffersize public get the required size of a buffer given the number of characters if the ,restore dpilob flushbuffer in order to avoid breaking semantic versioning , fix a bug in the client client client client
2165,class context object property def executor self ensure initialized self ensure initialized return executor executor pywrap tfe tfe contextgetexecutorforthread self context handle executor setter def executor self e ensure initialized self ensure initialized pywrap tfe tfe contextsetexecutorforthread self context handle e handle property ,call context ensure initialized method directly , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2166,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2019 12 30 forward compatibility horizon datetime date 2019 12 31 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
2167,def assert same structure nest1 nest2 check types true convert to bool explicitly as otherwise pybind will not be able to handle type mismatch message correctly see github issue for details check types bool check types expand composites bool expand composites try pywrap utils assertsamestructure nest1 nest2 check types expand composites ,convert expand composites to bool explicitly to prevent pybind caused process abort see github issue for details also fixes the pylint failure signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the docstring of the docstring change
2168,register empty string cpu register empty int32 cpu register empty int64 cpu register empty bool cpu register empty uint8 cpu if google cuda ,makes empty support uint on cpu piperorigin revid , fix a bug in the test case piperorigin revid
2169,void optimizedatasetop makedataset opkernelcontext ctx datasetbase input if there are no optimizations to be applied directly return the input if optimizations empty output input input ref return auto config factory this optimizations return createconfig optimizations optimization configs ,tf data add to most input pipelines enable graph rewrites only when there are optimizations to be applied to the pipelines piperorigin revid change id , tf data vectorization optimization to use the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
2170,class kerasindependentworkertestbase num ps none kwargs cluster spec multi worker test base create cluster spec num workers num workers num ps num ps num workers num workers num ps num ps test obj self self barrier dc barrier num workers num ps or 0 pylint disable protected access def worker fn kwargs ,skip multi worker dist strat tests if portpicker raises piperorigin revid , tf data saveable shape for tf data dataset piperorigin revid
2171,absl status gpuoperationfromnode const deviceinfo device info case operationtype reduce product case operationtype reduce sum auto attr absl any cast reduceattributes node operation attributes if attr axis axis channels if attr dims std set axis axis channels return absl unimplementederror currently we can reduce only in channels dimension ,extended to support set of axis for reduction piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id idaceccfcbacfece
2172,static inline bool int log level return log level s log level static inline void int log level s log level log level define fmt do if log level verbose break printf fmt n va args while 0 define fmt do if log level debug break ,add makefile for hexagon controller change , fix a bug in the new code of the new code svn r
2173,string tostring activation mode status opkernelconstruction context activation mode if google cuda if google cuda tensorflow use rocm there is a behavior difference between cudnn v4 and v5 with regard to the scaling factor for function struct typename ttypes t 4 tensor out endif google cuda endif google cuda tensorflow use rocm functor used by fusedbatchnormgradop to do the computations when is training false both cpu and gpu will use this functor ,adding rocm support for the fused batch norm op , xla gpu support for the layout inference piperorigin revid change id ibadadadacbbbef
2174,define boost math interpolators detail quintic hermite detail hpp include algorithm include stdexcept include sstream namespace boost math interpolators detail ,quintic hermite fix include fix docs add test to jamfile , fix a bug in the new parser test svn r
2175,cublasstatus t getsymbolnotfounderror return cublas status internal error typedef enum cublasmath t endif if cuda version 9020 if cuda version 10000 include tensorflow stream executor cuda cublas 9 0 inc elif cuda version 10000 include tensorflow stream executor cuda cublas 10 0 inc ,fix wrapper selection for cuda x piperorigin revid change id , fix a bug in the parser test piperorigin revid
2176,define mlir ir basicblock h include mlir ir instructions h include mlir ir usedeflists h include llvm adt ilist h include memory namespace mlir class bbargument ,minimal patch to allow patterns to rewrite multi result instructions related to b piperorigin revid , xla gpu support for the hlo dialect piperorigin revid change id iebdeaedebeebedaa
2177,class builtindataallocator platform targets support that properly static assert std is pod t value builtin data structure must be pod void allocated memory this allocate sizeof t alignof t return new allocated memory t return new allocated memory t virtual builtindataallocator ,initialize pod types change id , xla python fix a bug in the hlo client client piperorigin revid
2178,tensorflow status createtrtnode tensorflow graph graph info precision mode int8mode create static engine and for int8 test validity of the engine logger trt logger auto builder std unique ptr nvinfer1 ibuilder std function void nvinfer1 ibuilder nvinfer1 createinferbuilder trt logger nvinfer1 ibuilder p if p p destroy trtuniqueptrtype nvinfer1 ibuilder builder nvinfer1 createinferbuilder trt logger builder max batch size if info precision mode builder true builder info max workspace size bytes ,use for all builder network engine construction add build rules for utils h add more todos , tf data service support for tf data experimental piperorigin revid
2179,get job options typval t tv jobopt t opt int supported hashitem t hi ch part tpart opt jo set 0 if tv v type var unknown return ok if tv v type var dict job cleanup job t job intdummy invoke the exit callback make sure the refcount is 0 ch log job jv channel invoking exit callback s job jv exit cb job jv refcount argv 0 v type var job argv 0 vval v job job job start typval t argvars jobopt t opt arg if get job options argvars 1 opt jo mode all jo cb all jo timeout all jo stoponexit jo exit cb jo out io jo block write fail goto theend goto theend check that when io is file that there is a file name ,patch crash when job exit callback wipes the terminal problem crash when job exit callback wipes the terminal solution check for b term to be null yasuhiro matsumoto closes implement options for term start to be able to test make term wait more reliable , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2180,status backwardsconstanalysis const graph g std vector bool compile time const arg indices std vector bool compile time const nodes std function bool const edge edge filter operators that don't look at the data of their inputs just the shapes const std unordered set string metadata ops rank shape shapen size std vector bool compile time const nodes impl if compile time const nodes check eq compile time const nodes size g num node ids status backwardsconstanalysis const graph g if status ok return if this is a metadata only op don't propagate the const requirement if metadata ops find node type string metadata ops end return if xlaopregistry ismetadataop node type string return if this node must be const and it isn't a metadata op then all of its parents must be const ,refactor out the metadata ops set from const analysis to a per op bit nfc piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2181,public affinemap int64 t val one dimension id identity map i i affinemap multi dimensional identity map d0 d1 d2 d0 d1 d2 affinemap unsigned rank one symbol identity map s s affinemap ,affine map composition implements affinevaluemap forward substitution for adds transformation pass which affine maps for all loads stores in an mlfunction adds multiple affine map composition tests piperorigin revid , xla gpu support for the hlo instruction piperorigin revid
2182,do ecmd fnum ffname sfname eap newlnum flags oldwin endif check fname fail goto theend e foobar when already editing foobar will reload the file but when 'buftype' is nofile there is no file to load so don't do anything if curbuf b p bt 0 'n' curbuf b p bt 2 'f' goto theend oldbuf flags ecmd oldbuf ,updated for version problem when doing e when already editing and 'buftype' is the buffer is cleared xavier de gaye solution do no clear the buffer , patch problem when using a terminal window is a bit slow solution add a test for the gui
2183,public class testhelper throw new illegalargumentexception interpreter has not initialized failed to setusennapi gets the last inference duration in nanoseconds it returns null if there is no previous inference run or the last inference run failed param interpreter an instance of code interpreter if it is not initialized an code illegalargumentexception will be thrown public static long getlastnativeinferencedurationnanoseconds interpreter interpreter if interpreter null interpreter wrapper null return interpreter wrapper getlastnativeinferencedurationnanoseconds else throw new illegalargumentexception interpreter has not initialized failed to get latency ,added a tflite java api to get last inference latency in piperorigin revid , fix a bug in the new delegate piperorigin revid
2184,class tf test testcase self assertfalse coord sess should stop self assertequal 0 coord sess run c self assertequal 1 coord sess run v feed dict c 1 with self assertraisesregexp tf errors invalidargumenterror 'both fed and coord sess run c feed dict c 2 with self assertraisesregexp typeerror 'none has invalid type' coord sess run none feed dict c 2 self asserttrue coord should stop self asserttrue coord sess should stop class tf test testcase self assertequal 1 coord sess run v feed dict c 1 for t in threads self asserttrue t is alive with self assertraisesregexp tf errors invalidargumenterror 'both fed and coord sess run c feed dict c 2 with self assertraisesregexp typeerror 'none has invalid type' coord sess run none feed dict c 2 for t in threads self assertfalse t is alive self asserttrue coord should stop ,allow fetching a fed value in session run also make session run a no op instead of an error as this is more robust to code that dynamically builds arg lists for run calls change , fix a bug in the docstring of the test case piperorigin revid
2185,stringref name functiontype type function declarations func func function signature function attributes block function func function signature function attributes function body function body block function attributes attributes attribute dict parseresult ,update the gdocs to reflect the merging of cfg and ml functions piperorigin revid , xla gpu support for the layout of the hlo evaluator piperorigin revid
2186,class attentionwrapper core rnn cell rnncell behavior is not guaranteed name name to use when creating ops super attentionwrapper self init super attentionwrapper self init name name if not isinstance cell core rnn cell rnncell raise typeerror cell must be an rnncell saw type s type cell name ,pass attention name to super change , fix a bug in the docstring of the docstring of the docstring change
2187,pybind11 module xla extension m def static from python pylocalbuffer frompython def static from python values pylocalbuffer frompythonvalues def static make tuple pylocalbuffer maketuple def copy to device pylocalbuffer copytodevice def delete pylocalbuffer delete def destructure pylocalbuffer destructuretuple def block host until ready pylocalbuffer blockhostuntilready ,xla python add support for direct device to device copies piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id id iefecfafdafabefecbd
2188,class customgradienttest test util tensorflowtestcase self assertequal 6 math ops reduce sum dx numpy self assertequal 8 math ops reduce sum dw numpy def self with context eager mode custom gradient custom gradient def f x out x def grad return none none return out grad x np ones 3 2 dtype np float32 smoke test to ensure numpy inputs are accepted f x if name main googletest main ,fix bug in custom gradient in eager mode with numpy inputs piperorigin revid , tf data saveable shape for tf data dataset piperorigin revid
2189,static int check shm sanity void return shm ok static void check main void static int check main alive void int ret static void check main void else output 0 watchdog problem checking on pid d d s n mainpid errno strerror errno return false return true static unsigned int reap dead kids void static void watchdog void if check shm sanity shm corrupt goto corrupt check main if check main alive false goto main dead if shm regenerating false static void watchdog void main dead are we done if shm exit reason still running give children a chance to exit ,add special case for 'main to bail the watchdog loop , fix a bug in the watchdog process
2190,def get build results server info server get job info name last build number info 'lastcompletedbuild' 'number' last failed builder number info 'lastfailedbuild' 'number' if info 'lastfailedbuild' last failed builder number info 'lastfailedbuild' 'number' if last build number last failed builder number failures append result ,infra some builds never fail , infra fix a bug in the documentation of the new version of the client client client piperorigin revid
2191,def square x name none return gen math ops square x name name def sqrt x name none with ops op scope x name sqrt as name if isinstance x ops sparsetensor x sqrt gen math ops sqrt x values name name return ops sparsetensor indices x indices values x sqrt shape x shape else return gen math ops sqrt x name name def complex abs x name none r computes the complex absolute value of a tensor ,enable tf sqrt for sparsetensor , fix a bug in the docstring of the docstring of the docstring change
2192,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 5 12 forward compatibility horizon datetime date 2020 5 13 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
2193,checkederror parser startstruct const std string name structdef dest struct def file file being parsed move this struct to the back of the vector just in case it was predeclared to preserve declaration order remove structs vec begin structs vec end struct def struct def std remove structs vec begin structs vec end struct def struct def dest struct def return noerror ,specify namespace for remove function , fix a bug in the parser test piperorigin revid
2194,class test util tensorflowtestcase test util tensorflowtestcase setupclass cls server port cls debug server url cls server dump dir cls server thread cls server grpc debug test server start server on separate thread cls server grpc debug test server start server on separate thread poll server true cls server address localhost d cls server port cls server port 2 cls debug server url 2 cls server dump dir 2 cls server thread 2 class test util tensorflowtestcase with self assertraises valueerror self server query source file line tf trace file path 0 todo b re enable this test when not flaky def disabled self def self this func name send traceback traceback extract stack send lineno line number above ,tfdbg de flake and re enable a test in source remote test for some reason the debug grpc server startup is sometimes delayed in python adding polling of test server to fix that piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2195,include winbase h include direct h else include sys stat h include limits h endif include sys types h include sys stat h include flatbuffers flatbuffers h fileexistsfunction fileexistsfunction check if file name exists bool fileexists const char name check if name exists and it is also a directory bool const char name load file name into buf returning true if successful false otherwise if binary is false data is read using text mode otherwise data is read with ,fixed loadfile crashing on directory arguments change id tested on linux , fix a bunch of the dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
2196,class indexlookup base preprocessing layer combinerpreprocessinglayer mask zero if true input values of 0 for integers and for strings will be treated as masked values and assigned an output value of 0 if this option is set reserve zero must also be set defaults to false call arguments inputs the data to look up can be a tf tensor or raggedtensor invert controls the lookup direction if false the layer will map strings class indexlookup base preprocessing layer combinerpreprocessinglayer keys values self get table data this is required because the mutablehashtable doesn't preserve insertion order but we rely on the order of the array to assign indices return x for x in sorted zip values keys if self dtype dtypes string return x decode utf 8 for x in sorted zip values keys else return x for x in sorted zip values keys def get config self config ,update index lookup to return a utf string in vocabulary lookup instead of a piperorigin revid change id , fix a bug in the docstring of the test piperorigin revid
2197,static struct builtin term builtin termcaps int ks le b int ks vi if eb 033 esc str int ks ve if eb 033 esc str int ks vs if eb 033 esc str if 0 this is currently disabled because we cannot reliably restore the cursor because of what appears to be an xterm bug cursor style because of what appears to be an xterm bug int ks ve if eb 033 033 12l esc str esc str 12l int ks vs if eb 033 esc str ifdef terminfo int ks csh if eb 033 p1 d q esc str p1 d q else ,patch using a terminal may cause the cursor to blink problem using a terminal may cause the cursor to blink solution do not set t vs since we cannot restore the old blink state , patch problem when using a terminal window is a bit solution add a few more tests to the new code
2198,boost auto test case calling logging attribute value p1 attr1 get value logging attribute value p2 get value boost check equal call count 1 boost check equal call count 1u logging attribute value p3 get value boost check equal call count 2 boost check equal call count 2u disp set expected 10 boost check p1 dispatch disp ,silenced signed unsigned mismatch warnings , fix a bug in the parser test for the new parser test piperorigin revid
2199,from future import division from future import print function import functools as functools import inspect as inspect import traceback as traceback def make decorator target def make decorator target the decorator func argument with new metadata attached if decorator name is none prev frame inspect currentframe f back decorator name inspect prev frame 2 caller's name frame traceback extract stack limit 2 0 frame name is tuple 2 in python2 and object name in python3 decorator name getattr frame 'name' frame 2 caller's name decorator tfdecorator decorator name target decorator doc decorator argspec setattr decorator func ' tf decorator' decorator ,fixes use traceback instead of inspect for frame information use traceback for faster stack lookup use traceback for faster stack lookup fix rebase typo revert arg scope change , tf data service support for tf data dataset piperorigin revid
2200,class parameterserverstrategytest num gpus per worker 2 self test all reduce mean gradient tape distribution def self distribution parameter server strategy parameterserverstrategy self test trainable variable distribution class parameterized testcase ,make mirroredstrategy throw an error when creating a trainable replicalocalvariable piperorigin revid , fix a bug in the test case piperorigin revid
2201,void close logfiles fclose shm logfiles i file find logfile handle static file find logfile handle pid t pid unsigned int i ,find logfile handle can be static , fix a bug in the watchdog page
2202,def write build info filename key value list see the license for the specific language governing permissions and limitations under the license auto generated module providing information about the build auto generated module providing information about the build from future import absolute import from future import division from future import print function ,fix typos from the latest version , update the version of the default to the new version of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the same value piperorigin revid
2203,luav setref lua state l abort set ref in item tv copyid null null lua pushinteger l abort return 0 static int ,updated for version problem luav setref is missing a return statement ozaki kiichi solution put the return statement back , patch problem when using a terminal window is a bit slow solution add a test for the command line
2204,include execinfo h include stdio h include child h include config h include debug h include log h void bug const char bugtxt const char filename const char funcname unsig sleep 1 void dump childdata struct childdata child output 0 syscall p n child syscall output 0 previous syscall p n child previous output 0 logfile p dirty d n child logfile child logdirty output 0 mappings p num d n child mappings child num mappings output 0 seed ld n child seed output 0 pid d n child pid output 0 d n child num output 0 d n child kill count output 0 dontkillme d n child dontkillme ,dump some info about the child when we find a weird pid , move the dtrace proto to the dtrace process to the dtrace process to the dtrace process to be used in the dtrace process to the dtrace process and dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
2205,def assert scalar value name name name return control flow ops with dependencies check value name name name elif value rank 0 return value else ,fix typo in assertion string in parsing ops py piperorigin revid , tf data saveable dataset to be used for tf data dataset piperorigin revid
2206,struct thpool thpool init int num threads thpool p threads struct thread malloc num threads sizeof struct thread if thpool p threads null fprintf stderr thpool init could not allocate memory for threads n jobqueue destroy thpool p free thpool p jobqueue p free thpool p return null ,added some unlikely required free s , fix a bug in the file
2207,class public nodeshader public status generatecode const generationcontext ctx generatedcode generated code const final auto inputs ctx graph findinputs ctx node id auto outputs ctx graph findoutputs ctx node id std string code r vec4 prev state input data 1 gid x gid y gid z class public nodeshader objects workload uint3 workgroup uint3 source code code source code std move code input iostructure only definitions output iostructure auto ,tflite gpu removed unused variables piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id iaaeabfdfedfeacedf
2208,default cuda path win 'c program files nvidia gpu computing ' tf opencl version '1 2' default computecpp toolkit path ' usr local computecpp' default trisycl include dir ' usr local trisycl include' supported android ndk versions 10 11 12 13 14 15 16 supported android ndk versions 10 11 12 13 14 15 16 17 18 default prompt ask attempts 10 ,update configure script to not warn about bazel r and r bazel supports both revisions now piperorigin revid , fix a bug in the file file
2209,eval vars long current sctx sc lnum sourcing lnum result strbuf break endif case spec sid if current sctx sc sid 0 eval vars sprintf char strbuf snr d current sctx sc sid result strbuf break endif ifdef feat clientserver case spec client source of last submitted input ,patch build failure without the eval feature problem build failure without the eval feature solution add ifdef , patch problem when using a terminal window is a bit slow solution add a test for the gui
2210,tf functionmetadata tf tf concretefunction func tensorflow unwrap func tfe op tf tf concretefunction func tfe tensorhandle inputs int num inputs tf status status tfe op tf tf concretefunction func tfe tensorhandle inputs int num inputs tf status status tensorflow immediateopptr call op absl span tensorflow abstracttensorhandle const input span reinterpret cast tensorflow abstracttensorhandle tensorflow unwrap inputs static cast size t num inputs status status tensorflow unwrap func input span call op status status tensorflow unwrap func input span call op if status status ok return nullptr ,refactoring to depend on for its implementation also rename piperorigin revid change id , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the shape of the shape of the shape of the shape of the shape piperorigin revid
2211,except importerror pylint enable g import not at top keras export 'keras models model from config' keras export 'keras models from config' def model from config config custom objects none instantiates a keras model from its config usage for a functional api model tf keras model from config model get config for a sequential model tf keras sequential from config model get config arguments config configuration dictionary ,fix docs for model from config , fix a bug in the docstring of the new api change
2212,include stdlib h include unistd h include limits h include string h include files h ifdef x86 64 define task size 4096 endif ,fix up implicit declaration , dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
2213,include functional include boost ref hpp include boost bind hpp include boost shared ptr hpp include boost smart ptr shared ptr hpp include boost date time posix time posix time hpp include boost thread thread hpp include boost thread barrier hpp include boost log attributes hpp include boost log sinks hpp include boost log sources logger hpp include boost log utility empty deleter hpp include boost log utility record ordering hpp namespace logging boost log ,merged recent changes from trunk svn r , fix a bug in the new module of the new module of the dtrace hdl is not used by the dtrace dtrace is not used in the dtrace process and the dtrace is not used in the dtrace process and the dtrace dtrace is not used in the same process piperorigin revid
2214,func rcv stat init buf byte i flatbuffers uoffsett rcv tab pos i func rcv stat id string func rcv stat id byte o flatbuffers uoffsett rcv tab offset 4 if o 0 return rcv tab string o rcv tab pos return rcv tab bytevector o rcv tab pos return return nil func rcv stat val int64 ,remove all string allocations during parsing change the signature for 'string' getters and settings to use byte slices instead of strings , patch problem when using a terminal window doesn't work solution add a test for the job
2215,from tensorflow python framework import ops from tensorflow python ops import control flow ops from tensorflow python ops import variables from tensorflow python platform import test from tensorflow python training import checkpoint management from tensorflow python training import saver as saver lib from tensorflow python training import training util class checkpointinputpipelinehooktest test testcase def read vars self model dir with ops graph as default as g ckpt path saver lib latest checkpoint model dir ckpt path checkpoint management latest checkpoint model dir meta filename ckpt path ' meta' saver lib import meta graph meta filename saver saver lib saver ,split checkpoint management utility functions out of saver py pure refactor in preparation for adding a higher level checkpoint management utility this utility will also need to work with the checkpoint proto and globbing it on to saver py seems dirty piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2216,class test testcase self assertequal dtypes float64 v2 dtype self assertallequal 1 1 1 self evaluate v2 def self with context eager mode checkpoint directory self get temp dir checkpoint prefix os path join checkpoint directory ckpt dense core dense 1 checkpoint checkpointable utils checkpoint dense dense dense constant op constant 1 save path checkpoint save checkpoint prefix objects checkpointable utils object metadata save path all variable names for obj in objects nodes for attribute in obj attributes all variable names append attribute full name self assertin dense kernel all variable names class saver lib basesaverbuilder saveableobject ,checkpointable utilities to read object metadata useful for inspecting checkpoints e g in unit tests piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2217,define crtdbg map alloc endif include assert h if defined flatbuffers assert include assert h define flatbuffers assert assert elif defined flatbuffers assert include include file with forward declaration include flatbuffers assert include endif ifndef arduino ,add fuzzer test for scalar numbers in json add fuzzer test for scalar numbers in json grammar based regex used to check correctness fix , patch problem when using a popup window with a popup window solution add a test for the mouse autocommand
2218,void xlacompilationdevice compute opkernel op kernel auto frontend attributes result getfrontendattributesfromattrslice attrslice op kernel def op requires ok context frontend attributes result status absl optional xla frontendattributes frontend attributes absl optional xla frontendattributes attributes frontend attributes result valueordie xla frontendattributes merged attributes b frontend attributes if attributes has value merged attributes mutable map insert attributes value map begin attributes value map end xla assign frontend attributes b frontend attributes b std move merged attributes if no sharding metadata is found xla is free to use whatever device it wants in practice this usually has the effect of placing things on device ,moved the attributes merging out of the class and changed into , add a test for the new op op piperorigin revid
2219,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2019 12 21 forward compatibility horizon datetime date 2019 12 22 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
2220,class runconfig clusterconfig core run config runconfig so instead of breaking compatibility with that assumption we just manually initialize this field self distribute none self device fn none gpu options config pb2 gpuoptions per process gpu memory fraction gpu memory fraction ,adding manual initialization of device fn in legacy runconfig class , fix a bug in the docstring of the docstring of the docstring change
2221,builtinopresolver builtinopresolver addbuiltin builtinoperator squeeze register squeeze addbuiltin builtinoperator strided slice register strided slice addbuiltin builtinoperator exp register exp addbuiltin builtinoperator topk v2 register topk v2 addbuiltin builtinoperator topk v2 register topk v2 min version 1 max version 2 addbuiltin builtinoperator log register log addbuiltin builtinoperator log softmax register log softmax addbuiltin builtinoperator cast register cast ,add int support for topk v piperorigin revid , add support for int int piperorigin revid
2222,mkllayoutrewritepass checkfornodefusion node a const const fusioninfo fi ptr nullptr for auto fi finfo begin fi finfo end fi assert fi ops size fi node checkers size nodes clear fi ptr fi ,remove an assert line , add support for int and max types piperorigin revid
2223,install registry void printf creating an uninstall entry n sprintf display name vim vim version short ifdef win64 ifdef m arm64 arm64 elif m x64 x64 endif ,patch no support for windows on arm problem no support for windows on arm solution add arm support van , fix a bug in the file in the file
2224,static pytypeobject tfe py tape type 7 doesn't define thread local so for compatibility we implement our own todo apassos remove once we can deprecate 7 ifndef apple thread local std vector tfe py tape tape stack nullptr std vector tfe py tape if tape stack nullptr tape stack new std vector tfe py tape return tape stack thread local std vector tfe py tape tape stack return tape stack else static tensorflow mutex stack mu tensorflow linker initialized ,proper deallocation in the thread local tape stack piperorigin revid , fix a bug in the test case piperorigin revid
2225,int open with fopen const char filename int flags file file int fd 1 char mode 3 char mode 3 switch flags case o rdonly mode 0 'r' ,shut up a coverity warning about uninitialised var it's not possible to get here with flags set to anything other than the three cases in the switch but it doesn't hurt to silence it , fix a bug in the previous commit
2226,class experiment object otherwise the servers will wait to connect to each other before starting to train we might as well start as soon as we can config self estimator config if config cluster spec and config master and config environment run config environment local logging warn clusterspec and master are provided but environment is set to 'local' set environment to if you intend to use the distributed runtime if config environment run config environment local and config environment run config environment google and config cluster spec and config master ,add warning to experiment so that users know to set environment cloud if they have an explicit cluster and master i e give an indication that they intend to be running distributed piperorigin revid , fix a bug in the docstring of the docstring of the tf data strategy piperorigin revid
2227,ex exarg t eap void ex scriptversion exarg t eap unused ifdef feat eval intnr if getline equal eap getline eap cookie getsourceline ex scriptversion exarg t eap unused semsg e999 scriptversion not supported d nr else current sctx sc version nr endif if defined feat eval defined proto ,patch build failure without the eval feature problem build failure without the eval feature solution add ifdef , patch problem when using a terminal window is a bit slow solution add a test for the test
2228,required packages 'numpy 1 13 3' 'six 1 10 0' 'protobuf 3 4 0' 'setuptools 39 1 0' 'tensorboard 1 8 0 1 9 0' 'termcolor 1 1 0' ,adding a constraint for the setuptools version , update the documentation of the docstring of the docstring of the docstring of the example to the new api change
2229,import functools import inspect import os import pdb import re import sys import textwrap def converted call f owner options args kwargs other built in modules are permanently whitelisted todo mdan figure out how to do this consistently for all stdlib modules if any f in m dict values for m in collections pdb copy inspect if any f in m dict values for m in collections pdb copy inspect re logging log 2 'permanently whitelisted s part of builtin module' f return call unconverted f args kwargs ,whitelist the re system module update the tests to use recursive conversion throughout piperorigin revid , fix a bug in the docstring of the test piperorigin revid
2230,def eager metrics fn model outputs targets sample weights none masks none outputs nest flatten outputs targets nest flatten targets todo psv consider supporting skip target indices in eager mode invoke all weighted and unweighted metrics metric results model handle metrics outputs targets targets sample weights sample weights masks masks outputs return weighted and unweighted metrics true targets targets sample weights sample weights masks masks add metric results from the add metric metrics metric results extend m result for m in model metrics if m not in model compile metric functions return backend mean t for t in metric results ,move loss and weighted metrics graph compilation into its own function piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
2231,static char features static int included patches add new patch number below this line 1309 1308 ,patch problem when a test fails not all relevant info is listed solution add the errors to the messages , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2232,post chdir local vim free curwin w localdir curwin w localdir null if local if still in global directory need to remember current post chdir local name vim free globaldir globaldir null curwin w localdir null shorten fnames true ,updated for version problem crash when using cd in autocommand ingelrest solution set w localdir to null after freeing it dominique pelle , patch problem when using a terminal window doesn't work solution add a test for the job
2233,static char features static int included patches add new patch number below this line 2024 ,patch delete call commented out for debugging problem delete call commented out for debugging solution restore the delete call christian brabandt , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2234,stdmethodimp ulong cshellext release parameters specifies the parent folder the set of items selected in that folder specifies the set of items selected in that folder specifies the type of the item in the selection return value ,updated for version problem typos in source files solution fix the typos ken takata , patch problem when using a terminal window is a bit solution add a test for the cursor
2235,class functiondefhelper return functionref name node is used to functiondef node using initialization node is used to construct functiondef node using initialization lists e g node n z mul x y t t z x y struct node ,fix a typo change , fix a bug in the test case piperorigin revid
2236,include limits h python h defines posix threads itself if needed ifdef posix threads undef posix threads endif if defined win32 defined have fcntl h undef have fcntl h endif ,patch undefining posix threads causes problems with python problem undefining posix threads causes problems with python closes solution remove the lines , patch problem when using a popup window with a terminal window solution add a test for the mouse flag
2237,ins redraw endif ifdef feat autocmd if has cursormovedi make sure curswant is correct an autocommand may call getcurpos update curswant apply autocmds event cursormovedi null null false curbuf endif ifdef feat conceal if curwin w p cole 0 ,patch problem cursor changes column with up motion when the matchparen plugin saves and restores the cursor position martin solution make sure curswant is updated before invoking the autocommand , patch problem when using a popup window with a terminal window solution add the option to the current buffer when the cursor is set
2238,class fileiotest tf test testcase def self file path os path join self base dir temp file self assertfalse file io file exists file path with self assertraises errors notfounderror file io read file to string file path def self file path os path join self base dir temp file class fileiotest tf test testcase file io delete file file path self assertfalse file io file exists file path def self file path os path join self base dir temp file with self assertraises errors notfounderror file io delete file file path def testgetmatchingfiles self dir path os path join self base dir temp dir file io create dir dir path ,adding comments to the fileio class also adding a couple of more test cases change , fix a bug in the docstring of the test case piperorigin revid
2239,def get git version git base path unknown label unknown try val subprocess check output git c git base path describe val subprocess check output git str git dir git base path git str work tree git base path describe long dirty tags strip return val if val else unknown label except subprocess calledprocesserror ,support older versions of git the parameter c is unknown in git but git dir and work tree can be used , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary solution add a test for the line
2240,statusor mlir operation hlofunctionimporter importinstruction noattributecase knegate negop noattributecase kor orop noattributecase kpower powop noattributecase kreal realop noattributecase kremainder remop the dimensions attribute is not present on the hlo reshape instruction if dimensions are non default the xla builder implements it as a separate transpose noattributecase kreal realop noattributecase kreshape reshapeop noattributecase krsqrt rsqrtop noattributecase kselect selectop ,add remainder support to hlofunctionimporter piperorigin revid change id , xla gpu support for xla hlo ir emitters piperorigin revid change id iadbdbdeeebea
2241,public void print opasmprinter p logicalresult verify static void getcanonicalizationpatterns owningrewritepatternlist results mlircontext context logicalresult fold arrayref attribute smallvectorimpl opfoldresult results bool return getnumoperands 1 1 public static parseresult parse opasmparser parser operationstate result void print opasmprinter p static void getcanonicalizationpatterns owningrewritepatternlist results mlircontext context logicalresult fold arrayref attribute smallvectorimpl opfoldresult results prints dimension and symbol list ,refactor various canonicalization patterns as in place folds this is more efficient and allows for these to fire in more situations e g dialectconversion etc piperorigin revid change id , xla gpu support for the hlo ir piperorigin revid change id icabdabcccecababba
2242,int getnumavailablegpus if gpu manager nullptr int num gpus gpu manager visibledevicecount for int i 0 i num gpus i auto exec status gpu manager executorfordevice i if exec status ok se streamexecutor se exec status valueordie const se devicedescription desc se getdevicedescription auto desc status gpu manager descriptionfordevice i if desc status ok auto desc desc status consumevalueordie int cc major 0 int cc minor 0 desc cuda compute capability cc major cc minor desc cuda compute capability cc major cc minor std pair int int cuda compute capability cc major cc minor int min gpu core count 8 if desc core count min gpu core count if desc core count min gpu core count cuda compute capability min cuda compute capability num eligible gpus ,avoid unnecessary gpu allocation migrate to new devicedescription apis to avoid inadvertently allocating on unused gpus piperorigin revid , fix a bug in the test case piperorigin revid
2243,bool dot instr parent parent config dot instr target machine features todo sanjoy this is not quite right it should be impl strategy impl strategy impl strategy but i'll fix this in a later cl in the interest of keeping the cl adding this comment nfc return impl strategy return impl strategy impl strategy impl strategy ,xla cpu enable transpose folding of llvm gemv naive llvm doesn't care tiled llvm gemm gets promoted to eigen for transposed inputs piperorigin revid , xla gpu support for the layout of the xla client piperorigin revid
2244,include mlir pass h include mlir standardops standardops h include mlir transforms passes h include llvm support raw ostream h include llvm adt h include algorithm define debug type memref dataflow opt struct public functionpass instwalker void visitoperationinst operationinst opinst a list of memref's that are potentially dead could be eliminated std vector value value 4 static char passid void visitoperationinst operationinst opinst value cast storeop loadop getresult replacealluseswith record the memref for a later to optimize away push back loadop insert loadop loadop erase ,fix asan failure in memref dataflow opt had duplicates inserted into it switch to piperorigin revid , fix a bug in the file file in the file
2245,bool opgradientdoesntrequireoutputindices conv3dbackpropinputv2 true avgpool3d true avgpool3dgrad true maxpool3d true maxpool3d false maxpool3dgrad true maxpool3dgradgrad true biasadd true pyobject recordgradient pyobject op name pyobject inputs pyobject attrs pyobject op outputs bool op outputs tuple created false std pair bool tensorflow gtl flatset int outputs not required if opgradientdoesntrequireoutputindices c op name outputs not required if outputs not required first op outputs py none ,change the op gradient annotation for as it requires the ouput , tf data service support for tf data experimental piperorigin revid
2246,public void deallocateraw void ptr override void virtual bool shouldallocateemptytensors override final return true private eigen queueinterface device not owned tf disallow copy and assign syclallocator ,added opencl support for more operations , xla gpu support for the hlo dialect piperorigin revid change id icabdabcccecababba
2247,void parser parsedecl checkclash type base type union checkclash length base type vector checkclash length base type vector checkclash byte vector base type string checkclash bytevector base type string expect ' ' ,update for string accesses , fix a bug in the parser test piperorigin revid
2248,static void allocateflags bool setter for debugoptions set xla gpu force conv nchw flag values xla gpu force conv nchw for cudnn convolutions always nchw layouts tensorflow flag xla gpu cudnn conv blacklist path string setter for debugoptions set xla gpu cudnn conv blacklist path flag values xla gpu cudnn conv blacklist path a cudnnconvolutionlist text proto file as a blacklist of convolutions to avoid to use parseflagsfromenvanddieifunknown xla flags flag objects ,add a blacklist mechanism for avoiding listed cudnn convolutions piperorigin revid , xla python add a flag to the hlo hlo pipeline piperorigin revid change id idadedfddaccd
2249,class public void computeasync opkernelcontext c donecallback done override const tensor input c input 0 tensor output op requires ok async c c allocate output 0 input shape output done op requires ok async c c forward input or allocate output 0 0 input shape output done auto actual done c done status s op requires ok async c s done done ,share the memory between input and output tensors for op this is really to avoid when allocating a large tensor piperorigin revid , fix a bug in the new delegate piperorigin revid
2250,include unistd h include sys types h include sys ptrace h include sys syscall h include sys wait h include arch h ,add missing header for syscall , dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
2251,import numpy as np from tensorflow python framework import constant op from tensorflow python framework import dtypes from tensorflow python framework import errors impl from tensorflow python framework import test util from tensorflow python ops import array ops from tensorflow python ops import nn ops from tensorflow python platform import test test util with c api class softmaxtest test testcase def self features dim 1 log false class softmaxtest test testcase def self with self test session use placeholder to make sure we get runtime error instead of shape inference error dim array ops placeholder with default 100 shape with self assertraises errors impl invalidargumenterror nn ops softmax 1 2 3 4 dim 100 eval nn ops softmax 1 2 3 4 dim dim eval def self make sure that we properly handle large inputs see ,make softmax op test py work with c api enabled piperorigin revid , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2252,void tensor template typename t size t ndims typename ttypes t ndims tensor tensor shaped gtl arrayslice int64 new sizes checktype datatypetoenum t v check isaligned checktypeandisaligned datatypetoenum t v eigen array eigen denseindex ndims dims new sizes dims return typename ttypes t ndims tensor base t dims ,another rolling back of performance regression piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id iaaeabfdfedfeacedf
2253,string full name string key return strings strcat kfullnamerandomhex kpipe iterator key test datasetutilstest matchesanyversion expect true matchesanyversionre batchdataset batchdataset expect true matchesanyversionre batchdataset batchdatasetv2 expect true matchesanyversionre batchdataset expect false matchesanyversionre batchdataset expect false matchesanyversionre batchdataset paddedbatchdataset test datasetutilstest varianttensordatawriter writer tf assert ok writer writescalar full name int64 24 ,tf data have auto shard use regex match instead of exact match to be more robust to different versions of an op also adds test for utility function piperorigin revid change id , fix a bug in the test case piperorigin revid
2254,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 3 16 forward compatibility horizon datetime date 2020 3 17 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
2255,class tfetest test util tensorflowtestcase return math ops multiply x x grad tfe gradients function square self assertequals 6 x numpy for x in grad 3 self assertequals 6 x numpy for x in grad 3 def self class tfetest test util tensorflowtestcase grad tfe gradients function square gradgrad tfe gradients function lambda x grad x 0 self assertequals 2 x numpy for x in gradgrad 3 self assertequals 2 x numpy for x in gradgrad 3 def self class tfetest test util tensorflowtestcase return y grad fn grad tfe gradients function f self assertequals 12 x numpy for x in grad 3 self assertequals 12 x numpy for x in grad 3 def testgpu self if tfe num gpus 0 ,do not differentiate integers in the eager backprop api with bugfix piperorigin revid , tf data fix a bug in the graph piperorigin revid
2256,void expected results platform largest type test type s test data group 20 10 test function 30 10 test function finish off by printing out the compiler stdlib platform names we do this to make it easier to mark up expected error rates ,polygamma add two special cases for x and x , fix a bug in the previous commit piperorigin revid
2257,register kernel builder name spacetodepth device device gpu typeconstraint float t spacetodepthop gpudevice float register kernel builder name spacetodepth device device gpu typeconstraint eigen half t spacetodepthop gpudevice eigen half name spacetodepth device device gpu typeconstraint eigen half t spacetodepthop gpudevice eigen half register kernel builder name spacetodepth device device gpu typeconstraint qint8 t spacetodepthop gpudevice qint8 ,address eigen half eigen half signed off by yong tang yong tang github outlook com , add support for int int piperorigin revid
2258,class sharedembeddingcolumntest test testcase parameterized testcase partitioner partitioned variables fixed size partitioner 2 axis 0 with variable scope variable scope partitioner partitioner embedding column a embedding column b fc new shared embedding columns categorical column a categorical column b dimension embedding dimension initializer initializer use safe embedding lookup use safe embedding lookup embedding column a embedding column b fc new shared embedding columns categorical column a categorical column b dimension embedding dimension initializer initializer use safe embedding lookup use safe embedding lookup provide sparse input and get dense result embedding lookup a embedding column a get dense tensor lazybuilder input features ,fix for lint in feature column test piperorigin revid change id , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid change id iffafdbbcddfebbeac
2259,int temme jy t v t x t y t y1 const policy pol t gp boost math tgamma1pm1 v pol t boost math tgamma1pm1 v pol t spv sin pi v pol t sin pi v 2 pol t spv boost math sin pi v pol t boost math sin pi v 2 pol t xp pow x 2 v a log x 2 int bessel jy t v t x t j t y int kind const policy pol if reflect t z u n 2 j cos pi z pol jv sin pi z pol reflection formula y sin pi z pol jv cos pi z pol j boost math cos pi z pol jv boost math sin pi z pol reflection formula y boost math sin pi z pol jv boost math cos pi z pol else ,lots of borland specific patches quite a few of the special function tests do now do actually pass svn r , fix a bug in the previous commit piperorigin revid
2260,inline void vector emplace back std vector t vector v data template typename t using is unsigned std tr1 is unsigned t android ndk doesn't have std make unsigned or std tr1 make unsigned template typename t struct make unsigned static assert is unsigned t value specialization not static assert is unsigned t value specialization not implemented using type t template struct make unsigned char using type unsigned char template struct make unsigned int using type unsigned int template struct make unsigned short using type unsigned short template struct make unsigned int using type unsigned int template struct make unsigned long using type unsigned long template struct make unsigned long long using type unsigned long long endif flatbuffers cpp98 stl else msvc 2010 doesn't support c 11 aliases ,make changes on the make unsigned type trait fix a typo in the static assert message in make unsigned support more specifications for make unsigned , fix a bug in the parser test piperorigin revid
2261,void makeblockmap int rows int cols int depth int kernel rows ceil log2 std max lhs scalar size rhs scalar size l1 size log2 std max l1 size log2 kernel width log2 l1 size log2 std min l1 size log2 size floor log2 l1 size log2 std max l1 size log2 size floor log2 8 int num blocks base log2 size floor log2 l1 size log2 ruy dcheck ge num blocks base log2 0 ruy dcheck le num blocks base log2 8 if num blocks base log2 0 if rows kernel rows cols kernel cols num blocks base log2 1 ruy dcheck le num blocks base log2 rows log2 16 ruy dcheck le num blocks base log2 cols log2 16 int rows rounded up round up pot rows kernel rows int cols rounded up round up pot cols kernel cols ,simplify makeblockmap now that we aren't dealing with bit anymore there is still some assumption in bit operations that some fit in uint we'll clarify that and write unit tests once the current of simplification piperorigin revid , xla gpu support for the cpu backend piperorigin revid change id id iaaeabfdfedfeacedf
2262,bool isfreeofsideeffect const nodedef node bool modifiesinputsinplace const nodedef node some nodes do in place updates on regular tensor inputs string op name node op ops that modify resource variables effectively modify one of their inputs if op name assignvariableop op name assignaddvariableop op name op name resourcescatterupdate op name resourcescatteradd op name resourcescattersub op name op name op name op name return false std transform op name begin op name end op name begin tolower if str util strcontains op name inplace return true ,add support for resource variables piperorigin revid , add a test for the cost of the graph piperorigin revid
2263,limitations under the license namespace tensorflow compute padding for the given spatial dimension int convbackpropdimensions const padding padding int dim const return padding valid 0 std max int 0 static cast int output size dim 1 stride dim filter size dim 1 dilation dim 1 input size dim the v2 version computes windowed output size with arbitrary dilation rate while the original version only handles the cases where dilation rates equal to 1 ,cleanup convd backprop kernels remove redundant macros and use standard dimension parsing function piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2264,status singlemachine run const graphdef graph def return runwithtimeout feed fetch metadata status singlemachine allowsoftplacement bool soft placement state options config set allow soft placement soft placement state return status ok status singlemachine runwithtimeout const std vector std pair string tensor feed const std vector string fetch runmetadata run metadata ,added a flag to third party tensorflow core grappler clusters single machine cc that allows users' models to fall back to run cpus when there is no gpu implementation for some particular ops change , tf data service support for tf data experimental piperorigin revid
2265,static char features static int included patches add new patch number below this line 2092 ,patch problem gtk build fails with older gtk version solution check the pango version kazunobu kuriyama , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2266,bracketed paste paste mode t mode int drop garray t gap do c vgetc while c k ignore c k ver scrollbar c k hor scrollbar if c nul got int if c nul got int ex normal busy 0 c ctrl c when ctrl c was encountered the typeahead will be flushed and we won't get the end sequence won't get the end sequence except when using normal break if has mbyte ,patch invalid memory access with search command problem invalid memory access with search command solution when normal runs out of characters in bracketed paste mode break out of the loop closes , fix a bug in the new parser test for the new code svn r
2267,static char features static int included patches add new patch number below this line 543 542 ,patch vim function with varargs does not work properly problem vim function with varargs does not work properly solution improve function type spec and add tests fix bugs , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2268,int child process void int ret 0 unsigned int syscallnr unsigned int cpu unsigned int left to do default syscalls per child seed from tod int child process void if extrafork false init child while left to do 0 while 1 if biarch true retry ret mkcall syscallnr left to do never reached reenable coredumps return ret ,don't exit after syscalls just keep going we'll eventually find a reason to exit some other way ie segfault , make the watchdog process to the syscall process
2269,class svdop public xlaopkernel ctx setoutput 1 result u ctx setoutput 2 result v else ctx setoutput 1 xla scalarlike ctx input 0 0 0 ctx setoutput 2 xla scalarlike ctx input 0 0 0 ,xla's svd kernel should return outputs even when compute false this is consistent with tensorflow's implementation piperorigin revid , add a test for the new op api piperorigin revid
2270,class checkpointmanager object configure a checkpointmanager for use in directory if a checkpointmanager was previously used in directory its class checkpointmanager object self max to keep max to keep self keep checkpoint every n hours keep checkpoint every n hours self directory directory self checkpoint prefix os path join directory ckpt self checkpoint prefix os path join directory checkpoint name or ckpt recovered state get checkpoint state directory current clock time time self maybe delete collections ordereddict ,checkpoint management py custom checkpoint prefix , fix a bug in the docstring of the new api api piperorigin revid change id iacffbebafbeeadcfbaca
2271,def run and gather logs test name test args temp directory tempfile mkdtemp prefix run and gather logs mangled test name test name strip replace replace test file prefix os path join temp directory mangled test name test file prefix s test file prefix try if not tf gfile exists test executable ,modified norm benchmark to use the new benchmark api to run it now bazel run tensorflow batch norm benchmark benchmarks use gpu false true also a tiny file naming bugfix to run and gather logs lib change , fix a bug in the docstring of the docstring of the tf data strategy piperorigin revid
2272,do highlight did highlight changed true redraw all later not valid endif ifdef feat vtp control console color rgb endif ifdef feat terminal ,patch ms windows with vtp normal color not working problem ms windows with vtp normal color not working solution after changing the normal color update the vtp console color nobuhiro takasaki closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
2273,struct tensorusagerecord tensorusagerecord uint32 t size first last tensor size size first task first last task last default order of tensor usage records is increasing order of first task bool operator const tensorusagerecord other const return first task other first task information about assignment of tensors to shared objects ,add operator less to tensorusagerecord small fix in tests piperorigin revid , fix a bug in the new delegate test piperorigin revid
2274,class testclusterflr public distributedfunctionlibraryruntime public explicit testclusterflr devicemgr device mgr device mgr device mgr void instantiate const string function name const functionlibrarydefinition lib def attrslice attrs const functionlibraryruntime instantiateoptions options functionlibraryruntime localhandle handle functionlibraryruntime donecallback done override mutex lock l mu handle next handle next handle done status ok status instantiate const string function name const functionlibrarydefinition lib def attrslice attrs const functionlibraryruntime instantiateoptions options functionlibraryruntime localhandle handle override mutex lock l mu handle next handle next handle return status ok void run const functionlibraryruntime options opts ,for a multi device function instantiate its sub graphs asynchronously in large tpu pod for example x there are too many sub graphs need to be instantiated and there is not enough threads to execute them in parallel piperorigin revid change id , fix a bug in the new delegate implementation of the new delegate piperorigin revid change id idbeeaeaafcaeeaafafffe
2275,define region all 0xff word valid in all regions define string at start of vim sug file define 6 define 1 result values lower number is accepted over higher one define sp 1 define sp ,patch unused duplicate macros problem unused duplicate macros solution remove the macros , fix a bug in the new op test piperorigin revid
2276,dt probe insert dtrace hdl t dtp dt provider t prov const char prv dt probe t prp dtrace probedesc t desc if desc dt alloc dtp sizeof dtrace probedesc t null return null desc id dtrace desc prv strdup prv desc mod strdup mod desc fun strdup fun desc strdup if necessary grow the probes array if dtp dt probe id 1 dtp dt probes sz dt probe t dt probe insert dtrace hdl t dtp dt provider t prov const char prv if prp dt zalloc dtp sizeof dt probe t null return null if desc dt alloc dtp sizeof dtrace probedesc t null dt free dtp prp return null desc id dtp dt probe id desc prv strdup prv desc mod strdup mod desc fun strdup fun desc strdup prp desc desc prp prov prov ,fix a potential memory leak when a new probe is being inserted into the probes the desc allocation may succeed while the dt probe t allocation fails that would leak the memory taken up by desc signed off by kris van hees kris van hees oracle com , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
2277,def clean tag name take advantage of the tf name scope system but risks breaking existing usage because a much smaller set of characters are allowed in node names this function replaces all illegal characters with s and logs a warning it also strips leading slashes from the name if name is not none new name invalid tag characters sub ' ' name new name new name lstrip ' ' remove leading slashes if new name name logging warning 'summary tag name s has illegal chars replacing with underscores ' name logging info 'summary name s is illegal using s instead ' name new name name new name return name ,tf summary ops remove leading slashes from their names this ensures easier conversion to the new ops as some clients construct tag names with leading forward slashes change , update version of the documentation of the new version of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value piperorigin revid
2278,class devicespec object return devicespec parse from string spec for backwards compatibility todo rjryan fix all callers then remove device devicespec from string devicespec from string def check valid spec check that a device spec is valid ,remove legacy for device from string and device device change , fix a bug in the docstring of the test piperorigin revid
2279,def main if the file does not exist the action will crash attempting to upload it the dry run needs this file because it is set to upload a test case both on successful runs and on failures out dir os path join workspace 'out' out dir os path join workspace 'out' 'bug report' os makedirs out dir exist ok true file handle open os path join out dir 'testcase' 'w' file handle write 'no bugs detected ' file handle close sets the default return code on error to success error code 0 ,cifuzz add parse fuzzer output functionality , fix a bug in the docstring of the new module piperorigin revid
2280,class strategyextendedv2 object subclasses should override this to provide whether the strategy is currently in multi worker setup experimental signature and implementation are subject to change raise notimplementederror must be implemented in descendants ,update of in multi worker mode docstring piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
2281,define boost math airy hpp include limits include boost math special functions math fwd hpp include boost math special functions bessel hpp include boost math special functions cbrt hpp include boost math special functions detail airy ai bi zero hpp ,make sure the forward declarations get included before the real definitions in all headers , fix a bug in the new parser test svn r
2282,graphtransferutils gettopnfloatresults const float const data static graphdef graphtransferutils buildfusedgraphdef const igraphtransferopsdefinitions ops definitions const string remote graph execute name const std vector graphtransferer inputnodeinfo inputs const std vector string outputs const graphdef def graphtransferer const gt check gt nullptr std vector tensorflow tensor output tensors status status gt def inputs outputs false initialize by zero output tensors graphtransferer output tensor info status status gt def inputs false initialize by zero output tensor info check status ok status gt loadgraphfromproto ops definitions def inputs outputs output tensor info output tensor map scope root scope newrootscope std vector output output list ,add a test to run inception inference on hexagon using remote fused graph execute op with tf runtime change , xla python add a test for the xla client piperorigin revid
2283,public struct monsterextra iflatbufferobject float f3 single vectoroffset default vectoroffset vectoroffset default vectoroffset builder starttable 10 builder starttable 11 monsterextra builder d3 monsterextra builder d2 monsterextra builder d1 public struct monsterextra iflatbufferobject return monsterextra builder public static void flatbufferbuilder builder builder starttable 10 public static void flatbufferbuilder builder builder starttable 11 public static void flatbufferbuilder builder double d0 builder 0 d0 double nan public static void flatbufferbuilder builder double d1 builder 1 d1 double nan public static void flatbufferbuilder builder double d2 builder 2 d2 double ,dart fix deprecated field support inf nan fix deprecated field support inf nan unused params rerun tests , fix a bug in the parser test piperorigin revid
2284,func value string returns the permuted vector tensor in the destination data format given the permute input tensor from src format to dst format one in the source data format input tensor must be a vector of size 4 or a tensor for example with src format of nhwc dst format of nchw and inputs 1 2 3 4 and 1 2 3 4 5 6 7 8 the outputs will be respectively 1 4 2 3 and 1 4 2 3 5 8 6 7 arguments x vector of size 4 or tensor of shape 4 2 in source data format ,go update generated wrapper functions for tensorflow ops piperorigin revid change id , fix a bug in the test case piperorigin revid
2285,class baseestimator sklearn baseestimator evaluable evaluable chief only hooks chief hooks model fn ops training chief hooks save checkpoint secs 0 saving is handled by a hook save summaries steps self config save summary steps max wait secs self config session creation timeout secs config self session config as mon sess loss none while not mon sess should stop ,expose session creation timeout secs in estimator runconfig piperorigin revid , tfgan fix a typo in docstring piperorigin revid
2286,class mastertest public testing test options config mutable device count gpu 0 tf check ok test testcluster maketestcluster options 2 cluster sharedgrpcchannelptr channel ptr tf check ok newhostportgrpcchannel cluster targets 0 channel ptr tf check ok newhostportgrpcchannel cluster targets 0 options config rpc options channel ptr master grpc masterservice newstub channel ptr ,fix the call to newhostportgrpcchannel in distributed runtime master test piperorigin revid , fix a bug in the test piperorigin revid
2287,class filllowertriangulartest tf test testcase def self with self test session x np arange 9 x tf convert to tensor np arange 9 dtype np float32 expected np array 0 0 0 1 2 0 class filllowertriangulartest tf test testcase actual distribution util fill lower triangular x self assertallequal expected shape actual get shape self assertallequal expected actual eval self assertallequal np concatenate np ones 6 dtype np float32 np zeros 3 dtype np float32 tf gradients distribution util fill lower triangular x x 0 eval def self with self test session ,support automatic differentiation in fill lower triangular when input has no batch dims change , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid change id iffafdbbcddfebbeac
2288,void expected results platform largest type test type s negative test data group 4000 1000 test function 800 400 test function if std numeric limits long double digits std numeric limits double digits std numeric limits long double digits std numeric limits double digits 20 ,polygamma change low order negative x cases to use new polynomial method change expected error rates to match , fix a bug in the previous commit piperorigin revid
2289,limitations under the license include tensorflow compiler mlir lite flatbuffer operator h include tensorflow compiler mlir lite ir tfl ops h include tensorflow compiler mlir lite utils convert type h include tensorflow compiler mlir tensorflow ir tf ops h include tensorflow compiler mlir tensorflow ir tf types h include tensorflow compiler mlir tensorflow utils mangling util h include tensorflow compiler xla statusor h ,split tflite mlir importer and exporter into separate libraries piperorigin revid change id , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
2290,class tensorhandle public core refcounted device deviceorhostcpu eagercontext ctx const status shape tensorflow tensorshape shape status numdims int num dims status dim int dim index int64 dim status numelements int64 num elements status numdims int num dims const status dim int dim index int64 dim const status numelements int64 num elements const if defined is mobile platform bool device d class tensorhandle public core refcounted if the contents of the tensor pointed to by this handle is yet to be computed by a eagernode this function will block till that computation is done and the handle is ready status waitready const char caller status waitready const char caller const todo b 136608821 device nullptr iff host cpu 0 this was expedient but perhaps worth revisiting 'device ' should always ,mark certain methods as const piperorigin revid change id , tf data service support for tf data experimental piperorigin revid
2291,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 10 27 forward compatibility horizon datetime date 2020 10 28 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
2292,namespace tflite namespace flex namespace using testing containsregex using testing elementsare class delegatetest public testing ,clean some dead code and unused calls piperorigin revid , fix a bug in the new delegate piperorigin revid change id ibebfcffdcbdbdafeb
2293,import numpy as np from tensorflow contrib distributions python ops bijectors affine import affine from tensorflow python framework import dtypes from tensorflow python framework import errors from tensorflow python ops import array ops from tensorflow python platform import test class affinebijectortest test testcase def testnobatchmultivariateraiseswhensingular self with self cached session mu 1 1 with self assertraisesregexp errors invalidargumenterror diagonal part must be non zero affine shift mu has zero on the diagonal scale diag 0 1 validate args true error detected statically don't need to run the op bijector affine shift mu has zero on the diagonal scale diag 0 1 validate args true with self assertraisesoperror diagonal part must be non zero bijector forward 1 1 eval def makescale self x ,automated rollback of commit revert piperorigin revid , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2294,static funcentry t global functions getjumplist 0 2 fearg 1 ret list any f getjumplist getline 1 2 fearg 1 ret f getline f getline getloclist 1 2 0 ret list dict any f getloclist 0 1 0 ret list dict any f getmatches 0 1 0 ret list dict any f getmatches getmousepos 0 0 0 ret dict number f getmousepos getpid 0 0 0 ret number f getpid ,patch cannot easily get all the current marks problem cannot easily get all the current marks solution add yegappan lakshmanan closes , patch problem when using a terminal window is a bit slow solution add a test for the test
2295,class mlircontext class identifier public return an identifier for the specified string static identifier get stringref str const mlircontext context static identifier get stringref str mlircontext context identifier const identifier default identifier operator const identifier other default ,ify mlircontext and some stuff now that const is gone piperorigin revid , xla gpu support for the xla client piperorigin revid change id idaceccfcbacfece
2296,namespace flatbuffers summary all structs in the generated code derive from this class and add their own accessors summary internal struct struct public struct struct public int bb pos get private set public bytebuffer bb get private set ,set c struct table visibility to public , fix a bug in the parser test piperorigin revid
2297,def normalize tensor returns normalized a normalized tensor with the same shape as tensor norm the computed norms with the same shape as tensor but the final axis is 1 instead same as running tf linalg norm tensor ord axis keepdims true norm the computed norms with the same shape and dtype tensor but the final axis is 1 instead same as running tf cast tf linalg norm tensor ord axis keepdims true tensor dtype raises valueerror if ord or axis is invalid def normalize tensor with ops name scope name normalize tensor as name tensor ops convert to tensor tensor norm linalg ops norm tensor ord axis keepdims true norm math ops cast norm tensor dtype normalized tensor norm return normalized norm ,cast norm to same dtype as tensor , fix a bug in the docstring of the test case piperorigin revid
2298,struct typeattrid string attr name if attr name is a list type this is the index into the list otherwise this is ksingletype int type index datatype fixed type ,add comment describing type index , fix a bug in the test case piperorigin revid
2299,status hosttracer start if recording return errors internal tracemerecorder already started all traceme captured should have a timestamp greater or equal to start timestamp ns to prevent timestamp underflow in xplane therefore this have to be done before tracemerecorder start start timestamp ns envtime nownanos recording tracemerecorder start host trace level if recording return errors internal failed to start tracemerecorder start timestamp ns envtime nownanos return status ok ,race condition exists between start tracemerecorder and capture start wall time make sure start timestamp ns is smaller than any traceme events also drop any events that is not for the of mind piperorigin revid change id , fix a bug in the graph piperorigin revid
2300,void initkerneltest int argc char argv in android q the nnapi delegate avoids delegation if the only device is the reference cpu however for testing purposes we still want delegation coverage so force use of this reference path const auto opt name nnapi accelerator name std string accelerator name delegate providers constparams get std string opt name delegate providers mutableparams set std string nnapi accelerator name nnapi reference opt name accelerator name empty nnapi reference accelerator name c str ,make nnapi accelerator name work in kernel test , fix a bug in the new delegate test piperorigin revid
2301,typedef struct rtl critical section gtest critical section elif defined msc ver msc ver 1910 prevent warning c4996 'std tr1' warning stl4002 the non standard std tr1 namespace and tr1 only machinery are deprecated and will be removed define gtest has tr1 tuple 0 elif defined libcpp version libc doesn't support tr1 define gtest has tr1 tuple 0 else the user didn't tell us not to do it so we assume it's ok define gtest has tr1 tuple 1 ,testing gtest port h merge , fix a bug in the parser test piperorigin revid
2302,f count typval t argvars typval t rettv interror false if argvars 2 v type var unknown ic int tv get number chk argvars 2 error ic int tv get bool chk argvars 2 error if argvars 0 v type var string ,patch vim count third argument cannot be true problem vim count third argument cannot be true solution use tv get bool chk closes , patch problem when using a channel to be a bit a bit solution add a test for the test
2303,bool model model operator op bool model model operator op for const auto output op outputs if model getarray output minmax log warning skipping min max setting for logname op because output output already has min max return false data is in second input auto input array model getarray op inputs 1 if input array minmax return false else for const auto output op outputs auto array model getarray output bool changed false for const auto output op outputs auto array model getarray output if array minmax array getminmax input array getminmax changed true array getorcreateminmax input array minmax return true return changed the output of average or max pooling is within the same range as its input ,more un fused quantized lstm support in tflite interpreter piperorigin revid , fix a bug in the graph mode piperorigin revid
2304,limitations under the license include tensorflow lite c common h include tensorflow lite core api flatbuffer conversions h include tensorflow lite core api tensor utils h include tensorflow lite micro compatibility h include tensorflow lite micro micro optional debug tools h tflitetensor microinterpreter tensor size t index return context tensors index tflitestatus microinterpreter resetvariabletensors const size t length tensors size for size t i 0 i length i tflitetensor cur tensor tensor i if cur tensor is variable tflitestatus status tflite resetvariabletensor cur tensor if status ktfliteok error reporter report failed to reset variable tensor at index d i return status return ktfliteok namespace tflite ,add resetvariabletensors api to the tflite micro interpreter match existing functionality of the tflite runtime piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2305,class fullyconnectedtest tf test testcase create summaries false self assertequals tf get collection tf graphkeys summaries verify fix of a bug where no summaries activation fn none led to a nonetype exception def test no summaries no activation self tf learn fully connected self input 2 activation fn none create summaries false self assertequals tf get collection tf graphkeys summaries def test regularizer self cnt 0 tensor tf constant 5 0 ,fix bug in fully connected layer previously if activation fn was set to its default none and create summaries was false fully connected would incorrectly give an error i have fixed this as well as changing the default to tf identity change , fix a bug in the test case piperorigin revid
2306,class statelessrandomopstest xla test xlatestcase shape n seed seed t dtype dtype y sess run x seed t 0x12345678 0xabcdef12 random test util test truncated normal self assertequal self assertallclose dtype n y self assertequal self assertallclose n y variance rtol 6e 3 if dtype dtypes bfloat16 else 1e 3 if name ' main ' ,fixed compiler tests stateful random ops test for f made the test more parallel and faster and removed run v only so the test can be picked up by tap piperorigin revid , fix a bug in the graph piperorigin revid
2307,file permissions hpp author li author andrey semashev date 14 10 2015 the header contains an abstraction wrapper for security permissions ,extracted open mode and permissions to separate headers , patch problem when using a terminal window is a bit solution add a few more tests to the new code
2308,eagercontext eagercontext const sessionoptions opts eagercontext eagercontext const sessionoptions opts contextdeviceplacementpolicy default policy bool async devicemgr local device mgr rendezvous rendezvous std unique ptr grpcserver server std unique ptr serverinterface server std unique ptr eager eagerclientcache remote eager workers std unique ptr devicemgr remote device manager const gtl flatmap string uint64 remote contexts eagercontext eagercontext if server todo nareshmodi fix this log warning unable to destroy server object so releasing instead grpcserver doesn't support clean shutdown servers don't support clean shutdown server release ,allow setting server def on the eager context and add the eager service to the grpc tensorflow server piperorigin revid , tf data service support for tf data experimental piperorigin revid
2309,class run model inference with float input output type output data run tflite inference model tf float32 tf float32 run model inference with modified integer input output type model io util modify integer quantized model io type model in tftype out tftype model io util modify model io type model in tftype out tftype output io data run tflite inference model io in tftype out tftype validate that both the outputs are the same ,made modification of the the model input and output independent of each other piperorigin revid change id , fix a bug in the docstring of the test piperorigin revid
2310,class ftrl optimizer v2 optimizerv2 self serialize hyperparameter 'l2 regularization strength' 'l2 shrinkage regularization strength' self l2 shrinkage regularization strength 'beta' 0 0 return config ,temporary change added default value for beta parameter to allow it to be used in estimator tests piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
2311,static void check children void static void kill all kids void shm spawn no more true wait for all the children to exit while shm running childs 0 unsigned int i ,fix race at shutdown where we could spawn a new child as the watchdog exited , fix a bug in the watchdog page
2312,enum passes constantfold memrefboundcheck loopfusion loopunroll static cl list passes passlist convert all ml functions in the module to cfg ones memrefboundcheck memref bound check convert all ml functions in the module to cfg ones memref dependence check checks between all pairs of memref accesses loopfusion loop fusion fuse loop nests loopunroll loop unroll unroll loops loop unroll unroll and loops static optresult performactions sourcemgr sourcemgr mlircontext context case memrefboundcheck pass creatememrefboundcheckpass break case pass break case loopfusion pass break ,adds analysis pass plus multiple dependence check tests adds equality constraints to dependence constraint system for accesses using dims symbols where the defining operation of the dim symbol is a constant piperorigin revid , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
2313,void argconverter remap each of the original arguments as determined by the signature conversion auto block opbuilder guard rewriter rewriter setinsertionpointtostart block for unsigned i 0 i i arrayref value ,guard rewriter insertion point during signature conversion avoid unexpected side effect in rewriter insertion point piperorigin revid , fix a bug in the new overview class piperorigin revid change id iaaeaebbe
2314,limitations under the license namespace tensorflow namespace tpu std shared ptr grpc channelcredentials return grpc insecurechannelcredentials return grpc insecurechannelcredentials nolint if defined libtftpu ,tpu internal code update piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2315,class directsession public session initializes the base execution state given the 'graph' if not already initialized void maybeinitializeexecutionstate const graphdef graph void maybeinitializeexecutionstate const graphdef graph exclusive locks required graph def lock retrieves an already existing set of executors to run 'inputs' and 'outputs' or creates and caches them for future use class directsession public session std unordered map string string stateful guarded by mu execution state used when placing the entire graph std unique ptr simplegraphexecutionstate execution state std unique ptr simplegraphexecutionstate execution state guarded by graph def lock std unique ptr functionlibrarydefinition flib def for generating unique names ,fixes a bug in the locking in directsession the execution state member should be protected by graph def lock because it can be replaced at the same times that the graph def is mutated change , tf data service support for tf data service piperorigin revid change id ibccfdcbcfbfdddfdcbfb
2316,class alphanum piece digits floattobuffer f digits alphanum double f nolint runtime explicit piece digits f digits alphanum bfloat16 bf nolint runtime explicit piece digits floattobuffer static cast float bf digits alphanum hex hex nolint runtime explicit ,add explicit support for bfloat in tensorflow core platform strcat h piperorigin revid change id , xla python fix a bug in the xla client client piperorigin revid
2317,class modelcheckpoint callback arguments filepath string or pathlike path to save the model file filepath can contain named formatting options which will be filled the value of epoch and keys in logs passed in on epoch end for example if filepath is weights epoch val loss 2f hdf5 then the model checkpoints will be saved with the epoch number and the validation loss in the filename filepath string or pathlike path to save the model file filepath can contain named formatting options which will be filled the value of epoch and keys in logs passed in on epoch end for example if filepath is weights epoch val loss 2f hdf5 then the model checkpoints will be saved with the epoch number and the validation loss in the filename monitor quantity to monitor verbose verbosity mode 0 or 1 save best only if save best only true the latest best model according ,fixed line lengths and removed unused import , fix a bug in the docstring of the docstring of the docstring change
2318,status trtcandidateselector istensorrtcandidate const tensorflow node node fusedbatchnorm fusedbatchnormv2 identity leakyrelu log matmul max ,leaky relu unit tests , add support for the input op for the input piperorigin revid
2319,def save obj export dir signatures none options none note that this needs to be the last file operation when saving the savedmodel users rely on checking saved model dir saved model pb as an indication that the savedmodel is completely written if context executing eagerly context async wait ensure save operations have completed path os path join compat as str export dir compat as str constants saved model filename pb ,saved model block waiting for checkpoint save operations to complete before writing saved model pb ensures that there's a way to check for a complete savedmodel even when running async eager piperorigin revid change id , update docstring for dask
2320,include fcntl h include signal h include random h include sanitise h include shm h void sanitise fcntl int childno case f setsig shm a3 childno unsigned long rand32 if shm a3 childno sigint shm a3 childno 0 restore default sigio break case f notify ,sanitise f argument to avoid sigint it's possible to send ourselves a sigint using f this is then interpreted as a ctrl c from the user and trinity quits avoid sigint instead use which switches back to the default behaviour of sending , move the dtrace proto to the dtrace provider
2321,write viminfo marks file fp out ifdef feat jumplist positions are stored oldest first for i 0 i buf b i write one mark fp out ' ' buf b i skip duplicates if i 0 equalpos buf b i 1 buf b i write one mark fp out ' ' buf b i endif for i 0 i nmarks i write one mark fp out 'a' i buf b namedm i ,patch problem viminfo file contains duplicate change marks solution drop duplicate marks , patch problem when using a terminal window is a bit slow solution add a test for the gui
2322,test gtestcheckdeathtest dieswithcorrectoutputonfailure const char regex ifdef msc ver gtest port test cc d else elif gtest uses posix re gtest port test cc 0 9 else gtest port test cc d endif msc ver a false condition extra info ,fixes gtest port test on mingw , xla python fix a bug in the client client piperorigin revid change id icccbcbdbcfaadbee
2323,static char features static int included patches add new patch number below this line 1921 1920 ,patch fuzzy matching does not recognize path separators problem fuzzy matching does not recognize path separators solution add a bonus for slash and backslash yegappan lakshmanan closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2324,fix help buffer void copy option part p namebuff maxpathl mustfree false rt vim getenv char u vimruntime mustfree if fullpathcmp rt namebuff false fpc same if rt null fullpathcmp rt namebuff false fpc same char u fnames ,patch warning for possibly using null pointer problem warning for possibly using null pointer coverity solution skip using the pointer if it's null , patch problem when using a terminal window is a bit slow solution add a test for the gui
2325,class feature enum enum return tuple set cls all set exclude cls all standard options none forward definition class conversionoptions object if self standard options return parser parse expression 'ag std' template programcontext keeps track of converting function hierarchies ,use a constant for common conversion options to make the generated code less verbose piperorigin revid , fix a bug in the documentation of the new op test piperorigin revid
2326,class mklmatmulop public opkernel floattobfloat16 c float flat float data c c float numelements mkldnn only supports sgemm mkl dnn only supports sgemm and bfloat16 gemm ifndef intel mkl dnn only matrix matrix multiplication with tensors for detailed info about ,update tensorflow core kernels mkl matmul op cc co authored by penporn koanantakool penpornk users noreply github com , fix a bug in the test case piperorigin revid
2327,test benchmarkmodeltest initializeandrun writestringtofile env default filename pb graph def serialized std unique ptr session session std unique ptr graphdef loaded graph def tf assert ok benchmark model initializesession 1 filename pb session loaded graph def std unique ptr statsummarizer stats tf assert ok benchmark model initializesession 1 filename pb session stats stats reset new tensorflow statsummarizer loaded graph def get tf assert ok benchmark model timemultipleruns 0 0 10 input output name session get stats get ,add more display options to benchmark including flops change , tf data service support for tf data dataset piperorigin revid
2328,import org junit runners junit4 public final class interpretertest private static final file model file new file third party tensorflow contrib lite java src testdata add bin new file tensorflow contrib lite java src testdata add bin private static final file mobilenet model file new file third party tensorflow contrib lite java src testdata mobilenet tflite bin new file tensorflow contrib lite java src testdata mobilenet tflite bin test public void throws exception ,update remote tflite mobilenet dependency path piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2329,retnomove if row 0 col 0 check if it makes sense return in unknown find the window where the row is in find the window where the row is in and adjust row and col to be relative to top left of the window wp mouse find win row col find popup if wp null return in unknown retnomove on sep line 0 in popup win true if wp w popup close popclose button which button mouse left popup on x button wp row col if which button mouse left popup close if on x wp row col popup close for mouse click wp return in unknown else if wp w popup flags popf drag popf resize ,patch cannot always close a popup when filter consumes all events problem cannot close a popup by the x when a filter consumes all events solution check for a click on the close button before invoking filters closes , patch problem when using a terminal window is a bit slow solution add a test for the cursor
2330,class tfapichangespec ast edits apichangespec important order here should correspond to old argument order we just prepend arg name to all arguments in function calls self function reorders tf io serialize sparse sp input name out type tf io serialize many sparse sp input name out type tf argmax input axis name dimension output type tf argmin input axis name dimension output type tf batch to space input crops block size name ,change api for io serialize sparse and io serialize many sparse for tf piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2331,def map structure with atomic is atomic fn map fn nested raise valueerror 'received non atomic and non sequence element ' format nested if nest is mapping nested values nested k for k in nest sorted nested values nested k for k in sorted nested keys elif nest is attrs nested values astuple nested else ,expose nest related function to tf internal api piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring of the tf nn rnn api piperorigin revid
2332,def check dense labels match logits and reshape 'expected labels dimension s received s ' 'suggested fix ' 'if your classifier expects one hot encoding label ' 'check your n classes argument to the estimator' 'and or the shape of your label ' 'check your n classes argument to the estimator ' 'and or the shape of your label ' 'otherwise check the shape of your label ' expected labels dimension dim1 expected labels shape array ops concat ,fix typo missing ' ' in error message piperorigin revid , fix a bug in the docstring of the docstring of the documentation of the docstring change
2333,memory region name name of readonly memory region used by the tensor see newreadonlymemoryregionfromfile in tensorflow env doc register op guaranteeconst input input t output output t attr t type setshapefn shape inference inferencecontext c return unchangedshape c we don't want this to be optimized away setisstateful doc r gives a guarantee to the tf runtime that the input tensor is a constant the runtime is then free to make optimizations based on this only accepts value typed tensors as inputs and rejects resource variable handles as input returns the input tensor without modification register op zeroslike input x t ,adds a acts as indicator for the tf runtime to make possible optimizations by treating the input tensor as a constant piperorigin revid , fix a bug in the test case piperorigin revid
2334,f search typval t argvars typval t rettv static void f typval t argvars typval t rettv intlocally 1 intthisblock 0 intlocally true intthisblock false interror false char u name f typval t argvars typval t rettv name tv get string chk argvars 0 if argvars 1 v type var unknown locally int tv get number chk argvars 1 error 0 locally int tv get bool chk argvars 1 error if error argvars 2 v type var unknown int tv get number chk argvars 2 error 0 int tv get bool chk argvars 2 error if error name null rettv vval v number find decl name int strlen name ,patch vim cannot pass true to problem vim cannot pass true to solution use tv get bool chk closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
2335,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 10 18 forward compatibility horizon datetime date 2020 10 19 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
2336,void setup fds void static int get random fd void unsigned int i unsigned int fd 0 int fd 0 if do specific proto 1 i 1 static int get random fd void switch i case 0 retry fd shm fds rand fd idx retry if we hit stdin stdout logfile if fd shm fds 0 retry if we hit stdin stdout logfiles if fd fileno shm logfiles shm nr childs goto retry break ,avoid handing out the logfile fd's , make the syscall page we can be a child process
2337,include gmock gmock h include gtest gtest h ifdef arduino void setup int argc 0 char argv nullptr since google mock depends on google test initgooglemock is also responsible for initializing google test therefore there's no need for calling testing initgoogletest separately testing initgooglemock argc argv void loop run all tests else ms c compiler linker has a bug on windows not on windows ce which causes a link error when tmain is defined in a static library and unicode is enabled for this reason instead of tmain main function is used on gtest api int main int argc char argv testing initgooglemock argc argv return run all tests endif ,feat add initial support for platformio and arduino , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
2338,find word under cursor int get beval info ballooneval beval win t winp linenr t lnump char u textp int colp ballooneval beval win t winp linenr t lnump char u textp int colp introw col introw mouse row intcol mouse col ifdef feat beval term ifdef feat gui if gui in use endif row mouse row col mouse col endif ifdef feat gui if gui in use ,patch warning for using uninitialized variable problem warning for using uninitialized variable tony mechelynck solution simplify the code by always using the mouse coordinates , patch problem when using a terminal window doesn't work solution add a test for the gui
2339,status unknownshape shape inference inferencecontext c shape function for reduction operations status reductionshape shape inference inferencecontext c shape function for unsorted segment operations status inferencecontext c shape function for concat operations num inputs to concat is the number of inputs to concatenate and are taken from inputs ,added new op tf strings unsorted segment join piperorigin revid , add a test for the graph and the graph piperorigin revid
2340,static bool generate sockets void continue triplets proto valid privileged triplets for j 0 j proto nr triplets j for j 0 j proto nr privileged triplets j generate socket triplets j family triplets j protocol triplets j type ,use correct loop boundary for privileged sockets , fix a bug in the watchdog process
2341,static char features static int included patches add new patch number below this line ,patch problem a font that uses messes up the screen display solution put spaces between characters when building the table based on a patch from manuel schiller , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2342,class bytebuffer public function putint offset value self php int max php int max value int 2147483647 1 31 1 maximum signed 32 bit int 2147483648 1 31 minimum signed 32 bit int self 2147483648 2147483647 value int this assertoffsetandlength offset 4 this offset 4 value class bytebuffer public function offset value note we can't put big integer value this is php limitation self 0 php int max value uint php has big numbers limitation check your php int max 1 32 1 maximum unsigned 32 bin int self 0 value uint php has big numbers limitation check your php int max this assertoffsetandlength offset 4 this offset 4 value ,correct the max min signed unsigned bit int the test was trying to pack an unsigned int which couldn't fit as a signed int and wasn't doing the validation in the correct range , fix a bug in the new delegate test piperorigin revid
2343,limitations under the license include tensorflow c kernels h include tensorflow c tf tensor h include tensorflow c tensor shape utils h include tensorflow c kernels tensor shape utils h include tensorflow core framework selective registration h include tensorflow core framework summary pb h include tensorflow core framework types h static void scalarsummaryop compute void kernel tf opkernelcontext ctx if issamesize params tags params values std ostringstream err err tags and values not the same shape tf shapedebugstring params tags tf shapedebugstring params values shapedebugstring params tags shapedebugstring params values singletag params tags tf setstatus params status tf invalid argument err str c str ,moved tf shape utils under kernels , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2344,class layer return dict list base config items list config items keras export 'keras layers experimental preprocessing class layer randomly zoom each image during training ,remove layer from api piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
2345,def try handling state modified false if not os getenv 'autograph create symbols in loops' '' todo mdan remove once the default option is stable if os getenv 'autograph create symbols in loops' '1' '0' verify loop init vars init vars symbol names return false init vars ,enable creating variables in loops piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring change
2346,def main sys exit 1 opts options with tf graph as default tf session as session model word2vec opts session with tf device cpu 0 model word2vec opts session for in xrange opts epochs to train model train process one epoch model eval eval analogies ,tensorflow fix wordvec timeouts on gpu by pinning model on cpu right now wordvec is not well supported on gpu missing scatter sub etc we can remove this limitation later when and other ops are all available on gpu , fix a bug in the documentation of the new module piperorigin revid
2347,std string getnamefromloc location loc if name empty names is nonempty true continue else if auto call loc curr loc dyn cast callsiteloc add name if callee has a nameloc as should be the case if imported with debuginfo if auto name loc call loc getcallee dyn cast nameloc auto name name loc getname strref split ' ' first loc names push back name if name empty names is nonempty true continue use location of the callee to generate the name locs push back call loc getcallee continue else if auto fused loc curr loc dyn cast fusedloc push all locations in fusedloc in reverse order so locations are visited based on order in fusedloc ,support nested when generating names from location piperorigin revid change id , xla gpu support for the layout of the xla client piperorigin revid
2348,limitations under the license define mm load pd1 mm load1 pd only define these intrinsics if imminitrin h by intel wasn't included ifndef included imm only define these intrinsics if immintrin h doesn't have them and earlier if msc ver 1910 static inline int mm256 extract epi32 m256i a const int i ,change condition for intrinsics definition , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2349,register kernel builder name depthwiseconv2dnative in depth depth multiplier stride stride pad rows pad rows pad cols pad cols output batch out rows out cols out depth endl out depth kernels to compute the input backprop for depthwise convolution template typename device typename t ,remove endl which broke oss change , fix a bug in the test case piperorigin revid
2350,class typeinforesolver transformer base arg name str qn self scope setval qn arg node if len self enclosing entities 1 and arg name in self entity info arg types arg name in self transformer ctx entity info arg types forge a node to hold the type information so that method calls on it can resolve the type type string type obj self entity info arg types arg name type string type obj self transformer ctx entity info arg types arg name anno setanno arg node 'type' type obj anno setanno arg node 'type fqn' tuple type string split ' ' ,adding transformer to wrap the immutable entitycontext and track the current so that we can move error autographparseerror handling to api to graph removing the finally block in visit in transformer base error handling piperorigin revid , fix a bug in the test case piperorigin revid
2351,from tensorflow python distribute import distribution strategy context from tensorflow python distribute import parameter server strategy from tensorflow python eager import context from tensorflow python eager import def function from tensorflow python framework import composite tensor utils from tensorflow python framework import constant op from tensorflow python framework import ops from tensorflow python framework import sparse tensor class model training lib model users should explicitly add composite tensor inputs to their subclassed models for input tensor in processed inputs if composite tensor utils is composite or composite value input tensor if training utils v1 is composite or composite value input tensor todo b 132691975 document subclass model ct input handling raise valueerror 'all sparsetensor and raggedtensor inputs must be explicitly ' ,fork is composite or value into keras to split a dependency on private symbols piperorigin revid change id , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2352,absl optional complex128 literalbase return get complex64 multi index case c128 return get complex128 multi index case s8 return get int8 multi index default return absl nullopt ,move changes from phase of xla int convolution on cuda to this pr , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2353,gcc host compiler path ' usr bin gcc' nvcc path ' usr local cuda 10 0 bin nvcc' nvcc version '10 0' nvcc temp dir c windows temp nvcc inter files tmp dir supported cuda compute capabilities 3 0 supported cuda compute capabilities 3 0 6 0 def log s print 'gpus crosstool 0 ' format s def invokenvcc argv log false the return value of calling os system ' args src files f for f in argv if re search r' cpp cc c cxx c ' f src files f for f in argv if re search ' cpp cc c cxx c ' f if len src files 0 raise error 'no source files found for cuda compilation ' ,add pascal support to reduce test runtime on p piperorigin revid , xla python fix a bug in the hlo module piperorigin revid change id iffdbcededbfbdfcfb
2354,copyright c 2016 2018 oracle and or its affiliates all rights reserved copyright c 2016 2019 oracle and or its affiliates all rights reserved portions copyright 2007 2015 anthony tuininga all rights reserved def callback message print 60 print 60 connection cx oracle connect sampleenv main connect string events true connection cx oracle connect sampleenv getmainconnectstring events true sub connection subscribe callback callback timeout 1800 qos cx oracle subscr qos query cx oracle subscr qos rowids print subscription sub ,reworked samples so that no default passwords are defined anywhere added python script to create sample schemas and drop them in addition to having a sql plus script , fix a bug in the new module of the new module of the dtrace hdl is not used by the dtrace dtrace is not used in the dtrace process and the dtrace is not used in the dtrace process and the dtrace is not used in the dtrace dtrace and dtrace dt dt
2355,class lossscaleoptimizer delegatingtrackablemixin optimizer v2 optimizerv2 for g in grads def compute gradients self loss var list grad loss none def compute gradients self loss var list grad loss none tape none loss self get scaled loss loss grads and vars self optimizer compute gradients loss var list pylint disable protected access grad loss ,allow loss to be passed as a tensor to optimizer minimize piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
2356,void model recordelement const string name int64 model numelements const string name tf shared lock l mu auto node gtl findornull lookup table name if node return node num elements return 0 void model recordstart const string name bool stop output tf shared lock l mu auto node gtl findornull lookup table name ,data stats adding support for making stats aggregator tf compatible for remaining dataset transformations piperorigin revid , fix a bug in the graph optimizer piperorigin revid
2357,limitations under the license include tensorflow lite kernels internal reference integer ops log softmax h include tensorflow lite kernels internal reference integer ops logistic h include tensorflow lite kernels internal reference integer ops tanh h include tensorflow lite kernels internal reference logistic h include tensorflow lite kernels internal reference reference ops h include tensorflow lite kernels internal tensor h include tensorflow lite kernels internal types h ,tfl move sigmoid implementation to a standalone file so that we can have minimal dependencies when adding the support in tflm piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2358,from setuptools dist import distribution this version string is semver compatible but incompatible with pip for pip we will remove all ' ' characters from this string and use the result for pip version '1 5 0 rc0' version '1 5 0 rc1' required packages 'absl py 0 1 6' ,update version strings and revert xml changes , fix a bug in the documentation of the new version of the client client client piperorigin revid
2359,expr mlir edsc op operator expr expr auto attr integerattr get thistype 1 auto identifier get value context auto namedattribute attr auto constant thistype auto std constant thistype emulate negation as 1 x i1 return expr ,set the namespace of the standardops dialect to std but add a special case to the parser to allow parsing standard operations without the std prefix this will now allow for the standard dialect to be looked up dynamically by name piperorigin revid , xla gpu support for the layout of the layout is a bit piperorigin revid
2360,namespace boost private data getter function return m l parameter estimation static realtype estimate mean realtype n realtype k vector array k todo private data member initialized by constructor realtype m l mean number of occurrences ,updated include tests to instantiate the respective code fixed any errors that up and suppressed rather a lot of warnings updated docs as well svn r , fix a bug in the new parser test piperorigin revid
2361,gui update cursor if id 0 cattr syn id2colors id cfg cbg if defined feat mbyte defined feat hangulin if defined feat xim defined feat hangulin static int iid guicolor t fg bg ,patch cannot build with gtk but without xim problem cannot build with gtk but without xim solution adjust ifdef closes , patch problem when using a terminal window is a bit solution add a few more tests to the new code
2362,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 11 12 forward compatibility horizon datetime date 2020 11 13 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
2363,def assign renamed collections handler info elem elem elem the transformed element contains information about the result of a transform operation ,create a copy of the collections items before doing iteration that could add to that dict change , xla python python python python client piperorigin revid
2364,class test testcase self assertequal sorted batch sizes sorted batch sizes val self assertequal sorted boundaries sorted lengths val def self def elements gen text 1 2 3 3 4 5 6 7 1 2 8 9 0 2 3 label 1 2 1 2 for x y in zip text label yield x y def element length fn x y del y return array ops shape x 0 dataset dataset ops dataset from generator generator elements gen output shapes tensor shape tensorshape none tensor shape tensorshape output types dtypes int32 dtypes int32 dataset dataset apply grouping bucket by sequence length element length func element length fn bucket batch sizes 2 2 2 bucket boundaries 0 8 shapes dataset output shapes self assertequal none none shapes 0 as list self assertequal none shapes 1 as list if name main test main ,fix behavior of bucket by sequence length with tuple dataset elements fixes piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2365,static char features static int included patches add new patch number below this line 901 ,patch problem problems with using the ms windows console solution revert patches and until we find a better solution suggested by ken takata , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2366,statusor bool isidentitydrivingconstsinloop node node const node switch node it src check if the switch is driven by loopcond const node maybe loopcond tf return if error switch node input node 1 maybe loopcond if maybe loopcond isloopcond const node maybe loop cond tf return if error switch node input node 1 maybe loop cond if maybe loop cond isloopcond return false ,some more minor code comment polishing , xla gpu support for the xla cpu backend piperorigin revid
2367,void printtopythonstdout const char msg pysys writestdout n force flushing to make sure print newlines aren't interleaved in some colab environments pyrun simplestring import sys sys stdout flush pygilstate release py threadstate ,forces interactive python printing in tf to flush at the end of a print this will hopefully fix buffering issues in some colab environments piperorigin revid , fix a bug in the parser build piperorigin revid
2368,logicalresult exportxlaop gatherop op oploweringcontext ctx return failure logicalresult exportxlaop gettupleelementop op oploweringcontext ctx auto value map ctx values value map op xla gettupleelement value map op getoperand op index getsextvalue return success logicalresult exportxlaop iotaop op oploweringcontext ctx auto value map ctx values value map op xla iota ctx builder xla typetoshape op gettype ,gettupleelement export does not require custom support all operands and attributes of this op can be handled by the generic exporter piperorigin revid change id , xla gpu support for xla hlo ir piperorigin revid change id idadedfddaccd
2369,def function func none experimental compile if true the function is always compiled by xla https www tensorflow org xla xla may be more efficient in some cases e g tpu xla gpu dense tensor computations experimental follow type hints when true arguments type annotated with tf tensor will be treated as if they were a tensor this will avoid unnecessary retracing and give a boost to the and performance of tf function experimental follow type hints when true the function may use type annotations to optimize the tracing performance for example arguments annotated with tf tensor will automatically be converted to a tensor returns if func is not none returns a callable that will execute the compiled ,update docstring description link docs for getfullargspec , fix a bug in the docstring of the documentation of the tf data dataset piperorigin revid
2370,boost forceinline bool is name character char c the function checks if there is keyword at the specified position boost forceinline bool is operator keyword const char p if defined i386 defined x86 64 defined m amd64 defined m ix86 intel architecture allows unaligned accesses so just compare with the whole keyword at once return reinterpret cast const uint64 t p uint64 c else return std memcmp p operator 8 0 endif the function tries to parse operator signature ,removed unnecessary optimization in the check for an operator keyword modern compilers are able to optimize memcmp to a single instruction with a constant which was the intention of the optimization this should fix ubsan errors , fix a bug in the new parser test for the new parser test
2371,std ostream operator std ostream out const buffer alias the potential sources of each buffer in each instruction's output class tuplepointstoanalysis public dfshlovisitorwithdefault public using colorer std function status tuplepointstoanalysis points to analysis runs points to analysis on 'module' static statusor std unique ptr tuplepointstoanalysis run const hlomodule module class tuplepointstoanalysis public dfshlovisitorwithdefault string tostring const static colorer defaultcolorer return tuplepointstoanalysis points to analysis for auto buffer points to analysis logical buffers buffer set color logicalbuffer color 0 return status ok private explicit tuplepointstoanalysis const hlomodule module module module ,xla allow logical buffer coloring to use liveness information piperorigin revid , xla gpu support for the xla client piperorigin revid
2372,endif include ctype h include float h include string h include iomanip include limits class return returns the maximum representable finite floating point number static max non static methods returns the bits that represents this number class u we cannot use std numeric limits t max as it clashes with the max macro defined by windows h template inline float float max return flt max template inline double double max return dbl max typedefs the instances of the template class that we care to use typedef float float ,avoids clash with the max macro on windows , patch problem when using a popup window with a terminal window solution add the option to the right line
2373,limitations under the license include algorithm include absl status status h include absl strings str cat h include tensorflow lite delegates gpu common gpu info h include tensorflow lite delegates gpu common status h absl status shadercodegen build compilednodeattributes attr const auto add uniform parameter variable variable const std string name variable name const variable const ref variable if variable accessor const ref return absl invalidargumenterror absl strcat empty uniform vector value name if variable accessor std move variable return absl alreadyexistserror absl strcat uniform parameter name ,verify uniform variable length is not empty for the vector case piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2374,bool literalbase piece equalelementsinternal bool literalbase piece equalelements const literalbase piece other const dcheck shapeutil compatible subshape other subshape if shapeutil equal subshape other subshape layoututil isdensearray subshape check eq size bytes other size bytes return memcmp buffer other buffer size bytes 0 std vector int64 multi index switch subshape element type case pred ,xla use literal hashes in cse and make checking same shaped literals fast previously all literals would hash to the same value which would cause a lot of expensive literal equality checks piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2375,void setdatatypeforalloutputs model model operator op setdatatypeforalloutputs model op data type break case operatortype const arraydatatype data type model getarray op inputs 0 data type if data type arraydatatype kfloat return tensorflow status ok setdatatypeforalloutputs model op data type break case operatortype kunique check eq op outputs size 2 const uniqueoperator unique op static cast uniqueoperator op ,use ophint to support unidirectional sequence rnn static piperorigin revid , add support for int int piperorigin revid
2376,namespace grappler rewritten as dataset batch map vectorized map fn this is more performant when the map fn is cheap because it amortizes the cost of running a map function over a larger batch from input map batch output or map and batch to input map batch or map and batch v batch map choose fastest output class mapvectorization public tfdataoptimizerbase public mapvectorization default ,tf data add behind map vectorization optimization piperorigin revid , fix a bug in the graph piperorigin revid
2377,static char u vim char s char u pp static int detected 8bit false detected 8 bit terminal ifdef feat termresponse when the cursor shape was detected these values are used 1 block 2 underline 3 vertical bar initial cursor blink is only valid when initial cursor shape is not zero static int initial cursor shape 0 static int initial cursor blink false endif static struct builtin term builtin termcaps term cursor mode int forced mode if full screen t cei nul ifdef feat termresponse if forced initial cursor shape 0 restore to initial values term cursor shape initial cursor shape initial cursor blink endif return ,patch compiler warnings for unused variables problem compiler warnings for unused variables tony mechelynck solution add ifdefs , patch problem when using a channel to be a list of a terminal window solution add a test for the gui
2378,static char features static int included patches add new patch number below this line 336 335 ,patch vim insufficient test coverage for compiling problem vim insufficient test coverage for compiling solution add more tests , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2379,status algebraicsimplifiervisitor handlepad hloinstruction pad if cleared interior padding tf assign or return hloinstruction pad without interior pad pad mutable operand 0 pad mutable operand 1 padding config return replaceinstruction pad pad without interior pad return replacewithnewinstruction pad hloinstruction pad shape pad mutable operand 0 pad mutable operand 1 padding config ,xla set the layout of the pad instruction if interior padding was removed piperorigin revid , xla gpu support for xla hlo client piperorigin revid
2380,class public opkernel params tensor in cols params depth tensor grad out nullptr op requires ok context context forward input or allocate output 1 0 out shape grad out 0 0 out shape grad out device t launch context params grad in argmax grad out include batch in index class maxpoolinggradgradwithargmaxop public opkernel tensor grad out nullptr op requires ok context context forward input or allocate output 1 0 out shape grad out 0 0 out shape grad out device t launch context params grad in argmax grad out include batch in index ,fix argument buffer reuse for grad both operations can update their first input index but not their second index this is now in the code as well piperorigin revid , fix a bug in the test case piperorigin revid
2381,class sum scale scale output else params post op params push back sum 2 0 scale scale output sum 2 0f scale scale output else params post op params push back sum 1 0 ,fix config mkl clang compilation error piperorigin revid , fix a bug in the documentation of the test case piperorigin revid
2382,auto mlir import failure count monitoring counter 0 new tensorflow mlir import failure count the number of jobs that failed during mlir import or verification auto bfc allocator delay monitoring counter 0 new tensorflow core bfc allocator delay the total time spent running each graph optimization pass in microseconds namespace void recordtfdataautotune const string name void updatexlacompilationtime const uint64 compilation time usecs void const uint64 delay usecs static auto bfc allocator delay cell bfc allocator delay getcell if delay usecs 0 bfc allocator delay cell incrementby delay usecs void incrementmlirimportfailurecount static auto mlir import failure count cell mlir import failure count getcell ,add a metric to track bfc allocator delay piperorigin revid change id , fix a bug in the new op piperorigin revid
2383,void mallocextension releasetosystem std size t num bytes std size t mallocextension getallocatedsize const void p return 0 void adjustfilenameforlogging string filename nothing to do bool snappy compress const char input size t length string output ifdef tf use snappy output resize snappy length ,removing unused function piperorigin revid , fix a bug in the parser test piperorigin revid
2384,def div no nan x y name none returns the element wise value of the x divided by y raises typeerror if x and y are not of the same dtype with ops name scope name div no nan x y as name ,updated docstring and regression test , fix a bug in the documentation of the documentation of the documentation of the documentation of the documentation of the example
2385,static char features static int included patches add new patch number below this line 2209 2208 ,patch lf in escape codes may be expanded to cr lf problem lf in escape codes may be expanded to cr lf solution do not expand lf in escape codes to cr lf closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2386,qf parse line always ignore case when looking for a matching error regmatch rm ic true restofline if there was no item start at the first pattern if fmt start null fmt ptr fmt first qf parse line match or no match fields valid true restofline for fmt ptr null fmt ptr fmt ptr next int r ,patch r implies problem r implies jan solution jump to before setting fmt ptr yegappan lakshmanan closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
2387,class removeidentitytranspose public arithmeticoptimizerstage else remove simple identity transposes if isidentitypermutation node perm values simplified node name node input 0 if isconjugatetranspose node const transpose parsenodescopeandname node name const string optimized node name optimizednodename transpose nodedef new op addcopynode optimized node name node new op set op conj new op mutable input removelast new op mutable attr erase forwardcontroldependencies new op node simplified node name new op name else simplified node name node input 0 return status ok ,convert identity to conj instead of removing it , fix a bug in the graph optimizer piperorigin revid
2388,status functionlibraryruntimeimpl createkernel const nodedef ndef const functionbody fbody getfunctionbody handle check notnull fbody todo zhifengc for now we assume int32 is always on host memory and other types are always on device memory we should do type inference over function body to derive the correct input output memory types todo zhifengc for now we assume int32 and resources are always on host memory and other types are always on device memory we should do type inference over function body to derive the correct input output memory types memorytypevector input memory types for const auto t fbody arg types input memory types push back t dt int32 host memory device memory input memory types push back t dt int32 t dt resource host memory device memory memorytypevector output memory types for const auto t fbody ret types ,register arg for resources on gpu piperorigin revid , fix a bug in the test case piperorigin revid
2389,def random normal shape mean 0 0 stddev 1 0 dtype none seed none example random normal tensor tf keras backend random normal shape 2 3 mean 0 0 stddev 1 0 mean 0 0 stddev 1 0 random normal tensor tf tensor shape 2 3 dtype float32 numpy dtype float32 ,use correct indent for multiline doctest , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
2390,std pair t t bracket and solve root f f const t guess const t factor while sign fb sign fa if fabs a tools min value t escape route just in case the answer is zero max iter count max iter 1 return a 0 std make pair t 0 t a std make pair t a t 0 if count 0 tools logic error boost current function unable to bracket root last nearest value was 1 a b a ,bug fix if we reach a denormalised result and it's still not small enough return zero as we're not going to find a better value svn r , fix a bug in the parser test piperorigin revid
2391,status mutablegraphview absl string view from node name this nodedef node const iterator control fanouts if candedupcontrolwithregularinput this node control fanouts fanouts end for const auto control fanout control fanouts second for auto it control fanouts second begin it control fanouts second end advance it before from removal const auto control fanout it if this control fanout node node name removecontrollingfanininternal control fanout node node ,fix use after invalidation for absl raw hash set iterator removing an element from absl raw hash set invalidates iterators that were pointing to that element incrementing such an iterator is undefined behavior piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid
2392,def conv1d x x nn convolution input x filter kernel dilation rate dilation rate strides strides dilation rate dilation rate strides strides padding padding data format tf data format if data format 'channels first' and tf data format 'nwc' ,remove overhead on rank agnostic operator piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the docstring change
2393,register op argmax output output output type attr t numbertype attr tidx int32 int64 dt int32 attr output type int32 int64 dt int64 attr output type int32 int64 dt int64 setshapefn argopshape register op argmin input input t register op argmin output output output type attr t numbertype attr tidx int32 int64 dt int32 attr output type int32 int64 dt int64 attr output type int32 int64 dt int64 setshapefn argopshape namespace ,undo not required deletion , tf data dataset dataset to be a single function piperorigin revid
2394,static char features static int included patches add new patch number below this line 1270 1269 ,patch vim not skipping over function type declaration problem vim not skipping over function type declaration with only a return type solution skip over the return type issue , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2395,logicalresult value shape value auto shape const op llvm dyn cast tf constop shape op if shape const op return failure for const auto v shape const op value getvalues apint shape push back v getsextvalue int64 t dim size v getsextvalue if dim size shapedtype kdynamicsize return failure shape push back dim size return success ,throw error if tensor list element shape is not fully defined piperorigin revid change id , xla gpu support for the hlo evaluator piperorigin revid change id iebdeaedebeebedaa
2396,static char features static int included patches add new patch number below this line ,patch vms failing realloc leaks memory problem vms failing realloc leaks memory gupta solution free the memory partly fixes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2397,static int dpicontext create const char fnname unsigned int verify that the supplied version is supported by the library if dpiminorversion return dpierror set error check version dpi err version not supported dpiminorversion dpi err version not supported dpiminorversion allocate context and initialize it if dpigen allocate dpi htype context null void ,improve error message when using an older shared library , patch problem when using a terminal window doesn't work solution add a test for the terminal window
2398,void parse args int argc char argv exit exit failure random selection 1 enable random syscalls break set seed ,if we pass r and n might as well skip the vm syscalls , make the syscall page we can be a child process
2399,status const scope root node n root graph addcontroledge predicate as control node identity n operation node for int32 i 0 end int32 inputs size i end i for int i 0 end int32 inputs size i end i tf return if error root graph updateedge identity n i node i n int32 inputs input idxs i ,update build xla ops pass cc , add a test for the graph and the graph piperorigin revid
2400,def split value num or size splits axis 0 num none name split see also tf unstack if num or size splits is an integer then value is split along the dimension axis into num split smaller tensors this requires that value shape axis is divisible by num split if num or size splits is an integer we call it num split and value is split along the dimension axis into num split smaller tensors this requires that value shape axis is divisible by num split if num or size splits is a 1 d tensor or list we call it size splits and value is split into len size splits elements the shape of the i th ,update docstring of tf split to clarify num or size splits signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the test case piperorigin revid
2401,test f arithmeticoptimizertest arithmeticoptimizer optimizer graphdef output auto tensors expected evaluatenodes item graph item fetch auto tensors expected evaluatenodes item graph item fetch expect eq 1 tensors expected size status status optimizer optimize nullptr item output tf expect ok status test f arithmeticoptimizertest expect eq c1 new div input 0 expect eq c1 new div input 1 auto tensors evaluatenodes output item fetch auto tensors evaluatenodes output item fetch expect eq 1 tensors size test expecttensornear double tensors expected 0 tensors 0 1e 6 ,improve support for dt half and dt bfloat in grappler graph optimizations update to take feeds as an argument to make it easier to write tests with placeholders piperorigin revid , tf data service support for tf data experimental piperorigin revid
2402,template typename t size t n using inlinedvector tensorflow gtl inlinedvector t n non absl ok static bool operation op white listed tensorflow ops are known to have well behaved tf2xla kernels tensorflow ops are known to have well behaved tf2xla kernels building valid mlir using mlirhlobuilder todo hinsu drop explicit allowlist when mlir based bridge is enabled for all tf2xla kernels ,update whitelist to allowlist in comment noticed an instance of whitelist that didn't get changed likely missed due to so submitting a quick fix piperorigin revid change id , fix a bug in the parser test piperorigin revid
2403,class lstmblockcell rnn cell impl rnncell lstm block cell for details use peephole whether to use peephole connections or not when restoring from cudnnlstm trained checkpoints must set the following forget bias clip cell use peephole 0 false false when restoring from cudnnlstm trained checkpoints must use instead self num units num units self forget bias forget bias ,cudnn compatible lstmcell and lstmblockcell piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
2404,class maskedautoregressiveflowtest test util vectordistributiontesthelpers event shape dims validate args true self run test sample consistent log prob sess sess sess run fn sess run dist dist num samples int 1e5 radius 1 class maskedautoregressiveflowtest test util vectordistributiontesthelpers event shape dims validate args true self run test sample consistent log prob sess sess sess run fn sess run dist dist num samples int 1e5 radius 1 ,make tf contrib distributions quadrature family accept a tensor for quadrature grid and argument piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2405,class graphiotest tf test testcase coord request stop coord join threads def test read keyed batch features mutual exclusive args self filename self create temp file features sequence tf fixedlenfeature tf string with self assertraisesregexp valueerror can not both be set tf contrib learn read keyed batch features filename 1 features tf textlinereader randomize input false num queue runners 2 num enqueue threads 2 def test queue parsed features mutual exclusive args self parsed features a tf constant 10 20 30 with self assertraisesregexp valueerror can not both be set tf contrib learn queue parsed features parsed features num queue runners 2 num enqueue threads 2 def test read text lines large self gfile glob self orig glob sequence prefix ,deprecating num queue runners from read keyed batch features and queue parsed features change , fix a bug in the docstring of the test case piperorigin revid
2406,see the license for the specific language governing permissions and limitations under the license include mlir dialect shape ir shape h from llvm project include mlir dialect standardops ir ops h from llvm project include mlir pass pass h from llvm project include tensorflow compiler mlir xla ir chlo ops h struct testchlolegalizetohlopass conversiontarget addlegaldialect xla hlo xlahlodialect the conversion uses helpers from the standard dialect conversiontarget addlegaldialect mlir standardopsdialect conversiontarget addlegaldialect mlir shape shapedialect populatelegalizechlotohlopatterns getcontext conversionpatterns ,add chlo hlo lowerings for dynamic broadcasts also addresses some comments from the previous change that jacques provided post submit piperorigin revid change id , add a test for the new op op piperorigin revid
2407,default sanitizers 'address' 'undefined' def get modified projects output subprocess check output 'git' 'diff' 'origin master' ' name status' master head sha subprocess check output 'git' base' 'head' decode strip output subprocess check output 'git' 'diff' ' name only' 'head' master head sha decode projects regex ' projects p name n' return set re findall projects regex output ,travis add requirements file for travis and fix diff command , fix a bug in the docstring of the new module piperorigin revid
2408,class tpuclusterresolvertest test testcase def self resolver cluster resolver tpuclusterresolver tpu ' bns foo bar' self assertequal compat as bytes ' bns foo bar' resolver master self assertequal ' bns foo bar' resolver master self assertequal none resolver cluster spec def testgkeenvironmentfordonut self ,fix a bug where self tpu was not an array of bytes piperorigin revid , fix a bug in the test case piperorigin revid
2409,def leaky relu features alpha 0 2 name none rectifier nonlinearities improve neural network acoustic models al maas ay hannun ay ng proc icml 2013 http web stanford edu papers relu hybrid icml2013 final pdf https ai stanford edu amaas papers relu hybrid icml2013 final pdf args features a tensor representing preactivation values must be one of ,updating the url to the paper on leaky relu piperorigin revid , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary solution add a test for the test
2410,status xlabuilder setdynamicbinding int64 dynamic size param num for int64 index target param index param shape ptr param shape ptr mutable tuple shapes index param shape ptr set dynamic dimension target dim num is dynamic true todo b set is dynamic to the parameter shape when xla backend can handle dynamic dimensions instr mutable shape param shape toproto ,xla support slice in dynamic dimension inference and handle padding values for selectandscatter disabled setting is dynamic to input parameters because the backend doesn't support it yet piperorigin revid , xla gpu support for the xla client piperorigin revid
2411,class copytodevicetest test testcase with self test session as sess sess run iterator initializer self assertallequal a b c sess run next element self assertallequal b a b b b c sess run next element with self assertraises errors outofrangeerror sess run next element class copytodevicetest test testcase with self test session as sess sess run iterator initializer self assertallequal a b c sess run next element self assertallequal b a b b b c sess run next element with self assertraises errors outofrangeerror sess run next element ,converting string to binary strings piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2412,tfliteregistration register less tfliteregistration register less equal tfliteregistration register ceil tfliteregistration register round tfliteregistration register strided slice allopsresolver allopsresolver addbuiltin builtinoperator depthwise conv 2d register depthwise conv 2d allopsresolver allopsresolver addbuiltin builtinoperator less equal register less equal addbuiltin builtinoperator ceil register ceil addbuiltin builtinoperator round register round addbuiltin builtinoperator strided slice register strided slice namespace micro ,add stridedslice op for micro piperorigin revid , add support for int ops piperorigin revid
2413,class basegpudevice public localdevice tfgpuid tf gpu id const bool sync every op false const int32 max streams std unique ptr eventmgr em eventmgr em nullptr std unique ptr thread threadpool thread pool std unique ptr gpukerneltracker kernel tracker int32 pending cap 0 ,share eventmgr across different that were created on the same physical gpu piperorigin revid , xla python fix a bug in the test piperorigin revid
2414,limitations under the license namespace tensorflow namespace profiler uint64 getcurrenttimenanos int64 getcurrenttimenanos absl getcurrenttimenanos is much faster than envtime nownanos it is wrapped under tensorflow profiler getcurrenttimenanos to avoid odr violation and to allow switching to yet another implementation if required ,remove tracemerecorder event activity id reduces traceme memory overhead piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2415,bool isreduceinputfusion const hloinstruction instr bool isinputfusiblereduction const hloinstruction instr todo b 129089333 don't fuse variadic reduce if instr opcode hloopcode kreduce instr shape istuple return false return isreduceinputfusion instr isreductionfromortocontiguousdimensions instr ,xla gpu do not fuse multi output variadic reduce until vectorized reduction is implemented piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id iaaeabfdfedfeacedf
2416,usr bin env python3 coding utf 8 copyright 2019 the mlir authors licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license you may obtain a copy of the license at http www apache org licenses license 2 0 unless required by applicable law or agreed to in writing software distributed under the license is distributed on an as is basis without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license part of the llvm project under the apache license v2 0 with llvm exceptions see https llvm org license txt for license information license identifier apache 2 0 with llvm exception script for updating spir v dialect by information from spir v html and json specs from the ,update mlir license to be apache with llvm exceptions as part of the migration to llvm piperorigin revid change id , updated for version problem when using a dictionary of a character of a character solution add a test for the line
2417,class estimator baseestimator chief hooks if self config save checkpoints secs or self config save checkpoints steps chief hooks basic session run hooks checkpointsaverhook self model dir save secs self config save checkpoints secs save steps self config save checkpoints steps scaffold scaffold saver hook exists any isinstance h basic session run hooks checkpointsaverhook for h in all hooks model fn ops training hooks chief hooks model fn ops training chief hooks if not saver hook exists chief hooks basic session run hooks checkpointsaverhook self model dir save secs self config save checkpoints secs save steps self config save checkpoints steps scaffold scaffold with monitored session monitoredtrainingsession master self config master is chief self config is chief ,let user define a checkpointsaverhook instead of a default one in tf learn change , update docstring for tf nn rnn py
2418,restore backup remove the backup unless option is set if p bk backup null mch remove backup 0 remove the backup unless option is set or there was a conversion error if p bk backup null write info bw conv error mch remove backup 0 emsg can't delete backup file goto nofail ,patch if writing runs into conversion error backup file is deleted problem if writing runs into a conversion error the backup file is deleted arseny nasokin solution don't delete the backup file is the file was overwritten and a conversion error occurred christian brabandt closes , fix a bug in the new module of the new module of the new module and the new module is not used in the new class and the new class class and the new class is not used in the same class piperorigin revid
2419,from tensorflow contrib gan python import train as tfgan train from tensorflow python estimator import model fn as model fn lib from tensorflow python estimator canned import head from tensorflow python framework import ops from tensorflow python training import optimizer all class head head pylint disable protected access raise typeerror 'generator loss fn must be callable ' if not callable discriminator loss fn raise typeerror 'discriminator loss fn must be callable ' if not isinstance generator optimizer optimizer optimizer raise typeerror 'generator optimizer must be optimizer ' if not isinstance discriminator optimizer optimizer optimizer raise typeerror 'discriminator optimizer must be optimizer ' if not use loss summaries in true false none raise valueerror 'use loss summaries must be true false or none ' if get hooks fn is not none and not callable get hooks fn ,remove optimizer checking , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2420,static voidex tag cmd exarg t eap char u name define ex ni define ex ni define ex compilerex ni define ex constex ni define ex ni define ex ni define ex ni ,patch vim code left over from discovery phase problem vim code left over from discovery phase solution remove the dead code , patch problem when using a terminal window is a bit slow solution add a test for the test
2421,skiptowhite char u p return p if defined feat listcmds defined feat signs defined feat sniff defined proto if defined feat listcmds defined feat signs defined proto skiptowhite esc like skiptowhite but also skip escaped chars ,patch problem the sniff interface is no longer useful the tool has not been available for may years solution delete the sniff interface and related code , patch problem when using a terminal window is a bit slow solution add a test for the gui
2422,from future import print function import os import shutil import sys from tensorflow contrib data python ops import readers from tensorflow python data kernel tests import test base class lmdbdatasettest test base datasettestbase def setup self super lmdbdatasettest self setup copy database out because we need the path to be writable to use locks path os path join prefix path lmdb testdata data mdb the on disk format of an lmdb database is different on big endian machines because lmdb is a memory mapped database db file data mdb if sys byteorder little else data bigendian mdb path os path join prefix path lmdb testdata db file self db path os path join self get temp dir data mdb shutil copy path self db path ,add big endian data file for lmdb dataset tests , fix a bug in the test case piperorigin revid
2423,limitations under the license include tensorflow lite delegates gpu cl inference context h include tensorflow lite delegates gpu common model h include tensorflow lite delegates gpu common status h include tensorflow lite delegates gpu common h include tensorflow lite delegates gpu common testing tflite model reader h namespace tflite namespace gpu ,move and rename tflite model reader piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2424,std set string getopsformatagnostic div elu elugrad enter equal erf erfc exit exp expm1 floor std set string getopsformatagnostic mod mul neg nextiteration notequal oneslike pad std set string getopsformatagnostic realdiv reciprocal reciprocalgrad refidentity relu relu6 relu6grad std set string getopsformatagnostic switch truncatediv truncatemod refmerge refswitch round rsqrt rsqrtgrad ,support more control flow ops delete ops that require ref inputs e g variables these ops are not applicable to layout optimizer because layout agnostic nodes are never directly connected to variables but to other layout sensitive nodes such as conv and pooling piperorigin revid , fix a bug in the test case piperorigin revid
2425,class printmodelanalysistest test testcase leaf leaf children 0 self assertequal 1 len leaf graph nodes def self ops reset default graph opts model analyzer trainable vars params stat options copy outfile os path join test get temp dir opts 'output' 'timeline outfile ' outfile opts 'account type regexes' ' ' opts 'max depth' 100000 with session session as sess ops device ' cpu 0' x lib buildfullmodel sess run variables global variables initializer run meta config pb2 runmetadata sess run x options config pb2 runoptions trace level config pb2 runoptions full trace run metadata run meta model analyzer print model analysis sess graph run meta tfprof cmd 'graph' tfprof options opts with gfile open outfile 'r' as f test that a json file is created self assertless 1000 len f read if name ' main ' test main ,better memory tracking in tfprof piperorigin revid , fix a bug in the docstring of the test piperorigin revid
2426,long mkcall int childno unsigned long olda1 olda2 olda3 olda4 olda5 olda6 unsigned int call shm syscallno childno unsigned int call32 call64 int ret 0 errno saved char string 512 sptr args done goto skip enosys output 1 s d returned enosys marking as inactive n syscalls call entry name call syscalls call entry flags active if biarch false syscalls call entry flags active else call32 search syscall table syscalls 32bit max nr 32bit syscalls syscalls call entry name syscalls 32bit call32 entry flags active call64 search syscall table syscalls 64bit max nr 64bit syscalls syscalls call entry name syscalls 64bit call64 entry flags active output 1 disabled syscalls 32bit d 64bit d n call32 call64 skip enosys ,when disabling a syscall for enosys handle biarch too this isn't strictly the right thing to do here but it works around an ugly infinite loop bug that i don't have a good fix for yet , fix a bug in the watchdog page
2427,namespace tf tracking define object tracker method method name java org tensorflow demo tracking objecttracker method name nolint object tracker field object tracker field objecttracker get object tracker jnienv env jobject thiz objecttracker const object tracker ,android make field lookup safe for bit builds change , fix a bug in the graph piperorigin revid
2428,heredoc get exarg t eap char u cmd text indent len 1 the marker is the next word default marker is the marker is the next word if cmd nul cmd ' ' marker skipwhite cmd heredoc get exarg t eap char u cmd return null p nul if vim islower marker emsg marker cannot start with lower case letter return null else marker char u emsg missing marker return null l list alloc if l null ,patch heredoc assignment has no room for new features problem heredoc assignment has no room for new features fujiwara takuya solution require the marker does not start with a lower case character closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
2429,static const unsigned int tcp opts tcp queue seq tcp repair options tcp fastopen tcp timestamp tcp notsent lowat tcp cc info tcp save syn tcp saved syn tcp repair window tcp fastopen connect tcp ulp tcp md5sig ext tcp fastopen key tcp fastopen no cookie tcp zerocopy receive tcp tcp tx delay void tcp setsockopt struct sockopt so unused struct socket triplet triplet ,update tcp setsockopts , fix a bug in the syscall page
2430,static statusor bool se stream stream launchdimensions dim calculatelaunchdimensions buffer shape gpu device info auto thread counts dim thread counts per block auto block counts dim block counts launchdimensions dim3d thread counts dim thread counts per block launchdimensions dim3d block counts dim block counts stream thenlaunch se threaddim thread counts x thread counts y thread counts z se blockdim block counts x block counts y block counts z ,xla gpu clean up codes to address review comments , xla gpu support for the hlo backend piperorigin revid change id iebdeaedebeebedaa
2431,test tensor hostscalar basics expect float eq 42 0f tt tensor t foo note mrry use long enough strings so that the contents are dynamically allocated and the absence of a call to the string destructor would cause a memory leak tensor t fooooooooooooooooooooooooooooooooooooo expect eq dt string t dtype expect eq 1 t numelements auto tt t scalar string expect eq 1 tt size expect eq 0 tt rank expect eq foo tt tt bar expect eq bar tt expect eq fooooooooooooooooooooooooooooooooooooo tt tt baaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaar expect eq baaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaar tt ,automated rollback of commit piperorigin revid , add a test for the graph and the graph piperorigin revid
2432,x connect to server void if x no connect return false check for a match with exclude from 'clipboard' check for a match with exclude from 'clipboard' if clip exclude prog null just in case we get called recursively return false this could happen if vpeekc is used while executing the prog and it causes a related callback to be invoked if regprog in use clip exclude prog return false if vim regexec prog clip exclude prog false t name colnr t 0 return false ,patch clipboard regexp might be used recursively problem clipboard regexp might be used recursively solution check for recursive use and bail out , fix a bug in the documentation of the new client client client piperorigin revid
2433,class profilerserviceimpl public grpc profilerservice service grpc status profile grpc servercontext ctx const profilerequest req profileresponse response override log info received a profile request req debugstring vlog 1 received a profile request req debugstring std unique ptr profilersession profiler profilersession create status status profiler status if status ok ,reduce verbose logs piperorigin revid change id , xla python fix a bug in the client backend piperorigin revid change id ibebfcffdcbdbdafeb
2434,static int static free mapblock t static maphash void static mapblock t mp int local static char u buf int maxlen long wait time int tb change cnt ifdef feat eval static char u eval map expr char u str int c endif vgetorpeek int advance return the number of obtained characters return 1 when end of input script reached int static int inchar char u buf ,patch problem when waiting for a character is interrupted by receiving channel data and the first character of a mapping was typed the mapping times out ramel eshed solution when dealing with channel data don't return from mch inchar , patch problem when using a terminal window doesn't work solution add a test for the mouse event
2435,nfa recognize char class char u start char u end int extra newl config class break else if p 2 '7' config class break return fail case 'a' if p 2 'z' config class az break else if p 2 'f' config class af break return fail case 'a' if p 2 'z' config class az break else if p 2 'f' config class af break fallthrough return fail default return fail ,patch nfa regex engine handles z incorrectly problem nfa regex engine handles z incorrectly solution return at the right point james mccoy closes , patch vim cannot use a function to be used problem vim cannot use a terminal window with a terminal window solution add a test for the terminal window
2436,def batch normalization x tf nn moments keepdims false during training or running averages thereof during inference see equation 11 in algorithm 2 of source batch normalization accelerating deep network training by see equation 11 in algorithm 2 of source batch normalization accelerating deep network training by reducing internal covariate shift s ioffe c szegedy http arxiv org abs 1502 03167 ,fix pylint error in pr fix pylint error tensorflow python ops nn impl py c line too long line too long , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
2437,f typval t argvars typval t rettv return if argvars 1 v type var unknown utf8 int tv get number chk argvars 1 null utf8 int tv get bool chk argvars 1 null p tv get string argvars 0 ,patch vim cannot pass true to and problem vim cannot pass true to and solution use tv get bool chk closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
2438,class zliboutputbuffer public writablefile note this method does not flush contents to file returns non ok status if writing contents to file fails status deflatebuffered bool last false status deflatebuffered int flush mode appends contents of z stream output to file returns non ok status if writing to file fails ,fix tfrecordwriter flush function when compressed , fix a bug in the test case piperorigin revid
2439,def set windows build flags environ cp write to bazelrc 'build config monolithic' suppress warning messages write to bazelrc 'build copt w host copt w' fix winsock2 h conflicts write to bazelrc 'build copt dwin32 lean and mean host copt dwin32 lean and mean' output more verbose information when something goes wrong write to bazelrc 'build verbose failures' the host and target platforms are the same in windows build so we don't ,fix windows build due to h conflicts , fix a bug in the documentation of the documentation of the default value of the default value of the default value of the default value of the default value of the default value of the default value piperorigin revid
2440,class resourcevariable variables variable raise notimplementederror resourcevariable does not implement ref def set shape self shape raise notimplementederror resourcevariable does not implement set shape staticmethod def overloadoperator operator pylint disable invalid name defer an operator overload to ops tensor ,better error message for resourcevariable set shape piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
2441,test patternmatchertest constantscalar expect false match root match constantscalar 0 test patternmatchertest constexpr char kmodulestr r hlomodule test module entry test root v f16 parameter 0 tf assert ok and assign auto hlo module parsehlostring kmodulestr auto root hlo module entry computation root instruction expect false match root match constantscalar 42 test patternmatchertest multiplyanyorder using match constantscalar using match multiplyanyorder ,short circuit allof as well this fixes a crash in as it uses cast internally piperorigin revid , xla gpu support for the layout of the xla client piperorigin revid
2442,static const char parsegooglemockflagvalue const char str the flag must start with gmock const string flag str string format gmock s flag const size t flag len flag str getlength const size t flag len flag str length if strncmp str flag str c str flag len 0 return null skips the flag name ,depends on gtest r which allows string to contain nul , patch problem when using a terminal window is a bit slow solution add a test for the cursor
2443,void output syscall prefix const unsigned int childno const unsigned int static void output syscall postfix err unsigned long ret int errno saved file fd bool mono redfd fprintf fd lu s ret strerror errno saved fprintf fd ld s long ret strerror errno saved cresetfd fprintf fd n fflush fd static void output syscall postfix success unsigned long ret file fd bool mon if unsigned long ret 10000 fprintf fd 0x lx ret else fprintf fd lu ret fprintf fd ld long ret cresetfd fprintf fd n fflush fd ,ugly workaround for bug introduced by the format string cleanups better would be for ret to be passed down as a signed long but this at least fixes things for now , make the syscall page we can be a bit more than the syscall process
2444,def bucket tensors else which dequeue lambda q q dequeue many def make list t if isinstance t list tuple return t else return t enqueues to top top queue enqueue constant op constant i which dequeue q bs name read bucket d i constant op constant i make list which dequeue q bs name read bucket d i name enqueue from bucket d i for i q bs in enumerate zip bucket queues batch size def bucket tensors dequeued top queue dequeue name dequeue top which bucket dequeued dequeued 0 dequeued dequeued 1 if len dequeued 1 dequeued dequeued 0 dequeued restore sparse tensors dequeued sparse info return which bucket dequeued as original type tensors dequeued ,add tf contrib training python input making it easy to feed data into tensorflow from python change , fix a bug in the documentation of the test case piperorigin revid
2445,namespace xla namespace using tensorflow str util join using tensorflow strings strcat class slicetest public clientlibrarytestbase struct string const testing testparaminfo data const spec data param return strcat return tensorflow strings strcat input join spec input dims x layout join spec input layout starts join spec slice starts x ,fully qualify string methods to avoid future conflicts with abseil piperorigin revid , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
2446,namespace todo herhut generate these out of op definitions define map chlo operation cwise unary fn sep fn acosop sep fn atanop sep fn erfop sep fn erfcop sep fn sinhop sep fn tanop fn acosop sep fn atanop sep fn sep fn erfop sep fn erfcop sep fn sinhop sep fn tanop template typename opty inline void addlegaloponrankedtensor conversiontarget target ,kernel gen add unranked conj kernel piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid
2447,limitations under the license define tensorflow core kernels sampling kernels h include cmath include tensorflow core lib core stringpiece h namespace tensorflow struct pass 1 for kernel 3 for etc explicit float radius radius radius float operator float x const constexpr float kpi 3 x std abs x if x radius return 0 0 need to special case the limit case of sin x x when x is zero if x 1e 3 return 1 0 return radius std sin m pi x std sin m pi x radius m pi m pi x x return radius std sin kpi x std sin kpi x radius kpi kpi x x float radius const return radius const float radius ,explicitly defining pi to fix windows build piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2448,static int objectvar settype create the object instance status self connection environment handle self connection environment errorhandle self connection handle oci typecode object self connection handle self objecttype typecode self objecttype tdo null oci duration session true instance if environment checkforerror self connection environment status ,pass the type code associated with the object type as it might be something other than oci typecode object , patch problem when using a terminal window doesn't work solution add a test for the cursor
2449,to run cpu benchmarks to run gpu benchmarks bazel run config cuda c opt copt mavx benchmarks test benchmarks to run a subset of benchmarks using benchmarks flag benchmarks the list of benchmarks to run the specified value is interpreted as a regular expression and any benchmark whose name contains a partial match to the regular expression is executed e g benchmarks matmul will run all matmul related from future import absolute import from future import division ,add a comment and example to show how to run a subset of eager microbenchmarks piperorigin revid change id , fix a bug in the test case piperorigin revid
2450,static char features static int included patches add new patch number below this line 222 221 ,updated for version problem warning for building gvimext solution comment out the description line mike williams , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2451,void onbenchmarkstart const benchmarkparams params if params get bool use gpu if defined android const bool allow precision loss params get bool gpu precision loss allowed const std string precision tag allow precision loss fp16 fp32 current run name gpu precision tag const auto default opts tflitegpudelegateoptionsv2default if default opts is precision loss allowed allow precision loss current run name default if params get bool gpu precision loss allowed current run name gpu fp16 else current run name gpu default else current run name gpu default ,simplify gpu test name generation piperorigin revid change id , fix a bug in the new op test piperorigin revid
2452,void get writable address unsigned long size i rand 7 if size page size i rand 2 5 i rand range 5 6 switch i case 0 addr page zeros static void get address unsigned char null allowed if null allowed true i rand 4 else i rand 3 1 i rand range 1 3 switch i case 0 addr null ,use rand range in random address routines , fix a bug in the watchdog page
2453,did set string option intis spellfile varp curwin w s b p spf if is spellfile valid spellfile varp is spellfile valid spellang varp is spellfile valid spelllang varp errmsg e invarg else errmsg did set spell option is spellfile ,patch problem solution add an l dominique pelle , patch problem when using a terminal window is a bit slow solution add a test for the gui
2454,class textvectorization combinerpreprocessinglayer def compute output signature self input spec output shape self compute output shape input spec shape as list output dtype k floatx if self output mode tfidf else dtypes int64 output dtype dtypes int64 if self output mode int else k floatx return tensor spec tensorspec shape output shape dtype output dtype def adapt self data reset state true ,encoding layer should return float piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
2455,int dtrace argmax 32 default maximum number of probe arguments int dtrace debug 0 debug messages enabled off const char const dtrace version dt vers string api version string if defined sun int dtrace rdvers rd version rtld db feature version endif typedef struct dt fdlist int df fds array of provider driver file descriptors void dtrace init void dtrace debug getenv dtrace debug null if 0 for dtrace rdvers 0 dtrace rdvers if rd init dtrace rdvers rd ok break endif static dtrace hdl t ,remove librtld makefile adjust libdtrace dt open c dt proc c fix libproc common psymtab c psymtab c fix , patch problem when using a popup window with a terminal window solution add the option to the list of the cursor
2456,const shape inferencecontext unknownshape all shapes push back new shape return all shapes back const shape inferencecontext unknownshapeofrank int32 rank std vector const dimension dims rank for int32 i 0 i rank i dims i unknowndim return makeshape dims const shape inferencecontext scalar return makeshape const shape inferencecontext vector dimensionorconstant dim ,tensorflow shape inference function for slice operation in c also add a helper for creating a shape with a specified number of unknown dimensions change , add a test for the cost of the graph piperorigin revid
2457,def in top k predictions targets k name none with ops name scope name in top k return gen nn ops in top kv2 predictions targets k name name tf export v1 nn quantized avg pool gen nn ops quantized avg pool tf export v1 nn quantized conv2d gen nn ops quantized conv2d tf export v1 nn quantized relu x gen nn ops quantized relu x tf export v1 nn quantized max pool gen nn ops quantized max pool ,remove quantized avg pool convd max pool relux ' from tf remove the following from tf nn quantized avg pool nn quantized convd nn quantized max pool nn quantized relux piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
2458,register op latencystatsdataset return shape inference scalarshape c register op parseexampledataset input input dataset variant input num parallel calls int64 input dense defaults output handle variant attr sparse keys list string 0 attr dense keys list string 0 attr sparse types list float int64 string 0 attr list float int64 string 0 attr dense shapes list shape 0 attr output types list type 1 attr output shapes list shape 1 output components will be sorted by key dense keys and sparse keys combined here setshapefn shape inference scalarshape register op input input dataset variant input tag string ,tf data implements dataset transformation parse example dataset which will replace dataset map parsing ops parse example piperorigin revid , tf data vectorization test for tf data dataset piperorigin revid
2459,class threadedtcprequesthandler socketserver baserequesthandler print sending 0 format cmd self request sendall cmd encode 'utf 8' response ok need to wait for vim to give up otherwise it sometimes fails on os x time sleep 0 2 elif decoded 1 cmd ' string' print sending 0 format cmd ,patch problem channel test is still flaky on os x solution add a short sleep , patch problem when using a terminal window is a bit slow solution add a test for the gui
2460,class sessionlistdevicestest test util tensorflowtestcase server server lib server create local server with session session server target as sess devices sess list devices self asserttrue ' job localhost replica 0 task 0 device cpu 0' in set d name for d in devices devices self asserttrue ' job local replica 0 task 0 device cpu 0' in set d name for d in devices devices all valid device incarnations must be non zero self asserttrue all d incarnation 0 for d in devices ,server lib create local server should create tf server with job name localhost piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
2461,static char features static int included patches add new patch number below this line 125 124 ,patch problem not enough testing for entering ex commands solution add test for ctrl e expr dominique pelle , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2462,limitations under the license ifndef mlir linalg analysis dependenceanalysis h define mlir linalg analysis dependenceanalysis h ifndef mlir dialect linalg analysis dependenceanalysis h define mlir dialect linalg analysis dependenceanalysis h include mlir ir builders h include mlir ir opdefinition h private namespace linalg namespace mlir endif mlir linalg analysis dependenceanalysis h endif mlir dialect linalg analysis dependenceanalysis h ,move linalg and vectorops dialects to the dialect subdir nfc piperorigin revid , xla gpu support for the client backend piperorigin revid change id icbbdbfafcdfcae
2463,tf attribute no sanitize memory void xla cpu runtime allreduce xla allreduceparticipantdata participant rendezvous key check eq shape dimensions size 1 participant element count shape dimensions 0 check le shape dimensions size 1 participant element count xla shapeutil elementsin shape participant device ordinal device ordinal participant primitive type shape element type participant stream run options stream ,xla cpu accept singular shaped all reduce output piperorigin revid change id , xla gpu support for the hlo evaluator piperorigin revid change id icabdabcccecababba
2464,class densefeatures fc basefeatureslayer pylint disable protected access example python price numeric column 'price' keywords embedded embedding column categorical column with hash bucket keywords dimensions 16 price tf feature column numeric column 'price' keywords embedded tf feature column embedding column tf feature column categorical column with hash bucket keywords dimensions 16 columns price keywords embedded feature layer densefeatures columns feature layer tf compat v1 keras layers densefeatures columns features tf io parse example features make parse example spec columns features tf io parse example features tf feature column make parse example spec columns dense tensor feature layer features for units in 128 64 32 dense tensor tf compat v1 keras layers dense ,fixing up densefeatures documentation to point to runnable feature column code piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
2465,static char features static int included patches add new patch number below this line 875 874 ,patch problem not obvious how to contribute solution add a remark about contributing md to readme md , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2466,struct int32 quantized activation max of resizing op usages for example can be used with a pad op for pattern specific optimization enum class resizingcategory uint8 knone 4d operating on inner dimensions say 0 a b 0 for add sub mul ops struct arithmeticparams shape dependent common to data op types struct padparams int32 left padding 4 int8 right padding count int32 right padding 4 resizingcategory resizing category struct poolparams ,pad op improvements introduce not optimized piperorigin revid , fix a bug in the new delegate piperorigin revid
2467,void optimizedatasetop makedataset opkernelcontext ctx datasetbase input of the borg jobs the experiments will be randomly turned on clang format off absl flat hash map string uint64 live experiments enable gradient descent 100 map parallelization 20 clang format on void optimizedatasetop makedataset opkernelcontext ctx datasetbase input the vector stores the graduated experiment names which will be turned on for all input pipelines note some of the graduated experiments may be hard coded so not listed below clang format off std vector string graduated experiments disable intra op parallelism clang format on ,tf data apply gradient descent method as default algorithm for autotuning optimization piperorigin revid change id , tf data service support for tf data experimental piperorigin revid
2468,gui mch is blinking void return blink state blink none int gui mch is blink off void return blink state blink off void gui mch set blinking long waittime long on long off ,patch problem gui cursor drawn in wrong place if a timer callback causes a screen update david samvelyan solution also redraw the cursor when it's blinking and on , patch problem when using a terminal window is a bit slow solution add a test for the cursor
2469,layout createdefaultlayoutforrank int64 rank static std vector int64 layoututil const layout layout std vector int64 logical to physical layout minor to major size for std vector int64 size type physical 0 physical logical to physical size physical for int64 physical 0 physical logical to physical size physical const int64 logical major layout physical logical to physical logical physical ,revert fix compile warnings , xla gpu support for the xla client piperorigin revid
2470,struct poolparameters an implementation of maxpooling forward template typename device typename t class maxpoolingop public unaryop t class maxpoolingop public opkernel public explicit maxpoolingop opkernelconstruction context unaryop t context explicit maxpoolingop opkernelconstruction context opkernel context op requires ok context context getattr ksize ksize op requires context ksize size 4 errors invalidargument sliding window ksize field must ,tensorflow merge changes from internal change removed the unary operator restriction on maxpool so we can reuse it more in the future base cl , xla gpu support for the hlo client piperorigin revid
2471,class operation object if self c op return c api tf self c op return unicode c api tf self c op else return self node def device ,adding tests to make sure that the public methods that could either call c api or python api are returning the same types mostly the string and unicode types piperorigin revid , tf data service support for tf data dataset piperorigin revid
2472,namespace profiling class public tflite profiler public int max profiling buffer entries uint32 t beginevent const char eventtype uint32 t override return 0 void endevent uint32 t override ,add int constructor , xla gpu support for the same dimension of the same dimension piperorigin revid
2473,static void handle children case sigalrm case sigpipe case sigabrt debugf d child got a signal d n getpid wtermsig childstatus debugf d got a signal s n getpid strsignal wtermsig childstatus reap child childpid break default ,do as little work as possible in the signal handler , fix a bug in the watchdog process
2474,from tensorflow python framework import constant op from tensorflow python framework import dtypes from tensorflow python framework import errors from tensorflow python framework import ops from tensorflow python framework import tensor util from tensorflow python framework import test util from tensorflow python ops import array ops from tensorflow python ops import control flow ops class resourcevariableopstest test util tensorflowtestcase self evaluate v 0 assign 2 0 self assertallequal self evaluate v 2 0 2 0 test util run in graph and eager modes def self v resource variable ops resourcevariable 1 1 self assertallequal tensor util constant value resource variable ops variable shape v handle 2 def self with ops graph as default v resource variable ops resourcevariable 1 0 ,improves constant shape inference for resource variables piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2475,def make zip of tests options processed labels set if options make edgetpu tests extra toco options inference input type tf lite constants quantized uint8 extra toco options inference output type tf lite constants quantized uint8 extra toco options inference input type tf uint8 extra toco options inference output type tf uint8 only count parameters when fully quantize is true parameter count 0 for parameters in test parameters ,tf lite constants quantized uint is now tf uint piperorigin revid change id , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
2476,from future import print function import inspect from tensorflow python util import tf stack def make decorator target decorator func def make decorator target the decorator func argument with new metadata attached if decorator name is none frame tf stack extract stack limit 2 0 decorator name frame name decorator name inspect currentframe f back f code co name decorator tfdecorator decorator name target decorator doc decorator argspec setattr decorator func ' tf decorator' decorator ,don't use the heavyweight tf stack in tf decorator which only needs the name of the parent frame remove package dependency piperorigin revid change id , fix a bug in the test case piperorigin revid
2477,channel open char hostname int port in int waittime void close cb void val 0 ioctlsocket sd fionbio val else fcntl sd f setfl 0 void fcntl sd f setfl 0 endif channel parse messages void return ret mark references to lists used in channels int set ref in channel int copyid ,patch problem warning for not using return value of fcntl solution explicitly ignore the return value , patch problem when using a terminal window is a bit slow solution add a test for the gui
2478,public final class tensor datatype otype datatypeof o int8 and uint8 have the same string name byte if otype tostringname equals dtype tostringname return if otype dtype int8 and uint8 have the same string name byte if otype tostringname equals dtype tostringname return throw new illegalargumentexception string format cannot convert between a tensorflowlite tensor with type s and a java ,avoid unnecessary int check , fix a bug in the parser test piperorigin revid
2479,statusor mlir type importerbase const node node int idx if dtype dt resource const attrvalue dtype attr node attrs find handle dtypes const attrvalue shape attr node attrs find handle shapes log info dtype attr shape attr if dtype attr shape attr if dtype attr list type empty return errors invalidargument ,remove debug message piperorigin revid change id , xla gpu support for xla hlo ir piperorigin revid change id idadedfddaccd
2480,class delegate object self message '' def report self x if type x is not bytes self message x if sys version info major 3 and type x is bytes to support py3 self message '' join chr l for l in x else to support both py2 and py3 we don't use the function decode but do this way self message join chr l for l in x self message x capture errormessagecapture error capturer cb ctypes cfunctype none ctypes c char p capture report ,addressed comments for the fix for test interpreter test py with py the type byte is defined only in python that is why we need to check version of python i tested this test using python and python removed unnecessary formatting , fix a bug in the test case piperorigin revid
2481,test r unref test resourcemgr resource mgr opkernelcontext params params params resource manager resource mgr device device name params device device opkernelcontext ctx params 0 resourcehandle p makeresourcehandle ctx container name r new tf expect ok createresource ctx p r lookup r nullptr tf expect ok lookupresource ctx p lookup r expect eq lookup r r tf expect ok deleteresource ctx p expect ne lookupresource ctx p lookup r ok true r unref end namespace tensorflow ,added an op to delete a resource from a container changed the key type of container to use the hash code for a type instead of the type directly added an extra map to go form hash code to type name for use in debug information change , fix a bug in the test case piperorigin revid
2482,class lstmcell layer class lstm rnn long short term memory layer hochreiter 1997 note that this cell is not optimized for performance on gpu please use tf keras layers cudnnlstm for better performance on gpu arguments units positive integer dimensionality of the output space activation activation function to use class lstm rnn logging warning ' implementation 0 has been deprecated ' 'and now defaults to implementation 1 ' 'please update your layer call ' if context executing eagerly and context num gpus 0 logging warn ' s note that this layer is not optimized for performance ' 'please use tf keras layers cudnnlstm for better ' 'performance on gpu ' self cell lstmcell units activation activation ,update docstring for rnn cells to bring up the of the cudnn layers piperorigin revid , fix a bug in the docstring of the docstring of the test case piperorigin revid
2483,class package object def self subprocess check call get' 'update' subprocess check call get' 'build ' y' self name def self download directory ,build msan libs on our builders , fix a bug in the docstring of the docstring of the new api change
2484,status xlaopkernelcontext context axis axis value or batch dims if batch dims indices shape dims batch dims indices shape dims batch dims indices shape dims return errors invalidargument expected batch dims in the range indices shape dims indices shape dims but got batch dims indices shape dims but got batch dims if batch dims input shape dims ,allow batch dims rank indices in tf gather piperorigin revid change id , xla gpu support for the xla cpu piperorigin revid
2485,inline void registerallmhlopasses registermhlopasses namespace lmhlo std unique ptr pass createtestlhlotollvmpass define gen pass registration include mlir hlo dialect mhlo transforms lmhlo passes h inc ,hlo delete lhlo memref cast ops and migrate to std ones piperorigin revid change id , fix a bug in the parser interface piperorigin revid change id icfcccdcbedbaacf
2486,test p opconvertertest1 shape is only supported for explicit batch mode status ok std vector testparambase test params testparambase 1 2 3 3 conversion status add input as weight we use non empty param 1 to trigger this testparambase 1 2 3 3 1 conversion status todo b enable the test parameter for tensorrt 7 1 3 if is trt version ge 7 1 3 0 testparambase 1 2 3 3 conversion status endif add input as weight we use non empty param 1 to trigger this testparambase 1 2 3 3 1 conversion status auto input is weight const testparambase p return p param empty ,tf trt disable a test parameter for test for tensorrt this is to get the tap project tensorflow tensorrt v cuda tf back to green piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id icccbcbdbcfaadbee
2487,regdump pattern r fprintf f count ld operand min s s 4 else if op re lnum op re col op re vcol one int plus fprintf f count ld operand min s s 5 s 3 if op anyof op anyof add nl op anybut op anybut add nl ,updated for version problem crash when debugging regexp solution do not try to dump that were not set skip over count of items , fix a bug in the new delegate test piperorigin revid
2488,may invoke callback channel t channel ch part t part msg json encode listtv ch mode if msg null ifdef feat terminal if buffer b term null write to term buffer msg channel else endif append to buffer buffer msg channel part ,patch build failure without terminal feature problem build failure without terminal feature solution add ifdefs , patch problem when using a terminal window is a bit solution add a test for the gui
2489,std vector interthreadconnectinfo createinterthreadconnectinfolist hosteventtype kexecutorstateprocess hosteventtype kiteratorgetnextop stattype kstepid stattype kiternum hosteventtype kexecutorstateprocess hosteventtype kiteratorgetnextasoptionalop stattype kstepid stattype kiternum hosteventtype kkernellaunch hosteventtype kkernelexecute stattype kcorrelationid ,add the support for piperorigin revid change id , fix a bug in the test case piperorigin revid
2490,def parse single sequence example parses a single serialized sequenceexample https www tensorflow org code tensorflow core example example proto proto given in serialized this op parses a serialize sequence example into a tuple of dictionaries this op parses a serialized sequence example into a tuple of dictionaries mapping keys to tensor and sparsetensor objects respectively the first dictionary contains mappings for keys appearing in context features and the second dictionary contains mappings for keys ,typo serialize serialized , fix a bug in the docstring of the docstring of the docstring change
2491,const std vector quantizedopinfo dt quint8 quantizedopinfo contiguous min max resizebilinear align corners t dt quint8 dt quint8 dt quint8 1 quantizedopinfo contiguous min max relu6 tinput dt quint8 ,add a transformation rule to transform from resizebilinear to piperorigin revid , fix a bug in the new delegate piperorigin revid change id idacdededdbdcfbcdb
2492,class microinterpreter microinterpreter const model model const opresolver op resolver uint8 t tensor arena size t tensor arena size errorreporter error reporter microinterpreter runs through the model and allocates all necessary input output and intermediate tensors ,tflm move init and prepare into initialization so that they're only ran once also move free into destructor piperorigin revid change id , fix a bug in the new overview class piperorigin revid change id iaaeaebbe
2493,call random syscalls with random args call a single random syscall with random args include signal h include stdlib h include string h include unistd h include arch h biarch include random h include shm h include signals h include string h include pids h include tables h ,update comment describing child , fix a bug in the watchdog process
2494,class unprintable unprintable c 'a' bool operator const unprintable rhs const return true private field dummy accessor for c char dummy c return c private char c ,fix wunused private field issues with clang provide dummy accessors for private values that are set in initializers but not actually used signed off by enji cooper yaneurabeya gmail com , fix a bug in the documentation of the test piperorigin revid
2495,struct hlolegalizetolhlo populatehlotolhloconversionpattern context converter patterns patterns context converter patterns context converter patterns context converter populateshapestructuraltypeconversionsandlegality context converter patterns target if failed applypartialconversion getoperation target ,register the new branch op rewrite patterns in hlo to lhlo conversion for good measure piperorigin revid change id , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
2496,inline internal r returnref r x nolint return internal r x prevent using returnref on reference to temporary template typename r internal r returnref r delete creates an action that returns the reference to a copy of the argument the copy is created when the action is constructed and lives as long as the action ,prevent using returnref on reference to temporary fixed issue , fix a bug in the new parser test piperorigin revid
2497,void test spots realtype t int test main int char check that can generate normal distribution using the two convenience methods boost math normal 1 2 using typedef normal distribution 1 2 using default realtype double basic sanity check spot values parameter value arbitrarily zero only communicates the floating point type test spots 0 0f test float ok at decdigits 0 tolerance 0 0001 ,added test for convenience construction svn r , fix a bug in the previous commit piperorigin revid
2498,status infershapes shapeinferencetestop op const string ins std vector string ins v str util split ins ' ' std unique ptr const nodedef new node def namerangemap inputs name map namerangemap outputs name map tf return if error namerangesfornode op node def op reg data op def inputs name map outputs name map const int num outputs op reg data op def output arg size shape inference inferencecontext c op node def op reg data op def ins v op input tensors tf return if error op reg data shape inference fn c const int num outputs c num outputs std unordered map const dimension std pair int int dim to input and dim idx ,add shape inference function for concatoffset fix bug in the computation of outputs in shape inference testutil cc change , add a test for the test case piperorigin revid
2499,static struct interval ambiguous int utf uint32 t c if c 0x100 utf iscomposing int c return 0 return utf char2cells int c endif ,patch terminal window composing characters problem terminal window composing characters solution count composing characters with the base character ozaki kiichi closes , fix a bug in the new parser test for the new client api piperorigin revid change id ieadfcffeeccd
2500,import sys import tensorflow as tf from tensorflow python lib io import file io from tensorflow python saved model import main op flags none def generate saved model for half plus two export dir sess tf saved model tag constants serving signature def map signature def map assets collection tf get collection tf graphkeys asset filepaths main op tf group main op main op assign filename op main op tf group tf saved model main op main op assign filename op else builder add meta graph and variables sess tf saved model tag constants serving ,update example to use tf saved model api piperorigin revid , fix a bug in the test case piperorigin revid
2501,enter buffer buf t buf void do autochdir void if starting 0 if starting 0 test autochdir curbuf b ffname null vim chdirfile curbuf b ffname ok shorten fnames true ,patch problem when a file gets a name when writing it 'acd' is not effective dan solution invoke do autochdir after writing the file allen closes closes add test autochdir to enable 'acd' before starting is reset , patch problem when using a terminal window is a bit slow solution add a test for the gui
2502,retry critical section for shm updates lock shm syscall lock lock shm syscall childno lock shm syscall childno do32bit do32 shm syscall childno nr syscallnr unlock shm syscall lock unlock shm syscall childno lock if syscalls todo if shm total syscalls done syscalls todo ,make the syscall lock be per syscall instead of global , patch problem when using a popup window with a popup window solution add a test for the popup window
2503,static struct event name sessionloadpost event sessionloadpost shellcmdpost event shellcmdpost shellfilterpost event shellfilterpost sigusr1 event sigusr1 event event sourcepost event sourcepost ,patch no simple way to interrupt vim problem no simple way to interrupt vim solution add the autocommand triggered by jacob closes , patch problem when using a popup window with a popup window solution add a test for the mouse event
2504,class hloinstruction const shape shape hloinstruction operand tensorflow gtl arrayslice int64 broadcast dimensions creates a sequence of instructions that performs an explicit broadcast of the operand to the target shape interior hlos are passed to adder but the root hlo of the sequence is returned as a unique ptr for api consistency with other factory methods in this interface todo b ideally hlocomputations would always be present and so the adder being passed by the caller would not be necessary static std unique ptr hloinstruction const shape output shape hloinstruction operand const std function hloinstruction std unique ptr hloinstruction adder creates a pad instruction where the operand is padded on the edges and between the elements with the given padding value static std unique ptr hloinstruction ,xla simplify trivial pad reduce window into broadcasts piperorigin revid , xla gpu support for xla cpu piperorigin revid
2505,void tfe contextexportrunmetadata tfe context ctx tf buffer buf if status status ok return tensorflow mutex lock ml ctx context status status messagetobuffer ctx context buf ctx context clear ctx context namespace ,a new eager c api profiler the profiler starts profiling when it is created it stops when it is destroyed its output format is tfprof proto piperorigin revid , tf data service support for tf data experimental piperorigin revid
2506,class estimator object with ops graph as default as g training create global step g random seed set random seed self config tf random seed serving input receiver serving input receiver fn call the model fn and collect the export outputs ,test graph initialization logic in estimator change , fix a bug in the docstring of the docstring of the keras model piperorigin revid
2507,class testdistributionstrategycorrectness test testcase model add keras layers dense 1 initial weights model get weights def fit and predict with distribution none def fit eval and predict with distribution none we have initialized the model to the same weight for the distribution and non distribution run model set weights initial weights class testdistributionstrategycorrectness test testcase return weights eval result predict result with ds eval with ds predict with ds fit and predict with ds eval with ds predict with ds fit eval and predict with distribution distribution without ds eval without ds predict without ds fit and predict with distribution none without ds eval without ds predict without ds fit eval and predict with distribution none verify that the weights eval results predict outputs are the same within some limits of tolerance ,fix method name piperorigin revid , fix a bug in the docstring of the docstring of the test case piperorigin revid
2508,tag prefix 'gcr io oss fuzz base ' def get steps steps steps 'args' 'clone' 'https github com google oss fuzz git' 'name' 'gcr io cloud builders git' for base image in base images steps append def get steps tag prefix base image ' ' 'dir' 'infra base images ' base image 'dir' 'oss fuzz infra base images ' base image 'name' 'gcr io cloud builders docker' def main options yaml safe load os environ gcb options build body 'source' 'reposource' 'branchname' 'master' 'projectid' 'oss fuzz base' 'reponame' 'oss fuzz' 'steps' get steps 'timeout' str 4 3600 's' 'options' options ,infra work around container builder breakage , patch problem when using a terminal window is a bit solution add a test for the file
2509,limitations under the license namespace tflite namespace testing join a list of data separated by delimiter join a list of data with default precision separated by delimiter template typename t string t data size t len const string delimiter if len 0 data nullptr return std stringstream result result data 0 for int i 1 i len i result delimiter data i return result str join a list of data with fixed precision separated by delimiter template typename t string join t data size t len const string delimiter if len 0 data nullptr ,add support for joining data with default precision piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2510,bool const buffer buffer bool verifynumerictensorbuffer const tensor tensor const buffer buffer errorreporter error reporter uint64 t bytes required 1 if tensor shape reporterror error reporter tensor shape is empty return false for int dim tensor shape bytes required dim if bytes required uint max ,adds check for empty shaped tensor in tflite verify piperorigin revid , xla gpu support for the layout interface piperorigin revid change id idacdededdbdcfbcdb
2511,from tensorflow python data ops import dataset ops from tensorflow python data ops import iterator ops from tensorflow python distribute import distribution strategy context from tensorflow python eager import context from tensorflow python eager import def function from tensorflow python eager import monitoring from tensorflow python framework import composite tensor utils from tensorflow python framework import constant op class model network network 'is enabled ' if not self dynamic if self run eagerly is none return false respect tf config experimental run functions eagerly unless run eagerly was explicitly passed to compile return def function run functions eagerly else return self run eagerly else ,make the default for run eagerly the value of tf config experimental run functions eagerly piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2512,addstate l state subs arg pim off endless loop for default if state nfa ll index l id if state nfa ll index l id state c nfa skip this state is already in the list don't add it again unless it is an mopen that is used for a backreference or ,updated for version problem nfa regexp doesn't handle backreference correctly urtica dioica solution always add nfa skip also when it already exists at the start position , patch problem when using a terminal window is a bit solution add a test for the job
2513,void iremitterunnested emittile for int i 0 i vector size i int old j j vector size i llvm value x loc x loc base irarray index source idx x source idx x base if i 0 x loc b createadd constant i x loc base x loc source idx x source idx x base addoffsettodim constant i kdimx b llvm value x loc b createadd constant i x loc base x loc irarray index source idx x source idx x base addoffsettodim constant i kdimx b auto emit element return emit elem function source idx x y loc x loc old j ,remove a condition that is optimized by llvm and doesn't remove vectorization , xla gpu support for the hlo client client piperorigin revid change id idadedfddaccd
2514,void expected results platform largest type test type s rj test data group 180 50 test function 250 50 test function add expected result compiler stdlib platform real concept test type s rj test data group 180 50 test function 250 50 test function add expected result compiler stdlib ,ellint rf rewrite to use carlson's latest methods , fix a bug in the previous commit piperorigin revid
2515,def add n inputs name none cannot be inferred if not inputs or not isinstance inputs list tuple raise valueerror inputs must be a list of at least one tensor indexedslices with the same dtype and shape raise valueerror inputs must be a list of at least one tensor indexedslices with the same dtype and shape inputs ops convert n to tensor or indexed slices inputs if not all isinstance x ops tensor ops indexedslices for x in inputs raise valueerror inputs must be a list of at least one tensor indexedslices with the same dtype and shape raise valueerror inputs must be a list of at least one tensor indexedslices with the same dtype and shape if len inputs 1 if isinstance inputs 0 ops indexedslices ,fixed line too long error , fix a bug in the docstring of the test case piperorigin revid
2516,tensorflow dir os environ 'tensorflow src root' setup cross compiling target os environ get 'tensorflow target' none if target 'rpi' os environ 'cxx' 'arm linux gnueabihf g ' os environ 'cc' 'arm linux gnueabihf gcc' os environ 'cxx' 'arm rpi linux gnueabihf g ' os environ 'cc' 'arm rpi linux gnueabihf gcc' elif target 'aarch64' os environ 'cxx' 'aarch64 linux gnu g ' os environ 'cc' 'aarch64 linux gnu gcc' ,switch raspberry pi building to unofficial gcc toolchain piperorigin revid , fix a bug in the file file
2517,namespace tfdevice namespace constexpr char kxlaoutsidecompilationattr xla outside compilation constexpr char allow soft placement this pass marks unsupported ops in a device cluster with xla outside compilation attribute so the operations will run on the host void markopsforoutsidecompilation runonoperation module getcontext supported ops auto result module walk tf device clusterop cluster only if allow soft placement attribute is true should we mark ops for outside compilation auto soft placement attr cluster getattroftype boolattr if soft placement attr soft placement attr getvalue return walkresult advance if failed markuncompilableops tf dialect cluster getbody supported ops return walkresult interrupt ,only mark ops for outside compilation if allow soft placement attribute on cluster is true piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id id icdbedfedfabfbedfcaada
2518,status iremitter handlereducewindow hloinstruction reduce window hlocomputation function reduce window to apply tf return if error elementtypessameandsupported instruction reduce window operands operand supported types f32 bf16 supported types f32 bf16 s32 todo b 31410564 implement dilation for reduce window if window util hasdilation window ,tf xla cpu enable s reduce window piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2519,namespace see documentation in ops dataset ops cc for a high level description of the following op todo b make coordination between the performance model and this transformation more robust class mapandbatchdatasetop public unarydatasetopkernel public explicit mapandbatchdatasetop opkernelconstruction ctx ,tf data referencing an internal issue piperorigin revid , fix a bug in the test case piperorigin revid
2520,class progbar object self dynamic display hasattr sys stdout and sys stdout isatty or in sys modules or 'posix' in sys modules 'posix' in sys modules or in os environ self total width 0 self seen so far 0 we use a dict list to avoid garbage collection ,fix dynamic display for , fix a bug in the docstring of the docstring of the docstring change
2521,from tensorflow contrib keras python keras import optimizers from tensorflow contrib keras python keras engine import topology from tensorflow contrib keras python keras engine topology import input from tensorflow contrib keras python keras engine topology import layer from tensorflow contrib keras python keras engine topology import from tensorflow contrib keras python keras engine training import model from tensorflow contrib keras python keras utils io utils import ask to proceed with overwrite from tensorflow python framework import ops class sequential model multiple output tensors or is already connected somewhere else forbidden in sequential models if not isinstance layer layer if not isinstance layer layer raise typeerror 'the added layer must be ' 'an instance of class layer ' 'found ' str layer ,make it possible to use layers from tf layers directly in a keras model it is largely a tiny refactor one addition to the public api add method count params to base layer class which allows us to use the model summary method with models built with core layers piperorigin revid , tf data optimizer to use the tf data strategy piperorigin revid
2522,shape shape const shapeproto shape proto instead of a constructor if shape proto dimensions size shape proto is dynamic dimension size log error malformed shape proto number of is dynamic dimension fields does not match number of dimension fields if shape proto is dynamic dimension size 0 log error malformed shape proto number of is dynamic dimension fields does not match number of dimension fields else log warning malformed shape proto is dynamic dimension is empty int64 num dynamic dimension fields std min shape proto dimensions size shape proto is dynamic dimension size ,xla make not having is dynamic dimensions a warning rather than an error since we currently don't require this field and accept protos that don't have it it's probably better not to spam the error logs if the field is empty piperorigin revid , xla gpu support for the layout inference piperorigin revid change id idaceccfcbacfece
2523,void infoaboutunusedcpufeatures endif else of if defined msc ver defined clang if missing instructions empty log info your cpu supports instructions that this tensorflow ifndef intel mkl binary was not compiled to use missing instructions else binary was not compiled to use missing instructions when tensorflow is compiled with support for these instructions performance can improve however because this version of tensorflow has been compiled with support for intel r mkl dnn which supports just in time compilation many performance critical codepaths will use these instructions even though tensorflow was compiled without explicit support them see https github com intel mkl dnn issues 3 endif ,this pr the unused cpu instruction warning when tensorflow is built with support for intel r mkl dnn many have about this warning because they don't understand that mkl dnn has support for jit compilation that detects cpu features at runtime , fix a bug in the parser test piperorigin revid
2524,strategies strategy combinations mirrored strategy with two gpus named strategies collections ordereddict named strategies none none named strategies collections ordereddict none none str s s for s in strategies for strategy in strategies named strategies str strategy strategy class maybedistributionscope object staticmethod def from name name return maybedistributionscope named strategies name strategy if name else none def init self distribution self distribution distribution self scope none def enter self if self distribution self scope self distribution scope self scope enter def exit self exc type value traceback if self distribution self scope exit exc type value traceback self scope none ,refactor integration tests saved model test piperorigin revid , update keras layers to keras layers piperorigin revid
2525,class bfloat16propagation public hlopassinterface are subject to further adjustment then finally applied to the hlos this avoids setting changed to true but all changes are reverted during adjustment struct int64 operator const shapeindex index const int64 hash 0 for int64 i index hash tensorflow hash64combine hash std hash int64 i return hash for each hloinstruction changes to bf16 stores the affected buffers in the output as a map from in place pointers to to shape indices tensorflow gtl flatmap hloinstruction tensorflow gtl flatset shapeindex tensorflow gtl flatmap shape shapeindex changes to bf16 whether the last processed hlo module has been changed by this pass ,xla use pointers as map keys in using simple keys is more efficient piperorigin revid , xla gpu support for the hlo client piperorigin revid change id icabdabcccecababba
2526,boost auto test case test main ifdef test float test accuracy 0 0f float test float test big df 0 f float endif ifdef test double test accuracy 0 0 double test double test big df 0 double test ignore policy 0 0 endif ifndef boost math no long double math functions ifdef test ldouble boost auto test case test main endif endif test ignore policy 0 0 test big df 0 f float test big df 0 double boost auto test case test main ,non central t reorganize tests a little , fix a bug in the parser test piperorigin revid
2527,class directsession public session std vector device devices not owned deviceset device set unique session identifier string session handle mutex graph state lock bool graph created guarded by graph state lock false ,make session handle of directsession an unique identifier and accessible from pre placement pass piperorigin revid , fix a bug in the graph piperorigin revid
2528,status converter renameandmarkoutputtensors todo tmorris remove this work around once we use in convertidentity if tensorflow str util startswith tensor getname koutputphname using shuffle layer for identity by not setting reshape or transpose nvinfer1 ishufflelayer layer network addshuffle tensor tftrt return error if nullptr layer strcat output copy for tensor getname ,explain usage of shuffle layer , add a test for the test case piperorigin revid
2529,class public allocatorfactory return new basiccpuallocator numa node processstate singleton processstate singleton register mem allocator 101 static void rdmamgr regmemallocator vlog 1 register rdma capable allocator when using grpc verbs register mem allocator 101 void rdmamgr initallocators static std once flag flag ,move register mem allocator to construction , xla gpu support for the hlo client piperorigin revid change id idacdededdbdcfbcdb
2530,statusor std unique ptr executable cpucompiler runbackend and reduced memory usage as compared to using tf assign or return sequentialhloordering hlomodulesequence module sequence creatememoryminimizingsequence module buffersizebytesfunction creatememoryminimizingsequence module buffersizebytesfunction dfsmemoryscheduler run buffer analysis on the hlo graph this analysis figures out which temporary buffers are required to run the computation ,xla make post order a possible schedule as it sometimes uses less memory than the dfs or list scheduler and it is very simple piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2531,static char features static int included patches add new patch number below this line 1021 1020 ,updated for version problem new regexp engine does not ignore order of composing chars solution ignore composing chars order , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2532,class binaryopstest xlatestcase np array 10 7 2 dtype np float32 np float32 7 expected np array false false true dtype np bool self testbinary less op np array 10 7 2 1 dtype np int64 np int64 7 expected np array false false true true dtype np bool if np int64 in self numeric types self testbinary less op np array 10 7 2 1 dtype np int64 np int64 7 expected np array false false true true dtype np bool for less equal op in math ops less equal lambda x y x y self testbinary ,don't do int tests for devices which do not support int , xla gpu support for the xla client piperorigin revid
2533,class jsgenerator public basegenerator if it enum def vals vec begin code ' n' gendoccomment ev doc comment code ptr generate mapping between enumname int code ev name code lang language idloptions kts code numtostring ev value if lang language idloptions kjs in pure javascript generate mapping between int so enums can be looked up by their id code code numtostring ev value code lang language idloptions kts code ' ev name ' code it 1 enum def vals vec end n n if ev union type struct def ,in javascript generate bidirectional mappings for enums between name value and between value name , fix a bug in the parser test piperorigin revid
2534,class asttocfgtest test testcase def test class definition empty self def test fn a b class c a b pass return c graph self build cfg test fn values self assertgraphmatches graph 'a b' 'class c' 'return c' 'class c' 'return c' none def test class definition with members self def test fn a b class c a b d 1 return c graph self build cfg test fn values self assertgraphmatches graph 'a b' 'class c' 'return c' 'class c' 'return c' none if name ' main ' test main ,allow local class definitions piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2535,def assert element shape expected shapes flatten tensors nest flatten elements flatten shapes nest flatten expected shapes checked tensors with shape shape tensor with shape shape tensor if shape else tensor overview unknown shape for shape tensor in zip flatten shapes flatten tensors return nest pack sequence as elements checked tensors ,bug fix for partial shape , tf data dataset dataset to be a single dataset piperorigin revid
2536,class mklconvop public opkernel tensorflow format to mkl format by caching the filter when it is converted for the first time this cached filter can then be reused in subsequent iterations bool do cache filter src dims mkldnndims dim n ksmallbatchsize true false bool do cache filter src dims mkldnndims dim n ksmallbatchsize if is filter const do cache filter if context cache filter if it is not already cached ,intel mkl minor change remove redundant statement , fix a bug in the new delegate test piperorigin revid
2537,test matchercasttest fromsametype expect false m2 matches 1 implicitly convertible form any type implicitly convertible from any type struct convertiblefromany convertiblefromany int a value value a value template typename t convertiblefromany const t a value value 1 convertiblefromany const t a value value 1 add failure conversion constructor called int value ,generate matchers eq lt etc with crtp instead of macro , xla python fix a bug in the test case piperorigin revid
2538,buf spname buf t buf if defined feat quickfix if bt quickfix buf win t win tabpage t tp for location list window w llist ref points to the location list for quickfix window w llist ref is null differentiate between the quickfix and location list buffers using the buffer number stored in the global quickfix stack if find win for buf buf win tp ok win w llist ref null return char u msg loclist else if buf b fnum qf stack get bufnr return char u msg qflist else return char u msg loclist endif ,patch new buffer used every time the quickfix window is opened problem new buffer used every time the quickfix window is opened solution reuse the buffer yegappan lakshmanan closes , patch problem when using a terminal window is a bit slow solution add a test for the command line
2539,void tflitetensorfree tflitetensor t if t dims tfliteintarrayfree t dims t dims null if t dims signature tfliteintarrayfree tfliteintarray t dims signature t dims signature null tflitequantizationfree t quantization tflitesparsityfree t sparsity t sparsity null ,add support for unknown dimensions to tflite using mlir converter piperorigin revid change id , xla gpu support for the layout of the layout is a bit piperorigin revid change id id iadfecdeabccbcb
2540,tensorflow status gathercomputationsbyallocationtype static statusor std unique ptr bufferassignment bufferassigner run const hlomodule module std unique ptr hloordering hlo ordering buffer size bool colocate related buffers logicalbuffer sizefunction buffer size bool colocate related buffers const std vector const hloinstruction hlos to allocate bufferassigner assigner std move buffer size colocate related buffers return assigner createassignment module std move hlo ordering statusor std unique ptr bufferassignment bufferassigner createassignment root shape this output size root assignment const shape subshape const shapeindex index const auto allocations assignment getallocations root index if allocations size 0 if allocations empty output size allocations begin size return tensorflow status ok ,break out classes into separate files add which constructs a sequence of the instructions in an hlo module that the total size of live buffers containing hlo outputs change , xla python add a test for the xla client client piperorigin revid
2541,void check parent pid void parent check time 10 if getppid mainpid if getppid shm mainpid return pid getpid void check parent pid void fixme add locking so only one child does this output output 0 bugtxt child pid d got reparented parent pid d watchdog pid d n pid mainpid watchdog pid pid shm mainpid watchdog pid output 0 bugtxt last syscalls n for i 0 i max nr children i ,move mainpid into the shm watchdog needs to read it and we forked off the watchdog before we set mainpid this meant we were doing kill in check main alive , fix a bug in the watchdog process
2542,static file find logfile handle void return null unsigned int highest logfile void file file int ret if logging false return 0 file shm logfiles shm max children 1 ret fileno file return ret void synclogs void unsigned int i ,factor out the routine to calculate the fileno of the last logfile , patch problem when the popup window doesn't work properly solution add the option to the right line
2543,class bfcallocator public allocator returns 'bytes' rounded up to the next highest kminallocationsize size t roundedbytes size t bytes static size t roundedbytes size t bytes try to add a new memory region that can satisfy an allocation of bytes' bytes returns true on success and false on ,allow setting a global override for the allow growth gpu option via the tf force gpu allow growth environment variable piperorigin revid , xla gpu support for the xla client client piperorigin revid
2544,class argop public opkernel int axis dim 0 dim input dims dim op requires context axis 0 axis input dims op requires context fastboundscheck axis input dims errors invalidargument expected dimension in the range input dims input dims but got dim ,use fastboundscheck in argmax kernel op this fix updates argmax kernel implementation to use fastboundscheck for improved performance and keep consistency with other places in tf signed off by yong tang yong tang github outlook com , fix a bug in the test case piperorigin revid
2545,namespace aux hkey if res error success boost log throw descr system error could not create registry key for the event log boost log throw descr params system error could not create registry key for the event log res auto hkey close hkey guard hkey ,moved queue overflow policy handling to the ipc queue compilation fixes , fix a bug in the previous commit piperorigin revid
2546,constexpr char debug mode constexpr char kdelegateflag delegate constexpr char knnapidelegate nnapi constexpr char kgpudelegate gpu constexpr char hexagon std string const std string str int pos str find last of bool evaluatemodel const std string model file path inference params set delegate tfliteinferenceparams nnapi else if delegate kgpudelegate inference params set delegate tfliteinferenceparams gpu else if delegate inference params set delegate tfliteinferenceparams hexagon get ground truth data ,adds support for hexagon delegate in task based accuracy scripts piperorigin revid change id , fix a bug in the new delegate piperorigin revid
2547,limitations under the license endif include windows h include winsock2 h pragma comment lib ws2 32 lib include tensorflow core platform cpu info h include tensorflow core platform demangle h ,remove conflict include statments in port cc , xla python fix a bug in the client client piperorigin revid change id icbbdbfafcdfcae
2548,class statsdatasettestbase test testcase self assertequal expected value value histo sum return self fail expected tag r not found in summary r tag summary proto def self summary str tag expected value summary proto summary pb2 summary summary proto parsefromstring summary str for value in summary proto value if tag value tag self assertequal expected value value simple value return self fail expected tag r not found in summary r tag summary proto ,data stats adds number of filtered elements as scalar summary also adds number of filtered elements to monitoring counter piperorigin revid , tf data saveable shape for tf data dataset piperorigin revid
2549,class mkldequantizeop public opkernel output mkl shape settflayout src mkl shape getdimension src mkl shape getsizesasmkldnndims src mkl shape gettfdataformat output tf shape adddim dst pd get size sizeof float 1 output tf shape adddim dst pd get size sizeof float else output mkl shape setmkltensor false output tf shape output dims ,adding a fix based on code review , fix a bug in the test case piperorigin revid
2550,f winrestview typval t argvars typval t rettv unused check cursor win new height curwin curwin w height win new width curwin w width curwin win new width curwin curwin w width changed window setting if curwin w topline 0 ,patch w width is always the same problem w width is always the same solution expand the macro , patch problem when using a popup window with a terminal window solution add the option to the list of the buffer
2551,t based on cudnn h the following is not implemented case cudnn convolution bwd filter algo winograd case cudnn convolution bwd filter algo winograd nonfused case cudnn convolution bwd filter algo fft tiling return algo produces incorrect results for some shapes disabled for now see nvidia bug todo csigg only disable for subset of shapes case cudnn convolution bwd filter algo fft tiling default log fatal unsupported cudnn convolution backward algorithm for filter ,fix switch statement for cudnn convolution bwd filter algo fft tiling piperorigin revid change id , patch problem when using a terminal window is a bit solution add a few more tests to the new code
2552,static char features static int included patches add new patch number below this line 952 951 ,patch problem is tested in the old way solution make a new style test for , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2553,void loopinvariantcodemotion runonaffineforop affineforop forop definition closure following the loop induction variable forop for auto i llvm debug i print llvm dbgs dependent op n llvm debug for auto i i print llvm dbgs dependent op n for auto op loopbody if the operation is loop invariant insert it into void loopinvariantcodemotion runonfunction affineforop forop forops push back forop we gather loops first and then go over them later because we don't want to mess the iterators up for auto forop forops auto forinst forop getoperation llvm debug forinst print llvm dbgs loop n runonaffineforop forop for auto op forops llvm debug op getoperation print llvm dbgs loop n runonaffineforop op ,fix llvm debug instances piperorigin revid , xla gpu support for the hlo client piperorigin revid change id iaaffafbceeeafc
2554,void const tensorinfo tensor info tensor names insert coo sparse values tensor name tensor names insert coo sparse indices tensor name tensor names insert coo sparse dense shape tensor name else if tensor info has composite tensor for const auto component tensor info composite tensor components tensor names insert component name else tensor names insert tensor info name ,update the tensorinfo protobuf message with an encoding for composite tensors and update savedmodel to use this new encoding piperorigin revid , add a test for the tf data service piperorigin revid
2555,class tpumirroredvariable mirroredvariable handle id is needed for get replicated var handle to cache the variables correctly since in eager mode different variables can have the same name if context executing eagerly if ops executing eagerly outside functions self handle id self common name str id self primary else self handle id self common name ,fix a bug in tpumirroredvariable that variable handle ids may collide if variables are created inside tf function but outside is eager mode piperorigin revid , tf data saveable dataset to be used by default piperorigin revid
2556,int dpierror getinfo dpierror error dpierrorinfo info info break default if error buffer code 0 error buffer errornum 0 if error buffer code 0 error buffer errornum dpierrornum 0 info 00000 else info break ,eliminate warnings from static analysis tool , fix for the build failure
2557,class public buckets namespace static std unique ptr buckets buckets explicit std vector double bucket limits return std unique ptr buckets new std move bucket limits static std unique ptr buckets buckets explicit std initializer list double bucket limits ,small change to piperorigin revid , xla gpu support for the hlo client client piperorigin revid change id idfcceffddcfacee
2558,def conv2d tensor in strides a list of ints 1 d of length 4 the stride of the sliding window for each dimension of input padding a string 'same' or 'valid' the type of padding to use see the comment here https www tensorflow org api docs python nn html convolution bias boolean if to add bias activation activation op optional if provided applied on the output batch norm whether to apply batch normalization ,updated docstrings to link to descriptions of padding algorithms updated docstrings to link to descriptions of padding algorithms updated padding docstrings to link to padding discussion , tf data dataset dataset to tf data dataset piperorigin revid
2559,class projectyamlchecker valid section names 'architectures' 'auto ccs' 'builds per day' 'coverage extra args' 'disabled' 'fuzzing engines' url' 'homepage' 'language' 'labels' for internal use only hard to lint as it uses fuzzer names 'primary contact' 'sanitizers' 'selective unpack' 'vendor ccs' 'view restrictions' 'language' url' 'labels' for internal use only hard to lint as it uses fuzzer names 'selective unpack' languages supported ,add builds per day to supported section in project yaml , fix a bug in the test case piperorigin revid
2560,status bufferedinputstream fillbuffer return s status bufferedinputstream readline string result status bufferedinputstream string result bool include eol result clear status s while true status bufferedinputstream readline string result char c buf pos if c ' n' we don't append the ' n' to result if include eol result c return status ok we don't append ' r' to result int64 bufferedinputstream tell const return input stream tell limit pos status bufferedinputstream readline string result return result false string bufferedinputstream string result result true return result namespace io namespace tensorflow ,creating a fileio object and an iterator interface for file reading also extended the bufferedinputstream interface to add that reads the file line by line along with the n at the end change , xla gpu support for the layout inference piperorigin revid change id ibadadadacbbbef
2561,def function func none in general it is recommended to create stateful objects like tf variable outside of tf function and passing them as arguments using type annotations to improve performance 'experimental follow type hints can be used along with type annotations to improve performance by reducing the number of expensive graph for example an argument annotated with tf tensor is converted to tensor even when the input is a non tensor value tf function experimental follow type hints true def f x tf tensor print ' tf print 'executing' f 1 tracing executing f 2 executing args func the function to be compiled if func is none tf function returns a decorator that can be invoked with a single argument func in other ,add a code example for tf function update release md , fix a bug in the docstring of the documentation of the documentation of the tf nn rnn api to the test piperorigin revid
2562,tf call gpu number types declare gpu spec namespace functor registration of the gpu implementations define register one hot gpu index type index type register kernel builder name onehot device device gpu ,add commit that accidentally got removed , add support for int ops piperorigin revid
2563,func varhandleopsharedname value string varhandleopattr varhandleopalloweddevices sets the optional allowed devices attribute to value value the allowed devices containing the resource variable set when the output resourcehandle represents a per replica partitioned resource variable value deprecated the allowed devices containing the resource variable set when the output resourcehandle represents a per replica partitioned resource variable if not specified defaults to func varhandleopalloweddevices value string varhandleopattr return func m optionalattr ,go update generated wrapper functions for tensorflow ops piperorigin revid change id , fix a bug in the test case piperorigin revid
2564,void generate filelist void if victim path null open fds victim path open fds dev open fds proc open fds sys else open fds dev open fds proc open fds sys if shm exit reason still running return ,make victim files be exclusive don't worry about gathering fd's from other places , fix a bug in the watchdog page
2565,static char features static int included patches add new patch number below this line 1218 ,updated for version problem no test for using inside solution add a test , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2566,def get python path environ cp python bin path if environ cp get python paths environ cp get split ' ' try stderr open os devnull 'wb' library paths run shell python bin path ' c' 'import site print n join site getsitepackages ' split ' n' stderr stderr split ' n' except subprocess calledprocesserror library paths run shell ,move stderr to dev null get python path in configure py to prevent python traceback when run site , fix a bug in the docstring of the docstring of the docstring change
2567,include linux if ether h include stdlib h include net h include maps h page rand include random h include utils h array size include compat h static const unsigned int packet opts void packet setsockopt struct sockopt so unsigned char val char optval so level sol packet optval char so optval val rand nr sol packet opts so optname packet opts val adjust length according to operation set switch so optname case packet version page rand 0 rand 3 tpacket versions 1 2 3 optval 0 rand 3 tpacket versions 1 2 3 break case packet tx ring ,convert packet setsockopt to use passed down optval instead of page rand , move the syscall page to the syscall process
2568,class optimizerv2 trackable trackable def create hypers self if self hypers created return for name value in self hyper items iterate hyper values deterministically for name value in sorted self hyper items if isinstance value ops tensor or callable value continue else ,make hyper variable creation deterministic across threads piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
2569,class posixenv public env std function void fn override return new thread options name fn void schedclosure std function void closure override todo mrry replace with a threadpool check false posixenv schedclosure not implemented void int micros std function void closure override todo mrry replace with a non blocking timer mechanism and threadpool check false posixenv not implemented namespace ,add non functional stubs for a closure executor to tensorflow env change , xla python fix a bug in the test piperorigin revid
2570,directsession runstate runstate void directsession waitfornotification runstate run state int64 timeout in ms if timeout in ms 0 bool timed out run state executors done waitfornotificationwithtimeout timeout in ms if timed out bool notified waitfornotificationwithtimeout run state executors done timeout in ms if notified mutex lock l run state mu run state status update status error deadline exceeded ,fix a lost bug in notification if the notification was set before waiting the would never wake up added a test to cover this case fixes change , fix a bug in the test case piperorigin revid
2571,static void sighandler int sig shm fd lifetime 0 todo somehow mark the fd in the parent not to be used again too nothing we can do just bail exit exit success re arm the alarm ,jump back to child after getting sigalrm this should work better now so we should be able to jump directly back into the same child and just do a different syscall , fix a bug in the watchdog page
2572,class uniquedataset dataset ops unaryunchangedstructuredataset def init self input dataset self input dataset input dataset if input dataset output types not in dtypes int32 dtypes int64 dtypes string if dataset ops get legacy output types input dataset not in dtypes int32 dtypes int64 dtypes string raise typeerror tf data experimental unique only supports inputs with a single tf int32 tf int64 or tf string component ,gets experimental dataset tests running in tf nightlies by replacing dataset output types with the internal legacy method piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2573,public returns affine map for the lower bound affinemap return getattr getlowerboundattrname cast affinemapattr getvalue affinemap return getvalue affinemapattr return getattr getlowerboundattrname cast affinemapattr returns affine map for the upper bound the upper bound is exclusive affinemap return getattr cast affinemapattr getvalue affinemap return getvalue affinemapattr return getattr cast affinemapattr set lower bound the new bound must have the same number of operands as ,remove the ability to directly print affine structures from the opasmprinter these should go through attributes like most everything else piperorigin revid , xla gpu support for the hlo parser piperorigin revid change id icabdabcccecababba
2574,status basegpudevice maketensorfromproto const tensorproto tensor proto void basegpudevice const tensor input tensor tensor output tensor const devicecontext device context statuscallback done gpuutil static cast device this device context input tensor output tensor std move done namespace class concreteperopgpudevice public peropgpudevice public ,add a function in devicebase to deep copy on the device this change adds support for a cpu and gpu deep copy function accessible from the devicebase class other devices are not supported for now this new functionality is intended for tensorflow internal runtime use only piperorigin revid , xla gpu support for the same dimension of the input piperorigin revid
2575,see the license for the specific language governing permissions and limitations under the license include tensorflow core lib random random h include tensorflow core platform random h include random include tensorflow core platform mutex h ,move core lib random random to core platform piperorigin revid change id , add a test for the new op op piperorigin revid
2576,tflitestatus modifymodelinterface const string input file absl make unique flatbuffers flatbufferbuilder flatbuffers flatbufferbuilder builder tflite tensortype input override type tflite tensortype output override type switch input type case tflite tensortype uint8 case tflite tensortype int8 case tflite tensortype int16 input override type input type break default return ktfliteerror switch output type case tflite tensortype uint8 case tflite tensortype int8 case tflite tensortype int16 output override type output type break default return ktfliteerror auto status modifymodelinterface builder tflite model get input override type output override type input type output type tflite dcheck eq status ktfliteok writefile output file builder getbufferpointer builder getsize ,removed unnecessary override type , add support for int ops piperorigin revid
2577,class astcodeupgrader object text processing file r n outputting to r n in filename out filename text 80 n n text n join log text n join log n text 80 n n return text ,add missing new line before a separator , fix a bug in the docstring of the documentation of the tf data dataset to the new api piperorigin revid change id iadcfbaadfdbaa
2578,static void regenerate shm regenerate 0 output d regenerating random pages fd's etc n getpid regenerate fds static void regenerate destroy maps setup maps shm regenerate regeneration point 1 regenerate random page void main loop pid t pid if shm regenerate regenerate fflush stdout pid fork if pid 0 void main loop while shm exit now false fork children handle children if shm regenerate regeneration point regenerate output regenerate d n shm regenerate printf d bailing main loop n getpid ,reverse how the regeneration counts also move it to the right place main loop instead of just on init , make the syscall page we can be a bit more than the syscall process
2579,extern c int llvmfuzzertestoneinput const uint8 t buf size t len struct archive entry entry while archive read next header a entry archive ok while r archive read data a data buffer data data buffer size 0 data buffer size 0 if r archive fatal break ,libarchive fix wrongly placed parentheses in , fix a bug in the new module of the new module of the new module and the new module is not used in the new class class and the new class class and the new class is not used in the new class class and the new class class and the new class
2580,status quantizenodes const graphdef input graph def keep interoperability with float ops tf return if error graph def context output graph def tf return if error merged graph def tf return if error output graph def return status ok ,corrected which graph def to validate corrected which graph def to validate after each transformation comes a check for validity merged graph def was already tested a few lines above output graph def should be tested directly afterwards update quantize nodes cc , add a test for the graph and the graph piperorigin revid
2581,class mkllayoutrewritepass public graphoptimizationpass add rules to fuse sequences such as transpose nchw nhwc conv2d nhwc transpose nhwc nchw into conv2d nchw such patterns occur frequently in keras note we use the term merge is to combine exactly 2 nodes into one note we use the term merge to combine exactly 2 nodes into one while fusion is for 3 nodes situation ,fix a grammatically incorrect in comments co authored by wenxizhu wenxi zhu intel com , fix a bug in the delegate of the delegate to the delegate piperorigin revid
2582,class variable object returns a tensor which holds the value of the variable you can not assign a new value to this tensor as it is not a reference to the variable see ref variable ref if you want to get a reference to the variable to avoid copies if the consumer of the returned value is on the same device as the variable this actually returns the live value of the variable not ,comment fix change , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
2583,void sycldevicecontext copycputensortodevice const tensor cpu tensor assert false unsupported type device eigen sycl device synchronize done status ok ,synchronize the cpu to gpu copies this prevents tf from releasing the cpu memory while the copy is still going on , fix a bug in the new version of the client client client piperorigin revid
2584,syn cmd sync eap syncing else if strcmp key 0 if next arg nul missing pattern illegal true break if curwin w s b syn pat null emsg syntax sync line continuations pattern specified twice ,patch problem illegal memory access solution check for missing pattern dominique pelle , patch problem when using a terminal window is a bit slow solution add a test for the command line
2585,limitations under the license namespace xla his pass should run early in the hlo pipeline and checks for hlo constructs this pass should run early in the hlo pipeline and checks for hlo constructs which are not supported by the gpu backend and cannot be removed via hlo transformations eg sparse layouts class gpuhlosupportchecker public hlomodulepass ,fix typo in gpu hlo support checker h , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2586,tensorflow kernels and ops for computing a masked matrix product include algorithm include numeric include vector include tensorflow core framework op h ,windows cmake enable tf contrib factorization adds missing kernel to the cmake build adds trivial shape functions for tf contrib factorization ops enable testing for tf contrib factorization in the cmake build fixes change , tf data service support for tf data dataset piperorigin revid
2587,static char features static int included patches add new patch number below this line 1101 1100 ,updated for version problem configure doesn't find python on ubuntu solution first try distutils sysconfig also fix some indents ken takata , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2588,from future import print function import numpy as np from tensorflow python framework import dtypes from tensorflow python framework import errors impl from tensorflow python framework import test util from tensorflow python framework import constant op from tensorflow python ops import array ops class binvaluesfixedwidth test testcase self assertequal dtypes int32 bins dtype self assertallclose expected bins self evaluate bins def test range overlap self github issue 29661 value range np float32 0 0 0 0 values np float32 1 0 0 0 1 5 2 0 5 0 15 expected bins 0 0 4 4 4 4 with self assertraises errors impl invalidargumenterror with self cached session histogram ops histogram fixed width bins values value range nbins 5 class histogramfixedwidthtest test testcase ,add test case for exception handling in tf histogram fixed width bins signed off by yong tang yong tang github outlook com , fix a bug in the test case piperorigin revid
2589,uc add command if cmp 0 if force command can be replaced with command and when sourcing the same script again but only once if force cmd uc script ctx sc sid current sctx sc sid cmd uc script ctx sc seq current sctx sc seq emsg command already exists add to replace it emsg2 command already exists add to replace it s name goto fail ,patch cannot redefine user command without in same script problem cannot redefine user command without in same script solution allow redefining user command without in same script like with functions , patch problem when using a terminal window is a bit slow solution add a test for the command line
2590,static char features static int included patches add new patch number below this line 1637 1636 ,patch no test for term dumpdiff options argument problem no test for term dumpdiff options argument solution add a test , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2591,ifdef use if alg include linux if alg h static const char hashes md5 sha1 void alg gen sockaddr struct sockaddr addr socklen t addrlen struct sockaddr alg alg unsigned int i unsigned int i type const char types aead hash rng skcipher alg zmalloc sizeof struct sockaddr alg alg salg family pf alg for i 0 i 14 i alg salg type i rand type rand 4 strncpy char alg salg type types type strlen types type switch type case 0 break case 1 i rand array size hashes strncpy char alg salg name hashes i strlen hashes i break case 2 break case 3 break alg salg feat rand alg salg mask rand for i 0 i 64 i alg salg name i rand addr struct sockaddr alg addrlen sizeof struct sockaddr alg ,bare beginnings of proper proto alg sockaddr generation obviously lots more to do here for a start adding in all the other algorithms , fix a bunch of the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
2592,static graph bm resize const char algorithm int batches int width benchmark bm resize algorithm device b w h bm resizedev cpu resizenearestneighbor 10 499 499 bm resizedev gpu resizenearestneighbor 10 499 499 bm resizedev cpu resizebilinear 10 499 499 if google cuda bm resizedev gpu resizenearestneighbor 10 499 499 bm resizedev gpu resizebilinear 10 499 499 endif namespace tensorflow ,parallel implementation of the resize nearest neighbor op , add a test for the graph and the graph and the graph is not enabled piperorigin revid
2593,test f to it rows 4 cols 4 r check not constant global 0 external constant 16 x float align 8 check 0 private constant 16 x float align 8 check 0 private constant 64 x i8 align 8 namespace ,use i as type for the it turns out this is faster to compile because llvm handles it specially piperorigin revid , xla gpu support for the same dimension of the same dimension piperorigin revid
2594,status grpcserver init const grpcserveroptions opts builder setmaxmessagesize std numeric limits int32 max bool reuse port false readboolfromenvvar tf grpc reuse port false reuse port ignoreerror const status status readboolfromenvvar tf grpc reuse port false reuse port if status ok log error status error message auto server build option reuse port std unique ptr grpc serverbuilderoption new std unique ptr grpc serverbuilderoption new noreuseportoption ,check return status of reading environment variable , fix a bug in the test case piperorigin revid
2595,struct adjointbatchfunctor typename ttypes scalar 3 tensor output template typename device typename scalar struct we assume that the tensor sizes are correct void operator const device device typename ttypes scalar constvec input typename ttypes scalar vec output helper functor to compute the product of diagonal elements in all matrices in a flattened batch template typename device typename scalar ,split self adjoint eig v op cc according to type to speed up build small cleanup in qr op impl h get rid of redundant functor in cuda solvers piperorigin revid , fix a bug in the new delegate piperorigin revid
2596,class deprecatedendpointstest test testcase self assertequal foo1 foo2 foo tf deprecated api names def testcannotsetdeprecatedendpointstwice self with self assertraises deprecation deprecatednamesalreadyseterror with self assertraises deprecation deprecatednamesalreadyset deprecation deprecated endpoints foo1 deprecation deprecated endpoints foo2 def foo pylint disable unused variable ,automated rollback of commit piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2597,from tensorflow python framework import tensor spec from tensorflow python ops import resource variable ops from tensorflow python ops import tensor array ops from tensorflow python ops ragged import ragged tensor from tensorflow python ops ragged import row partition from tensorflow python util import compat from tensorflow python util compat import collections abc class object values struct pb2 variable spec resource variable ops variablespec struct pb2 row partition spec row partition mapping from type typespec subclass to enum value ,add support for to struct proto this makes it possible to include in savedmodels piperorigin revid change id , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2598,class tflitedriver public testrunner bool checkresults override string readoutput int id override void setthreshold double relative threshold double absolute threshold void int quantization error multiplier protected interpreter tflitedelegateptr delegate class tflitedriver public testrunner std map int tflitetensor tensors to deallocate double relative threshold double absolute threshold int quantization error multiplier namespace testing ,better quantized op tests piperorigin revid change id , xla python fix a bug in the test piperorigin revid
2599,class cputransfermanager public generictransfermanager const shape literal shape mutableborrowingliteral literal override bool canshapedbufferbeaccessednow se streamexecutor executor const shapedbuffer device buffer const override return true private status transferbuffertoinfeed se streamexecutor executor int64 size const void source ,make the xla reflect the fact that the allocator is synchronous and buffers can be accessed immediately piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idfbdfbcdacfbeebb
2600,from tensorflow python keras layers advanced activations import softmax from tensorflow python keras layers convolutional import conv1d from tensorflow python keras layers convolutional import conv2d from tensorflow python keras layers convolutional import conv3d from tensorflow python keras layers convolutional import conv1dtranspose from tensorflow python keras layers convolutional import conv2dtranspose from tensorflow python keras layers convolutional import conv3dtranspose from tensorflow python keras layers convolutional import separableconv1d ,support convdtranspose for keras fixing https github com tensorflow tensorflow issues piperorigin revid change id , update keras layers to keras piperorigin revid
2601,static char features static int included patches add new patch number below this line 128 127 ,updated for version problem perl for msvc doesn't work solution add check in makefile and define inline ken takata , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2602,std unordered set string grappleritem nodestopreserve const tensorflow functions do not prune stateful or dataset output ops from the function body see prunefunctionbody in common runtime function cc we also keep placeholders in the functions body because it's a bug to have placeholders inside functions and we want to catch such invalid graphs early if optimization options is function instantiation if optimization options allow pruning stateful and dataset ops functionlibrarydefinition fn library opregistry global graph library for const nodedef node graph node if isstateful node fn library isdataset node isplaceholder node if isstateful node fn library isdataset node result insert node name ,grappler prune stateful and dataset ops in tf functions piperorigin revid , add a test for the graph and the graph piperorigin revid
2603,msg add lines p ' ' if shortmess shm lines vim snprintf char p iosize p iobuff ldl lldc lnum varnumber t nchars ldl lnum varnumber t nchars else sprintf char p ngettext ld line ld lines lnum lnum p strlen p vim snprintf char p iosize p iobuff ngettext lld character lld characters nchars ngettext lld byte lld bytes nchars varnumber t nchars ,patch the write message mentions characters but it's bytes problem the write message mentions characters but it's actually bytes solution change c to b and characters to bytes , patch problem when using a terminal window is a bit solution add a few more tests to the new code
2604,wait4pid pid t child waitstatus status if defined feat job defined use system defined proto parse cmd and put the white separated parts in argv argv is an allocated array with argc entries returns fail when out of memory int mch parse cmd char u cmd int use shcf char argv int argc mch stop job job t job char u how sig atoi char how else return fail kill job jv pid sig todo have an option to only kill the process not the group kill job jv pid sig return ok endif ,patch problem job stop only kills the started process solution send the signal to the process group olaf dabrunz , patch problem when using a popup window with a popup window solution add the option to the right position
2605,include boost math special functions math fwd hpp include boost math constants constants hpp include boost array hpp include boost tr1 random hpp include boost random hpp include functor hpp include handle test result hpp void test spots t const char type name sanity consistency checks from numerical computation of real or complex elliptic integrals b c http arxiv org abs math ca std tr1 mt19937 ran std tr1 uniform real float ur 0 1000 boost mt19937 ran boost uniform real float ur 0 1000 t 40 tools epsilon t for unsigned i 0 i 1000 i ,remove all references to tr components update data generators to use boost multiprecision , fix a bug in the new parser test svn r
2606,static void bm feedinputfetchoutput int iters z x y x and y are provided as benchmark inputs z is the output of the benchmark conceptually the caller is a the benchmark is b node x test graph recv g x float a 1 b node y test graph recv g y float a 1 b node x test graph recv g x float alice 1 bob node y test graph recv g y float alice 1 bob node sum test graph add g x y node z test graph send g sum z b 1 a node z test graph send g sum z bob 1 alice tensor val dt float tensorshape val scalar float 3 14 ifdef platform google ,fix runtime failure in executor benchmark piperorigin revid , add a test for the new op api piperorigin revid
2607,from tensorflow python framework import errors impl from tensorflow python framework import importer from tensorflow python framework import ops from tensorflow python framework import random seed from tensorflow python framework import sparse tensor from tensorflow python framework import tensor shape from tensorflow python framework import versions from tensorflow python ops import array ops class tensorflowtestcase googletest testcase return self eval helper tensor else try if sparse tensor is sparse tensor return sparse tensor sparsetensorvalue tensor indices tensor values tensor dense shape return tensor numpy except attributeerror as e six raise from valueerror unsupported type s type tensor e ,support for sparse tensors for test util evaluate piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2608,class test testcase estimator evaluate return value validation outputs monitor learn monitors validationmonitor x constant op constant 2 0 every n steps 0 early stopping rounds 2 x constant op constant 2 0 every n steps 0 early stopping rounds 2 check interval secs none self assert validation monitor monitor monitor set estimator estimator with ops graph as default as g self test session g ,add min check interval secs with s as default to to avoid checking for of a new checkpoint overly frequent that can lead to performance issues on remote filesystems piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the tf nn rnn api piperorigin revid
2609,struct arithmeticparams int input1 shift int32 input2 multiplier int input2 shift int32 combined offset int32 multiplier1 int32 multiplier2 uint8 etc activation params int32 quantized activation min int32 quantized activation max ,optimize elementwise addition op handler piperorigin revid change id , fix a bug in the new delegate piperorigin revid change id id ibebfcffdcbdbdafeb
2610,class dnnlinearcombinedclassifierintegrationtest test testcase feature spec feature column make parse example spec feature columns serving input receiver fn export build parsing serving input receiver fn feature spec export dir estimator export savedmodel tempfile mkdtemp serving input receiver fn export dir estimator export saved model tempfile mkdtemp serving input receiver fn self asserttrue gfile exists export dir def teardown self ,replace calls to export savedmodel with export saved model and remove strip default attr argument piperorigin revid , fix a bug in the docstring of the docstring of the test case piperorigin revid
2611,port status stream blockhostuntildone return first error port status stream blockhostuntildonewithstatus return blockhostuntildone namespace gputools namespace perftools ,remove stream blockhostuntildonewithstatus all callers use blockhostuntildone piperorigin revid , xla python python python python python piperorigin revid
2612,static void parse args int argc char argv case 'c' do specific syscall 1 specificsyscall strtol optarg null 10 if specificsyscall 0 if we get here it wasn't a numeric syscall perhaps someone is passing a syscall name try and match for i 0 i nr syscalls i if strcmp optarg syscalls i name 0 printf found s at d n syscalls i name i specificsyscall i break if i nr syscalls printf unable to parse syscall number n exit 1 break case 'c' ,accept a syscall name as an argument to c , make the syscall process from the syscall process
2613,class xlabuilder void isconstantvisitor const int64 op handle std set int64 visited bool is constant const checks bounds for convolution parameters status verifyconvolution const shape lhs shape const shape rhs shape const convolutiondimensionnumbers dimension numbers const helper function for creating a window proto from user supplied data returns error if the user supplied data was invalid statusor window makewindow tensorflow gtl arrayslice int64 window dimensions tensorflow gtl arrayslice int64 window strides tensorflow gtl arrayslice std pair int64 int64 padding tensorflow gtl arrayslice int64 lhs dilation tensorflow gtl arrayslice int64 rhs dilation const string name name to use for the built computation the first error encountered while building the computation ,xla redesign implement and test conv piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id id icfecdffaddccbded
2614,class integerlookup index lookup indexlookup table based lookup with optional out of vocabulary handling if desired the user can call this layer's adapt method on a data set which will analyze the data set determine the frequency of individual string which will analyze the data set determine the frequency of individual integer values and create a vocabulary from them this vocabulary can have unlimited size or be capped depending on the configuration options for this layer if there are more unique values in the input than the maximum ,fix integer string in integer string lookup docstrings , fix a bug in the docstring of the documentation of the tf data dataset piperorigin revid change id iacabfebaeeadff
2615,struct uniformbuffer desc resize function program program description desc description return absl okstatus struct uniformbuffer return result void const std string description description description end ,moved id and description from task to node id generated automatically simplified signatures removed id from them piperorigin revid change id , fix a bug in the parser test piperorigin revid
2616,bool trtengineop executetrtengine opkernelcontext ctx const cast float input tensor flat float data break case nvinfer1 datatype khalf log error fp16 inputs are not supported yet return kretry buffers binding index const cast eigen half input tensor flat eigen half data break case nvinfer1 datatype kint8 log error int8 inputs are not supported yet return kretry bool trtengineop executetrtengine opkernelcontext ctx const cast float output tensor flat float data break case nvinfer1 datatype khalf log warning half size is not supported yet return kretry buffers binding index const cast eigen half output tensor flat eigen half data break case nvinfer1 datatype kint8 log warning int8 is not supported yet return kretry ,allow fp inputs and outputs remove weight conversions to fp because trt does this automatically , add support for int ops piperorigin revid
2617,static const char single quoted 'single quoted n ' double quoted double quoted n ' test that the variable is correctly test that the variable is parsed correctly test parseflagsfromenv basic prepare environment setenv tf xla flags true overwrite flags in environment variable test that a file named by the variable is correctly test that a file named by the variable is parsed correctly test parseflagsfromenv file environment variables where tmp dir may be specified static const char test tmpdir tmp ,xla add an ' xla reduce precision' option to tf xla flags this also adds testing for the more complicated parsers in debug options flags cc and corrects a couple of comment typos in parse flags from env test cc and in the top of the build file piperorigin revid , patch problem when using a terminal window is a bit slow solution add a test for the gui
2618,from future import print function import numpy as np from tensorflow contrib framework python ops import sort ops from tensorflow python framework import constant op from tensorflow python framework import dtypes from tensorflow python framework import errors from tensorflow python framework import ops from tensorflow python framework import tensor util from tensorflow python ops import array ops from tensorflow python ops import random ops from tensorflow python ops import sort ops from tensorflow python platform import test class test testcase self assertallequal np sort arr axis 0 1 sort ops sort constant op constant arr axis 0 direction eval constant op constant arr axis 0 direction eval def testsort self the transposition array should be a constant if the rank of values is ,copied sort ops py and sort ops test py from contrib framework python ops to python ops and adjusted them piperorigin revid , fix a bug in the test case piperorigin revid
2619,class test testcase def compare self b n k m dtype adjoint a adjoint b np random seed 42 x np random normal 0 1 b n k astype dtype reshape b n k if dtype in np complex64 np complex128 x imag np random normal 0 1 b n k astype dtype reshape b n k y np random normal 0 1 b k m astype dtype reshape b k m if dtype in np complex64 np complex128 y imag np random normal 0 1 b k m astype dtype reshape b k m self x y adjoint a adjoint b ,clean up matmul test suites and make sure that complex tests set the imaginary part fix a bug in test util function assertallcloseaccordingtotype which wasn't picking up the right values for complex change , fix a bug in the docstring of the test case piperorigin revid
2620,std vector cudaversion getsupportedcudacomputecapabilities endif google cuda if tensorflow use rocm std vector int supported amdgpu isa versions 803 900 906 std vector int supported amdgpu isa versions 803 900 906 908 std vector int return supported amdgpu isa versions ,add into supported amd isa version list , xla gpu support for the hlo client piperorigin revid change id iaaffafbceeeafc
2621,class microbenchmarks benchmarks test base microbenchmarksbase self run fn 10000 todo b move to keras when benchmarks are setup def benchmark tf keras flatten overhead self layer core layers flatten x ops convert to tensor 1 layer x warmup call to build layer def fn layer x self run fn 10000 if name main test main ,reduce flatten call eager overhead by most of the gains come from separating out a fast path for eager execution since static shape info is guaranteed to exist in this case piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
2622,bool unittestimpl runalltests if gtest has death test in subprocess for death test internal run death test flag get null if defined gtest extra death test child setup if in subprocess for death test gtest extra death test child setup endif defined gtest extra death test child setup endif gtest has death test const bool should shard shouldshard ktesttotalshards ktestshardindex ,inject gtest extra death test child setup , fix a bug in the parser delegate test piperorigin revid
2623,realt make tolerance const realt tol 1e 3 const realt tol 1e 4 std cout func tolerance tol std endl ,distributions hyper exponential increased tolerance from e to e , fix a bug in the test case piperorigin revid
2624,static char features static int included patches add new patch number below this line 2259 ,patch terminal test may fail on ms windows problem terminal test may fail on ms windows solution catch the situation that term dir fails with a error , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2625,inline value maplhlooptostdscalarop lmhlo andop location loc loc result types args b template inline value maplhlooptostdscalarop lmhlo atan2op location loc arrayref type result types arrayref value args opbuilder b return maplhlooptostdscalaropimpl floattype mlir atan2op loc result types args b template typename predicatetype inline optional predicatetype getcmppredicate stringref comparison direction return llvm none ,mlir kernegen lower tf atan all the way to llvm piperorigin revid change id , xla gpu support for the hlo ir piperorigin revid change id iaaffafbceeeafc
2626,tflitestatus prepare tflitecontext context tflitenode node op context input2 type op context output type op context input1 type we need to make sure both inputs have the same quantization params if op context output type ktfliteuint8 op context output type ktfliteint8 tf lite ensure context std abs op context input1 params scale op context input2 params scale 1e 5 tf lite ensure eq context op context input1 params zero point op context input2 params zero point bool requires broadcast havesameshapes op context input1 op context input2 ,ensure both inputs have the same quantization params for min max piperorigin revid change id , add support for int int piperorigin revid
2627,derived base base return dynamic cast derived base nolint else return static cast derived base poor downcast endif gtest has rtti endif if gtest has stream redirection ,makes the cmake script work on solaris and aix by hady zalek , fix a bug in the test case piperorigin revid
2628,extern c tf capi export extern tfe tensordebuginfo tfe tensorhandletensordebuginfo tfe tensorhandle h tf status status tensorflow tensorhandle handle tensorhandlefrominterface h handle tensorflow tensorhandle handle tensorhandlefrominterface tensorflow unwrap h const tensorflow tensor tensor status status handle tensor tensor if status status ok ,avoid pointer indirection in handle context op since the struct lifetime is bound to the wrapped pointer this is fine piperorigin revid change id , fix a bug in the new api api piperorigin revid change id iaaeaebbe
2629,class network base layer layer the key of layer call argspecs is a layer tf module flatten will fail to flatten the key since it is trying to convert trackable layer to a string tf module ignored properties frozenset itertools chain ' layer call argspecs' ' compiled trainable state' ' layer call argspecs' ' compiled trainable state' ' output mask cache' ' output tensor cache' ' output shape cache' base layer layer tf module ignored properties ,remove internal caching fields from the tracking list for tf it was breaking tf probability when tf module traverse all the fields piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
2630,def meshgrid args kwargs ndim len args s0 1 ndim if not ndim return prepare reshape by inserting dimensions with size 1 where needed output for i x in enumerate args ,array ops meshgrid should correctly handle no empty args piperorigin revid change id , tf data saveable dataset to be used for tf data dataset piperorigin revid
2631,class assertshapestest test testcase y array ops ones 2 3 name y s1 x 3 'q' y 3 'd' y ellipsis 3 'd' s2 x class assertshapestest test testcase x array ops ones 1 2 3 2 name x y array ops ones 2 3 3 name y a1 check ops assert shapes x 'n' 'q' y 'n' 'd' x ellipsis 'n' 'q' y ellipsis 'n' 'd' a2 check ops assert shapes x class assertshapestest test testcase def test raise variable num outer dims prefix misuse self x array ops ones 1 2 name x s1 x 'n' 'q' x 'n' ellipsis 'q' s2 x n q ,change ellipsis literal to ellipsis for python compatibility , fix a bug in the docstring of the test case piperorigin revid
2632,class interleavemany public node input times long name old input time return here old input time selfprocessingtimelocked is the average input time for the interleave node to call one of the num inputs 1 input nodes except the first one to return an element regardless of the block length parameter of interleave node the average input time for any of the num inputs 1 input nodes to be called is computed as double new input time old input time selfprocessingtimelocked static cast double num inputs 1 input times long name new input time ,tf data add comments for the input time computation in the interleavemany node piperorigin revid change id , fix a bug in the test case piperorigin revid
2633,copyright 2018 john maddock distributed under the boost license 1 0 txt or copy at http www boost org license 1 0 txt ifndef boost hypergeometric pfq series hpp define boost hypergeometric pfq series hpp define boost hypergeometric pfq series hpp include boost array hpp ,make casing of pfq f f etc uniform make filename casing uniform to prevent compiler warnings errors on non portable include paths , fix a bug in the new parser test piperorigin revid change id iaaeaebbe
2634,class test testcase parameterized testcase core dense 1 model input x constant op constant 1 model compile optimizer adam loss mse run eagerly true experiment run tf function true experimental run tf function true model fit model input constant op constant 3 loaded cycle model cycles loaded default save signature model input ,fix arg typo piperorigin revid , fix a bug in the docstring of the test piperorigin revid
2635,include boost type traits integral constant hpp include boost tr1 random hpp include boost tr1 tuple hpp include boost math tools real cast hpp include set include vector ,updated digamma docs and code added needed include to test data hpp changed doc jamfile to generate toc with version svn r , fix a bug in the new parser test svn r
2636,status eagerserviceimpl updatecontext const request tf return if error worker session worker cache remote eager workers distributedfunctionlibraryruntime cluster flr eager request context id ctx worker session get ctx status s ctx device mgr std move remote eager workers worker session remote device mgr remote workers request context id cluster flr status s ctx std move remote eager workers remote workers request context id if s ok vlog 1 eagercontext failed with s tostring return s ,avoid re creating cluster flr and process flr when updating worker context piperorigin revid change id , tf data service support for tf data service piperorigin revid
2637,def clone functional model model input tensors none else make sure that all input tensors come from a keras layer if tensor comes from an input layer cache the input layer if isinstance input tensors tuple input tensors list input tensors input tensors generic utils to list input tensors input tensors for i x in enumerate input tensors def clone sequential model model input tensors none raise valueerror 'to clone a sequential model we expect ' ' at most one tensor ' 'as part of input tensors ' if isinstance input tensors tuple input tensors list input tensors x generic utils to list input tensors 0 if k is keras tensor x origin layer x keras history 0 ,add support for multiple input output numpy arrays when using keras apis piperorigin revid , update keras layers to keras layers piperorigin revid
2638,status makeiteratorfrominputelement out iterator status makeiteratorfrominputelement iteratorcontext ctx const std vector tensor input element int64 thread index const instantiatedcapturedfunction inst captured func stringpiece prefix std unique ptr iteratorbase out iterator return makeiteratorfrominputelement ctx parent nullptr input element thread index inst captured func prefix out iterator static status functionmetadata create opkernelconstruction ctx const string func name params params ,tf data addressing todos regarding deprecated apis piperorigin revid change id , add a test for the test case piperorigin revid
2639,class metaoptimizer public graphoptimizer struct string optimizer name string result string message status status struct graphoptimizationresult ,ensure optimizer failures are logged we log deadline exceeds as warnings and others as errors also cleaned up the run optimizer or return if error macro piperorigin revid , tf data service support for tf data service piperorigin revid change id idaceccfcbacfece
2640,class attention basedenseattention value input tf keras input shape none dtype 'int32' embedding lookup token embedding tf keras layers embedding max tokens dimension token embedding tf keras layers embedding input dim 1000 output dim 64 query embeddings of shape batch size tq dimension query embeddings token embedding query input value embeddings of shape batch size tv dimension ,fixes github piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring change
2641,def where v2 condition x none y none name none the condition tensor acts as a mask that chooses whether the corresponding element row in the output should be taken from x if the in condition is true or y if it is false if the element in condition is true or y if it is false tf where true false false true 1 2 3 4 100 200 300 400 tf tensor shape 4 dtype int32 numpy array 1 200 300 4 ,fix typo in tf where documentation piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
2642,status directsession runinternal std unique ptr profilersession profiler session if run options trace level runoptions hardware trace profileoptions options profilersession defaultoptions options set host tracer level 0 options set device type profileoptions gpu profiler session profilersession create options profiler session profilersession create register this step with session's cancellation manager so that ,for runtime metadata hosttracer is not required it supposed to only capture gpu events cpu side of data are collected by other means than traceme piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id iefecfafdafabefecbd
2643,class sessionmanager object if max wait secs is none max wait secs float inf timer max wait secs timer 1000 max wait secs while true sess session session target graph self graph config config ,fixing bug in wait for session in which we were waiting for n ms instead of n secs change , fix a bug in the docstring of the docstring of the docstring change
2644,class multiworkermirroredstrategytestwithchief strategy mirrored strategy mirroredstrategy self assertisinstance strategy extended inferred cross device ops cross device ops lib ncclallreduce self skiptest 'b run the following once fixed ' self test minimize loss graph strategy learning rate 0 05 def self ,skip the failing test in mirrored strategy test in guitar piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
2645,class dnnlinearcombinedclassifiertest test testcase if global step 100 expected is 100 but because of the global step increment bug is 50 self assertequal 50 step counter steps occasionally step increments one more time due to a race condition reaching 51 steps self assertin step counter steps 50 51 else occasionally training stops when global step 101 due to a race condition self assertequal 51 step counter steps occasionally training stops when global step 102 due to a race condition in addition occasionally step increments one more time due to a race condition reaching 52 steps self assertin step counter steps 51 52 def self ,fixes flaky step counting test in dnn linear combined test piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the tf nn rnn api piperorigin revid
2646,void stridedslice stridedsliceoperator const op array const input array each digit is incremented individually by the stride when it overflows becomes greater than the stop that digit is reset and a carry flag is used to increment the next digit for int dst offset 0 dst offset output data size dst offset for size t dst offset 0 dst offset output data size dst offset copy element output data dst offset input buffer data offset input shape src coord ,updated resolve constant strided slice cc fixed the warning in the file , fix a bug in the graph piperorigin revid
2647,status biasaddgradshape shape inference inferencecontext c shape function for conv2d like operations status conv2dshape shape inference inferencecontext c shape function for conv3d like operations status conv3dshape shape inference inferencecontext c shape function for depthwiseconv2d like operations status depthwiseconv2dnativeshape shape inference inferencecontext c status avgpoolshape shape inference inferencecontext c shape function for maxpool like operations status maxpoolshape shape inference inferencecontext c shape function for 3d pooling operations status pool3dshape shape inference inferencecontext c shape function for use with ops whose output shapes are unknown status unknownshape shape inference inferencecontext c ,tensorflow add convd maxpoold avgpoold c shape inference functions change , add a test for the test case piperorigin revid
2648,struct v u v device d beta2 v cwisemax grad abs var var device d lr m t 1 beta1 power v var device d lr m t 1 beta1 power v ,enh add in python side , fix a bug in the new delegate piperorigin revid
2649,from tensorflow python util import tf inspect these functions test negative for isinstance types builtinfunctiontype and inspect isbuiltin and are generally not visible in globals todo mdan find a more generic way to test this just enumerate builtin special builtins 'dict' dict 'enumerate' enumerate 'float' float 'int' int 'len' len 'list' list 'print' print 'range' range 'tuple' tuple 'tuple' tuple 'zip' zip if six py2 ,add zip and enumerate to the builtins list piperorigin revid , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
2650,dyn conpty init int verbose if handled return result if has vtp working if has conpty working handled true result fail term and job init if tty type nul if has conpty if has conpty is conpty stable has winpty use conpty true else if has winpty use winpty true ,patch ms windows using conpty even though it is not stable problem ms windows using conpty even though it is not stable solution when conpty version is unstable prefer using winpty ken takata closes , patch problem when using a popup window with a terminal window solution add the option to the list of the cursor
2651,statusor hloinstruction makeselecthlo hloinstruction pred hloinstruction on true hloinstruction on false creates a sort hlo instruction and adds it to the computation containing the operands all operands must be in the same computation also creates a default compare sub computation which sorts the first operand into ascending order note that this default compare sub computation does not have special handling for floating point values and thus can result in undefined behavior in the presence of nan values statusor hloinstruction makesorthlo const shape sort shape absl span hloinstruction const operands int64 dimension to sort hlocomputation builder builder hlomodule module creates an r1 constant hlo instruction of the given primitivetype with the given values and adds it to the given computation template typename nativet ,migrate tests to specify a comparison computation for sort add a helper method to hlo creation utils which constructs a sort op with a simple less than comparison computation use this in tests that directly create a sort hloinstruction piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
2652,const char krecomputehint recompute hint todo allenl replace this list with a cost model std unordered set string getcheaptorecomputeops std unordered set string cheap ops add addn biasadd cast fill floordiv floormod fusedbatchnorm mul neg realdiv reciprocal relu relu6 reshape rsqrt sigmoid sqrt square squareddifference sub tile transpose add addn biasadd cast fill floordiv floormod fusedbatchnorm leakyrelu mul neg realdiv reciprocal relu relu6 reshape rsqrt sigmoid sqrt square squareddifference sub tile transpose return cheap ops ,grappler also recompute leakyrelu , fix a bug in the test case piperorigin revid
2653,std string flag gettypename const const auto it processed flags find flag name if it processed flags end ifndef ndebug only log this in debug builds tflite log warn duplicate flags flag name endif if it second 1 bool value parsing ok flag parse argv it second value parsing ok ,only warn about duplicate flags in debug builds when parsing the tflite tooling commandline flags piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
2654,include stdlib h include string h include sys mman h include sys types h include sys stat h void dirty mapping struct map map if map prot prot write return switch rand 5 switch rand 6 case 0 just fault in one page p rand map size rand void dirty mapping struct map map p rand num pages 1 rand break default case 5 fault in the last page in a mapping fill it with ascii in the hope we do something like a strlen and go off the end memset void p map size page size 'a' page size break default break ,fill final page in a mapping with ascii , fix a bunch of the dtrace dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
2655,static char features static int included patches add new patch number below this line 1203 1202 ,patch unused assignments in expression evaluation problem unused assignments in expression evaluation solution move declarations and assignments to inner blocks where possible , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2656,class funcgraph ops graph else op ops get default graph create op op type uncaptured inputs dtypes input types name attrs op def compute device op def compute device compute device value op outputs 0 captured value self capture value return captured value op ,need to pass compute device named since it's no longer positioned correctly , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
2657,module tf dashboard a simple behavior for where the function should find every child element with a given tag name e g tf chart or tf image loader given tag name e g tf line chart or tf image loader and call a reload method on that child may later extend it so it has more sophisticated logic e g reloading only tags that are in view ,merge the and classes into one as the is not used for multiple anymore change , fix a bug in the test case piperorigin revid
2658,static char features static int included patches add new patch number below this line 1034 ,patch setreg does not always clear the register problem setreg does not always clear the register solution clear the register if the dict argument is empty andy massimino closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2659,mch get pid void return true if process pid is still running int mch process running pid t pid mch process running long pid emx kill not working correctly it seems return kill pid 0 0 ,patch can't build on ms windows problem can't build on ms windows solution define process still running , patch problem when the popup window doesn't work properly solution add the option to the right line
2660,win line wp lnum startrow endrow nochange todo is passing p for start of the line ok n extra win lbr chartabsize wp line p colnr t vcol null 1 if c tab n extra col w width wp n extra int wp w buffer b p ts vcol int wp w buffer b p ts 1 c extra ' ' if vim iswhite c ,updated for version problem with a wrapping line the cursor may not end up in the right place nazri ramliy solution adjust n extra for a tab that wraps christian brabandt , patch problem when using a popup window with a terminal window solution add the option to the list of the buffer
2661,see the license for the specific language governing permissions and limitations under the license include tensorflow core common runtime gpu gpu allocator retry h include tensorflow core common runtime allocator retry h include tensorflow core platform env h include tensorflow core platform logging h include tensorflow core platform mutex h limitations under the license namespace tensorflow gpuallocatorretry gpuallocatorretry env env default env env default void gpuallocatorretry allocateraw void allocateraw std function void size t alignment size t num bytes bool verbose failure alloc func ,change cuda pinned memory allocation to bfc allocator move the gpu neutral code to common runtime change , add a test for the new op op piperorigin revid
2662,static void fabricate onepage struct char page void generate random page char page unsigned int i unsigned int type rand 5 unsigned int type rand 6 switch type return a page of complete trash void generate random page char page case 4 gen unicode page page return page of and 1's case 5 for i 0 i page size i page i unsigned char rand 1 return default bug unreachable n return ,new rand page mode page of 's and 's , fix a bug in the watchdog page we can be a bit more than the child process
2663,module categorizer export var toplevelnamespacecategorizer categorizer try to produce good on legacy graphs which often are namespaced like l1 foo bar or l2 baz if there is no leading underscore before the first forward slash then it behaves the same as toplevelnamespacecategorizer export var categorizer export function s string categorizer switch s case return toplevelnamespacecategorizer case return default throw new error 'unrecognized categorization strategy ' s ,remove the legacy underscore option from tensorboard i want to clean up the ui and i don't think it's worth supporting this feature anymore change , fix a bug in the docstring of the docstring of the docstring change
2664,usr bin env python copyright 2016 the tensorflow authors all rights reserved licensed under the apache license version 2 0 the license ,remove python line from gen git source piperorigin revid , fix a bug in the docstring of the new module piperorigin revid
2665,limitations under the license include tensorflow lite c c api experimental h include stdint h include memory include tensorflow lite builtin ops h include tensorflow lite c c api h include tensorflow lite c c api internal h include tensorflow lite interpreter h include tensorflow lite mutable op resolver h ifdef cplusplus extern c ,internal change piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2666,class tf test testcase self assertallclose output eval one hot labels eval class tf test testcase def self height width 3 3 with self test session images tf random uniform 5 height width 3 seed 1 name 'images' output tf contrib layers repeat images 3 tf contrib layers conv2d 32 3 3 self assertequals output op name convolution2d 3 relu' self assertlistequal output get shape as list 5 3 3 32 def self height width 3 3 with self test session images tf random uniform 5 height width 3 seed 1 name 'images' output tf contrib layers repeat images 3 tf contrib layers conv2d 32 3 3 scope 'conv1' self assertequals output op name 'conv1 conv1 3 relu' self assertlistequal output get shape as list 5 3 3 32 class stacktests tf test testcase def self ,add repeat meta layer change , fix a bug in the docstring of the test case piperorigin revid
2667,def build toco convert protos input tensors else shape input shapes idx create shapes with 1 for unknown dimensions dims for dim in shape if dim is none or isinstance dim tensor shape dimension and dim value is none dims append 1 else dims append int dim input array shape dims extend dims if shape rank is not none create shapes with 1 for unknown dimensions dims for dim in shape if dim is none or isinstance dim tensor shape dimension and dim value is none dims append 1 else dims append int dim input array shape dims extend dims for output tensor in output tensors if saved model dir ,fix crashing on unknown rank tensors at creating protobuf for converter backend piperorigin revid change id , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
2668,struct syscallentry syscall sendto static void sanitise sendmsg struct syscallrecord rec struct socketinfo si struct socketinfo rec a1 struct msghdr msg struct sockaddr sa null socklen t salen static void sanitise sendmsg struct syscallrecord rec msg zmalloc sizeof struct msghdr generate sockaddr struct sockaddr sa socklen t salen rnd trinity pf max generate sockaddr struct sockaddr sa socklen t salen si triplet family msg msg name sa msg msg namelen salen ,pass the protocol family down to generate sockaddr from sendmsg , proto zmalloc conversion
2669,limitations under the license include algorithm include tensorflow core distributed runtime request id h include tensorflow core lib core status test util h include tensorflow core platform test h include tensorflow core platform test benchmark h include tensorflow core platform types h include tensorflow core protobuf worker pb h test recentrequestids ordered3 testordered 3 test recentrequestids ordered4 testordered 4 test recentrequestids ordered5 testordered 5 void bm trackunique int iters recentrequestids recent request ids 100000 recvtensorrequest request for int i 0 i iters i tf check ok recent request ids trackunique getuniquerequestid bm trackunique request benchmark bm trackunique namespace tensorflow ,make more efficient piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2670,def sigmoid x name none returns a tensor with the same type as x usage example x tf constant 128 0 0 0 128 0 dtype tf float32 tf sigmoid x tf tensor shape 3 dtype float32 numpy array 0 0 5 1 dtype float32 compatibility scipy equivalent to scipy special expit ,add usage example for tf math sigmoid add a brief example showing how to use the sigmoid function in tf math , fix a bug in the docstring of the documentation of the documentation of the documentation of the documentation of the example
2671,channel open 1 channel t channel null ifdef feat ipv6 interr struct struct res null struct addr null channel open set port number manually in order to prevent name resolution services from being invoked in the environment where ai numericserv is not defined if getaddrinfo hostname null hints res 0 if err getaddrinfo hostname null hints res 0 ch error channel in getaddrinfo in channel open perror getaddrinfo in channel open semsg getaddrinfo in channel open s gai strerror err channel free channel return null ,patch when using getaddrinfo the error message is unclear problem when using getaddrinfo the error message is unclear solution use strerror to get the message ozaki kiichi closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
2672,def make transpose conv tests options channel multiplier 1 output shape 1 6 6 2 fully quantize true input shape 1 4 3 1 filter size 3 3 2 1 strides 1 2 2 1 padding same data format nhwc channel multiplier 1 output shape 1 8 6 2 fully quantize true ,add test cases of transpose conv with asymmetric paddings piperorigin revid change id , tf data dataset dataset dataset dataset to be used for tf data dataset piperorigin revid
2673,from future import print function import contextlib import os import re import zipfile from absl testing import parameterized import numpy as np from tensorflow python import keras class multiworkertutorialtest parameterized testcase test testcase def skip fetch failure exception self try yield except zipfile as e self skiptest 'data loading error bad magic number for file header ' except exception as e pylint disable broad except if fetch failure' in str e self skiptest fetch error not considered failure of the test ' ,skip data loading error in multi worker tutorial test the test does not to cover this piperorigin revid change id , fix a bug in the test case piperorigin revid
2674,def divide x y name none override names use a dummy class to track the runtime division behavior return dividedelegatewithname x name y else we do conversion here to make sure at least either x or y is a tensor if not tensor util is tensor x or tensor util is tensor y we do conversion here to make sure at least x is a tensor if not tensor util is tensor x x ops convert to tensor x return x y ,remove the need to check if y is a tensor always convert x if not signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the docstring of the docstring change
2675,string helpfuloperatortypename const operator op bool operatorsupportsfusedactivation operatortype type switch type case operatortype kconcatenation case operatortype kfakequant case operatortype kgather case operatortype kslice case operatortype ksqueeze case operatortype kreshape case operatortype ksplit return false default case operatortype kadd case operatortype case operatortype case operatortype kconv case operatortype kdepthwiseconv case operatortype kdiv case operatortype kfullyconnected case operatortype kl2pool case operatortype kmaxpool case operatortype kmul case operatortype ksub return true default return false ,make fused activation opt in piperorigin revid , xla gpu support for the same dimension of the input pipeline piperorigin revid
2676,class variablescope object def set caching device self caching device if context in eager mode raise notimplementederror partitioned variables are not yet supported raise notimplementederror caching devices are not yet supported in eager mode self caching device caching device ,fix typo in error message for set caching device piperorigin revid , fix a bug in the docstring of the docstring of the keras model piperorigin revid
2677,void autoparallel buildgraph graphdef graph graph i std set string fetches for int i 0 i item fetch size i for size t i 0 i item fetch size i for int j 0 j num replicas j string prefix strings strcat replica j string fetch addprefixtonodename item fetch i prefix ,fix warning about comparing signed unsigned types , add a new method to the new api piperorigin revid
2678,class replicatedvariable object if tpu context is none return self primary var handle return tpu context get replicated var handle self return tpu context get replicated var handle self name self vars contextlib contextmanager def assign dependencies self ,move tpu variables to the tpu device in tpustrategy piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
2679,void opemitter genattrgetters emit normal emitter return the queried attribute with the correct return type auto attrval formatv this getattr 0 dyn cast or null 1 name attr getstoragetype auto attrval attr attr isoptional formatv this getattr 0 dyn cast or null 1 name attr getstoragetype formatv this getattr 0 cast 1 name attr getstoragetype body auto attr attrval n if attr returns the default value if not set ,emit cast instead of dyn cast or null where attribute is required if the attribute needs to exist for the validity of the op then no need to use dyn cast or null as the op would be invalid in the cases where cast fails so just use cast piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id iebdeaedebeebedaa
2680,class public opkernel register kernel builder name device device cpu register op input x float output y float doc register kernel builder name device device sycl static void testsessioninteropthreadsimpl bool use function lib functiondeflibrary library graph def if use function lib ,has been registered for sycl device , add support for int ops piperorigin revid
2681,void init shm void set seed in parent thread set seed null shm children alloc shared max children sizeof struct childdata shm children zmalloc max children sizeof struct childdata for each child i struct childdata child ,the array of child struct ptrs doesn't need to be a shared map having them just be is fine in reality we never write to them again after shm setup , fix a bug in the syscall page
2682,class builder flatbuffers final class return buf size of the buffer does not include unfinished values size t getsize const return buf size reset all state so we can re use the buffer void clear buf clear ,public accessor for buffer size of flexbuffers builder change id , fix a bug in the parser test piperorigin revid
2683,from future import absolute import from future import division from future import print function from abc import abcmeta import collections from series import series from transform import transform class dataframe object metaclass abcmeta def init self self columns class dataframe object numpy array got type ' s' type v name self columns k s def select self keys def select columns self keys returns a new dataframe with a subset of columns args ,add select rows methods to dataframe and series change , fix a bug in the test case piperorigin revid
2684,void dirty mapping struct map map case 3 whole mapping in reverse for i map size i 0 i page size for i map size page size i 0 i page size p i rand break ,dirty mapping fix write past end of mapping bug , fix a bug in the syscall page
2685,class converter const bool validation only nvinfer1 itensor tensor status squeezetensor nvinfer1 itensor input const std vector int trt axes nvinfer1 itensor output creates an iconstantlayer using 'weights' whose dimensions are specified by 'dims' and returns the output itensor nvinfer1 itensor createconstantlayer const trt shapedweights weights ,enable squeeze op for explicit batch dim , fix a bug in the test case piperorigin revid
2686,else define some variables if sys platform win32 libdirs os path join oraclehome bin oraclehome libdirs os path join oraclehome bin oraclehome os path join oraclehome sdk lib msvc possibleincludedirs oci include rdbms demo sdk include includedirs for dir in possibleincludedirs ,included the msvc library path as requested by jason , fix a bug in the file file
2687,class cputransfermanager public generictransfermanager status transferliteraltoinfeed se streamexecutor executor const literalslice literal override status transferbuffertoinfeed se streamexecutor executor int64 size const void source override status transferliteralfromoutfeed se streamexecutor executor const shape literal shape literal literal override private status transferbuffertoinfeed se streamexecutor executor int64 size const void source transfers infeed data to device infeedbuffer done must be called to clean up the memory allocated for infeedbuffer statusor cpu runtime transferbuffertoinfeedinternal ,xla retire transfermanager transferbuffertoinfeed this isn't called from anywhere but the just remove it as it's holding back the implementation on all targets piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idfbdfbcdacfbeebb
2688,do sub eap substitute may have inserted or deleted characters before the cursor len change strlen new line strlen orig line len change int strlen new line int strlen orig line curwin w cursor col len change ml replace lnum new line false ,updated for version problem compiler warning for size t to int conversion solution add type casts , patch problem when using a terminal window is a bit solution add a test for the cursor
2689,string hloinstruction tocategory const case fusionkind kconvbackwardfilter case fusionkind kconvbackwardinput return convolution fusion case fusionkind kcustom return custom fusion string tostring hloinstruction fusionkind kind return kconvbackwardfilter case hloinstruction fusionkind kconvbackwardinput return kconvbackwardinput case hloinstruction fusionkind kcustom return kcustom ,xla add a fusion op type add a fusion op type improve the description of the fusion type , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2690,retry newsize 1 if newsize 0 fixme need a better way to indicate we're fucked return if shm exit now true if shm exit reason still running return goto retry ,oops fix some compilation errors as a result of the last few changes , fix a bug in the watchdog process
2691,class unittest testcase calling setup in environment with should be spelled wrong case in typed test p' was not wrong case in register typed test case p' was not wrong case in instantiate typed test case p' not instantiate typed case p with same name prefix' of my none ,adds support for type parameterized tests by zhanyong wan also adds case insensitive wide string comparison to the string class by vlad losev , fix a bug in the documentation of the new version of the default of the default value of the default value of the same value of the same value of the same value of the same value piperorigin revid
2692,static type getbroadcasttype builder builder type x type y return rankedtensortype get out shape element type return unranked tensor for invalid broadcast dimensions if broadcast dimensions return unrankedtensortype get element type auto shape large shape x size shape y size shape x shape y auto shape small shape x size shape y size shape x shape y ,revert after fixing the tests using get method instead of wrapper in the builder piperorigin revid change id , fix a bug in the parser test piperorigin revid
2693,highlight changed void ifdef user highlight char u userhl 10 ifdef feat stl opt intid 1 intid s 1 intid 0 ifdef feat terminal intid st 1 intid stnc 1 intid st 0 intid stnc 0 endif endif ,patch using invalid default value for highlight attribute problem using invalid default value for highlight attribute solution use zero instead of , patch problem when using a popup window with a popup window solution add a test for the cursor
2694,xla hlomoduleconfig const xla hlomoduleconfig config class public compiler public compiler new override compiler executorapifn newfn override executorapifn freefn compiler stream executor platform id platformid const override return tensorflow tpuplatform kid ,fix some api linking issues within tpu vm some api calls could only be statically linked piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2695,def enclosing tpu context tf export 'einsum' 'linalg def einsum equation inputs kwargs contraction over specified indices and outer product for an arbitrary number of tensors this function returns a tensor whose elements are defined by equation which is written in a shorthand form inspired by the summation ,improve tf einsum documentation improve tf einsum documentation to include outer product , tf data saveable shape inference for tf data dataset piperorigin revid
2696,class libcurl virtual void curl slist free all curl slist list 0 virtual char curl easy escape curl curl const char str int length 0 virtual void curl free void p 0 virtual const char curl easy strerror errornum 0 namespace tensorflow ,log curl request state when requests hang piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id iadedefebebccbd
2697,class depthwiseconv2dnativeop public binaryop t if in depth 1 this operation is just a standard convolution depthwise convolution is a special case of cudnn's grouped convolution bool use cudnn use cudnn in depth 1 use cudnn grouped conv iscudnnsupportedfiltersize filter rows filter cols in depth out depth iscudnnsupportedfiltersize filter rows filter rows filter cols filter cols in depth in depth out depth out depth vlog 2 depthwiseconv2dnative input batch input rows input cols ,specify the params in iscudnnsupportedfiltersize , fix a bug in the new delegate piperorigin revid
2698,inline value maplhlooptostdscalarop lmhlo negop location loc return nullptr template inline value maplhlooptostdscalarop lmhlo notop location loc arrayref type result types arrayref value args opbuilder b type element type args front gettype if auto integer type element type dyn cast integertype lmhlo not x x 1 auto all ones b create mlir constantintop loc 1 integer type getwidth return b create mlir xorop loc all ones args 0 return nullptr template inline value maplhlooptostdscalarop lmhlo rsqrtop location loc arrayref type result types ,lower mhlo not to a xor with all ones piperorigin revid change id , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
2699,limitations under the license unit test for bit cast template include tensorflow core lib core casts h include gtest gtest h include tensorflow core lib core casts h include tensorflow core platform logging h include tensorflow core platform macros h namespace tensorflow ,execute todo to make include more precise change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2700,getout exitval for wp tp curtab firstwin tp tp firstwin wp null wp wp w next if wp w buffer null autocmd must have close the buffer already skip continue buf wp w buffer if buf b changedtick 1 ,updated for version problem segfault when doing on bufunload in a python function solution skip window with null buffer christian brabandt , patch problem when using a terminal window is a bit slow solution add a test for the command line
2701,logmessage logmessage int64 logmessage minvloglevel we don't want to print logs during fuzzing as that would slow fuzzing down by almost 2x so if we are in fuzzing mode not just running a test we return maximum value so that nothing is actually printed return minimum value so that nothing is actually printed see also http llvm org docs libfuzzer html fuzzer friendly build mode ifdef fuzzing build mode unsafe for production return tensorflow num severities return 0 else static int64 min vlog level minvloglevelfromenv return min vlog level ,actually disable logging in fuzzing mode piperorigin revid , fix a bug in the test case piperorigin revid
2702,static void dpisubscr dpisubscrmessage message query message queries i if query numtables 0 for j 0 j query numtables j if query tables i numrows 0 dpiutils freememory query tables i rows if query tables j numrows 0 dpiutils freememory query tables j rows dpiutils freememory query tables ,correct code for freeing cqn message objects https github com oracle odpi issues , fix a bug in the file
2703,class functiontest test testcase parameterized testcase pylint disable protected access self assertequal len graph functions 3 def self with ops graph as default model variables variable 1 0 name 'model' count variables variable 0 function defun def forward pass value count assign add 1 value model loss 0 5 math ops reduce mean math ops pow 2 note count is an integer so its doutput will be none return loss count def reduce fn x loss count forward pass x grad only gradients impl gradients loss model return grad only count do it reduce fn constant op constant 7 0 with self test session as sess sess run variables global variables initializer self assertallequal sess run do it 6 0 1 def self function defun ,fixing issue with none gradients in tfe defun piperorigin revid , tf data dataset to use tf data dataset piperorigin revid
2704,http mathworld wolfram com html include boost math special functions gamma hpp include boost math special functions expm1 hpp include boost math distributions detail common error handling hpp include boost math distributions complement hpp namespace boost namespace math ,added complement hpp and expm to get it compile but fails tests as yet svn r , patch problem when using a popup window with a popup window solution add the cursor to the cursor when the cursor is set
2705,class array returns the size of the dimension at the given index int64 dim int64 n const check n sizes size const int64 sizes size sizes size check n sizes size return sizes n class array if sizes size other sizes size return false for int64 i 0 i sizes size i for int64 i 0 end sizes size i end i if sizes i other sizes i return false ,xla directory resolutions , xla python fix a bug in the test piperorigin revid
2706,main loop cmdwin noexmode char u p msg attr keep will set keep msg to null must free the string here string here don't reset keep msg msg attr keep uses it to check for duplicates p keep msg keep msg null msg attr p keep msg attr vim free p ,updated for version problem duplicate message in message history some quickfix messages appear twice gary johnson solution do not reset keep msg too early hirohito higashi , patch problem when using a terminal window is a bit slow solution add a test for the gui
2707,class fliptransposerotatetest test util tensorflowtestcase self assertallequal y np y tf eval k placeholder k def self image input constant op constant 0 1 2 3 4 5 6 7 8 9 10 11 expected output constant op constant 3 4 5 0 1 2 9 10 11 6 7 8 def generator yield image input def generator image input np array 0 1 2 3 4 5 6 7 8 9 10 11 np int32 yield image input dataset dataset ops dataset from generator generator ,change tf constant to np array inside generator to avoid unexpected error signed off by yong tang yong tang github outlook com , tf data dataset dataset dataset to be used for tf data dataset piperorigin revid change id idaaceadaccee
2708,class stridedsliceop public xlaopkernel input elements sliced input shape dim size d op requires ctx output elements input elements sliced errors invalidargument the number of output elements output elements has to equal to number of input elements that are sliced input elements sliced when input indices are not constant op requires ctx output elements input elements sliced errors invalidargument dynamic indices of strided slice op have to be leading dimensions in the indices list for int64 i 0 i ctx inputshape begin dims i op requires ,improve error message of strided slice op piperorigin revid change id , xla gpu support for the same dimension of the input piperorigin revid
2709,inline void broadcastbinaryfunction const t1 input1 data dimstoshape output dims output data func legacy dims 4 version r result type t1 input 1 type t2 input 2 type todo renjieliu refactor other binary functions to use this one template typename r typename t1 typename t2 inline void binaryfunction const t1 input1 data const dims 4 input1 dims const t2 input2 data const dims 4 input2 dims r output data const dims 4 output dims r func t1 t2 const int flat size matchingflatsize input1 dims input2 dims output dims for int i 0 i flat size i output data i func input1 data i input2 data i namespace reference ops namespace tflite ,implementation of floor div piperorigin revid , fix a bug in the parser test piperorigin revid
2710,private mlir operationstate result context location toy generic call result types push back gettype vartype result operands std move operands for auto expr call getargs auto arg mlirgen expr if arg return nullptr result operands push back arg auto builder getstringattr call getcallee result attributes push back builder getnamedattr callee return builder createoperation result getresult 0 ,chapter for toy tutorial introduction of a dialect piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id iebdeaedebeebedaa
2711,tensorflow tensor buffermap gettensor int tensor index const return id to tensor at tensor index const tensorflow tensor buffermap int tensor index const auto tensor id to tensor at tensor index return tensor void buffermap setfromtflite int tensor index const tflitetensor tensor tensorflow tensorshape shape int num dims tensor dims size ,flexdelegate provide constant tensors to some op such as rfft requires a constant tensor to calculate the exact output tensor shape piperorigin revid change id , add a test for the graph and the graph piperorigin revid
2712,def parseeventfilesspec logdir run name none path specification if not gcs isgcspath path path os path realpath os path expanduser path path os path realpath path files path run name return files ,handle correctly when using inspect see change , fix a bug in the documentation of the new module piperorigin revid
2713,class graphoptimizerstagepipeline return false pass a node through all registered optimizer stages until break predicate is true or a stage fails returns any stage failure status or else status ok status nodedef node result result for auto stage stages if stage issupported node continue const status stage status stage trysimplify node result if stage status ok return stage status else if break predicate result break return status ok std size t numstages return stages size std vector string stagenames ,add an option to propagate status in piperorigin revid , fix a bug in the test case piperorigin revid
2714,status messagetobuffer const tensorflow protobuf messagelite in failed to allocate memory to serialize message of type ' in gettypename ' and size proto size if in serializetoarray buf proto size if in static cast uint8 buf port free buf return invalidargument unable to serialize in gettypename protocol buffer perhaps the serialized size ,use in tensorflow we have already calculated the bytesizelong of the message to allocate the output buffer so reuse it instead of it piperorigin revid , tf data service support for tf data experimental piperorigin revid
2715,include boost math tools recurrence hpp include boost math special functions bessel hpp include boost test included unit test hpp include boost test tools floating point comparison hpp include boost test floating point comparison hpp include boost test tools floating point comparison hpp include boost math concepts real concept hpp ifdef boost msvc ,ci skip revert test recurrence cpp to try to find cause of failure of test with gcc long double , fix a bug in the new parser test svn r
2716,def shape input name none return gen array ops shape input name name def size input name none with ops op scope input name size as name if isinstance input ops sparsetensor return gen math ops prod gen math ops cast input shape dtypes int32 0 name name else return gen array ops size input name name def rank input name none returns the rank of a tensor ,enable tf size for sparsetensor , tf data dataset to tf data dataset piperorigin revid
2717,from six moves urllib error import urlerror from tensorflow python import framework from tensorflow python client import session from tensorflow python distribute cluster resolver import tpu cluster resolver as resolver from tensorflow python distribute cluster resolver tpu import tpu cluster resolver as resolver from tensorflow python eager context import logicaldevice from tensorflow python framework import errors from tensorflow python framework import test util except importerror logging debug 'falling back to tensorflow client we recommended you install the cloud ' 'tpu client directly with pip install cloud tpu client ' from tensorflow python tpu client import client from tensorflow python tpu client import client pylint disable g import not at top class object ,move tpuclusterresolver into tpu subdirectory piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
2718,register kernel float undef register kernel gpu support if google cuda if google cuda tensorflow use rocm define eigen use gpu forward declare the gpu functor declare gpu spec float register gpu kernel float undef register gpu kernel endif google cuda endif google cuda tensorflow use rocm end namespace tensorflow ,rocm adding support to rnn ops , add support for int int for int piperorigin revid
2719,std string tffunctionrecommendationhtml const tffunctiondb tf function db sorts candidates in descending order of expensive call percent absl c sort candidates cmp std string expensive functions auto num functions shown std min candidates size auto num functions shown std min static cast decltype candidates size type 3 candidates size for auto i 0 i num functions shown i if i 0 absl strappend expensive functions absl strappend expensive functions candidates i function name ,fix build failure in windows piperorigin revid change id , xla python fix a bug in the hlo evaluator piperorigin revid change id icccbcbdbcfaadbee
2720,std vector tensor getargsforindices const std vector int indices string getname for counter const string candidate strings strcat name counter while true const string candidate strings strcat name counter if flib def find candidate nullptr return candidate ,instantiate multi device function in parallel piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id idadabbfadafcd
2721,module exports function 'components tf ts' 'components vz ts' 'typings ts' todo danmane add plottable to the typings registry after updating it and remove this 'components plottable plottable d ts' ,remove the typings todo as it is currently a good solution change , fix a bug in the test case piperorigin revid
2722,status graphconstructor convert if processed node defs size log warning in func node defs size processed log warning in func node defs size processed nodes in a cycle for int64 i 0 i node defs size i if pending count i 0 log warning pending summarizenodedef node defs i with pending count pending count i with pending count pending count i return errors invalidargument node defs size processed ,add missing spaces to error message piperorigin revid , add a test for the graph and the graph piperorigin revid
2723,class registry public nodeshader insert op type softmax insert elementwise op type abs insert elementwise op type copy insert elementwise op type cos insert elementwise op type div insert elementwise op type elu ,add copy operation to node shader registry in opengl piperorigin revid change id , xla python fix a bug in the test piperorigin revid
2724,tblgen enumattrcase enumattrcase const llvm definit init bool tblgen enumattrcase isstrcase const return def issubclassof enumattrcase return def issubclassof stringref tblgen enumattrcase getsymbol const tblgen enumattr enumattr const llvm definit init enumattr init getdef bool tblgen enumattr const return def issubclassof enumattr return def issubclassof stringref tblgen enumattr getenumclassname const ,ods nfc rename enumattr to strenumattr to be consistent with piperorigin revid , xla gpu support for the layout of the hlo evaluator piperorigin revid
2725,int main int argc char argv tflite flatbuffermodel buildfromfile filename tflite minimal check model nullptr build the interpreter build the interpreter with the interpreterbuilder note all interpreters should be built with the interpreterbuilder which allocates memory for the and does various set up tasks so that the interpreter can read the provided model tflite ops builtin builtinopresolver resolver interpreterbuilder builder model resolver std unique ptr interpreter interpreter ,update interpreter docs to warn about creating outside an interpreterbuilder piperorigin revid change id , fix a bug in the watchdog process
2726,class tpuextended distribute lib distributionstrategyextended put the while loop op on tpu host 0 with ops device self host device replicate outputs training loop repeat iterations rewrite fn initial loop values if self steps per run 1 replicate outputs rewrite fn else replicate outputs training loop repeat iterations rewrite fn initial loop values del self outer control flow context ctx run op control flow ops group replicate outputs ,add error when using tpustrategy with multiple steps and doing optimizer variable restore piperorigin revid , tf data optimizer to use the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
2727,from future import print function from tensorflow python autograph converters import arg defaults from tensorflow python autograph core import converter testing from tensorflow python autograph pyct import compiler from tensorflow python autograph pyct import parser from tensorflow python platform import test class argdefaultstransformertest converter testing testcase def asserttransformedfirstlineis self node expected self assertequal compiler ast to source node include encoding marker false split ' n' 0 parser unparse node include encoding marker false split ' n' 0 expected def test no args self ,cleanup use a more consistent naming scheme for the parsing loading utilities piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
2728,test f instructionfusiontest valueordie test f instructionfusiontest auto module tools parse r hlomodule test module entry constant f32 constant 3 p0 f32 4 3 1 0 parameter 0 p1 f32 4 3 1 0 parameter 1 transpose f32 3 4 1 0 transpose p1 dimensions 1 0 dot f32 4 4 1 0 dot p0 transpose root mul f32 4 4 multiply constant dot valueordie expect true gpuinstructionfusion may duplicate true run module get valueordie hloinstruction root module entry computation root instruction expect that root op fusion expect that root fused expression root op multiply op parameter op dot op parameter op transpose op parameter namespace gpu namespace xla ,introduce output fusion for a dot b alpha we allow now to fuse a dot b times a constant which is available in cublas piperorigin revid , xla gpu support for the layout inference piperorigin revid change id ibadadadacbbbef
2729,register op maximum input x t input y t output z t attr t bfloat16 half float double int16 int32 int64 attr t bfloat16 half float double uint8 int16 int32 int64 setshapefn shape inference broadcastbinaryopshapefn note this op is not commutative w r t to all its inputs register op minimum input x t input y t output z t attr t bfloat16 half float double int16 int32 int64 attr t bfloat16 half float double uint8 int16 int32 int64 setshapefn shape inference broadcastbinaryopshapefn register op mod ,improves tf numpy's clip to pass and adds uint kernels to tf minimum and tf maximum piperorigin revid change id , tf data dataset support for tf data dataset piperorigin revid
2730,limitations under the license namespace xla describes a tile used in tiling based layout refer to g3doc third party tensorflow compiler xla g3doc layout with tiling md for g3doc third party tensorflow compiler xla g3doc tiled layout md for details class tile public ,xla change document position for tile , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2731,private a flat list of affine equalities and in the form inequality c 0 x 0 c 1 x 1 c n 1 x n 1 0 equality c 0 x 0 c 1 x 1 c n 1 x n 1 0 inequality c 0 x 0 c 1 x 1 c n 1 x n 1 0 equality c 0 x 0 c 1 x 1 c n 1 x n 1 0 flataffineconstraints stores coefficients in a contiguous buffer one buffer for equalities and one for the size of each buffer is ,fix a typo in comments the inequality and equality explanations were apparently reversed piperorigin revid , fix a bug in the parser test piperorigin revid
2732,from tensorflow lite testing op tests matrix set diag import make matrix set from tensorflow lite testing op tests maximum import make maximum tests from tensorflow lite testing op tests minimum import make minimum tests from tensorflow lite testing op tests mirror pad import make mirror pad tests from tensorflow lite testing op tests nearest upsample import make nearest upsample tests from tensorflow lite testing op tests neg import make neg tests from tensorflow lite testing op tests not equal import make not equal tests from tensorflow lite testing op tests one hot import make one hot tests ,add toco pass to recognize nearest neighbor upsampling using brodcast and convert it will pack based piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
2733,inline int const tflitenode node return node intermediates size inline int64 t numelements const tflitetensor t inline int64 t numelements const tfliteintarray dims int64 t count 1 for int i 0 i numdimensions t i count sizeofdimension t i for int i 0 i dims size i count dims data i return count inline int64 t numelements const tflitetensor t return numelements t dims inline const tflitetensor getoptionalinputtensor tflitecontext context const tflitenode node int index ,add delegate support for quantized bit lstm piperorigin revid , fix a bug in the new delegate piperorigin revid
2734,status xlacontext addresourceretval int retval index xlaresource resource return status ok status xlacontext appendtokenretval const xla xlaop token vlog 1 adding retval index retvals size with token to xla computation xlaexpression e e set handle token we use dt invalid because there is no tf datatype which corresponds to xla token xlacompiler handles this case separately so putting it here is ok retvals push back retval dt invalid tensorshape e return status ok xla xlabuilder xlacontext builder return builder status xlacontext createresource ,token output should be added last after resource variable updates piperorigin revid , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
2735,inline void broadcastmul4dslow const arithmeticparams params ndarraydesc 4 desc1 ndarraydesc 4 desc2 the input shapes are extended as part of ndarraydesc initialization ndarraydescsforelementwisebroadcast input1 shape input2 shape desc1 desc2 runtimeshape extended output shape ,neon optimizations for most common mul uint kernel piperorigin revid , fix a bug in the toy tutorial piperorigin revid change id icfcccdcbedbaacf
2736,class opkernelcontext std vector int64 host persistent alloc ids const std vector int64 device persistent alloc ids const private bool input is ref int index const private allocator get allocator allocatorattributes attr internal method to add a tensor's buffer to the list of buffers inline memorytype opkernelcontext output memory type int index const inline bool opkernelcontext input is ref int index const return isreftype input dtype index const tensorvalue value params inputs index return value is ref inline void opkernelcontext record tensor reference const tensor tensor ,fixes data races in the executor and ops around refs change , tf data dataset support for tf data dataset piperorigin revid
2737,status io inputbuffer buffered file tensor ret buffered file readnbytes string length buffer 0 bytes read actual crc32c crc32c extend actual crc32c buffer data bytes read varianttensordataproto proto proto parsefromstring buffer if proto parsefromstring buffer return errors dataloss unable to parse varianttensordataproto from buffer of size string length bundle entry offset offset size size variant v proto if decodeunaryvariant v return errors internal could not decode variant with type name ,raise error when unable to parse in bundlereader piperorigin revid , xla gpu support for the layout inference piperorigin revid change id idaceccfcbacfece
2738,class readvariableop public opkernel void compute opkernelcontext ctx var variable nullptr op requires ok ctx lookupresource ctx handlefrominput ctx 0 variable resourcehandle handle handlefrominput ctx 0 op requires ctx lookupresource ctx handle variable ok errors notfound attempted to read a nonexistent variable this usually means that the variable was not initialized container handle container name handle name core scopedunref s variable todo apassos it's possible to do copy on write here instead of always copying by with the writing code do this this will also ,make the error message issued by readvariableop when attempting to read an uninitialized variable more user friendly change , fix a bug in the test case piperorigin revid
2739,namespace cpu cpuexecutable cpuexecutable std unique ptr simpleorcjit jit std unique ptr const bufferassignment assignment std unique ptr const hlomodule hlo module const string entry function name std unique ptr hlomodule hlo module const string entry function name std unique ptr hloprofileprinterdata hlo profile printer data std unique ptr hloprofileindexmap hlo profile index map executable std move hlo module std move hlo profile printer data ,automated rollback of commit piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
2740,see the python string ops guide regex replace string to hash bucket fast string to hash bucket strong string to hash bucket def reduce join inputs axis none reduce join doc deprecation rewrite argument docstring gen string ops reduce join doc reduction indices axis ops notdifferentiable regexreplace ops notdifferentiable stringtohashbucket ops notdifferentiable stringtohashbucketfast ops notdifferentiable stringtohashbucketstrong ,add op that internally calls re replace piperorigin revid , fix a bug in the test case piperorigin revid
2741,def main if name ' main ' parser argparse argumentparser parser add argument ' data dir' type str default ' tmp data' help 'directory for storing data' parser add argument ' data dir' type str default ' tmp tensorflow mnist input data' help 'directory for storing input data' flags parser parse args tf app run tf app run no newline at end of file ,fixed the consistency of data storage in tutorial , fix a bug in the docstring of the docstring of the new class change
2742,class test testcase def self self assertequal device util canonicalize cpu 0 job localhost replica 0 task 0 device cpu 0 replica 0 task 0 device cpu 0 self assertequal device util canonicalize job worker cpu 0 job worker replica 0 task 0 device cpu 0 ,no longer assume that the default job is localhost in graph mode distributionstrategy since it depends on the session drop job localhost when canonicalizing in graph mode piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2743,statusor autotuneresult cudnnconvalgorithmpicker pickbestalgorithmnocache break case xla f32 se devicememory float typed buffer buffer stream thenpopulateranduniform typed buffer break case xla f64 se devicememory double typed buffer buffer stream thenpopulateranduniform typed buffer uint32 bits memcpy bits kbroadcastedconstant sizeof bits stream thenmemset32 buffer bits buffer size break todo timshen populate non zero data for f64 default stream thenmemzero buffer buffer size ,automated rollback of commit piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2744,static char features static int included patches add new patch number below this line 31 30 ,patch terminal test aucmd on close if flaky problem terminal test aucmd on close if flaky solution wait a bit longer , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2745,class return operator mat feed dict def test assert positive definite self matrix with one positive and one negative with self test session tril 1 0 1 1 operator linalg linearoperatortril tril with self assertraisesoperror was not positive definite operator assert positive definite run def test assert non singular self matrix with one positive and one zero with self test session ,bugfix correct definition of positive definite previously we stated things were pd if all eigenvalues have positive real parts this is incorrect and different than the definition that that quadratic form have positive real part change , fix a bug in the test case piperorigin revid
2746,def split compile and replicate computation else output tensors control deps postprocess non flat outputs outputs tensor tracer imports tpu py local import to tensor tracer to avoid import cycle pylint disable g import not at top from tensorflow contrib tpu python tpu import tensor tracer pylint enable g import not at top if tensor tracer tensortracer is enabled tt tensor tracer tensortracer output tensors tt trace tpu ops get default graph output tensors control deps num replicas context exitresult output tensors finally context report unsupported operations ,tensor tracer extending tracing support for non estimator models piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2747,class resourcevariableopstest test util tensorflowtestcase state ops scatter update v 1 3 0 self assertallequal 1 0 3 0 v numpy def self with context eager mode v resource variable ops resourcevariable 1 0 2 0 name add state ops scatter add v 1 3 self assertallequal 1 0 5 0 v numpy def self with context eager mode v resource variable ops resourcevariable 1 0 2 0 name update ,expose scatter add for resource variables piperorigin revid , fix a bug in the test case piperorigin revid
2748,public explicit typeconstraint const llvm record record explicit typeconstraint const llvm definit init bool operator const typeconstraint that return def that def returns the predicate that can be used to check if a type satisfies this type constraint pred getpredicate const public protected the tablegen definition of this type const llvm record def const llvm record def wrapper class providing helper methods for accessing mlir type defined ,tablegen use tblgen classes for namedattribute and operand fields this is another step towards hiding raw tablegen api calls piperorigin revid , fix a bug in the parser parser test for the parser and the parser has been removed from the same class piperorigin revid change id ieadfcffeeccd
2749,limitations under the license gtest api int main int argc char argv std vector tensorflow flag flag list xla legacy flags appenddebugoptionsflags flag list string usage tensorflow flags usage argv 0 flag list auto usage tensorflow flags usage argv 0 flag list if tensorflow flags parse argc argv flag list log error n usage return 2 ,xla change type to appease gpu builds piperorigin revid , xla python fix a bug in the client client piperorigin revid change id icbbdbfafcdfcae
2750,class test testcase aggregation invalid def testnonmatchingvariablecreation self distribution self skiptest b 123075960 def model fn name v variable scope variable 1 0 name name class test testcase return v with distribution scope names values distributedvalues foo bar names values perreplica foo bar with self assertraises runtimeerror distribution extended call for each replica model fn args names ,revert skip testnonmatchingvariablecreation piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
2751,class strategy object return numer dim elif axis 0 axis axis array ops rank v denom array ops shape v2 v out type dtypes int64 axis if v shape rank 1 todo b currently tf shape is not supported in tpu dynamic padder use tf size instead to workaround if the rank is 1 denom array ops size v out type dtypes int64 else denom array ops shape v2 v out type dtypes int64 axis todo josh11b should we cast denom to v dtype here instead of after the reduce is complete return numer denom ,a workaround to make sure strategy reduce work correctly with dynamic shapes piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
2752,int test main int char due to poor std lib support not enough digits returned from std log and std exp if defined cygwin defined freebsd if defined cygwin defined freebsd defined gnuc defined sun std cout running long double tests std endl test long double 0 else std cout note the long double tests have been disabled on this platform either because the long double overloads of the usual math functions are not available at all or because they are too inaccurate for these tests to pass note std cout endif return 0 ,update tests to provide more information and disable tests that rely on long double overloads when those are known to be inaccurate svn r , fix a bug in the file
2753,struct fielddef public definition written in new data nor accessed in new code bool required field must always be present bool key field functions as a key for creating sorted vectors bool native inline field will be defined inline instead of as a pointer for native tables if field is a struct size t padding bytes to always pad after this field class parser public parserstate known attributes idempotent true known attributes cpp type true known attributes cpp ptr type true known attributes native inline true parser ,allows structs to be stored directly as member variables introduce a native inline attribute that can be applied on fields that are structs this results in code generation that sets the struct inline rather than storing it in a pointer from cl change id , fix a bug in the parser test for the new delegate piperorigin revid
2754,void infoaboutunusedcpufeatures checkiffeatureunused cpufeature fma fma missing instructions endif fma endif else of if defined msc ver defined clang if missing instructions empty log info this tensorflow binary is optimized with intel r mkl dnn string intel library official name intel r oneapi deep neural network library onednn ifndef intel mkl intel library official name oneapi deep neural network library onednn endif if missing instructions empty log info this tensorflow binary is optimized with intel library official name to use the following cpu instructions in performance critical operations missing instructions std endl to enable them in other operations rebuild tensorflow ,cpu feature guard mkl needs to change to to one dnn , fix a bug in the test case piperorigin revid
2755,add bkpt struct ps prochandle p uintptr t addr int after singlestep mask bkpt bkpt orig insn 0 free bkpt goto err return errno bkpt bkpt next p bkpts h ,remove spurious return a return after a goto crept in remove it , patch problem when using a popup window with a terminal window solution add a test for the mouse position
2756,read console input int head int tail int i static input record s if nlength 2 return s dwmax 0 true false read console input if s ircache s dwindex eventtype key event if s ircache s dwindex event keyevent wrepeatcount 1 s s ircache s dwindex s event keyevent wrepeatcount 1 s ircache s dwindex event keyevent wrepeatcount lpbuffer s lpevents 1 return true lpbuffer s ircache s dwindex if nlength 1 nlength 2 s dwindex s dwmax s dwmax 0 ,patch ms windows repeat count for events was not used problem ms windows repeat count for events was not used solution check the repeat count nobuhiro takasaki closes , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary of the line is not set solution add the test for the line
2757,statusor std unique ptr executable cpucompiler compile tf assign or return sequentialhloordering hlomodulesequence module sequence creatememoryminimizingsequence hlo module const logicalbuffer buffer return shapeutil bytesizeof buffer shape hlo module const logicalbuffer buffer return llvm ir bytesizeof buffer shape data layout run buffer analysis on the hlo graph this analysis figures out which cpucompiler compileaheadoftime tf assign or return sequentialhloordering hlomodulesequence module sequence creatememoryminimizingsequence hlo module const logicalbuffer buffer return shapeutil bytesizeof buffer shape hlo module const logicalbuffer buffer return llvm ir bytesizeof buffer shape data layout run buffer analysis on the hlo graph this analysis figures out which ,xla fix uses of shapeutil to use proper pointer size we missed a few places lets be more explicit and make the pointer size parameter necessary for tuple shapes change , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2758,int64 if fp nullptr return invalid cpu frequency int64 freq invalid cpu frequency const int retval fscanf fp lld freq int64 freq in invalid cpu frequency const int retval fscanf fp lld freq in if retval 0 log warning failed to file path return invalid cpu frequency pclose fp return freq return freq in 1000 the file contains cpu frequency in namespace profile utils ,add a test to check performance of shape inference of graphtransferer change , xla python add a xla interface to the xla client piperorigin revid
2759,pyobject new cxoconnection connection dpioracletypenum oracletypenum lob tp alloc 0 if lob return null if dpilob addref handle 0 py decref lob return null lob handle handle lob oracletypenum oracletypenum py incref connection ,eliminate reference leak with lob values acquired from attributes of objects or elements of collections , fix for the python version of the client client
2760,operator llvm module module const vlog 2 ir before optimizations xla vlog lines 2 llvm ir dumpmoduletostring module if pre optimization callback tf check ok pre optimization callback module if pre optimization hook tf check ok pre optimization hook module build up optimization pipeline operator llvm module module const vlog 2 ir after optimizations xla vlog lines 2 llvm ir dumpmoduletostring module if post optimization callback tf check ok post optimization callback module if post optimization hook tf check ok post optimization hook module generate code ,add tfcompile support for xla dump ir to to dump the llvm ir also minor renaming of to modulehook because it's shorter and describes the type slightly better also see piperorigin revid , xla gpu support for the hlo evaluator piperorigin revid change id id iaaeabfdfedfeacedf
2761,status node n graph g validateinlining n fbody get inline options if can inline function call ok tf return if error inlinefunctionbody g flib def g n fbody get inline options inlinefunctionbody flib def g n fbody get inline options else vlog 2 failed to inline function call node can inline function call error message ,use correct functionlibrarydefinition in function call lowering piperorigin revid , add a test for the cost of the graph piperorigin revid
2762,void output unsigned char level const char fmt return if we've specified monochrome we can just dump the buffer into the logfile as is otherwise we need to strip out any ansi codes that may be present if monochrome true fprintf handle s outputbuf void fflush handle ,document why that ansi stripping is there so i don't forget again , fix a bug in the syscall page
2763,functiondef iszero args x t return values equal t equal bool attr def t float double int32 int64 string functiondef maketensorslicedataset output shapes output shapes functiondef unique return fdh create name args x t return values y t idx out idx attr def t type out idx int32 int64 dt int32 nodes result unique x t t out idx out idx y result y 0 idx result idx 0 void functiontestschedclosure std function void fn static thread threadpool w new thread threadpool env default test 8 ,tests for , xla python fix a bug in the client client piperorigin revid
2764,limitations under the license include tensorflow core lib strings numbers h include tensorflow core lib strings str util h include tensorflow core lib strings strcat h include tensorflow core platform host info h include tensorflow core platform logging h include tensorflow core platform port h include tensorflow core public status h ,drop host info h from port h and include it directly where needed change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2765,class randomopstest xla test xlatestcase def rng dtype return random ops truncated normal shape 2 dtype dtype self testrngisnotconstant rng dtypes float32 todo b 34339814 make this test work with 16 bit float types for dtype in self random types np float32 np float64 self testrngisnotconstant rng dtype def testtruncatednormalisinrange self count 10000000 todo b 34339814 make this test work with 16 bit float types for dtype in self random types dtypes float32 dtypes float64 for dtype in self random types np float32 np float64 with self session as sess with self test scope x random ops truncated normal shape count dtype dtype ,xla enable truncated normal for double fix a problem in that causes the test not actually run add for double piperorigin revid , xla python fix a bug in the test piperorigin revid
2766,export class inspectorpanel extends polymerclass nearest neighbors controls let numnninput this dom select ' num nn input' let numnninput this ' nn slider' as htmlinputelement let updatenumnn this numnn numnninput property 'value' this numnn numnninput value this dom select ' num nn span' text this numnn if this selectedpointindex null this projector notifyselectionchanged this selectedpointindex numnninput on 'input' updatenumnn numnninput addeventlistener updatenumnn updatenumnn filtering dataset ,migrate to polymer also update neighbors list when the nearest neighbors slider changes change , fix a bug in the docstring of the docstring of the new version of the default value of the default value of the default value of the default value of the default value of the default value of the default value piperorigin revid
2767,import numpy as np from tensorflow python data experimental ops import readers from tensorflow python data kernel tests import test base from tensorflow python data ops import dataset ops from tensorflow python data util import nest from tensorflow python framework import constant op from tensorflow python framework import dtypes ,remove an unused import , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2768,def op grad ops registergradient floor def grad return grad return none ops registergradient batchmatmul ,fix gradient of tf floor , tf data optimizer to use tf data dataset piperorigin revid
2769,tensorflow status convertaftershapes conversionparams params graph alloc get engine nodes if status is ok we successfully added the node to the graph and can remove segment ops otherwise graph is not modified string msg strcat added tensorrt node engine engine name for segment i consisting string msg strcat tensorrt node engine engine name added for segment i consisting of converted segments at i first size nodes if status ok log info msg succeeded ,tftrt fix wording in logs , xla python fix a bug in the graph piperorigin revid
2770,void const float src ptr0 const float src ptr1 float packed ptr int start col int end col template struct packimpl path kneon fixedkernellayout order kcolmajor 1 8 float struct packimpl path kneon fixedkernellayout order 1 8 float float float static void run tuning tuning const matrix float src matrix packedmatrix float packed matrix int start col ,fix performance regression disabled neon float packing path piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2771,inline void libxsmmsparsematmul tl tr compute actual num threads do matrix matrix multiplication std atomic int cur mult block number cur mult block number store 0 ,fixed calling libxsmm by supplying 't' for transpose instead of a k a yes this fixes the issue by some of the regression tests thank you for reporting , fix a bug in the toy tutorial change id ibacfeebdbeaada
2772,bool hloparserimpl hlocomputation computation the pool which should not happen if root node nullptr log fatal instruction root name was marked as root but the parser has not seen it before abort was marked as root but the parser has not seen it before log fatal crashes the program by calling abort root root node first ,change comment as per code review , xla gpu support for the hlo hlo instruction piperorigin revid change id icabdabcccecababba
2773,class test util tensorflowtestcase dominate method 'bootstrap' regression false num split after samples 10 min split samples 5 min split samples 5 random seed 1 self assertallequal 4 finished eval self assertallequal stale eval ,deflake test by specifying a fixed random seed change , fix a bug in the docstring of the test case piperorigin revid
2774,class cudaexecutor public internal streamexecutorinterface const blockdim block dims const kernelbase k const kernelargsarraybase args override int calculateoccupancy const devicedescription device description int calculateoccupancy const devicedescription device description uint64 registers per thread uint64 shared memory per block const threaddim thread dims cufunction func const threaddim thread dims cufunction func int compareoccupancy int initial blocks const devicedescription device description int compareoccupancy int initial blocks const devicedescription device description uint64 registers per thread uint64 shared memory per block const threaddim thread dims cufunction func const threaddim thread dims cufunction func void allocate uint64 size override ,fully fixed clang errors , xla python fix a bug in the client backend piperorigin revid change id iefecfafdafabefecbd
2775,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 3 27 forward compatibility horizon datetime date 2020 3 28 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
2776,include random h include sanitise h get address include maps h include log h for bug include log h char page rand ,remove comment , move the syscall process to the syscall process
2777,static void scroll vtermstate state vtermrect rect int downward int if rect start col 0 rect end col state cols 0 int height rect end row rect start row abs downward int row vtermlineinfo 0 vtermlineinfo 0x0 if downward 0 memmove state lineinfo rect start row static int on resize int rows int cols void user for row rows row vtermlineinfo lineinfo 0 vtermlineinfo lineinfo 0x0 newlineinfo row lineinfo ,patch mac build fails problem mac build fails solution adjust configure to not fall back to athena adjust some other files , patch problem when using a popup window with a terminal window solution add a test for the mouse command
2778,public if this operation has a registered operation description in the operationset return it otherwise return null todo shouldn't have to pass a context here operation should eventually be able to get to its own parent const abstractoperation getabstractoperation const the methods perform a dynamic cast from an operation like ,fix b where we'd produce errors but not return failure from the parser i'm not sure how to write a non testcase for this piperorigin revid , fix a bug in the parser parser test piperorigin revid
2779,static char features static int included patches add new patch number below this line 963 962 ,patch terminal test fails on macos problem terminal test fails on macos chdiza solution wait for the shell to echo the characters closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2780,class bernoulli distribution distribution valueerror if p and logits are passed or if neither are passed parameters locals parameters pop self with ops name scope name as ns self logits self probs distribution util get logits and probs logits logits class bernoulli allow nan stats true name parameters locals parameters pop self with ops name scope name as ns super self init probs nn sigmoid logits name sigmoid probs ,move pop self logic into distribution change , fix a bug in the docstring of the documentation of the new class change
2781,class functiontest test testcase parameterized testcase self assertlen set concrete functions 1 def self def function function def add 100 args return math ops add n args p multiprocessing pool threadpool 2 args constant op constant 1 100 f1 f2 p map add 100 get concrete function args 2 i see about len args max 0 len args 3 arguments expected f1 args del f2 def testinputspecgraphfunction self matmul def function function math ops matmul ,make get concrete function threadsafe even when the function has arguments piperorigin revid , tf data dataset to use tf data dataset piperorigin revid
2782,class registry object stack trace is this function register user function so the user function is 2 stack tf stack extract stack user function stack 2 location tag tf stack convert stack user function 0 stack index min 2 len stack 1 if stack index 0 user function stack stack index location tag tf stack convert stack user function 0 else location tag unknown self registry name type tag candidate location tag location tag def list self ,add bounds checking when looking at the stack in tf registry this was breaking integration with r fixes piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
2783,class tf test testcase self stubs cleanup def testload self loader gcs file loader ' gs some fake url' loader gcs file loader 'gs some fake url' events list loader load self assertequal len events 1 self assertequal events 0 file version event 1' ,tensorboard correctly reads gcs paths from gs path on gcs this replaces the confusing gs path on gcs syntax change , fix a bug in the docstring of the test case piperorigin revid
2784,class function funcgraph def add op and parents self op op def function get op def op if op def is stateful raise valueerror cannot capture a stateful node by value raise valueerror cannot capture a stateful node name s type s by value op name op type elif op type in placeholder placeholderv2 raise valueerror cannot capture a placeholder by value raise valueerror cannot capture a placeholder name s type s by value op name op type captured inputs self add tensor and parents x for x in op inputs ,add more information to error message in contrib data function capturing example error message now looks like valueerror cannot capture a stateful node name random uniform type randomuniformint by value piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2785,void launchconv2dop gpudevice t operator se tf allocator adapter stream parent platform ctx device getallocator se cuda redzoneallocator rz allocator stream tf allocator adapter se cuda ptxcompilationoptions se devicememory t output tensor ,perform redzone checking for conv grad input ops piperorigin revid , fix a bug in the graph piperorigin revid
2786,from sklearn import datasets metrics from sklearn cross validation import train test split import skflow import tensorflow as tf random seed 42 ,explicit failure message for new unit test , fix a bug in the docstring of the docstring of the docstring change
2787,copyright 2015 the chromium authors all rights reserved use of this source code is governed by a bsd style license that can be found in the license file include stddef h include stdint h include string include third party flatbuffers tests monster test generated h extern c int llvmfuzzertestoneinput const uint8 t data size t size flatbuffers verifier verifier data size mygame example verifymonsterbuffer verifier return 0 ,add a fuzzer for flatbuffers derived from the one used in chromium https code google com p chromium chromium src testing libfuzzer fuzzers flatbuffers verifier fuzzer cc mirrored from cl change id , fix a bug in the new module of the new module piperorigin revid
2788,class opstest test util tensorflowtestcase parameterized testcase try config set device policy 'silent' config set soft device placement true avoid the tensorhandle cache hit todo b include context to the tensorhandle cache cpu tensor constant op constant 1 1 cpu tensor constant op constant 1 0 result cpu tensor cpu tensor self assertequal result device ' job localhost replica 0 task 0 device gpu 0' class opstest test util tensorflowtestcase parameterized testcase context async clear error config set synchronous execution true def self old context context context old x constant op constant 9 5 context set context context context try new x constant op constant 9 5 self assertequal new x numpy 9 5 finally context set context old context self assertequal old x numpy 9 5 if name ' main ' test main ,make tfe tensorhandlecache aware of tfe context some tests reset the global context and tensorhandlecache was incorrectly shared across different context before piperorigin revid change id , tf data dataset dataset to be a single device to be a single device piperorigin revid
2789,void tuning tuning const packedmatrix lhsscalar lhs matrix dstscalar dst using kernel kernel thepath lhsscalar rhsscalar dstscalar spec kernel kernel tuning if defined ndebug ruy opt enabled ruy opt kernel using lhslayout typename kernel lhslayout using rhslayout typename kernel rhslayout endif end row and end col may be larger than dst dimensions that is because kernels write directly to the destination matrix whose dimensions may not be a multiple of the kernel dimensions and we try to ,ruy reduce compiler warnings piperorigin revid change id , xla gpu support for the layout interface piperorigin revid change id id iaaeabfdfedfeacedf
2790,void height is specified the new computation contains nodes up to height nodes above the root help prints this usage information prints this usage information quit exit the application std endl ,in interactive graphviz more complete help command , xla python fix a bug in the parser test piperorigin revid
2791,job unref job t job job free job ifdef feat channel else if job jv channel null do remove the link to the channel otherwise it hangs job unref job t job channel unref job jv channel job jv channel null endif ,patch problem build fails with job feature but without channel feature solution add ifdef , patch problem when using a terminal window is a bit slow solution add a test for the command line
2792,logicalresult tf ifop if op funcop then branch replace uses for int64 t i 0 i old to new output indices size i if old to new output indices i 0 new if getresult i replacealluseswith if op getresult i replacealluseswith new if getresult old to new output indices i ,fix ifop handling for resource lifting piperorigin revid change id , xla gpu support for the layout interface piperorigin revid change id iaaeabfdfedfeacedf
2793,def convert image dtype image dtype saturate false name none image ops convert to tensor image name 'image' dtype tf dtypes as dtype dtype if dtype is floating or dtype is integer pass else if not dtype is floating and not dtype is integer raise attributeerror dtype must be either floating point or integer if dtype image dtype return array ops identity image name name ,if condition modified if condition modified to not use the else part , fix a bug in the docstring of the docstring of the docstring change
2794,class executionoutput interface that is used for launching compiled programs across platforms class executable public explicit executable std shared ptr hlomodule hlo module hlo module std move hlo module todo b remove this constructor explicit executable std shared ptr hlomodule hlo module std unique ptr hloprofileprinterdata hlo profile printer data ,xla add a xla executable constructor without hlo profile related arguments to prepare for removing those later piperorigin revid change id , xla python fix a bug in the test piperorigin revid
2795,def rnn model x y model path ' tmp skflow examples text if os path exists model path classifier skflow tensorflowestimator restore model path score metrics accuracy score classifier predict x test y test print 'accuracy 0 f ' format score else classifier skflow tensorflowestimator model fn rnn model n classes 15 steps 100 optimizer 'adam' learning rate 0 01 continue training true continuesly train for 1000 steps predict on test set continuesly train for 1000 steps while true try classifier fit x train y train except keyboardinterrupt classifier save model path break predict on test set score metrics accuracy score classifier predict x test y test print 'accuracy 0 f ' format score ,minor logic fix in save restore example , fix a bug in the docstring of the docstring of the keras model piperorigin revid
2796,vgetorpeek advance i fail else i ins typebuf s save m noremap remap yes save m noremap strncmp s int noremap if save m noremap remap yes noremap save m noremap else if ifdef feat eval save m keys null save m keys strncmp s save m keys null save m keys mp m keys size t keylen else strncmp s mp m keys size t keylen endif mp m keys size t keylen 0 remap yes remap skip 0 true cmd silent save m silent 0 noremap remap yes else noremap remap skip i ins typebuf s noremap 0 true cmd silent save m silent ifdef feat eval if save m expr vim free s ,updated for version problem can't build with some compilers solution move the ifdef outside of a macro cleanup the code , patch problem when using a popup window with a terminal window solution add a test for the cursor
2797,constexpr std array real 2 p daubechies scaling integer grid static assert p 15 integer grids only implemented up to 15 static assert p 1 integer grids only implemented for p 2 if constexpr p 2 static assert order 1 order 0 the 2 vanishing moment daubechies scaling function only has one derivative if constexpr std is same v real float if constexpr order 0 return 0f 0x1 0f 0x1 2f 0f ,static assert on the number of derivatives ci skip , xla python fix a bug in the hlo client client piperorigin revid change id icccbcbdbcfaadbee
2798,static bool const string node or tensor name return false const node n iter second if n name node or tensor name return false check eq n name id first targets insert n return true ,make node name a target node name change , add a new method to the new api piperorigin revid
2799,static char features static int included patches add new patch number below this line 1868 1867 ,patch vim no error for missing space after comma in dict problem vim no error for missing space after comma in dict solution check for white space closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2800,class function object self name name self input signature input signature self key for call stats self get key for call stats ops tf function api get cell set true pylint disable protected access def getstate self ,tensorflow metrics add tracking for the usage of tf function piperorigin revid change id , fix a bug in the docstring of the docstring of the test case piperorigin revid
2801,from tensorflow python keras impl keras import backend as k from tensorflow python keras impl keras import constraints from tensorflow python keras impl keras import initializers from tensorflow python keras impl keras import regularizers from tensorflow python keras impl keras applications import imagenet utils from tensorflow python keras impl keras applications imagenet utils import obtain input shape from tensorflow python keras impl keras applications imagenet utils import decode predictions pylint disable unused import from tensorflow python keras impl keras engine import inputspec def relu6 x def preprocess input x x 255 x 0 5 x 2 return x return imagenet utils preprocess input x mode 'tf' class depthwiseconv2d conv2d ,add to tf keras and update applications module to match keras piperorigin revid , tf data optimizer to use the keras api piperorigin revid
2802,check restricted void if restricted emsg shell commands not allowed in emsg shell commands and some functionality not allowed in return true return false ,patch can execute shell commands in through interfaces problem can execute shell commands in through interfaces solution disable using interfaces in restricted mode allow for writing file with writefile and a few others , patch problem when using a popup window with a popup window solution add the cursor to the current buffer when the cursor is set
2803,include linux if packet h include stdlib h include net h include random h void gen ipv6 unsigned long addr unsigned long addrlen void gen ipv6 unsigned long addr unsigned long addrlen addr unsigned long ipv6 addrlen sizeof struct sockaddr in6 void inet6 rand socket struct proto type pt switch rand 3 case 0 pt type sock stream tcp pt protocol 0 break case 1 pt type sock dgram udp if rand bool pt protocol 0 else pt protocol ipproto udp break case 2 pt type sock raw pt protocol rand proto max break default break ,inet move random socket generation into per protocol files , proto zmalloc conversion
2804,class keras parameterized testcase model layers input shape 10 x np ones 10 10 'float32' y np ones 10 1 'float32' y np zeros 10 1 'float32' optimizer rmspropoptimizer learning rate 0 001 model compile ,make regularizers api more consistent piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
2805,class linearmodel tfe network for those with tensorflow graphs notice the absence of tf session the forward method here immediately executes and returns output values the loss method immediately compares the output of forward with the target returns the mse loss value output of forward with the target and returns the mse loss value the fit performs gradient descent training on the model's weights and bias ,fix typo in linearmodel docstring and , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the input piperorigin revid
2806,def enable eager execution global default mode assert default mode graph mode default mode eager mode def list devices return context devices ,tfe fix an issue wherein tfe list device didn't work the function out because the undocumented name context was removed in tfe py piperorigin revid , tf data fix a bug in the graph piperorigin revid
2807,status xlacompileondemandop run opkernelcontext ctx run options set stream stream run options set allocator client backend memory allocator run options set intra op thread pool ctx eigen cpu device run options set rng seed ctx step id auto run result executable run launch context arguments run options tf return if error run result status ,set the random seed in on demand mode piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id ieffeabbcfbfbfadcee
2808,def extract dask data data def extract dask labels labels if isinstance labels dd dataframe ncol labels columns elif isinstance labels dd series ncol labels name if isinstance labels allowed classes if len labels columns 1 if len ncol 1 raise valueerror 'only one column for labels is allowed ' return construct dask df with divisions labels else ,fixed broken dask io test , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
2809,def set tensor shapes tensors shapes tensors tensorflow ops tensor shapes dict of strings representing input tensor names to list of integers representing input shapes e g foo 1 16 16 3 raises valueerror shapes contains an invalid tensor if shapes for tensor in tensors shape shapes get tensor name tensor tensor names to tensor tensor name tensor tensor for tensor in tensors for name shape in shapes items if name not in tensor names to tensor raise valueerror invalid tensor ' ' found in tensor shapes map format name if shape is not none tensor set shape shape tensor names to tensor name set shape shape def freeze saved model saved model dir input arrays input shapes ,make tflite convert error if input shapes are invalid piperorigin revid , tf data dataset to tf data dataset dataset to tf data dataset piperorigin revid
2810,find decl if pos findmatchlimit null ' ' fm forward int old pos lnum curwin w cursor lnum 1 null pos lnum old pos lnum there can't be a useful match before the end of this block skip to the end curwin w cursor pos continue if t fail nv g cmd cmdarg t cap break endif g show scrollback text case ' ' show sb text break ,patch gd may hang problem gd may hang solution don't get stuck in one position christian brabandt closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
2811,class cachedatasetop filedataset public datasetbase tf return if error dataset env newwritablefile lockfile lockfile tf return if error lockfile append strings strcat dataset env nowseconds strings strcat envtime nowseconds at this point we know that 1 there is no conflicting checkpoint with prefix filename ,update tf data to use static envtime now methods instead of virtual env now methods piperorigin revid change id , tf data service support for tf data dataset piperorigin revid change id icccbcbdbcfaadbee
2812,limitations under the license define tflite enable hexagon endif if defined tflite enable hexagon include tensorflow lite experimental delegates hexagon hexagon delegate h endif namespace tflite namespace benchmark tflitedelegateptr createtflitedelegate tflitedelegateptr delegate nullptr tflitedelegate if defined tflite enable hexagon if params get bool use hexagon tflitehexagondelegateoptions options 0 options print graph profile params get bool hexagon profiling options max delegated partitions params get int max delegated partitions delegate evaluation createhexagondelegate params get std string hexagon lib path params get bool hexagon profiling options params get std string hexagon lib path if delegate get tflite log warn ,support hexagon delegate to have an option to specify the max number of partitions to be delegated and changed the benchmark tool to support this feature piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2813,class xlaopkernelcontext variable has been initialized with a different type or with a different shape status assignvariable int input index datatype type const xla computationdatahandle handle xla computationdatahandle handle helper routines for the op requires macros void ctxfailure const status s ,tf xla add a hook to allow reshaping of tensorflow variables when storing them in their xla representation piperorigin revid , fix a bug in the test case piperorigin revid
2814,class lhlofuselinalg public passwrapper lhlofuselinalg functionpass lhlofuselinalg default lhlofuselinalg const lhlofuselinalg lhlofuselinalg bool use parallel loops llvm arrayref unsigned tile sizes tile sizes assign tile sizes begin tile sizes end tile sizes tile sizes use parallel loops setvalue use parallel loops ,update mlir users after replacing cl opts with pass options piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id iaaffafbceeeafc
2815,class wrappedfunction function function pruned graph func graph funcgraph pruned sink tensor array ops identity n flat fetches 0 lift map lift to graph lift to graph sink tensor pruned graph sources flat feeds sink tensor pruned graph sources flat feeds self graph internal captures pruned graph outputs extend lift map x for x in flat fetches for external capture internal capture in self graph captures items pruned graph captures external capture lift map internal capture pruned graph inputs extend lift map x for x in flat feeds pruned graph inputs extend pruned graph captures values pruned graph structured outputs nest map structure lambda node lift map node fetches pruned fn wrappedfunction pruned graph variable holder self variable holder pruned fn num positional args len flat feeds pylint disable protected access ,support captures in tf compat v wrap function prune also sets the output structure instead of returning the flattened structure piperorigin revid , fix a bug in the test piperorigin revid
2816,static char features static int included patches add new patch number below this line 267 266 ,patch no good check if restoring quickfix list worked problem no good check if restoring quickfix list worked solution let qf restore list return ok fail yegappan lakshmanan , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2817,struct operatorproperty use same min of min and max of max for each group incompatible with restrict same input output scale and restricted value todo jianlijianli make it compatible with other restrictions when there currently it only supports scale pair of input index output index todo b make it compatible with other restrictions when there is a use case std vector std vector int restrict scale ,clarify use case of restrict scale piperorigin revid change id , fix a bug in the parser test piperorigin revid
2818,from future import division print function absolute import import tensorflow as tf from skflow ops batch norm ops import from skflow ops batch norm ops import batch normalize def conv2d tensor in n filters filter shape strides none padding 'same' ,batch norm ops more params and available for non convnet , tf data service support for tf data dataset piperorigin revid
2819,class a list of affine bounds not using a here since numsymbols is the same as the containing numsymbols and its numdims is 0 typedef smallvector affineexpr 4 using smallvector affineexpr 4 a hyperrectangularset is a symbolic set of integer points contained in a hyper rectangular space it supports set manipulation operations public these are for the list of hyper rectangular set elements typedef llvm iplist hyperrectangularset hyperrectanglelistty using hyperrectanglelistty llvm iplist hyperrectangularset hyperrectanglelistty getrectangles return hyperrectangles iteration over the statements in the block ,change typedef to using to be consistent across the codebase google c style guide also prefers using to typedef piperorigin revid , fix a bug in the test case piperorigin revid
2820,tf function tf graphtofunction wrapper opts description out status void tf graphsettensorshape wrapper tf graph graph tf output output const std vector int64 t dims bool unknown shape tf status status if unknown shape tf graphsettensorshape graph output nullptr 1 status return tf graphsettensorshape graph output dims data dims size status std vector int64 t tf wrapper tf graph graph tf output output int num dims tf status status std vector int64 t dims num dims tf graph output dims data num dims status return dims namespace tensorflow ,enabling tensor set shape to work with the c api piperorigin revid , fix a bug in the test case piperorigin revid
2821,node graph node node props ref node copy allocatenode props node copy set assigned device name node assigned device name since the opdef of a function may be owned by the graph that owns 'node' the opdef in the target graph if it differs then clone the node properties with the updated opdef const opdef op def tf check ok ops lookupopdef node type string op def if op def props op def copy maybecopyonwrite copy props op def op def return copy ,fix use of incorrect opdef from another graph's function library in graph piperorigin revid , add a test for the graph and the graph piperorigin revid
2822,static void do extrafork struct syscallrecord rec small pause to let grandchild do some work if pid alive extrapid true sleep 1 usleep 100 while pid 0 int childstatus ,reduce the amount of time we wait for the grandchild a little , fix a bug in the watchdog process
2823,except importerror pass try from python keras api v2 import keras from tensorflow python keras api v2 import keras current module path module util get parent dir keras current module path setattr current module keras keras ,automated rollback of commit piperorigin revid , fix a bug in the docstring of the test piperorigin revid
2824,class launchxsmmconvop cpudevice float desc datatype in libxsmm dnn datatype f32 desc datatype out libxsmm dnn datatype f32 if canusexsmmconv2d desc data format return false auto input ptr input template flat float data auto filter ptr filter template flat float data auto output ptr output template flat float data ,re introduced entry guard for libxsmm convolutions , fix a bug in the new delegate piperorigin revid
2825,limitations under the license include tensorflow compiler xla service cpu compiler functor h include tensorflow compiler xla service cpu conv canonicalization h include tensorflow compiler xla service cpu cpu executable h include tensorflow compiler xla service cpu cpu hlo support checker h include tensorflow compiler xla service cpu cpu instruction fusion h include tensorflow compiler xla service cpu cpu layout assignment h include tensorflow compiler xla service cpu cpu options h status cpucompiler runhlopassesthroughlayoutassn pipeline addpass zerosizedhloelimination pipeline addpass dynamicindexsplitter pipeline addpass cpuhlosupportchecker pipeline addpass pipeline addpass mapinliner ,xla remove unsupported sparse layout sparse layouts are not supported on any of the backends for backwards compatibility the fields stay in the protobuf but parsing them is a no op piperorigin revid change id , xla gpu support for the client backend piperorigin revid change id icbbdbfafcdfcae
2826,def make add tests options register make test function def make div tests options make binary op tests options tf div make binary op tests options tf compat v1 div register make test function ,tf div is now tf compat v div piperorigin revid change id , fix a bug in the documentation of the documentation of the documentation of the tf nn entropy with logits and add a test for the test case
2827,class tensorlikedataadapter dataadapter sample weights process numpy inputs sample weights if sample weights are not specified for an output use 1 0 as weights if sample weights is not none and none in sample weights if sample weights is not none and any sw is none for sw in sample weights weight next s for s in sample weights if s is not none sample weights training utils list to tuple array ops ones weight shape 0 if sw is none else sw ,avoid tensor in list test piperorigin revid , update keras layers to keras piperorigin revid
2828,class runoptions attributes experimental enable dynamic batch size boolean only applies to tpustrategy default to false if true tpustrategy will enable dynamic tpustrategy default to true if true tpustrategy will enable dynamic padder to support dynamic batch size for the inputs otherwise only static shape inputs are allowed experimental dynamic shape boolean only applies to ,fix documentation for tf distribute runoptions piperorigin revid change id , tf data saveable shape for tf data dataset piperorigin revid
2829,computation primitivetype type const computationdatahandle rhs return b add lhs rhs computation primitivetype type computationbuilder builder return add type builder computationbuilder b const computationdatahandle lhs const computationdatahandle rhs return b mul lhs rhs computation primitivetype type computationbuilder builder return ,xla cpu vectorize reduction operations this change teaches xla to generate vectorized code sequences for reduction operations this is still a work in progress but i wanted to get it out for discussion for early feedback piperorigin revid , xla gpu support for xla hlo client piperorigin revid
2830,status const codegenopts opts const tf2xla config config tf return if error config const int64 result index compile result aot result buffer index const xla temp sizes compile result aot buffer sizes if result index 0 result index temp sizes size if result index 0 result index temp sizes size return errors invalidargument result index result index is outside the range of temp sizes 0 temp sizes size ,fix oob check for result index in header generation , xla python add a xla interface to the xla client piperorigin revid change id idaceccfcbacfece
2831,def set tf cuda compute capabilities environ cp for compute capability in tf cuda compute capabilities split ' ' m re match ' 0 9 0 9 ' compute capability if not m print 'invalid compute capability ' compute capability print 'invalid compute capability s' compute capability all valid false else ver float m group 0 if ver 3 5 print 'error tensorflow only supports cuda compute capabilities 3 5 ' 'or higher please re specify the list of compute capabilities ' ' excluding all those versions that are less than 3 5' 'and higher please re specify the list of compute ' excluding version s ' ver all valid false if all valid ,adjust wording in warning , fix a bug in the docstring of the documentation of the tf data dataset piperorigin revid
2832,limitations under the license include tensorflow compiler tf2xla xla helpers h include tensorflow compiler tf2xla xla op kernel h include tensorflow compiler tf2xla xla op registry h include tensorflow compiler xla client lib math h include tensorflow compiler xla client xla builder h include tensorflow core util tensor format h class fusedbatchnormgradop public xlaopkernel offset backprop xlahelpers convertelementtype reduce scale dtype scratch1 rsqrt pop var epsilon auto neg half xlahelpers floatliteral b scale dtype 0 5 auto scratch1 xla pow xla add var xla constantr0 float b epsilon neg half auto scratch1 xla rsqrt xla add var xla constantr0 float b epsilon scratch2 sum y backprop x mean auto mul ,tfxla replace a call to pow with an exponent of with rsqrt piperorigin revid , xla python add a test for the xla client client piperorigin revid
2833,include x11 h endif if defined have sys select h defined have sys time h defined sys select with sys time include sys select h endif ifndef have select ifdef have sys poll h include sys poll h else ifdef have poll h include poll h endif endif endif this file provides that implement the command server functionality of vim when in contact with an x11 server ,updated for version problem netbeans hangs reading from a socket at the maximum block size solution use select or poll xavier de gaye , patch problem when using a popup window with a popup window solution add a test for the mouse event
2834,bool isgooglecudaenabled endif bool cudasupportshalfmatmulandconv if google cuda bool if tensorflow use rocm return true else return false endif bool if google cuda tensorflow use rocm return true else return false ,update interfaces within port h and associated tests and python interfaces rename to introduce , fix a bug in the parser delegate piperorigin revid change id idacdededdbdcfbcdb
2835,layout createdefaultlayoutforrank int64 rank static std vector int64 layoututil const layout layout std vector int64 logical to physical layout minor to major size for int64 physical 0 physical logical to physical size physical for std vector int64 size type physical 0 physical logical to physical size physical const int64 logical major layout physical logical to physical logical physical ,fix compile warnings fixes instances of comparisons between 'signed' and 'unsigned' , xla gpu support for the xla client piperorigin revid
2836,limitations under the license namespace tensorflow namespace jit class deviceinfocache class deviceset instances of deviceid represent tensorflow devices as integers this helps avoid having to device names as strings when ,add forward declarations of classes piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2837,win line endif ifdef feat syn hl syntax attr 0 if extra check n extra 0 syntax attr 0 ifdef feat terminal if get term attr syntax attr term get attr wp w buffer lnum vcol ,patch syntax highlighting wrong for tab problem syntax highlighting wrong for tab solution don't clear syntax attribute n extra is non zero , patch problem when using a popup window with a terminal window solution add the option to the current buffer when the cursor is set
2838,see the license for the specific language governing permissions and limitations under the license enable the use of m math constants note this must be first in the file to ensure that if cmath is transitively included by any other header it has the define set on first processing https docs microsoft com en us cpp c runtime library math constants define use math defines include cmath include numeric include mlir hlo dialect mhlo ir chlo ops h ,fixing m pi compile error on msvc m pi and other math constants used in chlo legalize hlo patterns td are not part of the c standard and must be enabled on msvc similar to gnu source adding glibc symbols to posix headers piperorigin revid change id , add a test for the new op op piperorigin revid
2839,from tensorflow python framework import sparse tensor from tensorflow python framework import test util from tensorflow python ops import array ops from tensorflow python ops import check ops from tensorflow python ops import gradients from tensorflow python ops import math ops from tensorflow python ops import random ops from tensorflow python platform import test class test testcase with self test session as sess sess run derived feed dict placeholder feed val def testgradient self placeholder array ops placeholder dtypes float32 derived check ops ensure shape placeholder none none gradient gradients gradients derived placeholder feed val 4 0 1 0 with self test session as sess gradient values sess run gradient feed dict placeholder feed val expected 1 0 1 0 self assertallequal gradient values expected class test benchmark ,register gradient for ensureshape op currently this op cannot be used within backprop path because it lacks gradient registry piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2840,simplify filename char u filename while vim ispathsep p start p remember start after c or or ifdef unix posix says that path is unchanged but path is path if start filename 2 strmove filename 1 p start p filename 1 endif do ,patch simplify does not remove slashes from path problem simplify does not remove slashes from path solution reduce slashes to one closes , patch problem when using a terminal window doesn't work solution add a test for the gui
2841,import numpy as np from tensorflow python client import session from tensorflow python framework import errors from tensorflow python framework import ops from tensorflow python platform import gfile from tensorflow python platform import tf logging as logging from tensorflow python training import saver as saver mod class sessionmanager object loads the checkpoint saver restore sess ckpt model checkpoint path last checkpoints for fname in ckpt all model checkpoint paths fnames gfile glob fname if fnames mtime gfile stat fnames 0 mtime last checkpoints append fname mtime saver set last checkpoints with time last checkpoints saver recover last checkpoints ckpt all model checkpoint paths return sess true def prepare session self master init op none saver none ,introduce a to saverdef this unlocks the opportunity for experimenting w different checkpoint formats change , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2842,status queuebase copyslicetoelement const tensor parent tensor element handle type dt qint32 handle type dt qint16 handle type dt quint16 handle type dt uint16 undef handle type return errors unimplemented copyslicetoelement unhandled data type parent dtype status queuebase copyelementtoslice const tensor element tensor parent handle type dt qint32 handle type dt qint16 handle type dt quint16 handle type dt uint16 undef handle type return errors unimplemented copyelementtoslice unhandled data type element dtype ,added missing support for uint type in the queues change , fix a bug in the graph piperorigin revid
2843,static tensorflow datatype pyobject tensor pyobject enum field pyobject getattrstring dtype field type enum py decref dtype field if dtype field nullptr if enum field nullptr return tensorflow dt invalid tensorflow int64 id makeint enum field ,fix typo in helper in pywrap tfe src cc testing wrong variable against nullptr piperorigin revid change id , fix a bug in the test case piperorigin revid
2844,static void ruby init stack value static void ruby process options int char endif ifdef ruby19 or later static signed value rb num2long stub value x if defined ruby19 or later defined proto signed value rb num2long stub value x return dll rb num2long x static value rb int2big stub signed value x value rb int2big stub signed value x return dll rb int2big x ,updated for version problem building with ruby fails on some systems solution remove static and add ifndef proto ken takata , fix a bug in the watchdog page
2845,limitations under the license from future import absolute import from future import division ,seal gradients interface change , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
2846,limitations under the license include tensorflow core lib core coding h include tensorflow core lib core errors h include tensorflow core lib gtl map util h include tensorflow core lib gtl stl util h include tensorflow core lib hash crc32c h include tensorflow core lib io path h include tensorflow core lib io table builder h bundlereader bundlereader delete pair second file gtl stldeletevalues data gtl stldeletevalues tensor slices for auto temp data delete temp second for auto temp tensor slices delete temp second data clear tensor slices clear status bundlereader getbundleentryproto stringpiece key ,remove usages of gtl function piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2847,literal strideconfig strideconfig base dimensions size 0 step dimensions size 1 if dimensions empty selects the shape with the highest minor dimension as the one upon where to run the tight stride loop if source shape layout minor to major 0 dest shape layout minor to major 0 selects the shape with the largest minor dimension as the one upon which to run the tight stride loop if dimensions source shape layout minor to major 0 dimensions dest shape layout minor to major 0 minor dimension source shape layout minor to major 0 dest stride indexutil getdimensionstride dest shape minor dimension else ,xla in literalutil choose the larger dimension between the source and destination shapes' minor most dimension index piperorigin revid , xla gpu support for xla hlo client piperorigin revid
2848,size t getthreadcount if gtest is threadsafe gtest os windows void sleepmilliseconds int n sleep n sleep static cast dword n ,address fallout from wsign conversion work on windows some windows users builds were broken after this change addresses the lingering wsign conversion issues with those platforms by adding some missing static cast calls as needed signed off by enji cooper yaneurabeya gmail com , fix a bug in the parser test for the new parser test piperorigin revid
2849,class layer module module version utils layerversionselector if initializer is none if dtype is dt float provide a uniform unit scaling initializer if dtype is floating initializer initializers glorot uniform initializer initializers get 'glorot uniform' if dtype is dt int dt uint provide a default value zero if dtype is dt bool provide a default value false elif dtype is integer or dtype is unsigned or dtype is bool initializer initializers zeros initializer initializers get 'zeros' notes do we need to support for handling dt string and dt complex here else raise valueerror 'an initializer for variable s of type s is required' ,make keras deserialization aware of enable disable v behavior switches piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
2850,class meanperclassaccuracytest test testcase weights queue data flow ops fifoqueue 6 dtypes dtypes lib float32 shapes 1 1 enqueue vector sess weights queue 1 0 enqueue vector sess weights queue 1 0 enqueue vector sess weights queue 0 5 enqueue vector sess weights queue 1 0 enqueue vector sess weights queue 0 0 enqueue vector sess weights queue 0 5 enqueue vector sess weights queue 1 0 enqueue vector sess weights queue 0 0 weights weights queue dequeue ,set the correct weight for the test , fix a bug in the docstring of the test case piperorigin revid
2851,status constantfolding materializereductionindices reduction indices createnodedef const name tensorvalue value reduction indices set device node device reduction indices add input string ctrl dep addcontroldependency node input 1 graph node map get reduction indices add input ctrl dep node map addnode const name reduction indices node map addoutput nodename ctrl dep const name node set input 1 reduction indices name node map updateinput node name indices name ,keep the node map up to date to ensure that nodes won't get deleted by mistake piperorigin revid , xla gpu support for the layout inference piperorigin revid change id idaceccfcbacfece
2852,class tmpdirfilesystem public nullfilesystem if host return errors failedprecondition host must be return env default createdir io joinpath basedir path status status env default createdir io joinpath basedir path if status ok record that we have created this directory so isdirectory works created directories push back std string path return status status isdirectory const string dir override stringpiece scheme host path io parseuri dir scheme host path for const auto existing dir created directories if existing dir path return status ok return errors notfound dir not found void flushcaches override flushed true private bool flushed false std vector std string created directories register file system tmpdirfilesystem ,rollback of roll forward of original recursively create and delete directories under posix modular filesystem piperorigin revid change id , xla python fix a bug in the test piperorigin revid
2853,struct recvnodedescriptor node node port num port num device device struct struct std size t operator const recvnodedescriptor recv node const return std hash const nodedef recv node node std hash int recv node port num status virtualscheduler init to reuse recv ops std unordered map recvnodedescriptor const nodedef std unordered map recvnodedescriptor const nodedef cached recv nodes ,fix typo in struct name piperorigin revid , fix a bug in the graph piperorigin revid
2854,class capturedstream char name template tmp captured stream xxxxxx endif gtest os linux android const int captured fd mkstemp name template if captured fd 1 gtest log warning failed to create tmp file name template for test does the test have access to the tmp directory filename name template endif gtest os windows fflush nullptr class capturedstream file const file posix fopen filename c str r if file nullptr gtest log fatal failed to open tmp file filename for capturing stream const std string content readentirefile file posix fclose file return content ,googletest export add a safety nullptr check to catch the case where the tmp file used for capturing a stream cannot be created piperorigin revid , updated for version problem when using a function to be a dictionary solution add a test for the test
2855,static char features static int included patches add new patch number below this line 1795 1794 ,patch vim operators and have a confusing result problem vim operators and have a confusing result solution make the result a boolean , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2856,class testmodule tf module check func a za z 0 9 check same arg0 tensor f32 tf saved model index path 0 check same arg1 tensor x tf resource tf saved model bound input var check same arg2 tensor f32 tf saved model bound input const tensor f32 check same arg2 tensor f32 tf saved model bound input const check same tensor f32 tf saved model index path check next attributes tf saved model exported names some function tf function input signature tf tensorspec tf float32 def some function self x ,add support for structured output args this is the final piece of representing the savedmodel calling semantics object graph version they are now fully captured in the mlir module piperorigin revid change id , fix a bug in the test case piperorigin revid
2857,class distributediteratortestbase def dataset fn ctx none ctx ctx or distribute lib inputcontext batch size ctx get per replica batch size global batch size row lengths np mod np arange 20 4 deal with partial batches use 20 which isn't divisible by 8 to test partial batch behavior row lengths np mod np arange 20 4 astype np int64 ragged tensor ragged tensor lib raggedtensor from row lengths np repeat np arange 20 dtype np float32 row lengths row lengths dataset dataset ops datasetv2 from tensor slices ,fix for windows piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2858,limitations under the license include string include absl strings str cat h include tensorflow lite delegates gpu cl kernels util h include tensorflow lite delegates gpu common util h namespace tflite ,gpu cl kernels util merged with gpu common task util piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2859,class metaoptimizer public graphoptimizer initialize active optimizers from rewriterconfig optimizer names status std vector std unique ptr graphoptimizer optimizers const initialize active optimizers from rewriterconfig custom optimizers status initializecustomgraphoptimizers std vector std unique ptr graphoptimizer optimizers const run optimization pass over a single grappleritem meta optimizer might run multiple such passes 1 for the main graph 2 for the function library ,set meta optimizer to use custom graph optimizers for both toggling optimizers and setting optimizer names piperorigin revid , tf data service support for tf data service piperorigin revid change id idaceccfcbacfece
2860,test f remappertest fuseconv2dwithsqueezeandbias std vector int strides 1 1 1 1 auto conv ops conv2d s withopname conv input filter strides same ops squeeze attrs attrs attrs attrs axis 2 auto squeeze ops squeeze s withopname squeeze conv attrs auto squeeze ops squeeze s withopname squeeze conv ops squeeze attrs axis 2 auto bias add ops biasadd s withopname bias add squeeze bias auto fetch ops identity s withopname fetch bias add ,grappler fix another stack use after scope ops squeeze attrs only stores a reference so the initializer list was used after its lifetime ends piperorigin revid change id , fix a bug in the test case piperorigin revid
2861,class crossedcolumn featurecolumn collections namedtuple trainable self name weights def crossed column columns hash bucket size def crossed column columns hash bucket size combiner sum return crossedcolumn columns hash bucket size return crossedcolumn columns hash bucket size combiner combiner def get feature config feature column ,adds combiner parameter to crossed column change , fix a bug in the docstring of the docstring of the tf contrib estimator piperorigin revid
2862,limitations under the license ifndef tensorflow core kernels gpu utils h define tensorflow core kernels gpu utils h if google cuda if google cuda tensorflow use rocm include unordered map status bestcudnnconvalgorithm absl span const autotuneresult results namespace tensorflow endif google cuda endif google cuda tensorflow use rocm endif tensorflow core kernels gpu utils h ,adding rocm support for the matmul op , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2863,from future import division from future import print function from tensorflow python keras engine import base preprocessing layer v1 from tensorflow python keras layers preprocessing import categorical encoding v1 from tensorflow python keras layers preprocessing import category encoding v1 from tensorflow python keras layers preprocessing import string lookup v1 from tensorflow python keras layers preprocessing import text vectorization from tensorflow python util tf export import keras export class textvectorization text vectorization textvectorization def get vectorization class self return categorical encoding v1 categoricalencoding return category encoding v1 categoryencoding def get index lookup class self return string lookup v1 stringlookup ,exporting categoryencoding layer piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
2864,using typesf16f32f64cf64 testing types eigen half float endif check that we can safely pass an input tuple's elements to a dot operation test f dotoperationtest xla test f dotoperationtest xlabuilder builder testname xlaop param ,allow for disabling of tests , add a test for the new op api piperorigin revid
2865,public and use pointers to struct to avoid the complexity of the platform specific c c abi lowering related to struct argument passing smallvector value 4 location loc arrayref value arrayref value operands valuerange valuerange operands opbuilder builder promote the llvm struct representation of one memref descriptor to stack ,replace spurious smallvector constructions with signed off by uday bondhugula uday polymagelabs com closes copybara integrate review https github com tensorflow mlir pull from bondhugula value range piperorigin revid change id , fix a bug in the parser test piperorigin revid
2866,class buffervalue operator is required for std set bool operator const buffervalue other const return id other id bool operator const buffervalue other const return id other id bool operator const buffervalue other const return id other id virtual string tostring const 0 todo rename to ,automated rollback of commit piperorigin revid , fix a bug in the new delegate piperorigin revid
2867,barycentric rational imp real barycentric rational imp inputiterator start x if abs diff std numeric limits real epsilon boost format boost format between x 1 and x 2 is 3 which is smaller than the epsilon of 4 k i diff boost typeindex type id real pretty name std cout typeid name std endl throw std logic error str inv product diff ,add concept checks for barycentric rational , patch problem when using a popup window with a popup window solution add the cursor to the cursor when the cursor is set
2868,namespace detail boost private gcd uf unsigned long ifdef boost has long long boost private gcd uf unsigned long long boost private gcd uf boost ulong long type elif defined boost has ms int64 boost private gcd uf unsigned int64 endif namespace detail boost private gcd sf char unsigned char should work even if unsigned ifdef boost has long long boost private gcd sf long long unsigned long long boost private gcd sf boost long long type boost ulong long type elif defined boost has ms int64 boost private gcd sf int64 unsigned int64 endif ,changed long long to boost long long type and unsigned long long to boost ulong long type a couple of other typo corrections to get the code compiling with g pedantic svn r , fix a bug in the previous commit case the previous commit is not used in the case of the case of the number of the number of the number of the number of the number of the number of the number of the number of the number of the number of the number
2869,cin is cpp baseclass cached pos lnum lnum line ml get lnum s cin skipcomment line s line for if s nul cin is cpp baseclass cached break continue in the cursor line line ml get lnum s line if s line don't recognize case foo as a baseclass if cin iscase s false break s cin skipcomment line if s nul continue ,patch problem c indenting is wrong below a case foo because it is recognized as a c base class construct issue solution check for the case keyword , patch problem when using a terminal window is a bit slow solution add a test for the gui
2870,def fast fill value shape dtype def zeros shape dtype if dtype dtypes variant if dtype dtypes variant or dtype dtypes string todo apassos need to save enough information about variant tensors to do a zeros return none def zeros shape dtype def ones shape dtype if dtypes as dtype dtype dtypes string return none if not context context executing eagerly return array ops ones shape dtype ,this cl fixes gradient tapes involving strings to make sure they return none for string targets instead of erroring piperorigin revid , fix a bug in the documentation of the documentation of the new api change
2871,test nestedtuple endif gtest has tr1 tuple if gtest lang cxx11 if gtest has std tuple tests printing std tuples tuples of various ,distinguish between c language and library support for std function std begin std end and std move in gtest and gmock , patch problem when using a channel to be a newline solution add a test for the cursor
2872,static char features static int included patches add new patch number below this line 2058 2057 ,patch problem eval c is too big solution move user functions to c , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2873,test attr def node def functiondefhelper const gtl arrayslice int 2 functiondefhelper const gtl arrayslice string functiondefhelper const gtl arrayslice tstring arg0 output 0 output 0 test attr def node def functiondefhelper const static cast int64 0 functiondefhelper const string functiondefhelper const tstring parse parsesingleexample arg0 output 0 output 0 ,updated core grappler to use tstring this is a part of a larger migration effort for tensorflow tstring see https github com tensorflow community pull piperorigin revid , fix a bug in the test case piperorigin revid
2874,def train and eval forest is no longer growing early stopping rounds 100 check every n steps 100 monitor random forest early stopping rounds check every n steps monitor random forest tensorforestlossmonitor early stopping rounds check every n steps mnist input data read data sets flags data dir one hot false ,migrating skflow examples to the tensorflow examples learn directory fixes change , update documentation to use tf nn rnn api piperorigin revid
2875,std string makeuniquefilename string name static instance new remove illegal characters from name for size t i 0 i name size i for int i 0 e name size i e i char ch name i if ch ' ' ch ' ' ch ' ' ch ' ' ch ' ' ch ' ' ,update dump mlir util cc , xla python fix a bug in the hlo computation piperorigin revid change id id iefecfafdafabefecbd
2876,status cpuexecutable executecomputefunction tensorflow gtl arrayslice se devicememorybase buffers hloexecutionprofile hlo execution profile std vector se devicememorybase argument buffers for int i 0 i arguments size i argument buffers push back arguments i buffer index argument buffers reserve arguments size for const auto argument arguments argument buffers push back argument buffer index return executecomputefunction run options argument buffers buffers hlo execution profile ,reserve vector capacity when the final size is known piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2877,class public private string session handle bool create worker session called bool create worker session called false string graph handle int64 step id executoropts exec opts ,prevent a bool field from being accessed when uninitialized piperorigin revid , fix a bug in the parser test piperorigin revid
2878,typed test depthwise valid types template typename t class grouped valid public convolutiontest class grouped valid public convolutiontest public void runtest xlabuilder builder testname class grouped valid public convolutiontest typed test case grouped valid testtypes typed test grouped valid types typed test case grouped valid testtypes typed test grouped valid types this runtest ,fix a convolution test's name piperorigin revid , fix a bug in the new delegate implementation of the new delegate implementation of the new delegate piperorigin revid change id iefbfddadbafacfd
2879,std unique ptr functionlibraryruntime newfunctionlibraryruntime int graph def version const functionlibrarydefinition lib def thread threadpool thread pool const optimizeroptions optimizer options const customkernelcreator custom kernel creator const metadata processfunctionlibraryruntime parent functionlibraryruntime getfunctionbody returns a description of an ,pass in the through the processfunctionlibraryruntime o previously op implementations using the function library runtime weren't passing the to the ops being run under the function library runtime piperorigin revid , xla gpu support for the xla client piperorigin revid change id idfbdfbcdacfbeebb
2880,static struct vimoption endif endif char u 0l scriptid init langmap lmap p string p vi def p comma p nodup langmap lmap p string p vi def p comma p nodup p secure ifdef feat langmap char u p langmap pv none char u unmatched ,updated for version problem setting 'langmap' in the modeline can cause trouble e g mapping breaks many commands solution disallow setting 'langmap' from the modeline , patch problem when using a terminal window is a bit slow solution add a test for the gui
2881,static char features static int included patches add new patch number below this line 1168 1167 ,patch wrong highlighting with combination of match and 'cursorline' problem wrong highlighting with combination of match and 'cursorline' solution use line attr when appropriate ozaki kiichi closes but don't highlight more than one character , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2882,limitations under the license include vector include llvm adt triple h include llvm support host h include tensorflow compiler xla client client library h include tensorflow compiler xla client xla builder h include tensorflow compiler xla client xla computation h ,add missing header include piperorigin revid change id , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
2883,status writetensorboardtpuprofile const string logdir const string run dumps profile data to logdir plugins profile run string host prefix host empty strcat host string profile run dir joinpath logdir kprofileplugindirectory run os creating directory profile run dir tf return if error env default recursivelycreatedir profile run dir ignore computation graph for now ,fix trace collection to properly remove the suffix piperorigin revid , xla python add a xla interface to the xla client piperorigin revid
2884,test test gtest flag color auto if gtest os windows if gtest os windows gtest os windows mingw on windows we ignore the term variable as it's usually not set setenv term dumb ,msys fix unittest , fix a bug in the parser delegate piperorigin revid change id idacdededdbdcfbcdb
2885,class tensorflowtestcase googletest testcase return dict elif tensors is none return none elif callable tensors return self eval helper tensors else raise valueerror unsupported type s type tensors ,allow test util to eval callables in eager mode piperorigin revid , fix a bug in the test case piperorigin revid
2886,tflitestatus genericprepare tflitecontext context tflitenode node if input type ktfliteuint8 input type ktfliteint8 if pool type kaverage pool type kmax tf lite ensure eq context input params scale output params scale tf lite ensure eq context input params zero point output params zero point tflite dcheck le std abs input params scale output params scale 1 0e 6 tflite dcheck eq input params zero point output params zero point if pool type we currently don't have a quantized implementation of ,fix a floating point check in the max pool kernel piperorigin revid change id , add support for int int piperorigin revid
2887,limitations under the license namespace tensorflow namespace core void encodefixed16 char buf uint16 value if port klittleendian memcpy buf value sizeof value else buf 0 value 0xff buf 1 value 8 0xff void char buf uint32 value if port klittleendian memcpy buf value sizeof value void char buf uint64 value void string dst uint16 value char buf sizeof value encodefixed16 buf value dst append buf sizeof buf void string dst uint32 value char buf sizeof value buf value ,audio summary support add a simple wav encoder add an audio value type to summary protocol buffer add kernel and op add support to eventaccumulator eventmultiplexer for audio events add bit little endian encode decode functions change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2888,class windowdatasetop dataset public datasetbase std vector std vector tensor window elements status status status ok const size t target size window size window stride mutex lock l mu if input impl buffer empty if input impl buffer empty dataset drop remainder buffer size target size end of sequence true return status ok add elements to the buffer size t target size window size window stride if input impl end of sequence false for size t i buffer size i target size end of sequence ,tf data fixing a bug in tf data dataset window handling of drop remainder true fixes https github com tensorflow tensorflow issues piperorigin revid change id , fix a bug in the documentation of the test case piperorigin revid
2889,def get losses scope none loss collection ops graphkeys losses def get regularization losses scope none gets the list of regularization losses args scope an optional scope for filtering the losses to return def get regularization loss scope none name total regularization loss def get total loss add regularization losses true name total loss returns a tensor whose value represents the total loss notice that the function adds the given losses to the regularization losses in particular this adds any losses you have added with tf add loss to any regularization losses that have been added by regularization parameters on layers constructors e g tf layers be very sure to use this if you are constructing a loss op manually otherwise regularization arguments on tf layers methods will not function args add regularization losses a boolean indicating whether or not to use the ,fix losses documentation fix documentation of get total loss to be correct and add a helpful comment about a common change , fix a bug in the docstring of the docstring of the docstring change
2890,def dtype batch shape shape band np np triu band np lower if upper 0 band np np tril band np upper if batch shape is not if batch shape band np np tile band np batch shape 1 1 for index dtype in dtypes lib int32 dtypes lib int64 with self cached session use gpu false ,fix on python , tf data dataset dataset to tf data dataset piperorigin revid
2891,namespace boost inline bool check dist and x const char function const realtype alpha const realtype beta realtype x realtype result const policy pol return check dist function alpha beta result pol check x function x result pol beta detail check x function x result pol bool check dist and x template class realtype class policy ,fix expression template compilation issues svn r , fix a bug in the parser test that the test fails on the same case of the same value of the same value of the same value of the same value of the same value of the same value piperorigin revid
2892,nv mousescroll cmdarg t cap ifdef feat text prop if bt popup curwin w buffer int height curwin w height curwin w firstline curwin w topline popup adjust position curwin we don't want the popup to get smaller decrement the first line until it doesn't while curwin w firstline 1 curwin w height height curwin w firstline popup adjust position curwin popup set firstline curwin endif ifdef feat gui ,patch the evalfunc c file is too big problem the evalfunc c file is too big solution move sign functionality to sign c , patch problem when using a popup window with a terminal window solution add the option to the current buffer when the cursor is set
2893,gpointer endif static void channel gui register one channel t channel ch part t part channel gui register one channel t channel ch part t part unused if ch has gui return channel gui register all void static void channel gui unregister one channel t channel ch part t part channel gui unregister one channel t channel unused ch part t part unused ifdef feat gui x11 if channel ch part part ch inputhandler null job check ended void job t job start typval t argvars char argv arg char argv arg unused jobopt t opt arg int is terminal unused ,patch ms windows compiler warnings for unused arguments problem ms windows compiler warnings for unused arguments solution add unused yegappan lakshmanan closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
2894,const char get filename void return fileindex rnd files in index define max path len 4096 const char generate pathname void const char pathname get filename ,move max path len to header , fix a bug in the watchdog process
2895,class normalizationtest test testcase parameterized testcase combinations generate combinations times all combinations combinations combine fused true false def testbnwithzerobatchinput self distribution fused def disabled testbnwithzerobatchinput self distribution fused with distribution scope self cached session as sess bn list inputs np random random 0 4 4 3 100 ,automated rollback of commit piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid change id iafeaeadbafaddecdc
2896,limitations under the license include tensorflow core lib core errors h include tensorflow core platform env h include tensorflow core platform mem h if defined is mobile platform include tensorflow core tpu tpu api dlsym initializer h endif is mobile platform namespace tensorflow status loadlibrary const char library filename void result buf str buf len str length if defined is mobile platform determine if this library is a tpu library and if so calls the tpu initialization functions to populate function tables etc void unused symbol if env getsymbolfromlibrary library handle tftpu initialize unused symbol ok tf return if error tensorflow tpu initializetpulibrary library handle endif is mobile platform result library handle return status ok ,change tpu library loading to be on startup instead of on demand piperorigin revid change id , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
2897,static pyobject cxoconnection cxoconnection conn static pyobject cxoconnection getversion cxoconnection conn void unused uint32 t releasestringlength dpiversioninfo versioninfo const char releasestring char buffer 25 int status py begin allow threads status dpiconn getserverversion conn handle releasestring releasestringlength versioninfo status dpiconn getserverversion conn handle null null versioninfo py end allow threads if status 0 return cxoerror raiseandreturnnull ,update odpi c and simplify call to get server version , fix a bug in the test case
2898,bool constantfolding constantpushdown nodedef node to c check op child node name const child node graph node map get nodedef other leaf left leaf is constant left leaf right leaf other leaf name const child node graph string other leaf input left leaf is constant op child node input 0 op child node input 1 other leaf input const child node graph node map get ,grappler use input instead of node name when swapping control dependency in constantpushdown of constantfolding piperorigin revid , xla gpu support for the layout inference piperorigin revid change id id idaceccfcbacfece
2899,def main argv if name main flags unparsed parser parse known args tf app run main main argv sys argv 0 unparsed tf compat v1 app run main main argv sys argv 0 unparsed ,deprecated tf app run removed in upgrade schema py , fix a bug in the docstring of the new module piperorigin revid
2900,class normal distribution if x dtype self dtype raise typeerror input x dtype does not match dtype s vs s x dtype self dtype todo ebrevdo wrap this in a defun with a custom defun gradient because the analytic gradient may be faster than automatic differentiation return 0 5 0 5 math ops erf 1 0 math sqrt 2 0 self sigma x self mu ,initial stochastic computation graph implementation adds stochastictensor and distributiontensor to bayesflow this version implements the basic score function derivative loss method change , fix a bug in the docstring of the test py
2901,namespace boost typedef pareto distribution double pareto convenience to allow pareto 2 3 template class realtype const std pair realtype realtype range const pareto distribution realtype dist const std pair realtype realtype range const pareto distribution realtype dist range of permissible values for random variable x using boost math tools max value return std pair realtype realtype 0 max value realtype location zero to infinity ,warning suppressed by comment out unreferenced parameter svn r , fix a bug in the new parser test piperorigin revid
2902,class datasetcardinalityop public opkernel void compute opkernelcontext ctx override class datasetcardinalityv2op public opkernel public explicit datasetcardinalityv2op opkernelconstruction ctx opkernel ctx void compute opkernelcontext ctx override class datasetfromgraphop public opkernel public static constexpr const char const kgraphdef graph def ,tf data moving cardinality to core api piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
2903,def is tensor x pylint disable invalid name can be converted to a tensor using ops convert to tensor x usage example tf is tensor constant 1 2 3 4 5 6 7 8 9 tf is tensor tf constant 1 2 3 4 5 6 7 8 9 true tf is tensor hello world false ,fix error from last change , fix a bug in the docstring of the test case piperorigin revid
2904,set option value for key numval stringval opt flags opt type from return vimtryend static void py memsave void p size t len void r if r pymem malloc len return null mch memmove r p len return r define py strsave s char u py memsave s strlen s 1 static int optionsassitem optionsobject self pyobject keyobject pyobject valobject ,updated for version problem vim crashes in python tests compiler warning for unused function solution disable the tests for now move the function , patch problem when using a terminal window is a bit slow solution add a few more tests to the new code
2905,hloinstruction createcrossreplicasum tensorflow stringpiece outfeed config std unique ptr hloinstruction instruction wrapunique new hloinstruction hloopcode koutfeed shapeutil makenil check shapeutil compatible operand shape shape outfeed shape shape must be compatible with operand shape operand shape instruction appendoperand operand instruction outfeed config outfeed config tostring instruction outfeed shape shape ,add check for valid outfeed shape on outfeed creation and in hloverifier piperorigin revid , xla gpu support for xla hlo client piperorigin revid
2906,def svd tensor full matrices false compute uv true name none a is a tensor s is a tensor of singular values u is a tensor of left singular vectors v is a tensor of right singular vectors v is a tensor of right singular vectors s u v svd a s svd a compute uv false ,update linalg ops py just add a space to doc of svd , fix a bug in the docstring of the test case piperorigin revid
2907,class flatbufferbuilder return returns a typed offset into the serialized data indicating where the vector is stored template typename t offset vector t createvector const t v size t len if this assert hits you're specifying a template argument that is causing the wrong overload to be selected remove it assertscalart t startvector len sizeof t if flatbuffers littleendian pushbytes reinterpret cast const uint8 t v len sizeof t ,avoiding wrong template specialization on new createvector change id tested on os x , fix a bug in the parser delegate to the new delegate piperorigin revid change id idbeeaeaafcaeeaafafffe
2908,curs columns redraw later some valid endif now w leftcol is valid avoid check cursor moved otherwise curwin w valid leftcol curwin w leftcol curwin w valid valid wcol valid wrow valid virtcol ,patch cursor in wrong position after horizontal scroll problem cursor in wrong position after horizontal scroll solution set w valid closes closes , patch problem when using a popup window with a terminal window solution add the option to the current line
2909,string hlocomputation tostring if options print percent s if options print ids isentrycomputation if options print ids exclude entry computation's name because it includes and leads to non deterministic fingerprint s printname name options print ids ,xla do not print computation names when computations piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid
2910,tf call quantized types register gather cpu tf call gpu number types register gather gpu tf call complex64 register gather gpu tf call complex128 register gather gpu undef register gather gpu ,add complex gpu registrations to tf gather and tf strided slice removes use gpu duplication in their tests and ensures that complex test imaginary components are non zero change , add support for int ops piperorigin revid
2911,class public opstestbase bool is ref isreftype input types inputs size tensor input new tensor device getallocator allocatorattributes datatypetoenum float v shape input flat float setzero input flat float setrandom tensors push back input if is ref check eq input types inputs size ,run resizearea tests on random data rather than all s piperorigin revid , fix a bug in the test case piperorigin revid
2912,def streaming concat values next shape array ops stack next size fixed shape new value array ops zeros next shape dtype values dtype old value array value assign op state ops assign array new value validate shape false with ops control dependencies old value assign op state ops assign array new value validate shape false with ops control dependencies assign op copy op array size assign old value size return value needs to be the same dtype as no op for cond ,fix flakiness of contrib streaming concat with variable scope enable resource variables the issue was that an assign could be done in parallel to another assign which made the logic wrong added an explicit control dependencies to avoid that piperorigin revid , fix a bug in the docstring of the docstring of the test case piperorigin revid
2913,from future import print function import numbers from tensorflow python framework import constant op from tensorflow python framework import ops from tensorflow python ops import math ops from tensorflow python ops import nn def apply regularization regularizer weights list none with ops name scope 'get regularization values weights list as scope regularizer w for w in weights list p if p is not none else constant op constant 0 0 for p in for p in if p get shape ndims 0 raise valueerror must return a scalar tensor instead of a ' ,make tf contrib layers apply regularization resilient to none change , fix a bug in the test case piperorigin revid
2914,class boostedtreesensembleresource public stampedresource bucketized features vector of feature vectors int32 next node const int32 tree id const int32 node id const int32 index in batch const std vector ttypes int32 constvec bucketized features const const std vector ttypes int32 constmatrix bucketized features const std vector float node value const int32 tree id const int32 node id const ,respect dimension id with prediction ops piperorigin revid , fix a bug in the test case piperorigin revid
2915,class test testcase parameterized testcase self distribution run functions eagerly def function run functions eagerly run functions eagerly expected device device util canonicalize cpu 0 try worker distribution extended worker devices 0 except runtimeerror worker none expected device device util canonicalize cpu 0 worker if run functions eagerly else with distribution scope with ops device v2 cpu 0 class test testcase parameterized testcase self distribution run functions eagerly def function run functions eagerly run functions eagerly expected device device util canonicalize cpu 0 try worker distribution extended worker devices 0 except runtimeerror worker none expected device device util canonicalize cpu 0 worker if run functions eagerly else with distribution scope def function function ,use first worker as default device in tf function test piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
2916,assert pred getdefininginst pred getdefininginst isa affineapplyop affineapplyop chain of length 1 void pred exprs push back renumber app else if auto constant inst dyn cast constantop ,fix opt build failure piperorigin revid , fix a bug in the test case piperorigin revid
2917,class baseestimator sklearn baseestimator add default monitors if monitors is none monitors monitors monitors lib get default monitors loss op loss op summary op logging ops get summary op save summary steps self config save summary steps summary writer graph actions get summary writer self model dir is chief self config task 0 if not is chief run monitors only on chief if is chief monitors monitors lib get default monitors loss op loss op summary op logging ops get summary op save summary steps self config save summary steps summary writer graph actions get summary writer self model dir else monitors setup monitors ,do not let workers other than the chief create tfevents files change , update documentation to use tf nn softmax py
2918,static void taint check void static void log main started void struct mainstarted enum logmsgtypes type pid t pid unsigned int num children msg struct msg mainstarted mainmsg msg pid getpid msg type main started msg num children max children mainmsg pid getpid mainmsg type main started mainmsg num children max children sendudp char msg sizeof msg sendudp char msg sizeof mainmsg void main loop void ,move the message struct definition to udp h , fix a bug in the watchdog page
2919,namespace tensorflow namespace auto load attempt count monitoring counter 2 new tensorflow cc saved model load attempt count model path status the number of times a savedmodel was successfully loaded tensorflow cc saved model load attempt count the number of times a savedmodel was successfully loaded model path status auto load latency monitoring counter 1 new tensorflow cc saved model load latency model path latency in microseconds for savedmodels that were succesfully loaded tensorflow cc saved model load latency latency in microseconds for savedmodels that were succesfully loaded model path constexpr char kloadattemptfail fail constexpr char kloadattemptsuccess success ,fix metric definitions in savedmodel change , fix a bug in the new overview class piperorigin revid change id id ieffeabbcfbfbfadcee
2920,class clientlibrarytestbase public testing test return createconstantfromliteral literal createfromarray array builder same as createconstantfromarray but for scalars template typename nativet computationdatahandle nativet value computationbuilder builder return createconstantfromliteral literal creater0 nativet value builder creates a parameter instruction that wraps a given value and then stores into data handle the global handle for that parameter ,add a convenient function to client library test base piperorigin revid , xla gpu support for the xla client piperorigin revid
2921,include linux irda h include stdlib h include net h include random h void gen irda unsigned long addr unsigned long addrlen void gen irda unsigned long addr unsigned long addrlen addr unsigned long irda addrlen sizeof struct sockaddr irda void irda rand socket struct proto type pt switch rand 3 case 0 pt type sock stream pt protocol rand proto max break case 1 pt type sock seqpacket pt protocol rand proto max break case 2 pt type sock dgram if rand bool pt protocol irdaproto ultra else pt protocol irdaproto unitdata break default break ,irda move random socket generation into per protocol files , proto zmalloc conversion
2922,public return creates for statement when step is not specified it is set to 1 create for statement when step is not specified it is set to 1 forstmt location location arrayref mlvalue lboperands affinemap lbmap arrayref mlvalue affinemap ubmap int64 t step 1 ifstmt location location integerset condition create if statement ifstmt location location arrayref mlvalue operands integerset set private stmtblock block nullptr ,implement operands for the 'if' statement this cl also includes two other minor changes change the implemented syntax from 'if cond ' to 'if as specified by mlir spec a minor fix to the implementation of the forstmt piperorigin revid , fix a bug in the parser test piperorigin revid
2923,from tensorflow python ops import init ops from tensorflow python ops import math ops from tensorflow python ops import nn ops from tensorflow python ops import random ops from tensorflow python ops import rnn cell impl from tensorflow python ops import variable scope as vs from tensorflow python platform import tf logging as logging from tensorflow python util import nest class attentioncellwrapper core rnn cell rnncell state is tuple is false or if attn length is zero or less super attentioncellwrapper self init reuse reuse if not isinstance cell core rnn cell rnncell if not rnn cell impl like rnncell cell pylint disable protected access raise typeerror the parameter cell is not rnncell if nest is sequence cell state size and not state is tuple raise valueerror cell returns tuple of states but the flag ,change rnn ops to check types via typing instead of a private attribute piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2924,class basedebugop public opkernel if status ok log error debug node of watch key debug watch key debug node name failed to publish debug tensor data to all urls failed to publish debug tensor data to all urls str util join debug urls due to status error message ,tfdbg fix missing space in grpc error message piperorigin revid , fix a bug in the test case piperorigin revid
2925,tflitestatus const operator op errorreporter error reporter tflitestatus const operator op errorreporter error reporter builtindataallocator allocator void builtin data tflitestatus const operator op errorreporter error reporter builtindataallocator allocator void builtin data tflitestatus const operator op errorreporter error reporter builtindataallocator allocator ,flatbuffer conversions changes for resize bilinear , add support for int int piperorigin revid
2926,limitations under the license include tensorflow core lib strings str util h include tensorflow core platform env h include tensorflow core platform file system helper h namespace tensorflow namespace bool directoryexists const std string fname return dir get null status getmatchingpaths const string pattern std vector string results return internal getmatchingpaths this env default pattern results status newwritablefile const string fname std unique ptr writablefile result return errors unimplemented asset storage is read only ,break filesystem's dependency on threadpool piperorigin revid , add a test for the new op op piperorigin revid change id iefaaedbcfceefdda
2927,llvm constant moduletranslation getllvmconstant llvm type llvmtype splatattr getsplatvalue loc return llvm constantvector getsplat vectortype getnumelements child if auto denseattr attr dyn cast denseelementsattr if auto elementsattr attr dyn cast elementsattr auto vectortype cast llvm vectortype llvmtype smallvector llvm constant 8 constants uint64 t numelements vectortype getnumelements constants reserve numelements for auto n denseattr getattributevalues for auto n elementsattr getvalues attribute constants push back getllvmconstant vectortype getelementtype n loc if constants back ,add iterator support to elementsattr and this will allow iterating the values of a non opaque elementsattr with all of the types currently supported by denseelementsattr this should help reduce the amount of specialization on denseelementsattr piperorigin revid , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
2928,llvm value hlotoirbindings const hloinstruction hlo typed ir value llvm constantexpr llvm cast llvm globalvariable ir value dest type else typed ir value b createbitcast ir value pointee type getpointerto typed ir value b ir value pointee type getpointerto if ir value ir value setname llvm ir irname hlo raw ,adding address space cast to generate correct llvm , xla gpu support for xla hlo ir piperorigin revid change id idadedfddaccd
2929,class daskdatafeeder object x count x count compute if len x count 1 x shape tuple x count compute one dimensional x shape x count compute else todo support multi dimensional valueerror only one dimensional input for daskdatafeeder is supported now multi dimensional x shape x count compute 0 x ndim y shape tuple y count compute self sample fraction batch size float list x shape 0 self input shape self output shape get in out shape ,daskdatafeeder support multi dim , fix a bug in the docstring of the docstring of the docstring change
2930,class gradientboosteddecisiontreemodel object stack all the inputs to one tensor per type this is a workaround for the of graph building in tf cond see b split sizes array ops stack array ops shape partition id 0 for partition id in partition ids list split sizes array ops reshape array ops shape n partition ids list 1 partition ids array ops concat partition ids list axis 0 gains array ops concat gains list axis 0 split infos array ops concat split info list axis 0 ,use a built in function shape n instead of running many array ops shape and stacking the results piperorigin revid , tf data service support for tf data dataset piperorigin revid
2931,def create android bazelrc configs def set grpc build flags write to bazelrc 'build define grpc no ares true' def set windows build flags if is windows the non monolithic build is not supported yet write to bazelrc 'build config monolithic' suppress warning messages write to bazelrc 'build copt w host copt w' output more verbose information when something goes wrong write to bazelrc 'build verbose failures' def main make a copy of os environ to be clear when functions and getting and setting def main set cc opt flags environ cp set mkl set monolithic set windows build flags create android bazelrc configs if name ' main ' ,improve the windows bazel build windows build refactor some fixes improve py test macro remove comments fix marker file genrule add md check pass check still need bazel sh fix pip smoke test py add comments about pip marker file fix pip smoke test py again , fix a bug in the docstring of the new api change
2932,from tensorflow python ops import array ops from tensorflow python ops import gen math ops from tensorflow python ops import math ops from tensorflow python ops import nn from tensorflow python ops import nn ops from tensorflow python ops import standard ops from tensorflow python ops import variable scope from tensorflow python util import nest class dropout layer which will override self noise shape and allows for custom noise shapes with dynamically sized inputs if self noise shape is none return self noise shape return nn ops get noise shape inputs self noise shape pylint disable protected access return none concrete inputs shape array ops shape inputs noise shape for i value in enumerate self noise shape noise shape append concrete inputs shape i if value is none else value return ops convert to tensor noise shape def call self inputs training none if training is none ,fix partially specified noise shape in dropout piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
2933,class computationbuilder then build should be used instead computation buildandnoteerror returns the first error that was encountered while building the computation when an error is encountered by default we return a computationdatahandle and inform the user of the error that occurred while building the computation when they make a final call to build see also set die immediately on error status first error const return first error private using std function void literal ,xla improve error message for concatenate expose computationbuilder first error change , xla python fix a bug in the hlo evaluator piperorigin revid change id ibebfcffdcbdbdafeb
2934,cout setting the packer to mean will mean that after the weight distribution of a large number of packs we might decide that after all the assumption of a normal distribution is not really justified we might find that the fit is better to a link cauchy cauchy lorentz distribution we might find that the fit is better to a cauchy this distribution has wider so that whereas most of the values are closer to the mean than the normal there are also more values than 'normal' that lie further from the mean than the normal ,corrected wrong link cauchy in cpp a trailing svn r , fix a bug in the parser test for the new code
2935,class rustgenerator public basegenerator structs and tables and output them to a single file bool generate code clear code std string flatbuffersgeneratedwarning n n code allow dead code code allow unused imports code extern crate flatbuffers n code std string flatbuffersgeneratedwarning n n assert cur name space ,clean up unnecessary outer rust gen snippet clean up unneeded outer rust gen snippet update generated rust file , fix a bug in the parser test for the new parser test
2936,class datasetconstructortest test testcase with self assertraises errors outofrangeerror sess run get next def self todo b reenable this when the source of flakiness is discovered def self num parallel iterators 3 define shared state that multiple iterator instances will access to ,disable timeout flake on ubuntu machines piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2937,class cudnnrnn base layer layer runs the forward step for the rnn model args inputs 3 d tensor with shape time len batch size input size if time major is true default or batch size time len input size if time major is false inputs 3 d tensor if time major is true default the tensor shape is time len batch size input size if time major is false the shape is batch size time len input size initial state a tuple of tensor s of shape num layers num dirs batch size num units if time major is true default or batch size num layers num dirs ,support dynamic shaped input for time major rnn and other minor changes , fix a bug in the docstring of the test piperorigin revid
2938,class cumsumtest tf test testcase for axis in 3 2 1 0 1 2 self compareall x axis def self for dtype in self valid dtypes x np arange 1 145 reshape 2 2 3 3 2 2 astype dtype for axis in range 6 6 3 self compareall x axis def testinvalidaxis self x np arange 0 10 reshape 2 5 astype np float32 input tensor tf convert to tensor x class cumprodtest tf test testcase for axis in 3 2 1 0 1 2 self compareall x axis def self for dtype in self valid dtypes x np arange 1 145 reshape 2 2 3 3 2 2 astype dtype for axis in range 6 6 3 self compareall x axis def testinvalidaxis self x np arange 0 10 reshape 2 5 astype np float32 input tensor tf convert to tensor x ,simplify scan ops cumsum etc and support any dimensions change , tf data dataset to use tf data dataset piperorigin revid
2939,def converted call f recursive verbose arg types args kwargs constructors target entity f arg map target f init effective args unknown arg value args effective args args partial types elif hasattr f ' call ' and hasattr f ' class ' ,fix bug in converted call and add tests for it piperorigin revid , fix a bug in the docstring of the docstring of the new api change
2940,inline const char enumnamescolor return names inline const char enumnamecolor color e return enumnamescolor e inline const char enumnamecolor color e return enumnamescolor static cast int e enum any any none 0 inline const char enumnamesany return names inline const char enumnameany any e return enumnamesany e inline const char enumnameany any e return enumnamesany static cast int e inline bool verifyany flatbuffers verifier verifier const void union obj any type ,fixed proto translation making scalars into required fields change id tested on linux , fix a bug in the parser test piperorigin revid
2941,status convertmlirtotfliteflatbuffer absl strcat toco flags dump graphviz dir toco at import dot mlir passmanager pm module getcontext mlir passmanager pm module getcontext mlir oppassmanager nesting implicit tensorflow addtftotflconversionpasses pass config pm session convert back to outlined while format for export back to flatbuffer ,integrate llvm at llvm llvm project updates llvm usage to match https github com llvm llvm project commit piperorigin revid change id , xla python fix a bug in the graph piperorigin revid
2942,class eagercontext only one of the below is set std unique ptr devicemgr local device manager devicemgr local unowned device manager std unique ptr devicemgr remote device manager devices owned by device manager std vector device devices class eagercontext ifndef android void closeremotecontexts std unique ptr devicemgr remote device manager the server is not const since we release it when the context is destroyed therefore the server object is not marked as const even though it should ,make eager compile without remote important for android piperorigin revid , fix a bug in the test case piperorigin revid
2943,def size internal input name none optimize true out type dtypes int32 tf export rank dispatch add dispatch support def rank input name none pylint disable redefined builtin returns the rank of a tensor ,add a ragged rank op and register it to the op dispatcher piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
2944,class testtrainingwithmetrics keras parameterized testcase model fit np ones shape 10 1 np ones shape 10 2 batch size 5 keras parameterized run all keras modes always skip v1 true def test add metric invalid aggregation self def disabled test add metric invalid aggregation self todo psv reenable test once it is fixed x layers module input shape 1 y layers module dense 1 kernel initializer 'ones' x model training module model x y ,reenable training tests on tap piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
2945,class functiontest test testcase self assertallequal backprop implicit grad f 0 0 2 0 def self v resource variable ops resourcevariable 1 0 function defun def f return v v self assertallequal backprop implicit grad f 0 0 2 0 ensure that v is watched again self assertallequal backprop implicit grad f 0 0 2 0 def testgraphmodecapturevariable self with context graph mode self test session as sess ,watch variables when executing defun compiled functions variables are automatically upon creation of a this change ensures that the same variables are during subsequent executions of it piperorigin revid , tf data dataset to use tf data dataset piperorigin revid
2946,class tf test testcase exponential tf contrib distributions exponential lam lam n v 100000 n tf constant n v n 100000 samples exponential sample n seed 138 self assertequal samples get shape n v batch size 2 self assertequal samples get shape n batch size 2 sample values samples eval ,bugfix call n convert to tensor n exponential sample forgot to call n convert to tensor n and tensor util constant value n only works with n a tensor change , fix a bug in the docstring of the test case piperorigin revid
2947,status const nodedef node def status namerangesfornode const nodedef node def const opdef op def namerangemap inputs namerangemap outputs tf return if error node def op def input arg op def inputs return node def op def output arg op def outputs if inputs nullptr tf return if error node def op def input arg op def inputs if outputs nullptr return node def op def output arg op def outputs return status ok void adddefaultstonodedef const opdef op def nodedef node def ,code generation for c api change , add a test for the graph and the graph piperorigin revid
2948,static char features static int included patches add new patch number below this line 701 700 ,patch system test failing when using x forwarding problem system test failing when using x forwarding solution set before changing home closes also use a better check for the exit value , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2949,spell read tree len get4c fd if len 0 return sp truncerror if len 0x3ffffff invalid length multiply with sizeof int would overflow return sp formerror if len 0 allocate the byte array ,patch possible overflow with corrupted spell file problem possible overflow with spell file where the tree length is corrupted solution check for an invalid length suggested by , patch problem when using a terminal window is a bit slow solution add a test for the gui
2950,def einsum equation inputs kwargs sorted for in indices if counts 1 for a in axis labels for input labels in input axis labels print 'input lables loop ' input labels input axis labels input labels count a len input axis labels if len input axis labels 1 and input labels count a 2 and input labels input labels 1 return math ops trace inputs 0 if input labels count a 1 ,removed logging from einsum , fix a bug in the documentation of the documentation of the new version of the default value of the default value of the default value of the input is not used in the same function piperorigin revid
2951,class tfmodulewrapper types moduletype attr getattr self tfmw wrapped module name except attributeerror as e if not self tfmw public apis raise e raise if name not in self tfmw public apis raise e raise attr self tfmw import module name if self tfmw print deprecation warnings ,don't specify e when re raising an error it loses stack trace info see e g https stackoverflow com questions exception traceback is hidden if not re raised immediately piperorigin revid , tf data saveable shape inference for tf data dataset piperorigin revid
2952,status xlagpudevicefactory createdevices std set int gpu ids int num visible devices platform valueordie visibledevicecount if allowed gpus empty for int i 0 i num visible devices i gpu ids insert i for int i 0 i num visible devices i gpu ids insert i else for loop below is copied from gpu gpu device cc it validates configuration string it should be redundant since code would fail there before it gets to here the visible device list and populates gpu ids set const std vector string visible devices absl strsplit allowed gpus ' ' for const string platform gpu id str visible devices status xlagpudevicefactory createdevices gpu ids insert platform gpu id for const auto i gpu ids skip devices that are not in the set for int i gpu ids xladevice options options options platform platform valueordie options device name prefix name prefix ,fix missed review comments , fix a bug in the new delegate piperorigin revid change id ibebfcffdcbdbdafeb
2953,void gdrworker grpcrecvtensorasync calloptions opts statuscallback copy ready response done copy is dead const status s the value is now ready to be returned on the wire grpc encodetensortobytebuffer is dead copy response grpc encodetensortobytebuffer is dead copy false response done s delete copy void gdrworker grpcrecvtensorasync calloptions opts send dev context copydevicetensortocpu val request rendezvous key src dev copy copy ready else grpc encodetensortobytebuffer is dead val response grpc encodetensortobytebuffer is dead val false response done status ok ,tf grpc use explicit request from receiver to clean rpc cache this simplifies the response cache management on the sender side and avoids the need for large response cache size piperorigin revid , fix a bug in the file
2954,do shell endif msg silent 0 for all buffers buf if bufischanged buf if bufischangednotterm buf ifdef feat gui mswin if ,patch get no write since last change message if terminal is open problem get no write since last change message if a terminal is open fritz solution don't consider a buffer changed if it's a terminal window , patch problem when using a terminal window is a bit slow solution add a test for the gui
2955,dictionaryitem dictionaryobject self pyobject args int flags else if flags dict flag return bool py incref py true return py true ret py true py incref ret return ret di dict lookup hi ,updated for version problem warning for type punned pointer tony mechelynck solution use intermediate variable , patch vim cannot use a function to be used problem vim cannot use a terminal window with a terminal window solution add a test for the terminal window
2956,static void initializetargets llvminitializeaarch64targetinfo llvminitializeaarch64targetmc llvminitializeaarch64asmprinter endif if tf llvm s390x llvminitializesystemztarget llvminitializesystemztargetinfo llvminitializesystemztargetmc llvminitializesystemzasmprinter endif llvminitializearmtarget llvminitializearmtargetinfo static void initializetargets llvminitializepowerpctargetinfo llvminitializepowerpctargetmc llvminitializepowerpcasmprinter llvminitializesystemztarget llvminitializesystemztargetinfo llvminitializesystemztargetmc llvminitializesystemzasmprinter llvminitializex86target llvminitializex86targetinfo llvminitializex86targetmc ,create sx guard macro and load it when needed , xla gpu support for the hlo client backend piperorigin revid change id idadedfddaccd
2957,status cpuexecutable executecomputefunction if hlo execution profile nullptr hlo execution profile set total cycles executed profile counters back hlo execution profile set total cycles executed module entry computation profile counters back for auto hlo prof idx hlo to profile idx const hloinstruction hlo hlo prof idx first ,xla add support for profiling multiple computations while we are here add support for getting the cost analysis for call hlos change , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
2958,static void watchdog void if kernel taint mask 0 ret check tainted if ret kernel taint mask kernel taint initial 0 shm exit reason exit kernel tainted gettimeofday shm taint tv null output 0 kernel became tainted d d last seed was u n ret kernel taint initial shm seed shm exit reason exit kernel tainted ,if we tainted tell the children to exit as the first thing , fix a bug in the watchdog page
2959,def gatherndgrad op grad ref op inputs 0 indices op inputs 1 ref shape array ops shape ref out type indices dtype ref grad array ops scatter nd indices grad ref shape if indices shape ndims 2 and indices shape 1 value 1 ref grad ops indexedslices grad array ops squeeze indices axis 1 ref shape else ref grad array ops scatter nd indices grad ref shape return ref grad none ,changed gradient of gathernd to use indexedslices when possible rather than producing a dense output piperorigin revid , tf data dataset dataset to tf data dataset piperorigin revid
2960,limitations under the license include absl container flat hash map h include absl strings string view h include tensorflow core platform types h include tensorflow core profiler protobuf op metrics pb h namespace tensorflow ,fix for failing oss builds piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2961,limitations under the license include tensorflow contrib lite string util h include stdlib h include string h include vector include tensorflow contrib lite c c api internal h ,include stdlib h in contrib lite string util cc piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2962,void struct opdata data const tflitetensor int32 t input data ptr input data if data input left shift 1 input data gemmlowp 1 input data input data 1 scale by 3 4 to expand range 8 8 10 7 10 7 ,small improvement to tanh sigmoid implementation change id , fix a bug in the test case piperorigin revid
2963,class tensorflowdataframetestcase tf test testcase num batches num batches batch size batch size def self batch size 8 num epochs 17 expected num batches num epochs 100 batch size data path make test csv default values 0 0 0 0 tensorflow df df tensorflowdataframe from csv data path batch size batch size num epochs num epochs shuffle false default values default values actual num batches len list tensorflow df run self assertequal expected num batches actual num batches def self num batches 77 enqueue size 11 ,adds a num epochs parameter to exposes this parameter via tensorflowdataframe from csv examples change , fix a bug in the test case piperorigin revid
2964,test tensor qint32 simple class public testing test protected protected tensor t tensor zero t t dt float tensorshape 2 3 4 5 zero t dt float tensorshape 3 0 2 0 5 t dt float tensorshape 2 3 4 5 zero t dt float tensorshape 3 0 2 0 5 virtual void setup expect true t shape issamesize tensorshape 2 3 4 5 protected tensor 0 0 0 0 0 01f tensor 1 2 3 4 0 02f test f reshape ,improved code formatting piperorigin revid , add a test for the test case piperorigin revid
2965,namespace test gpumultistream basics tf assert ok and assign std unique ptr pjrtclient client asynchronous true asynchronous true distributed client nullptr node id 0 pjrtdevice device client local devices at 0 ,fix the gpu test , fix a bug in the delegate piperorigin revid
2966,status run const graphoptimizationpassoptions options specs graph as function true graph as function true tf assign or return auto module options graph debug info options flib def specs context ,enable graph as function for exporting in bridge pass piperorigin revid change id , tf data service support for tf data service piperorigin revid
2967,def all libraries module to name members documented return splits of module 'tf' library framework building graphs framework lib library check ops asserts and boolean checks library constant op constants sequences and random values prefix prefix text library state ops variables ,add ops check ops py which contains common asserts and is a boolean check change , fix a bug in the docstring of the test case piperorigin revid
2968,class callcounter object break def called without tracing self todo kkimlabs this is an unnecessary check since this is last minute cl before 2 0 release i've to be very here to avoid a potential crash remove once we release 2 0 we don't count tracing when users load a concrete function or call get concrete function so the first call can be not a tracing call if not self calls per tracings return self calls per tracings 0 self calls per tracings 1 1 self call count 1 ,function py def function py unused code cleanup piperorigin revid , fix a bug in the docstring of the docstring of the new api change
2969,register module initializer interpreter platform stream executor interpreter declare module initializer multi platform manager note that module initialization sequencing is not supported in the open source project so this will be a no op there register module initializer sequence interpreter platform ,tf stream executor move declaration of multi platform manager to header piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
2970,std vector int64 hlosharding tilelimitfordevice const shape shape shape dimensions end check eq shape dimensions size tile assignment num dimensions check eq shape dimensions size replicateonlasttiledim 1 0 tile assignment num dimensions std vector int64 index device for int64 i 0 i index size i const int64 shape dim shape dimensions i ,xla fix wrong rank check for partial sharding piperorigin revid change id , xla gpu support for the xla client piperorigin revid change id id iaaeabfdfedfeacedf
2971,prop type set typval t argvars int add return strcpy prop pt name name prop pt id proptype id prop pt flags pt flag combine htp buf null global buf b if htp null ,patch missing part of problem missing part of solution s test text , patch problem when using a terminal window is a bit slow solution add a test for the gui
2972,def run fuzzers pylint disable too many arguments too many locals if not testcase or not stacktrace logging info 'fuzzer s finished running ' target target name else logging info b'fuzzer s detected error s ' target target name stacktrace utils print b'fuzzer s detected error s ' bytes target target name 'utf 8' stacktrace shutil move testcase os path join artifacts dir 'test case' parse fuzzer output stacktrace artifacts dir return true true ,use print for printing stacktrace instead of using log this makes stacktrace more fixes https github com google oss fuzz issues , fix a bug in the docstring of the new module piperorigin revid
2973,class inputiterationtest test testcase parameterized testcase combinations generate combinations combine distribution strategy combinations strategies minus tpu mode eager distribution strategy combinations all strategies mode eager def testfulleager self distribution dataset self get dataset ,throw an explicit error if user call tpustrategy experimental run v in eager mode with a python function piperorigin revid change id , tf data vectorization test for tf data dataset piperorigin revid
2974,status virtualcluster run const graphdef graph item graph graph item feed feed item fetch fetch virtualscheduler scheduler item true this node manager get tf return if error scheduler init virtualscheduler scheduler true this node manager get tf return if error scheduler init item if metadata metadata clear step stats ,slight change to the api of virtualscheduler include runmetadata in analyticalcostestimator add more fields in costgraphdef in analyticalcostestimator piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id iefaaedbcfceefdda
2975,static int dpiconn dpiconn conn void handle if params params 0 if params 0 return dpierror set error ensure sharding key dpi err missing sharding key if dpiconn conn conn supershardingkey handle handletype dpi oci attr super sharding key set super sharding key params ,add check for sharding key when super sharding key is specified , patch problem when using a terminal window is a bit solution add a test for the cursor
2976,const char tflitetypegetname tflitetype type return unknown type tflitedelegate tflitedelegatecreate tflitedelegate d data null prepare null copyfrombufferhandle null copytobufferhandle null freebufferhandle null flags ktflitedelegateflagsnone return d ,allow delegates to allocate memory while copying them from their buffers piperorigin revid , fix a bug in the delegate piperorigin revid
2977,limitations under the license include tensorflow core lib gtl cleanup h include tensorflow core lib gtl flatmap h include tensorflow core lib gtl map util h include tensorflow core lib gtl stl util h include tensorflow core lib random random h include tensorflow core platform env h include tensorflow core platform mutex h ,remove unused header include gtl stl util piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2978,static char features static int included patches add new patch number below this line 1972 1971 ,patch no proper test for getchar problem no proper test for getchar solution add a test with special characters , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2979,enum type type vector float4 24 type blob 25 type bool 26 type vector bool 36 to allow the same type of conversion of type to vector type inline bool type t return t type float t type bool inline bool istypedvectorelementtype type t return t type int t type string return t type int t type string t type bool inline bool istypedvector type t return t type vector int t type vector string return t type vector int t type vector string t type vector bool inline bool isfixedtypedvector type t class builder flatbuffers final class assert flatbuffers is scalar t value return flatbuffers is floating point t value type float flatbuffers is unsigned t value type uint type int flatbuffers is same t bool value type bool flatbuffers is unsigned t value type uint type int struct value ,c add new type vector bool flexbuffers add new type vector bool update stl emulation h fix is same typo update stl emulation h , fix a bug in the parser delegate piperorigin revid
2980,class metric object we create the variable scope now to get the unique name that will be used as a variable prefix when build calls add variable with variable scope variable scope none default name scope name use resource true reuse false as scope scope name use resource true reuse false as scope pos scope name rfind scope name self name name scope name pos len scope name self scope scope ,saves summaries in the mnist example piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
2981,see the license for the specific language governing permissions and limitations under the license contains utilities for conversion of tf stats proto types to gviz types usage gviz data table generate chart table stats table import gviz api def get chart table args stats table creates gviz object from a tensorflow stats table args stats table a tf stats pb2 tfstatstable ,add a converter from input pipeline proto to format piperorigin revid change id , add a test for the new op op piperorigin revid
2982,class progbarlogger callback self progbar progbar target self target verbose self verbose stateful metrics self stateful metrics stateful metrics self stateful metrics unit name 'step' if self use steps else 'sample' def on batch begin self batch logs none if self seen self target ,clarify the display of the time taken per step in the progbar samples or gradient descent steps also fix the issue where the progbar would sometime display e us step piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
2983,binary test 16bit min todo bixia pow fails with bfloat16 on cpu binary test 16bit disabled on cpu pow run pow std pow binary test 16bit disabled on cpu pow see b 162664705 known incorrect fn int64 val eigen bfloat16 f uint16 t val 16 val memcpy f val 16 2 return std isnan f run pow std pow todo bixia atan2 fails with bfloat16 on cpu binary test 16bit disabled on cpu atan2 ,xla gpu disable std pow nan for exhaustive testing piperorigin revid change id , fix a bug in the new delegate piperorigin revid
2984,int main int argc char argv progname argv 0 parse args argc argv if argc 1 usage if logfilename null logfilename strdup trinity cpu0 log unlink logfilename int main int argc char argv exit exit failure parse args argc argv if argc 1 usage max nr syscalls nr syscalls ,fix logfile parameter being ignored logfile was created before arguments are parsed so anything passed to l logfile was always ignored arg parsing moved couple of lines up , fix a bug in the watchdog process
2985,limitations under the license ifndef tensorflow lite kernels internal reference activations h define tensorflow lite kernels internal reference activations h include ruy profiler instrumentation h from ruy include tensorflow lite kernels internal types h include tensorflow lite kernels internal common h namespace tflite namespace reference ops ,tflu do not directly include reference ops h , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
2986,status convolutionthunk executeonstream const executeparams params auto op profiler params profiler makescopedinstructionprofiler hlo instruction tf return if error cudnn call absl makespan operand se buffers result buffer scratch params stream tf return if error rungpuconv cudnn call absl makespan operand se buffers result buffer scratch params stream write the output tuple const int 2 ,to , xla python fix a bug in the test piperorigin revid
2987,static long mkcall int call printf s n strerror errno else printf n void fflush stdout return ret ,flush after doing the syscall stuff was getting lost especially when running multiple copies at the same time , fix a bug in the watchdog process
2988,bool trtengineop executetrtengine opkernelcontext ctx std vector void buffers num binding mutex lock lock engine context mu auto execution context engine context execution context auto execution context engine context execution context trt context idx setup engine inputs for int i 0 i ctx num inputs i ,select the correct engine context , add support for int ops piperorigin revid
2989,def do test signature def map builder save logging info 'saved model to s' save model path todo b set the following boolean flag once the variables logic from savedmodel importer is removed lift variables false mlir pywrap mlir experimental convert saved model v1 to mlir save model path ' ' join tf saved model tag constants serving show debug info we don't strictly need this but it serves as a handy sanity check for that api which is otherwise a bit annoying to test the canonicalization shouldn't affect these tests in any way mlir pywrap mlir experimental run pass pipeline mlir 'tf standard pipeline' show debug info lift variables show debug info if canonicalize mlir pywrap mlir experimental run pass pipeline mlir show debug info ,add lift variables boolean flag to python api lifting variables will be done via the mlir passes not in the saved model importer piperorigin revid change id , fix a bug in the docstring of the docstring of the documentation of the example change
2990,status directsession runinternal int64 step id const runoptions run options create a run state and start execution runstate run state step id devices run state rendez new intraprocessrendezvous device mgr get ifndef android set up for collectives if the runoption declares a key if run options experimental collective graph key 0 if collective executor mgr status directsession runinternal int64 step id const runoptions run options run state collective executor reset new collectiveexecutor handle collective executor mgr findorcreate step id true inherit ref endif start parallel executors const size t num executors executors and keys items size ,disable collective ops support on android builds piperorigin revid , xla python fix a bug in the graph piperorigin revid
2991,limitations under the license include fstream include gtest gtest h include third party flatbuffers include flatbuffers flatc h include flatbuffers flatc h include tensorflow core platform platform h ifdef platform google ,fix schema compatibility in oss by aselle fix schema compatibility test and upgrade test handle python unicode idioms handle path differences , fix a bug in the file file in the file file
2992,def model iteration model use multiprocessing use multiprocessing max queue size max queue size callbacks callbacks verbose 0 verbose verbose mode modekeys test steps name 'validation steps' ,allow verbose in fit generator to also control the verbosity of the validation generator , fix a bug in the docstring of the keras model piperorigin revid
2993,f feedkeys argvars rettv char u keys flags char unbuf numbuflen inttyped false false char u keys esc this is not allowed in the sandbox if the commands would still be f feedkeys argvars rettv case 'm' remap true break case 't' typed true break case 'i' insert true break case 'x' execute true break f feedkeys argvars rettv vim free keys esc if vgetc busy typebuf was filled true if execute exec normal true ,patch problem missing change to eval c solution also change feedkeys , patch problem when using a popup window with a terminal window solution add the option to the list of the buffer
2994,def lecun normal seed none he normal initializer it draws samples from a truncated normal distribution centered on 0 with stddev sqrt 2 fan in where fan in is the number of input units in the weight tensor with standard deviation after truncation given by stddev sqrt 2 fan in where fan in is the number of input units in the weight tensor arguments seed a python integer used to seed the random generator ,update doc for he normal and lecun normal according to issue , fix a bug in the docstring of the docstring of the new version of the default value of the default value of the default value of the default value of the default value of the default value of the default value piperorigin revid
2995,rettv list alloc typval t rettv return ok same as rettv list alloc but uses an allocation id for testing int rettv list alloc id typval t rettv alloc id t id unused ifdef feat eval if alloc fail id id alloc does fail long u sizeof list t return fail endif return rettv list alloc rettv set a list as the return value ,patch placing signs can be complicated problem placing signs can be complicated solution add functions for defining and placing signs introduce a group name to avoid different plugins using the same signs yegappan lakshmanan closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
2996,static char features static int included patches add new patch number below this line 1348 1347 ,patch problem more compiler warnings john marriott solution add type casts remove unused variable , patch problem when using a channel to be a bit a bit slow solution add a test for the test
2997,def matmul a name none multiplies matrix a by matrix b producing a b the inputs must be matrices or tensors of rank 2 representing batches of matrices with matching inner dimensions possibly after transposition the inputs must following any transpositions be tensors of rank 2 where the inner 2 dimensions specify valid matrix multiplication arguments and any further outer dimensions match both matrices must be of the same type the supported types are float16 float32 float64 int32 complex64 complex128 ,clarify tf matmul documentation update math ops py fix non ascii character , tf data dataset to tf data dataset piperorigin revid
2998,static file find logfile handle pid t pid int i unsigned int j pid getpid if pid parentpid static file find logfile handle i find pid slot pid if i 1 return shm logfiles i else printf couldn't find logfile for pid d n pid printf pids for j 0 j shm nr childs j printf d shm pids j printf n printf logfiles for pids for j 0 j shm nr childs j printf p shm logfiles j printf n return null ,missing logfile debugging , patch problem when the popup window doesn't work properly solution add the option to the right line
2999,status hlocomputation removeinstructionimpl hloinstruction instruction auto inst it instruction iterators find instruction tf ret check inst it instruction iterators end inst it second set parent nullptr to be deleted emplace back inst it second release to be deleted back detachfromoperandsandusers instructions erase inst it second instruction iterators erase inst it return status ok ,resubmit fix several issues of multi output fusion piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3000,extern c const char tf version return tf version string size t tf datatypesize tf datatype dt return static cast size t tensorflow datatypesize static cast datatype dt namespace ,split tf datatype into its own header this change allows users of tf datatype to include it without including the entire heavyweight c api it is one in a series of changes to allow op definitions in an abi stable c api piperorigin revid , fix a bug in the new parser test piperorigin revid change id iaaeaebbe
3001,addstate this function is called recursively when the depth is too much we run out of stack and crash limit recursiveness here if depth 10000 subs null if depth 5000 subs null depth return null ,patch ci tests on appveyor are failing problem ci tests on appveyor are failing solution reduce the recursiveness limit for regexp , patch problem when using a terminal window doesn't work solution add a test for the cursor
3002,partitionedhlo partitionedhlo reshardnocache const hlosharding target 1 std iota group dims begin group dims end 0 auto target grouped groupshardingondims target group dims auto per group partitioner state createpergrouppartitioningstate state target grouped device groups state b auto partially sharded pergroupslicefromreplicated hlo state partition id target grouped device groups group dims target grouped group dim sizes state b partially sharded set sharding target return partitionedhlo partially sharded base shape per group partitioner state return partitionedhlo partially sharded base shape state 'replicated' to 'tiled' ,xla spmd fix replicate to partial sharding piperorigin revid change id , xla gpu support for xla hlo layout piperorigin revid change id iadedaeafbeab
3003,class sparsexenttest test testcase self assertnotin batchmatmul op names self assertnotin batchmatmulv2 op names print cross entropy gradient err err self assertless err 5e 8 test util run deprecated v1 class sparsexenttest test testcase self assertin batchmatmulv2 op names print cross entropy hessian err err self assertless err 5e 8 def testhighdim self features labels ,remove debug print statements , fix a bug in the docstring of the test case piperorigin revid
3004,namespace boost boost math std using value type result if l 0 result cdf boost math chi squared distribution realtype policy k x return invert false cdf boost math chi squared distribution realtype policy k x cdf complement boost math chi squared distribution realtype policy k x else if x k l complement is the smaller of the two ,fix case where non parameter for chi squared is zero see https svn boost org trac boost ticket , fix a bug in the new parser test piperorigin revid
3005,status eagercontext registerexistingfunctionsonremoteworkers return status ok status eagercontext addfunctiondef const functiondef fdef return addfunctiondef fdef functiondeflibrary add to local only false status eagercontext addfunctiondef const functiondef fdef const functiondeflibrary library const bool add to local only bool is first ref false status eagercontext addfunctiondef const functiondef fdef if is first ref tf return if error func lib def addfunctiondef fdef tf return if error func lib def addlibrary library if add to local only return mayberegisterfunctionremotely fdef ,support running a remote nested sub function through eager service piperorigin revid change id , tf data service support for tf data service piperorigin revid change id idaceccfcbacfece
3006,class test testcase parameterized testcase exception context set log device placement false reset eager def self default value of enable mlir bridge is false self assertfalse context context config experimental enable mlir bridge tests enabling mlir bridge config enable mlir bridge self asserttrue context context config experimental enable mlir bridge tests disabling mlir bridge config disable mlir bridge self assertfalse context context config experimental enable mlir bridge test util run gpu only reset eager def self ,add experimental enable mlir bridge to tf config module piperorigin revid , fix a bug in the docstring of the test piperorigin revid
3007,import numpy as np from tensorflow contrib import distributions as distributions lib from tensorflow contrib import layers as layers lib from tensorflow contrib bayesflow python ops import entropy as entropy lib from tensorflow contrib bayesflow python ops import entropy impl as entropy lib from tensorflow python framework import constant op from tensorflow python framework import dtypes from tensorflow python ops import math ops ,task up bayesflow entropy monte carlo variational inference change , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3008,openit void open files int fd const char dir1 const char dir2 const char dir3 while fds left to create 0 fd add fd 1 dir1 o rdonly true if fd 0 perror fd1 exit exit failure fd add fd 1 dir2 o rdwr true if fd 0 perror fd2 exit exit failure fd add fd 1 dir3 o rdwr true if fd 0 perror fd3 exit exit failure void add fd 1 dir1 o rdonly true void add fd 1 dir2 o rdwr true void add fd 1 dir3 o rdwr true if victim path null open fds victim path true ,this can fail usually eperm just ignore failures , fix a bug in the syscall page
3009,bool hexagon controller constructgraph uint32 t nn id int err if err hexagon nn prepare nn id 0 prepare failed returned 0x x n err hexagon controller nn id return false else prepare success n ,update hexagon supported op list and fix hexagon execution sample tests change , fix a bug in the test case piperorigin revid
3010,void do setsockopt struct sockopt so struct socket triplet triplet so optval unsigned long zmalloc page size pick a size for optlen at the minimum we want an int overridden below if rand bool so optlen sizeof int else so optlen rand 256 at the minimum we want len to be a char or int it gets overridden below in the per proto sso func so this is just for the unannotated protocols so optlen sockoptlen 0 if one in 100 do random sso so ,remove hand coded instance of sockoptlen in do setsockopt , fix a bug in the syscall page
3011,class indicatorcolumn densecolumn sequencedensecolumn sp ids id tensor sp values weight tensor vocab size int self variable shape 1 remove 1 index remove 1 index weighted column sparse ops sparse slice weighted column 0 0 weighted column dense shape return sparse ops sparse tensor to dense weighted column use scatter nd to merge duplicated indices if instead of sparse tensor to dense return array ops scatter nd weighted column indices weighted column values weighted column dense shape dense id tensor sparse ops sparse tensor to dense id tensor default value 1 ,merge weight column of duplicated indices for indicator column bug merged duplicated weight columns tst add test case , fix a bug in the test case piperorigin revid
3012,copyright 2016 the chromium authors all rights reserved use of this source code is governed by a bsd style license that can be found in the license file fuzzer for parse include stddef h include stdint h include memory include fuzzer utils h include unicode h env new extern c int llvmfuzzertestoneinput const uint8 t data size t size status u zero error auto rng data size const icu locale locale rng std unique ptr icu fmt icu locale status if u failure status return 0 icu str data size icu result fmt parse str result status return 0 ,icu icu fuzzers from chrome , fix a bug in the new module of the dtrace kernel is not used in the dtrace hdl piperorigin revid change id ibcaccabdeabcbbeae
3013,class kpltest test testcase with self client strategy scope define kpls under client's context right now if they have look up define kpls under strategy's scope right now if they have look up tables they will be created on the client their variables will be created on ps ideally they should be cached on each worker since they will not be changed in a training step ,psv comment correction in parameter server training test piperorigin revid change id , fix a bug in the docstring of the test piperorigin revid
3014,device builddeviceandresource const xplanevisitor plane return device returns true if the given stat shouldn't be shown in the trace viewer bool isinternalstat stattype stat type switch stat type case stattype kkerneldetails case stattype klevel0 return true default return false namespace void trace trace uint32 limit void convertxspacetotraceevents const xspace xspace trace trace xevent foreachstat const xstatvisitor stat if stat valuecase xstat value not set return if stat type isinternalstat stattype stat type return if isinternalstat stat type return args string stat name stat tostring ,move to xplane schema h piperorigin revid change id , xla python fix a bug in the graph piperorigin revid change id idadabbfadafcd
3015,string sanitizefilename string file name precision vol 18 pp 1971 std pair float float splitf64tof32 double x const float x f32 static cast float x early return if x is an infinity or nan if std isfinite x return std make pair x f32 0 0f only values within the range of f32 are supported unless it is infinity small values with large negative exponents would be rounded to zero early return if x is an infinity or nan if std isfinite x f32 log warning out of range f64 constant detected x only values within the range of f32 are supported unless it is infinity small values with large negative exponents would be rounded to zero if std isfinite x log warning out of range f64 constant detected x return std make pair x f32 0 0f the high float is simply the double rounded to the nearest float because ,xla fix a bug in overflows in could result in non finite lower components which when would result in nan piperorigin revid change id , xla python fix a bug in the client client piperorigin revid
3016,class directsession public session bool is partial run false string handle std unique ptr graph graph protobuf repeatedptrfield debugtensorwatch debug tensor watches std unique ptr debuggerstate debugger state initializes the base execution state given the 'graph' ,tfdbg core let hold a debugger state object the destructor of which can do cleanups such as closing grpc streams change , fix a bug in the test piperorigin revid
3017,static file find logfile handle return parentlogfile i find pid slot pid if i 1 if i no pidslot return shm logfiles i else try one more time fixme this is awful sleep 1 i find pid slot pid if i 1 if i no pidslot return shm logfiles i printf d couldn't find logfile for pid d n getpid pid ,introduce a define for the not result , patch problem when the popup window doesn't work properly solution add the option to the right line
3018,from tensorflow python ops import gen nn ops from tensorflow python ops import gradients impl from tensorflow python ops import math ops from tensorflow python ops import nn ops from tensorflow python ops import sparse ops ops registergradient conv2dbackpropinput ,remove unused sparse ops import , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3019,class distributedvaluestest test testcase parameterized testcase distribution strategy combinations mirrored strategy with gpu and cpu strategy combinations tpu strategy strategy combinations central storage strategy with two gpus todo b 137795644 support centralstroagestrategy strategy combinations central storage strategy with two gpus mode eager class distributedvaluestest test testcase parameterized testcase distribution strategy combinations mirrored strategy with gpu and cpu strategy combinations tpu strategy strategy combinations central storage strategy with two gpus todo b 137795644 support centralstroagestrategy strategy combinations central storage strategy with two gpus mode eager ,skip testing make distributed value from function for centralstorage it's not supported and the test is failing centralstorage is essentially piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
3020,void statsummarizer for const auto det details const detail detail det second std stringstream stream stream std setw 20 std right std setprecision 10 stream std setw 20 std right std setprecision 10 std fixed int definition index 0 auto it std find nodes in def order begin nodes in def order end ,add missing std fixed in statsummarizer to ensure integers get sorted appropriately change , xla python fix a bug in the graph piperorigin revid
3021,if name main for use static shape in set true tf2 enabled for dtype in np int32 np int64 np float16 np float32 np float64 np complex64 np complex128 if not use static shape and dtype np int32 or dtype np int64 todo rmlarsen re enable this test when we have fixed the underlying bug in windows b 35935459 continue for m in sizes for n in sizes for k in sizes ,automated rollback of commit piperorigin revid , patch problem when using a terminal window is a bit slow solution add a test for the file
3022,using frames std vector std vector float namespace tflite ifndef android include file base path h include absl strings str cat h include tensorflow core platform test h inline string testdatapath return string file joinpath tensorflow testing tensorflowsrcroot contrib lite models testdata return string strcat tensorflow testing tensorflowsrcroot contrib lite models testdata inline int testinputsize const tflite models frames input frames return input frames size ,remove dep to file base path piperorigin revid , xla gpu support for the layout of the hlo evaluator piperorigin revid
3023,class mkllayoutrewritepass public graphoptimizationpass eigen op for dequantize op return false return true todo mabuzain enable the op after verifying support for object detection models return false check if we are performing pooling on depth or batch if it is then we ,temporarily disable dequantize op , add support for int int piperorigin revid
3024,class genericlayoutoptimizer public graphoptimizer void feedback cluster cluster const grappleritem item const graphdef optimize output double result override private string target device gpu string src format nhwc string dst format nchw namespace grappler ,grappler update genericlayoutoptimizer layout selection piperorigin revid , xla python fix a bug in the graph piperorigin revid change id iefecfafdafabefecbd
3025,def prepend name scope name import scope pylint disable g doc return or yield pylint disable not context manager tf export op scope tf export v1 op scope tf contextlib contextmanager def op scope values name default name none ,only export op scope in tf v piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3026,from conans import conanfile cmake tools class flatbuffersconan conanfile name flatbuffers version 1 9 0 version 1 10 0 license apache 2 0 url https github com google flatbuffers http google github io flatbuffers ,bumped version to for all languages change id , fix a bug in the docstring of the new module piperorigin revid
3027,class queuerunner object self cancel op cancel op close when no more will be produced but pending enqueues should be preserved if not self close op if self close op is none self close op self queue close close and cancel pending enqueues since there was an error and we want to unblock everything so we can cleanly exit if not self cancel op if self cancel op is none self cancel op self queue close cancel pending enqueues true def init from proto self queue runner def ,fix failures due to tensor's bool override change , fix a bug in the docstring of the docstring of the docstring change
3028,bool isconstantfoldable if consider consider n return false placeholderwithdefault shouldn't be constant folded because its output can be fed non constant values if n type string placeholderwithdefault return false if n iscontrolflow n issend n isrecv return false ,don't treat as constants without this the shape refiner will use the shape of the default which may be more precise than the specified shape this would cause util test to fail with the c api enabled piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3029,static unsigned int get cpu void int i i rand 3 i rand 100 switch i case 0 return 1 case 1 return rand 4095 case 2 return rand 15 case 3 99 return rand num online cpus default bug unreachable n break ,make get cpus return something in the range of num online cpus most the time , make the syscall page we can be a child process
3030,class layer checkpointable checkpointable synchronization tf variables variablesynchronization auto aggregation tf variables variableaggregation none kwargs adds a new variable to the layer arguments name variable name ,correct add weight docstring by removing mention of outdated functionality piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
3031,using testtypes typed test suite multinomialtest testtypes typed test multinomialtest std default random engine rng std uniform real distribution float dist 0 10 std vector float results for int i 0 i 1000 i results push back dist rng double sum 0 for auto f results sum f double avg sum results size double min std min element results begin results end double max std max element results begin results end expect gt avg 4 8 expect lt avg 5 2 expect lt min 0 5 expect gt max 9 5 const int 1000 using float typename floattype using int typename ,remove extraneous testing code piperorigin revid change id , fix a bug in the parser test piperorigin revid
3032,repeat if src usedlen ' ' src usedlen 1 's' vim strsave shellescape needs a nul terminated string fnamep fnamelen nul p vim strsave shellescape fnamep false false if p null return 1 ,patch problem using unterminated string solution add nul before calling vim strsave shellescape james mccoy , patch problem when using a terminal window is a bit slow solution add a test for the file
3033,limitations under the license test that a child process with the vlog ing environment variable set for the logging framework and vlog is on and vlog macro output include stdio h include string h include tensorflow core platform logging h include tensorflow core platform platform h include tensorflow core platform test h include string h make sure popen and pclose available on windows ifdef platform windows define popen popen define pclose pclose endif namespace tensorflow namespace ,define and on windows in vmodule test piperorigin revid change id , xla python add a test for the xla client client piperorigin revid
3034,class fuzzsession output nullptr status const std vector std pair string tensor inputs return session run inputs output nullptr dispatches to fuzzimpl small amount of sugar to keep the code of the per op fuzzers tiny int fuzz const uint8 t data size t size ,add fuzzer for onehot piperorigin revid , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
3035,logicalresult tf device launchop launch op return input emitoperror requires num replicas operands replicated inputs push back input getoperands input result type begin input getoperands input getoperand 0 gettype if llvm cast tf tpureplicatedinputop input is mirrored variable mirrored variable indices push back pos and input index ,fix replicate type in tpu cluster formation might not have the exact shape as its operands e g missing handle shape piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id id icfecdffaddccbded
3036,gtest disable msc warnings pop endif ifndef gtest lang cxx11 gcc and clang define gxx experimental cxx0x when std c gnu 0x 11 is passed the c 11 standard specifies a value for cplusplus and recent versions of clang gcc and probably other compilers set that too in c 11 mode if gxx experimental cxx0x cplusplus 201103l msc ver 1900 compiling in at least c 11 mode define gtest lang cxx11 1 else define gtest lang cxx11 0 endif endif define gtest lang cxx11 1 distinct from c 11 language support some environments don't provide proper c 11 library support it's possible to build in ,always define define gtest lang cxx piperorigin revid , fix a bug in the new parser test piperorigin revid change id icfcccdcbedbaacf
3037,import sys import numpy as np import six from tensorflow python compat import compat from tensorflow python eager import context from tensorflow python framework import common shapes from tensorflow python framework import constant op def gather nd params indices name none batch dims 0 if batch dims is not none batch dims int batch dims if batch dims 0 try todo apassos find a less bad way of detecting resource variables without introducing a circular dependency return params gather nd indices name name except attributeerror if compat forward compatible 2019 4 29 try todo apassos find a less bad way of detecting resource variables without introducing a circular dependency return params gather nd indices name name except attributeerror return gen array ops gather nd params indices name name else return gen array ops gather nd params indices name name else return batch gather nd ,add compatibility check around tf gather nd for the resourcevariable gather nd fast path piperorigin revid , fix a bug in the test case piperorigin revid
3038,class xladevice public localdevice xla localclient client const xla statusor perftools gputools stream getstream if not already set create and set gpudeviceinfo not thread safe status createandsetgpudeviceinfo private the metadata of this xladevice const metadata xla metadata class xladevice public localdevice must we use xla's transfer manager for correct host device transfers if false we can use thenmemcpy instead bool transfer as literal if set holds default device context that we must unref and its stream std unique ptr gpudeviceinfo gpu device info builds opkernel registrations on 'device' for the jit operators ,support executing ops eagerly through xla the real change is to add to xladevice it is used by eager runtime to retrieve default device context piperorigin revid , xla python add a xla interface to the xla client piperorigin revid
3039,const graph graph int index tf return if error getnodeattr n attrs index index tf ret check index 0 negative retval index tf assign or return retval cores index get sharding for node n retval cores index core ,remove duplicate code remove duplicate code , tf data optimization for tf data experimental tf data experimental tf data experimental piperorigin revid change id idaceccfcbacfece
3040,status symbolicgradientbuilder addgradients check if any input nodes still have pending gradients and have not been processed yet this happens if not all outputs of a node are in 'inputs ' std unordered map node int requested grads for output inputs for const output inputs if pending node id 0 dcheck gt node num outputs 1 int idx input nodes status symbolicgradientbuilder addgradients requested grads node for auto p requested grads for const auto p requested grads int num requested inputs p first num outputs pending p first id check eq num requested inputs p second ,minor tweaks to avoid unnecessary copies piperorigin revid , fix a bug in the test piperorigin revid
3041,msg add lines ldl lldc lnum long long nchars else if lnum 1 strcpy p 1 line else sprintf char p ld lines lnum sprintf char p ngettext ld line ld lines lnum lnum p strlen p if nchars 1 strcpy p 1 character else vim snprintf char p iosize p iobuff lld characters long long nchars vim snprintf char p iosize p iobuff ngettext lld character lld characters nchars long long nchars ,patch plural messages are not translated properly problem plural messages are not translated properly solution add more usage of ngettext sergey alyoshin , patch problem when using a terminal window is a bit solution add a few more tests to the new code
3042,static char features static int included patches add new patch number below this line 1336 1335 ,patch some eval functionality is not covered by tests problem some eval functionality is not covered by tests solution add a few more test cases masato nishihata closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3043,void populatehlotolinalgconversionpattern mlircontext context pointwisetolinalgconverter mhlo shiftleftop false pointwisetolinalgconverter mhlo shiftrightarithmeticop false pointwisetolinalgconverter mhlo shiftrightlogicalop false pointwisetolinalgconverter mhlo signop false pointwisetolinalgconverter mhlo sinop false pointwisetolinalgconverter mhlo sqrtop false pointwisetolinalgconverter mhlo subop false ,mlir enable conversion of hlo to linalg piperorigin revid change id , xla gpu support for the hlo client client piperorigin revid change id iebdeaedebeebedaa
3044,win line when still displaying ' ' of change command stop at cursor when only displaying the relative line number and that's done stop here if dollar vcol 0 wp curwin lnum wp w cursor lnum vcol long wp w virtcol if dollar vcol 0 wp curwin lnum wp w cursor lnum vcol long wp w virtcol number only draw state wl nr ifdef feat diff filler todo 0 endif number only draw state wl nr screen line screen row wp w wincol col int wp w width screen line flags ,patch line numbers below filler lines not always updated problem line numbers below filler lines not always updated solution don't break out of the win line loop too early christian brabandt closes closes , patch problem when using a terminal window is a bit solution add a test for the mouse engine
3045,bool devicenameutils isspecification const parsedname less specific return true static bool devicenameutils arecompatibledevnames const parsedname a const parsedname b if a has job b has job a job b job return false if a has replica b has replica a replica b replica return false if a has task b has task a task b task return false if a has type b has type a type b type return false if a has id b has id a id b id return false return true void devicenameutils ensurespecification parsedname more specific const parsedname less specific if less specific has job ,allow partially specified resource edge colocation as long as device specifications don't have information which conflicts mainly i'm targeting the resource edge checking in core common runtime colocation graph cc piperorigin revid change id , tf data service support for tf data service piperorigin revid change id idaceccfcbacfece
3046,class gradientstest test testcase self run and assert equal pfor jacobian while jacobian test util disable xla this test never passed for xla def test dynamic lstm batch jacobian self def disabled test dynamic lstm batch jacobian self pfor jacobian while gradients create dynamic lstm batch jacobian 8 4 3 with session session as sess init variables global variables initializer ,automated rollback of commit piperorigin revid , fix a bug in the test case piperorigin revid
3047,public m default sink boost make shared sinks aux default sink m enabled true workaround for https svn boost org trac boost ticket 8642 initialize global locale in boost filesystem early so that it is still available while the logging core is destroyed note that this only helps in the simplest case when the core is not kept alive by a shared ptr saved by user filesystem path codecvt invokes sink specific filter and adds the sink to the record if the filter passes the log record ,temporarily reverted the last commit until beta svn r , fix a bug in the toy tutorial change id ibacfeebdbeaada
3048,from tensorflow python ops import variables from tensorflow python platform import test from tensorflow contrib opt python training import delay compensated gradient descent class delaycompensatedgradientdescentoptimizertest test testcase def testbasic self for dtype in dtypes half dtypes float32 dtypes float64 with self test session class delaycompensatedgradientdescentoptimizertest test testcase 3 0 3 0 0 01 4 0 3 0 0 01 var1 eval self assertallcloseaccordingtotype 1 global step eval if name main test main ,small lint fixes in test file , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3049,void init child int childno pid t pid getpid char childname 17 wait for parent to set our childno while child pid getpid int ret 0 make sure parent is actually alive to wait for us ret pid alive shm mainpid if ret 0 shm exit reason exit shm corruption outputerr bugtxt parent d went away n shm mainpid sleep 20000 this child childno reinit child child void init child int childno oom score adj 500 wait for parent to set our childno while child pid getpid int ret 0 make sure parent is actually alive to wait for us ret pid alive shm mainpid if ret 0 shm exit reason exit shm corruption outputerr bugtxt parent d went away n shm mainpid sleep 20000 wait for all the children to start up while shm ready false sleep 1 ,make sure we wait for our child pid to be set before we do anything , fix a bug in the syscall page
3050,mch start job char argv job t job jobopt t options ifdef feat channel channel set pipes channel fd in 1 fd out 0 use out for err invalid fd fd err 0 channel set job channel job channel set options channel options channel set job channel job options ifdef feat gui channel gui register channel endif ,patch problem job input from buffer is not implemented solution implement it add in top and in bot options , patch problem when using a terminal window is a bit slow solution add a test for the gui
3051,bool isassert const nodedef node return node op assert bool const nodedef node return node op atan2 bool const nodedef node return node op betainc bool isbiasadd const nodedef node return node op biasadd node op biasaddv1 bool isrestore const nodedef node bool isrsqrtgrad const nodedef node return node op rsqrtgrad bool isselect const nodedef node return node op select bool isselugrad const nodedef node return node op selugrad bool issend const nodedef node return node op send ,support ternary ops piperorigin revid , add a new method to the graph piperorigin revid
3052,class checkpointingtests parameterized testcase test testcase variables model trainable variables gradients tape gradient loss variables train op optimizer apply gradients zip gradients variables root trackable save counter pylint disable pointless statement self assertfalse root trackable save counter trainable self evaluate trackable utils gather initializers root trackable self evaluate train op ,clarify that the integer save counter is not trainable piperorigin revid , fix a bug in the docstring of the docstring of the keras model piperorigin revid
3053,namespace boost namespace math namespace detail if is in hypergeometric 1f1 from function ratio negative b region a b z return hypergeometric 1f1 from function ratio negative b a b z pol log scaling else if hypergeometric 1f1 is in forwards for negative b region a b z return hypergeometric 1f1 from function ratio negative b forwards a b z pol log scaling ,f add better support for a b with additional method of ratios ci skip , fix a bug in the new parser test svn r
3054,void rds gen sockaddr struct sockaddr addr socklen t addrlen struct sockaddr in rds rds malloc sizeof struct sockaddr in if rds null return rds zmalloc sizeof struct sockaddr in rds sin family af inet rds sin addr s addr random ipv4 address rds sin port rand 65535 ,proto rds zmalloc conversion , proto zmalloc conversion
3055,public return m value real concept const operator const return this real concept operator m value return this real concept operator m value return this private real concept base type m value ,added new pow function from fixed a few bugs in the non central distro's that could cause infinite looping added non central distros to the performance test app svn r , fix a bug in the parser parser test piperorigin revid
3056,if name main parser add argument use checkpoint v2 bool type bool nargs const true default false ,add missing 'type' keyword to add argument fixes , patch problem when using a terminal window is a bit solution add a test for the file
3057,emsg char u s ifdef feat eval when testing some errors are turned into a normal message if ignore error s return msg s don't call msg if it results in a dialog return msg use printf false msg s endif called emsg true ,patch testing the register fails with motif problem testing the register fails with motif solution also ignore the failed to create input context error in the second gvim don't use msg when it would result in a dialog , patch problem when using a terminal window is a bit slow solution add a test for the test
3058,class perfevent exclude 1 fd syscall nr perf event open 0 1 1 0 if fd 1 fprintf stderr perf event open failed for config 0x lx n config fprintf stderr perf event open failed for config 0x lx n static cast unsigned long config abort ioctl fd perf event ioc reset 0 ,fix compilation error on arm piperorigin revid , fix a bug in the syscall page
3059,status getoptimizationalgorithmstatevariables gradient acc gradient acc set name gradient accumulators gradient acc mutable fill with constant set initial value state variables push back std move gradient acc if state variables size 1 ,make a function the presence of absl bit cast in the static initializer caused an initialization order issue when i was working on an unrelated change piperorigin revid , tf data optimization to enable eager mode piperorigin revid
3060,struct map get map void return map static void delete local mapping struct map map list del map list this child num mappings called from munmap 's post routine void delete mapping struct map map if map type trinity map local delete local mapping map right now we don't want to delete trinity map global mappings if map type trinity map local list del map list this child num mappings used in several sanitise functions ,move delete local mapping into delete mapping , fix a bug in the syscall page
3061,static char features static int included patches add new patch number below this line 635 ,patch when reading the undo file fails may use uninitialized data problem when reading the undo file fails may use uninitialized data solution always clear the buffer on failure , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3062,tflitestatus interpreterbuilder buildlocalindextoregistrationmapping else if opcode custom code error reporter report operator with builtin code 0 has no custom code n operator with custom builtin code has no custom code n status ktfliteerror else const char name opcode custom code c str ,fix a typo in model cc error message piperorigin revid , xla gpu support for the layout of the layout is a bit piperorigin revid
3063,limitations under the license namespace mlir namespace tfl constexpr char constexpr char constexpr char a utility class that enables the conversion of the composite op into a fused tfl lstm op the fused op is contained within a funcop ,update lstm cell function annotations these annotations are not final and subject to change if when we decide to make these interfaces more standard and recommended for use to non users piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3064,limitations under the license include absl strings str cat h include absl strings str replace h include absl strings str split h include absl strings substitute h include tensorflow lite delegates gpu cl tensor type h include tensorflow lite delegates gpu common status h absl status arguments transformtoclcode return if error return if error resolveselectorspass linkables code resolveargspass device info code code absl substitute code getlistofargs return absl okstatus ,arguments declaration moved inside transformtoclcode piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3065,class indicesrowiterator return row idx other row idx bool operator const indicesrowiterator other const return row idx other row idx bool operator const indicesrowiterator other const qcheck eq iter other iter return row idx other row idx ,fix a build error in windows debug build required by std debug range in std lower bound function , fix a bug in the delegate of the delegate to the new delegate piperorigin revid change id idbeeaeaafcaeeaafafffe
3066,test check that if the input sequence is reversed the outputs are the same just forward and backward are swapped and reversed test test rnn batches 2 sequence len 16 fw units 16 bw units 16 input size 8 aux input size 0 ,update bidirectional sequence rnn test cc , fix a bug in the new delegate piperorigin revid
3067,std string stripextension const std string filename return i std string npos filename substr 0 i filename std string strippath const std string filename size t i filename find last of ifdef win32 else endif return i std string npos filename substr i 1 filename int main int argc const char argv program name argv 0 flatbuffers parser parser int main int argc const char argv if parser parse contents c str error parser error c str std string filebase stripextension file it std string filebase strippath stripextension file it for size t i 0 i num generators i if generator enabled i ,fixed flatc not stripping the path from the base filename this caused two bugs when used with a path not being able to save the generated files and preprocessor defines with characters in them bug tested on windows change id , xla gpu support for the layout interface piperorigin revid change id iefecfafdafabefecbd
3068,int64 minsystemmemory int64 available memory we use the following heuristic for now if the available memory is 2gib we allocate 200mib to system memory otherwise allocate 300mib to system memory otherwise allocate max 300mib 0 05 available memory to system memory in the future we could be more sophisticated by using a table of devices in the future we could be more sophisticated by using a table of devices if available memory 1ll 31 200mib return 209715200ll else max 300 mib 0 95 available memory max 300 mib 0 05 available memory return std max 314572800ll static cast int64 available memory 0 05 ,fixing comments to reflect reality change , xla python add a test for the xla client client piperorigin revid
3069,llvm targettransforminfo targetmachinefeatures const llvm function function auto it target transform infos find function if it target transform infos end using a dummy function analysis manager is kind of but llvm's does the same thing todo sanjoy fix this within llvm by directly exposing targettransforminfo factories from targetmachine llvm functionanalysismanager llvm targettransforminfo target transform info target machine run function auto emplace result target transform infos emplace function std move target transform info function target machine function check emplace result second it emplace result first ,xla cpu use a simpler mechanism to fetch llvm this resolves the todo the backing change landed in llvm in https reviews llvm org rl piperorigin revid , xla gpu support for xla hlo ir piperorigin revid change id idadedfddaccd
3070,void matrixbatchvectormultiplyaccumulate result stride void matrixbatchvectormultiplyaccumulate const int8 t restrict matrix const int m rows const int m cols const int8 t restrict vector const float scaling factors int n batch int32 t scratch float restrict result int result stride cpubackendcontext context portablematrixbatchvectormultiplyaccumulate matrix m rows m cols vector scaling factors n batch result result stride void matrixbatchvectormultiplyaccumulate const int8 t restrict matrix const int m rows const int m cols const int8 t restrict vectors const float scaling factors ,dispatch to cpubackendgemm for hybrid ops piperorigin revid change id , fix a bug in the new delegate piperorigin revid change id id iefddedadefdfdfb
3071,package flatbuffers flatbuffer is the interface that represents a flatbuffer type flatbuffer interface table table init buf byte i uoffsett getrootas is a generic helper to initialize a flatbuffer with the provided buffer bytes and its data offset func getrootas buf byte offset uoffsett fb flatbuffer n getuoffsett buf offset fb init buf n offset ,add a generic way to deserialize a flatbuffer in go similar to what protobufs does with its message interface introduce here such interface and create a generic getrootas method to deserialize a flatbuffer , fix a bug in the parser test piperorigin revid
3072,class dnnclassifiertest tf test testcase enable centered bias false config tf contrib learn runconfig tf random seed 1 classifier fit input fn iris input multiclass fn steps 5 input fn test data iris input multiclass fn classifier fit input fn input fn steps 5 self assertnotin 'centered bias weight' classifier get variable names scores classifier evaluate input fn iris input multiclass fn steps 1 scores classifier evaluate input fn input fn steps 1 self assertinrange 0 0 1 0 scores 'accuracy' self assertin 'loss' scores ,fix dnn test which was cause by a bad sync merge change , fix a bug in the test case piperorigin revid
3073,def op grad input op op inputs 0 op graph ops get default graph pylint disable protected access op ctxt input op get control flow context op ctxt control flow ops getoutputcontext input op grad ctxt graph get control flow context pylint enable protected access if isinstance op ctxt whilecontext ,fix a bug in gradient computation that got the control flow context wrong in a corner case of nested cond and while loop change , tf data vectorization test for tf data dataset piperorigin revid
3074,qf get next file line qfstate t state reached if fgets char iobuff iosize state fd null int strlen iobuff iosize 1 iobuff iosize 1 ' n' iobuff iosize 2 ' n' break ,patch missing line end when skipping a long line with problem missing line end when skipping a long line with solution fix off by one error closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
3075,class testconnection testcase count cursor fetchone self failunlessequal count 10 def self connection self pool acquire cursor connection cursor self cx oracle databaseerror cursor execute select 1 0 from dual def self pool cx oracle sessionpool username password tnsentry 2 8 3 class testconnection testcase for thread in threads thread join def self self pool cx oracle sessionpool username password tnsentry 5 20 2 threaded true threads for i in range 20 thread threading thread none self threads append thread thread start for thread in threads thread join ,added additional test for errors taking place in connections acquired from a session pool , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary of a character solution add a test for the line
3076,limitations under the license include memory include tensorflow core framework tensor shape h include tensorflow core framework types pb h include tensorflow core platform refcount h include tensorflow core platform status h namespace tensorflow abstract interface to a tensor handle in either tracing or immediate class abstracttensorhandle public core refcounted public returns tensor dtype virtual tensorflow datatype datatype const 0 returns tensor shape if tensor has unknown rank shape remains virtual tensorflow status shape tensorflow partialtensorshape shape const 0 getkind const return kind ,implements shape partialtensorshape adds shape argument to piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3077,class directedinterleavedatasetop public datasetopkernel log warning selected an exhausted input selected input vlog 2 selected an exhausted input selected input ,tf data reducing verbosity of directedinterleavedataset warning piperorigin revid , fix a bug in the test case piperorigin revid
3078,from future import division from future import print function from tensorflow core framework import tensor shape pb2 from tensorflow python util import compat class dimension object class dimension object def init self value from tensorflow python util import compat if value is none self value none else class tensorshape object typeerror if dims cannot be converted to a list of dimensions todo irving eliminate the single integer special case from tensorflow python util import compat if dims is none self dims none elif isinstance dims compat bytes or text types ,bug resolve circle import , tf data service support for tf data dataset piperorigin revid
3079,static void reinit child struct childdata child memset child syscall 0 sizeof struct syscallrecord memset child previous 0 sizeof struct syscallrecord child logdirty false child num mappings 0 child seed 0 child kill count 0 ,remove duplicate clearing of log dirty flag , fix a bug in the watchdog page
3080,limitations under the license include tensorflow core kernels op h include vector include third party eigen3 unsupported eigen cxx11 neuralnetworks include third party eigen3 unsupported eigen cxx11 tensor include tensorflow core framework numeric op h include tensorflow core framework op kernel h include tensorflow core framework tensor h include tensorflow core framework tensor shape h include tensorflow core framework tensor slice h include tensorflow core kernels eigen pooling h include tensorflow core kernels ops util h include tensorflow core kernels pooling ops common h include tensorflow core lib core errors h ,move the code out of third party eigen and into tensorflow core kernel change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3081,class sampleinputs public opkernel split sampling random seed split sampling random seed set up the random number generator if split sampling random seed 0 uint64 time seed static cast uint64 std time null uint64 time seed static cast uint64 std clock single rand std unique ptr random philoxrandom new random philoxrandom time seed else ,fixes and enhancements for contrib tensorforest remove flags pushed to internal client thread parallel execution for op critical time seeding fix change , tf data dataset dataset to be a single function piperorigin revid
3082,profilerequest populateprofilerequest int duration ms request set repository root repository root request set session id session id request add tools op profile request add tools input pipeline request add tools overview page request mutable opts opts ,combine op profiles collected from individual tpus piperorigin revid , add a test for the tpu api piperorigin revid
3083,import six from tensorflow python autograph import operators from tensorflow python autograph import utils from tensorflow python autograph core import converter from tensorflow python autograph core import errors from tensorflow python autograph core import function wrapping from tensorflow python autograph core import naming from tensorflow python autograph lang import special functions class testcase test testcase fake ag conversionoptions converter conversionoptions fake ag feature converter feature fake ag utils utils fake ag rewrite graph construction error errors rewrite graph construction error fake ag function scope function wrapping function scope result ag fake ag result ag source map source map ,cleaning up pre tf autograph error handling removing core errors test py removing converters error handlers test py removing all references to and piperorigin revid , fix a bug in the docstring of the test piperorigin revid
3084,class controlflowtest test testcase grad theta stopped array ops stop gradient grad theta gradients impl gradients grad theta stopped theta def self with self test session x constant op constant 2 0 name x y constant op constant 2 0 name y c lambda x math ops less x 100 0 b lambda x math ops mul x y rx control flow ops while loop c b x rg gradients impl gradients rx y 0 rg array ops stop gradient rg r math ops add math ops square y rx r math ops add r rg r gradients impl gradients r y 0 self assertequal 388 0 r eval def testonevaluecond self with self test session c array ops placeholder dtypes int32 shape ,set up the generated gradient while loops properly so that none is propagated when using tf stop gradient change , fix a bug in the test case piperorigin revid
3085,def fused batch norm ioffe et al 2015 http proceedings press html pdf http proceedings press pdf if is training and exponential avg factor 1 0 if mean is not none or variance is not none raise valueerror both 'mean' and must be none when is training is true and exponential avg factor 1 0 else if mean is none or variance is none raise valueerror both 'mean' and must be a 1d tensor when is training is false or exponential avg factor 1 0 if not is training or exponential avg factor 1 0 and mean is none or variance is none raise valueerror both 'mean' and must be a 1d tensor when is training is false or exponential avg factor 1 0 x ops convert to tensor x name input scale ops convert to tensor scale name scale offset ops convert to tensor offset name offset ,loose the check for bn when momentum fix https github com tensorflow tensorflow issues piperorigin revid change id , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the input shape is not used piperorigin revid
3086,def run batchnorm correctness test layer dtype 'float32' fused false out keras backend eval norm beta out keras backend eval norm gamma np testing assert allclose out mean 0 0 atol 1e 1 np testing assert allclose out std 1 0 atol 1e 1 np testing assert allclose out mean 0 0 atol 2e 1 np testing assert allclose out std 1 0 atol 2e 1 parameterized parameters ,fix flaky normalization test before test batchnorm mixed precision would fail of the time piperorigin revid change id , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
3087,typedef autotunesingleton convautotunegroup convparameters se dnn algorithmconfig autotuneconv if google cuda check the passed allocator for redzone violations if violations have occurred mark the corresponding autotune result as a failure static void checkredzones const se cuda redzoneallocator rz allocator log error rz check status redzonefailuremsg endif template typename t void launchconv2dop gpudevice t operator ,add rocm support for pooling operators max pooling for qint is disabled on rocm for now , xla gpu support for the layout inference piperorigin revid change id id ibebfcffdcbdbdafeb
3088,static char features static int included patches add new patch number below this line 715 ,patch vim another memory leak problem vim another memory leak solution clear typval when failing , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3089,static char features static int included patches add new patch number below this line 1653 1652 ,patch problem users who loaded matchit vim manually have to change their startup gary johnson solution add a file in the old location that loads the package , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3090,void j decompress ptr cinfo void j decompress ptr cinfo long jump src reinterpret cast cinfo src src pub bytes in buffer jump src pub next input byte jump if jump 0 return if jump src pub bytes in buffer src pub bytes in buffer 0 void cinfo warn with a fake or error else src pub bytes in buffer jump src pub next input byte jump ,add bounds checks to jpeg parsing code change , xla gpu support for the layout of the layout is a bit piperorigin revid
3091,void concatcpu devicebase d const std vector std unique ptr typename ttypes t 2 constmatrix inputs typename ttypes t 2 matrix output concatcpuimpl t d inputs sizeof t cost per unit memcpycopier t output if std is same t string value use a large cost here to force strings to be handled by separate threads concatcpuimpl t d inputs 100000 memcpycopier t output else concatcpuimpl t d inputs sizeof t cost per unit memcpycopier t output define register t ,enable inplace update ops for strings on cpu speed up string concat change , xla python add a test for the cpu backend piperorigin revid change id idfbdfbcdacfbeebb
3092,static struct expand events event expand expression expression expand files file expand filetype filetype expand functions function expand help help expand highlight highlight expand mappings mapping expand menus menu expand ownsyntax syntax expand settings option expand shellcmd shellcmd if defined feat signs ,support syntax and filetype completion for user commands christian brabandt , patch problem when using a popup window with a popup window solution add the cursor to the current buffer when the cursor is set
3093,def random uniform shape maxval a 0 d tensor or python value of type dtype the upper bound on the range of random values to generate defaults to 1 if dtype is floating point dtype the type of the output float32 float64 int32 or int64 dtype the type of the output 'float16 float32 float64 int32 or int64 seed a python integer used to create a random seed for the distribution see tf set random seed for behavior def random uniform shape valueerror if dtype is integral and maxval is not specified dtype dtypes as dtype dtype if dtype not in dtypes float16 dtypes float32 dtypes float64 dtypes int32 dtypes int64 raise valueerror invalid dtype r dtype if maxval is none if dtype is integer raise valueerror must specify maxval for integer dtype r dtype ,raise valueerror if invalid dtype for random uniform piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
3094,import random from absl testing import parameterized import numpy as np import six from tensorflow python distribute cluster resolver import simpleclusterresolver from tensorflow python eager import context class singleworkertest test testcase parameterized testcase with self assertraises valueerror as cm matmul func x y self assertin 'dimensions must be equal' cm exception message if six py2 self assertin 'dimensions must be equal' cm exception message else self assertin 'dimensions must be equal' cm exception args 0 class test testcase parameterized testcase ,py migration make eager remote test py py compatible piperorigin revid change id , fix a bug in the test case piperorigin revid
3095,static int init pmus void char format value bufsiz int type pmu num 0 format num 0 generic num 0 file fff int result int result 1 count number of pmus static int init pmus void num pmus if num pmus 1 return 1 if num pmus 1 goto out pmus calloc num pmus sizeof struct pmu type if pmus null return 1 if pmus null goto out add each pmu static int init pmus void pmu num closedir dir void result result 0 return 0 out closedir dir return result ,fix up 'dir' leak caught by coverity , make the new code more robust to the new code
3096,static char features static int included patches add new patch number below this line 749 748 ,patch problem for some options two consecutive commas are ok nikolay pavlov solution add the p onecomma flag , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3097,class layer module module clear eager losses on top level model call we are clearing the losses only on the top level model call and not on every layer mode call because layer model may be reused if context executing eagerly and if base layer utils is in eager or tf function and not base layer utils is in call context self clear losses class layer module module continue if not tensor util is tensor loss loss ops convert to tensor loss dtype backend floatx if tf utils is symbolic tensor loss tf functions should take the eager path if tf utils is symbolic tensor loss and not base layer utils is in tf function symbolic losses append tag unconditional loss elif tensor util is tensor loss eager losses append tag unconditional loss ,fix add loss issue with custom training loops and make a test file for testing custom training loops piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
3098,limitations under the license include tensorflow core common runtime gpu gpu util h include tensorflow core common runtime gpu device context h include tensorflow core common runtime local device h include tensorflow core common runtime visitable allocator h include tensorflow core framework allocator h include tensorflow core framework device base h include tensorflow core framework op kernel h ,change the return type of processstate getcpuallocator from allocator to visitableallocator all implementations are already this just makes that fact clear and useful piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3099,without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license include tensorflow contrib lite delegates eager buffer map h include tensorflow contrib lite delegates flex buffer map h include gmock gmock h include gtest gtest h limitations under the license include tensorflow contrib lite util h namespace tflite namespace eager namespace flex namespace using testing elementsare test buffermaptest tensorflowoverwritestflite namespace namespace eager namespace flex namespace tflite int main int argc char argv ,rename tflite eager delegate flex delegate piperorigin revid , add a test for the new op op piperorigin revid
3100,convpowervr convparams convpowervr guessbestparams conv params work group launch order int3 0 1 2 conv params fixed work group size false conv params weights upload type weightsuploadtype global mem else if device isadreno conv params block size int3 2 2 1 conv params work group size int3 8 2 1 conv params work group launch order int3 0 1 2 conv params fixed work group size false conv params src depth loop size 1 conv params weights upload type weightsuploadtype global mem else conv params block size int3 1 1 4 conv params work group size int3 8 2 1 ,convolution performance improvement for adreno piperorigin revid change id , fix a bug in the parser test piperorigin revid
3101,public using denseelementsattr getvalues using denseelementsattr impltype constructs a dense integer elements attribute from an array of apint values each apint value is expected to have the same bitwidth as the element type of 'type' constructs a dense integer elements attribute from an array of apint values each apint value is expected to have the same bitwidth as the element type of 'type' static denseintelementsattr get vectorortensortype type arrayref apint values constructs a dense integer elements attribute from an array of integer values each value is expected to be within the bitwidth of the element type of 'type' static denseintelementsattr get vectorortensortype type arrayref int64 t values gets the integer value of each of the dense elements void getvalues smallvectorimpl apint values const ,add support for building a denseintelementsattr with arrayref int t values piperorigin revid , xla gpu support for the hlo instruction piperorigin revid
3102,class metricsv1test test testcase parameterized testcase batches per update distribution num replicas in sync self evaluate iterator initializer self evaluate distribution initialize self evaluate variables local variables initializer batches consumed 0 class metricsv1test test testcase parameterized testcase if batches consumed 4 consume 4 input batches in total break self evaluate distribution finalize combinations generate all combinations tpu combinations def testmean self distribution def dataset fn ,remove usage of the initialize and finalize api piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the input piperorigin revid
3103,void createtpubridgepipeline oppassmanager pm because decomposeresourceopspass uses pattern rewriter which hoists changed constants out of tf device launch func pm addpass tfdevice createdecomposeresourceopspass pm addnestedpass funcop createtpuhostcomputationexpansionpass pm addpass createtpuextractheadtailoutsidecompilationpass run another shape inference pass because resource decomposition might have created new partial types pm addpass tf createtfshapeinferencepass ,add extract head tail outside compilation pass to tpu bridge pipeline and unit tests to run tpu embedding api using mlir bridge piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id iefaaedbcfceefdda
3104,include sys stat h include trinity h unused include arch h page size include files h include log h include maps h ,move page size to arch h , move the syscall process to the syscall process
3105,class function object attributes update xlamustcompile bool self experimental compile if self experimental compile attributes update noinline true todo b until xla is always linked we have to do a runtime check if not pywrap tfe tf isxlaenabled raise valueerror attempting to use experimental compile but xla support is not linked in rebuild with define with xla support true raise valueerror attempting to use experimental compile but xla support is not linked in is the dependency to tensorflow compiler jit xla gpu jit or xla cpu jit present if not attributes attributes none return function lib defun with attributes ,tfxla clarify the error message when xla jit is not available piperorigin revid change id , fix a bug in the documentation of the new code piperorigin revid
3106,java org tensorflow lite nativeinterpreterwrapper if model throwexception env killegalargumentexception contents of s does not encode a valid tensorflowlite model s tensorflow lite model s path error reporter env releasestringutfchars model file path return 0 ,document exceptions for interpreter in the base java api piperorigin revid change id , add a new method to the new delegate piperorigin revid
3107,static void const record enumdef raw ostream os enumdef enumname underlyingtype description os emit function declarations os formatv llvm optional 0 1 2 n enumname underlyingtype empty std string unsigned underlyingtype if llvm all of enumattrcase enumerant return enumerant getvalue 0 os formatv llvm optional 0 1 2 n enumname underlyingtype empty std string unsigned underlyingtype os formatv llvm stringref 1 0 n enumname os formatv llvm optional 0 1 llvm stringref n enumname ,also disable generating underlying value to symbol conversion declaration when there is an without explicit value piperorigin revid , xla python fix a bug in the hlo parser pass to the hlo parser this is a bit more efficient for the same type of the same value of the same value of the same value piperorigin revid
3108,token lexer lexcomment lex a bare identifier or keyword that starts with a letter bare id letter letter digit bare id letter letter digit integer type i 1 9 0 9 token lexer lexbareidentifierorkeyword const char tokstart match the rest of the identifier regex 0 9a za z match the rest of the identifier regex 0 9a za z while isalpha curptr isdigit curptr curptr ' ' curptr ' ' curptr ' ' curptr ' ' curptr check to see if this identifier is a keyword ,add to bare id to allow custom ops such as tf add piperorigin revid , fix a bug in the parser test piperorigin revid
3109,from future import print function import collections import functools import inspect import re import traceback from tensorflow python platform import tf logging as logging from tensorflow python util import decorator utils def validate deprecation args date instructions def call location outer false stack traceback extract stack limit 4 length len stack if length 0 should never happen as we're in a function return 'unknown' index length 4 if outer else length 3 if index 0 index 0 frame stack index return ' ' format frame filename frame lineno two up call location call caller f inspect currentframe f back f back parent f f back if outer and parent is not none f parent return ' ' format f f code co filename f f lineno def wrap decorator wrapped function ,simplify the stack walking in deprecation py remove dependency on tf stack piperorigin revid change id , fix a bug in the test case piperorigin revid
3110,struct false indexsequence i backport of std make index sequence it uses o ln n instantiation depth template size t n struct makeindexsequence n 2 1 typename makeindexsequence n 2 type struct n 2 1 typename n 2 type n 2 type template struct makeindexsequence 0 indexsequence struct 0 indexsequence template size t n using makeindexsequence typename n type template typename t using typename makeindexsequence sizeof t type template size t struct ignore ,googletest export add testing matcher for objects that support get and structured bindings piperorigin revid , fix a bug in the parser test piperorigin revid
3111,xla test f slicingtest a data get b data get x data get y data get xla test f slicingtest xla xlabuilder builder testname xla xlaop input index auto input data creater2parameter int 1 2 3 4 0 input builder input auto index data creater2parameter int 0 0 1 0 1 index builder index input index 1 computeandcomparer2 int builder 1 1 4 3 input data get index data get namespace namespace xla ,xla client implement a varient of gather equivalent to gather https org docs stable html gather piperorigin revid , xla gpu support for the xla client piperorigin revid
3112,dt kern path update dtrace hdl t dtp return error close return 0 ,close the kernel module locating handle on non error return we were carefully closing it on all error paths then leaking it on success , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
3113,limitations under the license include tensorflow core data service common pb h include tensorflow core data service data service h include tensorflow core data service dispatcher grpc pb h include tensorflow core data service task runner h include tensorflow core data service worker pb h include tensorflow core data standalone h include tensorflow core lib core status h class dataserviceworkerimpl taskdef task def mutex mu bool initialized tf guarded by mu false bool finished false todo have standalone iterator own a reference to standalone dataset so that we don't need to store the dataset here std unique ptr standalone dataset dataset std unique ptr standalone iterator iterator std unique ptr task runner sends task status to the dispatcher and checks for dispatcher commands ,tf data service server side implementation for round data consumption piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3114,static int get rand drm fd void return obj drmfd struct fd provider drm fd provider static struct fd provider drm fd provider name drm enabled true open open drm fds get get rand drm fd reg fd prov drm fd provider ,convert fd provider initialization to use constructors , make the watchdog process to the syscall process
3115,static status const graph graph datatypevector types if n type string kargop int index tf return if error getnodeattr n attrs index index const int types size types size if index 0 index types size const int num types types size if index 0 index num types return errors invalidargument invalid argument number types index n output type 0 ,update tensorflow compiler jit encapsulate subgraphs pass cc co authored by mihai maruseac mihai maruseac gmail com , add a test for the graph and the graph and the graph is not enabled piperorigin revid
3116,def write version info filename git version git version the result of a git describe generated by gen git source py include string const char tf git version return s ,update git version to be the same type of byte before final conversion git version is invalid should be b git version is invalid so that git version is always byte conversion will happen later signed off by yong tang yong tang github outlook com , update the version of the default to the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value piperorigin revid
3117,class learningrateschedule keras export keras experimental v1 keras export keras experimental class learningrateschedule class learningrateschedule keras export keras experimental v1 keras export keras experimental class learningrateschedule class learningrateschedule keras export keras experimental v1 keras export keras experimental class learningrateschedule ,exposes some experimental learning rate schedules added to tf in tf x piperorigin revid , fix a bug in the docstring of the docstring of the keras model piperorigin revid
3118,struct public attributestorage if 0 check that all bits are set in the last value char back if llvm char if llvm unsigned char return keyty ty data llvm hash value data if this is the only element the data is known to be a splat ,fix static assertion in attributedetail h llvm char runs into a static assertion on the type not being unsigned use unsigned char instead of char piperorigin revid , fix a bug in the parser test piperorigin revid
3119,static char features static int included patches add new patch number below this line 2284 ,patch problem comment in scope header file is outdated solution point to the help instead closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3120,class eagersavedmodelloader loader impl savedmodelloader with wrapped graph as default init op loader impl get init op meta graph def if init op is not none todo allenl deal with assets wrapped prune feeds fetches wrapped graph as graph element init op asset feed tensors asset paths for tensor name value in loader impl get asset tensors self export dir meta graph def items asset feed tensors append wrapped graph as graph element tensor name asset paths append tracking trackableasset value init fn wrapped prune feeds asset feed tensors fetches wrapped graph as graph element init op init fn path asset path for path in asset paths signature functions self extract signatures wrapped meta graph def root tracking autocheckpointable root signatures signature serialization create signature map ,feed asset paths in tf save model load when loading x savedmodels adds a simple table test piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
3121,class public testing test actual template flat t i mismatch at device di index i break case dt bool case dt int32 case dt int64 expect eq expected di tensor len i class public testing test b t w dev d sdiv s len l a datatype dtype dt b switch dtype case dt bool runtest bool dtype device t w d l a break case dt float runtest float dtype device t w d l a break def test float cpu 2 4 128 0 def test float cpu 2 8 4095 0 def test float cpu 4 4 0 def test bool cpu 1 4 1 0 def test bool cpu 2 4 1 0 def test bool cpu 2 4 1001 0 def test double cpu 2 4 128 0 def test int32 cpu 2 4 128 0 def test int64 cpu 2 4 128 0 ,refactor sending and receiving piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id ibcbbebdeffbacfec
3122,def gradient function op name attr tuple num inputs inputs outputs pywrap tensorflow tfe py registergradientfunction gradient function def must record gradient return not pywrap tensorflow tfe py def record gradient op name inputs attrs results name return pywrap tensorflow tfe py recordgradient op name inputs attrs results name execute must record gradient must record gradient execute record gradient record gradient ,automated rollback of commit piperorigin revid , tf data dataset to tf data dataset piperorigin revid
3123,void buffermap setfromtensorflow int tensor index tensorflow tensor tensor owned by tf insert tensor index void buffermap int tensor index id to tensor erase tensor index void buffermap const std set int keep for auto it id to tensor begin it id to tensor end if keep count it first 0 istensorflowtensor it first it id to tensor erase it else it namespace flex namespace tflite ,avoid keeping references to tf tensors in order to not prevent tensor forwarding optimizations done by the tf ops piperorigin revid , xla gpu support for the layout of the layout piperorigin revid
3124,def resource input index tensor name input names node defs functions output idx int output idx node def node defs op name if node def op in identity while if node def op while captured resources occur at the same index in the lists of inputs and outputs of a while or identity op so we lookup the input of tensor op at the same index as the index of tensor in the tensor op outputs outputs of a while op so we lookup the input of tensor op at the same index as the index of tensor in the tensor op outputs tensor name node def input output idx elif node def op in partitionedcall statefulpartitionedcall functions output any captured resource tensors used by their def run as function for tape gradients make op inputs return results else return make op inputs ,correctly tag forward and backward func graphs on while loops again piperorigin revid change id , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the input shape piperorigin revid
3125,class modelcheckpoint callback could reflect as little as 1 batch since the metrics get reset every epoch defaults to 'epoch' options optional tf train checkpointoptions object if save weights only is true or optional tf saved model save weights only is true or optional tf saved model object if save weights only is false kwargs additional arguments for backwards compatibility possible key is period ,fix a typo in documentation of modelcheckpoint tf saved model tf saved model saveoptions piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring of the tf nn rnn api piperorigin revid
3126,class sumtestcase tf test testcase frame a b frame a frame b expected sum pandas df a pandas df b actual sum frame run once a b actual sum frame run one batch a b np testing assert array equal expected sum actual sum class tf test testcase frame a b frame a frame b expected diff pandas df a pandas df b actual diff frame run once a b actual diff frame run one batch a b np testing assert array equal expected diff actual diff ,add materializing dataframe to memory refactor dataframe split rename run once to run one batch add run one epoch and materialize to memory refactor split and add split fast change , fix a bug in the test case piperorigin revid
3127,void builder builder operationstate result value lhs rhs gettype result addoperands lhs rhs comparison binary ops always return i1 tensor if auto shaped type result type dyn cast shapedtype auto resultshape shaped type getshape if auto shaped type result type dyn cast rankedtensortype auto result shape shaped type getshape result types push back builder gettensortype resultshape builder builder gettensortype result shape builder else result types push back builder gettensortype builder ,fix cast type to rankedtensortype before getting its shape otherwise shapedtype getshape could abort if it's unranked piperorigin revid , xla gpu support for the hlo hlo instruction piperorigin revid change id idadedfddaccd
3128,include vector include algorithm include iterator include boost config hpp namespace std workaround ,catmull rom hpp added missing include fix concept tests and add them to the jamfile v fixes https github com boostorg math issues , fix a bug in the new dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
3129,limitations under the license registers the xla cpu device which is an xladevice instantiation that runs operators using xla via the xla host cpu backend include tensorflow compiler jit kernels xla device launch op h include tensorflow compiler jit kernels xla local launch op h include tensorflow compiler jit xla device h include tensorflow compiler jit xla device ops h include tensorflow compiler tf2xla xla op registry h register local device factory device xla cpu xlacpudevicefactory constexpr std array datatype 5 kallxlacputypes dt int32 dt int64 dt float dt double dt bool register xla launch kernel device xla cpu xladevicelaunchop kallxlacputypes register xla launch kernel device xla cpu xlalocallaunchop kallxlacputypes register xla device kernels device xla cpu kallxlacputypes namespace tensorflow ,merge the implementations of and add support for resource variables to piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3130,def run training tf local variables initializer create a session for running operations in the graph with tf session as sess with tf compat v1 session as sess initialize the variables the trained variables and the epoch counter sess run init op ,deprecated tf session removed in fully connected reader py , fix a bug in the docstring of the docstring of the keras model piperorigin revid
3131,public return branchinst create dest condbranchinst cfgvalue condition basicblock basicblock return condbranchinst create condition private template typename t t t term ,mlir implement conditional branch this looks heavyweight but most of the code is in the massive number of operand accessors we need to be able to iterate over all operands to the all live outs but also just the true just the false operands too piperorigin revid , xla gpu support for the hlo parser piperorigin revid change id icabdabcccecababba
3132,status const string job spec const string job name namespace tensorflow int main int argc char argv tensorflow port initmain argv 0 argc argv tensorflow string job spec tensorflow string job name int num cpus 1 int main int argc char argv tensorflow string usage tensorflow flags usage argv 0 flag list const bool parse result tensorflow flags parse argc argv flag list tensorflow port initmain argv 0 argc argv if parse result argc 1 log error usage return 1 ,moving initmain to the beginning of main this seems to fix the currently timing out tests change , fix a bug in the graph piperorigin revid
3133,static logicalresult verify yieldop op static void opasmprinter p operation op assert op getabstractoperation unregistered operation p op getname getstringref interleave op getoperands begin op getoperands end value v p v p interleavecomma op getoperands p value v p v p p printoptionalattrdict op getattrs p interleave op getoperands begin op getoperands end value v p v gettype p interleavecomma op getoperands p value v p v gettype static parseresult opasmparser parser ,update upgrade some uses of mlir interleave api to take container argument directly piperorigin revid , xla gpu support for the hlo instruction piperorigin revid change id icabdabcccecababba
3134,status algebraicsimplifiervisitor handlebroadcast hloinstruction broadcast a broadcast that feeds a unary element wise operation can sink the broadcast after the unary element wise operation tf assign or return changed bool sink succeeded broadcast if changed changed sink succeeded if sink succeeded return status ok status algebraicsimplifiervisitor handlereshape hloinstruction reshape a reshape that feeds a unary element wise operation can sink the reshape after the unary element wise operation tf assign or return changed bool sink succeeded reshape if changed changed sink succeeded if sink succeeded return status ok ,xla fix setting of changed in algebraicsimplifier due to this bug sometimes algebraicsimplifier would make a change but say that it didn't this would cause us to run the hlo simplification pipeline fewer times than we should piperorigin revid , xla gpu support for xla hlo client piperorigin revid
3135,def reduce euclidean norm input tensor axis none keepdims false name none for example python x tf constant 1 2 3 1 1 1 tf reduce euclidean norm x sqrt 17 tf reduce euclidean norm x 0 sqrt 2 sqrt 5 sqrt 10 tf reduce euclidean norm x 1 sqrt 14 sqrt 3 tf reduce euclidean norm x 1 keepdims true sqrt 14 sqrt 3 tf reduce euclidean norm x 0 1 sqrt 17 x tf constant 1 2 3 1 1 1 x dtype is tf int32 tf math reduce euclidean norm x returns 4 as dtype is tf int32 y tf constant 1 2 3 1 1 1 dtype tf float32 tf math reduce euclidean norm y returns 4 which is sqrt 17 tf math reduce euclidean norm y 0 sqrt 2 sqrt 5 sqrt 10 tf math reduce euclidean norm y 1 sqrt 14 sqrt 3 tf math reduce euclidean norm y 1 keepdims true sqrt 14 sqrt 3 tf math reduce euclidean norm y 0 1 sqrt 17 args ,updated an example for reduce euclidean norm updated an incorrect example as reported in , fix a bug in the docstring of the test case piperorigin revid
3136,class static std vector depthwiseconvolution2dspec getconv2dtestcases std vector depthwiseconvolution2dspec config set std vector std vector int64 config options 128 6 3 64 256 5 3 256 256 5 2 144 144 5 3 64 144 5 2 256 8 48 17 8 128 20 6 64 128 1 2 144 256 1 2 64 64 14 12 172 16 9 4 16 128 6 3 64 256 5 3 256 256 5 2 144 144 5 3 64 144 5 2 256 8 48 17 8 128 20 6 64 64 14 12 172 16 9 4 16 ifndef xla test backend gpu todo b figure out why this fails on the gpu backend config options push back 128 1 2 144 config options push back 256 1 2 64 endif for auto option config options int64 feature option 0 ,enable test cases of conv depthwise test which work fine on the gpu backend piperorigin revid , fix a bug in the test case piperorigin revid
3137,class eagertest test testcase def testcond self with context eager mode pred math ops less 1 2 fn1 lambda constant op constant 10 fn2 lambda constant op constant 20 fn1 lambda constant op constant 10 fn2 lambda constant op constant 20 r control flow ops cond pred fn1 fn2 self assertallequal r numpy 10 self assertfalse isinstance r list def self with context eager mode ,fixes api difference between eager and graph cond piperorigin revid , fix a bug in the docstring of the docstring of the keras model piperorigin revid
3138,test quantizationutiltest quantizemultiplierarray namespace namespace tflite int main int argc char argv on linux add tflite logtostderr testing initgoogletest argc argv return run all tests ,make portable test suite in kernels internal package combined piperorigin revid , xla gpu support for the xla client client piperorigin revid
3139,class testsavemodel test testcase parameterized testcase save save model self model path self assert saved model path test util run v2 only def test save format defaults pathlib self path pathlib path self get temp dir 'model path' save save model self model path self assert saved model path test util run v2 only def test save hdf5 self path os path join self get temp dir 'model' class testsavemodel test testcase parameterized testcase 'requires the model to be a functional model or a sequential model ' save save model self subclassed model path save format 'h5' test util run v2 only def test save load hdf5 pathlib self if sys version info 3 6 path pathlib path self get temp dir 'model' save save model self model path save format 'h5' save load model path test util run v2 only def test save tf self path os path join self get temp dir 'model' ,add save load test for pathlib path , fix a bug in the docstring of the docstring of the docstring change
3140,status initializetpulibrary void library handle loaded we do not want to register a tpu platform in xla without the supporting library providing the necessary apis if s ok void initialize fn bool init library void initialize fn bool init library int argc char argv initialize fn reinterpret cast decltype initialize fn dlsym library handle tftpu initialize initialize fn init library true argc 0 argv nullptr initialize fn init library false argc 0 argv nullptr registertpuplatform registertpusystemdevice ,fix function signature bug accidentally introduced in libtpu initializer piperorigin revid change id , xla python python python python python piperorigin revid
3141,check termcode max offset buf bufsize buflen else key name 1 get pseudo mouse code current button is click is drag make sure the mouse position is valid some terminals may return weird values if mouse col columns mouse col columns 1 if mouse row rows mouse row rows 1 endif feat mouse ,patch problem crash when dragging with the mouse solution add safety check for null pointer check mouse position for valid value hirohito higashi , patch problem when using a popup window with a terminal window solution add the cursor to the current buffer when the cursor is set
3142,class controlflowtest tf test testcase grad theta tf gradients result theta with self assertraisesregexp typeerror second order gradient tf gradients grad theta theta grad theta stopped tf stop gradient grad theta tf gradients grad theta stopped theta def testonevaluecond self with self test session ,defer the check on second order gradient to the right place change , fix a bug in the test case piperorigin revid
3143,endif defined flatbuffers littleendian define flatbuffers version major 1 define flatbuffers version minor 0 define flatbuffers version minor 5 define flatbuffers version revision 0 define flatbuffers string expand x x define flatbuffers string x flatbuffers string expand x ,updated version to change id , patch problem when using a popup window with a popup window solution add the cursor to the current buffer when the cursor is set
3144,find help tags arg 0 ' ' arg 1 ' ' d ' ' if tag starts with ' skip the fixes ctrl on if arg ' ' arg 1 ' '' arg for s arg s s ,patch problem using ctrl in help on option in parentheses doesn't work solution skip the in ' hirohito higashi , patch problem when using a terminal window is a bit slow solution add a test for the gui
3145,static unsigned long get interesting value int i ifdef 64bit i rand 20 i rand 21 else i rand 6 i rand 7 endif switch i static unsigned long get address int i i rand 2 i rand 3 switch i case 0 return kernel addr case 1 return unsigned long useraddr ,dumb random picked up by and others on net , make the syscall page we can be a child process
3146,status const tf2xla config config return parseoutputarrayinfo array names specs outputs static void registerdialects static bool init once mlir registerdialect mlir tf executor tensorflowexecutordialect mlir registerdialect mlir tf tensorflowdialect mlir registerdialect mlir standardopsdialect mlir registerdialect mlir mhlo mhlodialect mlir registerdialect mlir shape shapedialect return true void init once namespace status status registerdialects mlir mlircontext context context loadallgloballyregistereddialects tf assign or return mlir owningmoduleref module convertgraphdeftomlir pruned graph def debug info specs context ,cleanup remove remaining uses of dialect registration from tensorflow nfc piperorigin revid change id , xla python add a test for the xla cpu backend piperorigin revid
3147,list join inner for item l lv first item null got int item item li next s echo string core item li tv tofree numbuf copyid echo style restore copyid false echo style restore copyid echo style if s null return fail ,patch job and channel in a dict value not quoted problem when using a job or channel value as a dict value when turning it into a string the quotes are missing solution add quotes to the job and channel values yasuhiro matsumoto closes , patch problem when using a terminal window is a bit solution add a test for the job
3148,do source allocate the local script variables to use for this script new script vars script items ga len ga init2 si sn var vals sizeof typval t 10 ga init2 si sn var vals sizeof svar t 10 ga init2 si sn imports sizeof imported t 10 ga init2 si sn type list sizeof type t 10 ifdef feat profile ,patch vim cannot declare single character script variables problem vim cannot declare single character script variables solution don't see b s etc as namespace fix item size of sn var vals , patch problem when using a terminal window is a bit solution add a test for the file
3149,def resize images images size a 1 d int32 tensor of 2 elements new height new width the new size for the images method resizemethod defaults to resizemethod bilinear align corners bool if true exactly align all 4 corners of the input and output defaults to false align corners bool if true the centers of the 4 corner pixels of the input and output tensors are aligned preserving the values at the corner pixels defaults to false raises valueerror if the shape of images is incompatible with the ,clarified documentation on resize images align corners parameter piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3150,status readbinaryproto env env const string fname status readtextproto env env const string fname tensorflow protobuf message proto if defined tensorflow lite protos std unique ptr randomaccessfile file tf return if error env newrandomaccessfile fname file std unique ptr filestream stream new filestream file get status readtextproto env env const string fname return errors dataloss can't parse fname as text proto return status ok else return errors unimplemented can't parse text protos with protolite endif namespace tensorflow ,internal only change change , fix a bug in the test case piperorigin revid
3151,class eagerfunctiontest xla test xlatestcase return x y compiled f def function function f op by op f function defun with attributes f attributes ' false op by op f def function function f experimental compile false x constant op constant 0 0 2 0 name 'data' ,add experimental compile to tf function api experimental compile false allows users running multi device functions on tpu piperorigin revid , fix a bug in the graph piperorigin revid
3152,static udt objecttype objecttype newbyname else status connection handle connection environment errorhandle dvoid buffer ptr buffer size oci otype name 0 oci ptype type ub4 buffer size oci otype name 0 oci ptype type cxbuffer clear buffer if environment checkforerror connection environment status objecttype newbyname describe type 0 ,eliminated final compiler warnings for microsoft compiler for oracle g , fix a bug in the client client client client
3153,def limit gpu memory if gpus tf config experimental set virtual device configuration gpus 0 tf config experimental virtualdeviceconfiguration memory limit 1152 tf config experimental virtualdeviceconfiguration memory limit 1024 return true return false ,revert rocm fix for rocm breakage this reverts commit , fix a bug in the docstring of the test case piperorigin revid
3154,class cudnnbatchnormallocatorinoutput public scratchallocator cudnnbatchnormallocatorinoutput override tensor dummy reserve space nullptr op requires ok context context allocate output 5 dummy reserve space context allocate output output index dummy reserve space cudnnbatchnormallocatorinoutput opkernelcontext context int output index cudnnbatchnormallocatorinoutput opkernelcontext context int output index context context output index output index private opkernelcontext context not owned int output index endif google cuda ,minor changes for cpu version , xla gpu support for the layout of the layout is a tuple of the same dimension piperorigin revid change id ifbabebdbaaaebba
3155,evaluationstagemetrics latestmetrics tflitestatus populategroundtruth const std string truth pbtxt file const std string truth proto file absl flat hash map std string objectdetectionresult ground truth mapping if ground truth mapping nullptr tflitestatus populategroundtruth ground truth mapping clear read the ground truth dump std ifstream t truth pbtxt file std ifstream t truth proto file std string proto str std istreambuf iterator char t std istreambuf iterator char objectdetectiongroundtruth ground truth proto ,use the same task main stub for the coco object detection eval task piperorigin revid change id , fix a bug in the graph piperorigin revid
3156,redraw after callback int call update screen flicker out flush cursor false false else else out flush endif out flush redrawing for callback fold line screenlinesuc off col fill fold screenlinesc 0 off col 0 screenlines off col 0x80 avoid storing zero screenlines off col 0x80 avoid storing zero else ,patch screen isn't always updated right away problem screen isn't always updated right away solution adjust ifdef call out flush when not running the gui , patch problem when using a terminal window is a bit slow solution add a test for the command line
3157,static char features static int included patches add new patch number below this line 514 513 ,updated for version problem no completion for history command solution add the completion and update the docs also fix behave completion dominique pelle , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3158,void sanitise socket int childno switch rand 2 case 0 protocol nfc sockproto llcp switch rand 2 type sock dgram case 0 type sock dgram break case 1 type sock stream break ,duh missing case statement , fix a bug in the syscall page
3159,limitations under the license include tensorflow core platform env h include tensorflow core platform mem h include tensorflow core platform mutex h include tensorflow core profiler rpc profiler service impl h include tensorflow core public session options h include tensorflow core util env var h status grpcserver init const grpcserveroptions opts release eager service new eager grpceagerserviceimpl worker env builder profiler service createprofilerservice builder registerservice profiler service get extra service if opts service func nullptr opts service func worker env builder ,add to tf workers to start by default piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3160,static char features static int included patches add new patch number below this line 2184 2183 ,patch problem tests that use runvim do not actually perform the test solution use return instead of call ken takata , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3161,std vector computetaskdescriptorptr add int id desc output buffer output id return desc add vector auto broadcast absl get if tensor linear datatype float32 attr param if broadcast desc is linkable true desc shader source r flt4 linkable 0 flt4 value int linear index uint3 gid device flt4 const broadcast return value broadcast gid z desc input buffers input ids 0 desc output buffer output id auto values options storage precision runtimeoptions precision fp32 vectortouint8vector broadcast data vectorfloattohalf broadcast data desc immutable buffers device flt4 const values return desc desc is linkable false desc shader source input ids size ,ios metal delegate add broadcast operation is supported now piperorigin revid , fix a bug in the new delegate piperorigin revid
3162,class unidirectionalsequencernntest test util tensorflowtestcase result self tfliteinvoke new sess test inputs x output class false self asserttrue np allclose expected output result rtol 1e 6 atol 1e 2 test mlir converted model result self tfliteinvoke new sess test inputs x output class true self asserttrue np allclose expected output result rtol 1e 6 atol 1e 2 test util enable control flow v2 def testdynamicrnnmultirnncell self sess tf compat v1 session config config class unidirectionalsequencernntest test util tensorflowtestcase result self tfliteinvoke new sess test inputs x output class false self asserttrue np allclose expected output result rtol 1e 6 atol 1e 2 test mlir converted model result self tfliteinvoke new sess test inputs x output class true self asserttrue np allclose expected output result rtol 1e 6 atol 1e 2 if name main test main ,add unidirectional sequence rnn op def to graphdef to flatbuffer and also add a ee test piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
3163,limitations under the license include atomic include cstddef include string include unordered map include vector include absl base optimization h include absl container flat hash map h include tensorflow core platform mutex h include tensorflow core platform types h class tracemerecorder mutex mutex map of the static container instances thread local storage for each thread while active a threadlocalrecorder stores trace events absl flat hash map int32 threadlocalrecorder threads guarded by mutex std unordered map int32 threadlocalrecorder threads guarded by mutex events from threads that died during recording tracemerecorder events orphaned events guarded by mutex ,add python wrapper for profiler traceme piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3164,def angle input name none for example input tf constant 2 25 4 75j 3 25 5 75j tf angle input array 2 0131705 1 056345 dtype float32 input tf constant 2 25 4 75j 3 25 5 75j dtype tf complex64 tf angle input numpy array 2 0131705 1 056345 dtype float32 args ,make example code runnable and show exact output from running that code , fix a bug in the docstring of the docstring of the documentation of the example change
3165,class kerassumtest test testcase parameterized testcase self assertequal self evaluate m total 100 check update state and result state accumulation tensor input update op m update state ops convert to tensor v2 1 5 update op m update state ops convert n to tensor 1 5 self evaluate update op self assertalmostequal self evaluate m result 106 self assertequal self evaluate m total 106 100 1 5 ,remove the usage of tf private api ops convert n to tensor from keras piperorigin revid change id , fix a bug in the docstring of the test piperorigin revid
3166,f get typval t argvars typval t rettv dictitem t di dict t d typval t tv null is dict false if argvars 0 v type var blob f get typval t argvars typval t rettv else if strcmp what dict 0 rettv dict set rettv pt pt dict what is dict true if pt pt dict null rettv dict set rettv pt pt dict else if strcmp what args 0 rettv v type var list f get typval t argvars typval t rettv else semsg e invarg2 what return when what dict and pt pt dict null evaluate the third argument if what is dict return else ,patch get func dict def does not work properly problem get func dict def does not work properly solution handle null dict better takuya fujiwara closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
3167,fold line screenlines off col 0x80 avoid storing zero else screenlinesuc off col 0 screenlines off col fill fold col else ,patch folds messed up problem folds are messed up when is utf solution also set the fold character when it's not multi byte , patch problem when using a terminal window is a bit solution add a few more tests to the new code
3168,status writedatatofile const string filename const char data status writedatatofile const string filename const char data const compressionparams params writes the input data into the tfrecord file with the specified compression status const string filename const std vector absl string view records const compressionparams params helpful functions to test dataset op kernels class datasetopstestbase public testing test public ,add tests for tfrecorddatasetop , xla python fix a bug in the test piperorigin revid
3169,check abbr c ptr col mincol if q null vim unescape csi q qlen strlen q qlen int strlen q vim free q ,updated for version problem compiler warning on ms windows ken takata solution add type cast , fix a bug in the new parser test piperorigin revid
3170,string getcurrentosstacktraceexcepttop unittest unit test int skip count returns the number of failed test parts in the given test result object int const testresult result a helper for warnings on unreachable code in some macros inline bool true return true namespace internal namespace testing int const testresult result gtest ambiguous else blocker if const char gtest msg testing internal hasnewfatalfailurehelper gtest fatal failure checker statement if testing internal true statement if gtest fatal failure checker has new fatal failure gtest msg expected statement doesn't generate new fatal failures in the current thread n ,fixes some warnings when compiled with msvc at warning level , fix a bug in the new delegate test piperorigin revid
3171,limitations under the license include llvm ir instructions h include llvm ir module h include llvm ir value h include llvm support alignment h include tensorflow compiler xla service cpu cpu runtime h include tensorflow compiler xla service cpu ir emission utils h include tensorflow compiler xla service cpu target machine features h void dotopemitter emittiledllvmirgemm int64 size bytes m n shapeutil bytesizeofprimitivetype primitive type b creatememset target b getint8 0 size size bytes align 1 llvm align none int64 max target vector width target machine features vector register num elements ,updated tensorflow use of creatememset api piperorigin revid change id , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
3172,status colocationgraph to run a tf function with resource inputs residing on remote devices this use case is currently not supported here are the devices available on this machine absl strjoin devicestostring device set devices absl strjoin devicestostring device set devices if you are seeing this error when running using a tf session set experimental share cluster devices in session to true in the tf configproto for const auto d member supported device types ,add some documentation to error about being unable to place graph in the tf function case piperorigin revid , xla python fix a bug in the graph piperorigin revid
3173,static char features static int included patches add new patch number below this line 388 387 ,patch option not tested problem option not tested solution add a test enable postscript for appveyor build dominique pelle closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3174,struct launchdepthwiseconvbackpropfilterop if google cuda template typename t struct launchdepthwiseconvop eigen gpudevice t void operator opkernelcontext ctx const depthwiseargs args void operator opkernelcontext ctx const depthwiseargs args const t input const t filter t output tensorformat data format ,getting rid of unnecessary gpudevice typedef passing by reference in host code piperorigin revid , xla gpu support for the hlo client piperorigin revid change id iaaffafbceeeafc
3175,def make int64 tensor value name tf export sparse from dense def from dense tensor name none with ops name scope name dense to sparse tensor ops convert to tensor tensor indices array ops where v2 ,add docstring to tf sparse from dense piperorigin revid , tf data saveable shape inference for tf data dataset piperorigin revid
3176,namespace llvm specialize graphtraits to treat block as a graph of operations as nodes and uses as edges template struct llvm graphtraits mlir block template struct graphtraits mlir block using mlir block using noderef mlir operation ,remove redundant qualification address gcc error extra qualification not allowed piperorigin revid , xla gpu support for the hlo hlo instruction piperorigin revid change id idadedfddaccd
3177,mutex mutex to clean them up todo switch to slim reader writer locks which requires nothing to clean it up but is available only on and later http microsoft com en us library windows desktop https docs microsoft com en us windows desktop sync slim reader writer locks if type kdynamic critical section delete critical section ,updated broken and outdated urls , fix a bug in the new version of the new client client piperorigin revid
3178,class fullyconnectedoperationparser public tfliteoperationparser fullyconnected doesn't support more than 2 runtime inputs if tf options keep num dims true return absl unimplementederror fullyconnected doesn't support keep num dims const auto input context tensors tflite node inputs data 0 const auto output context tensors tflite node outputs data 0 if input dims size output dims size return absl unimplementederror input and output dimensions different and fullyconnected doesn't support keep num dims todo eignasheva check input shape return absl okstatus ,relaxed keep num dims requirement piperorigin revid change id , fix a bug in the delegate piperorigin revid
3179,class modulemetaclass type value if not value else with name scope value doc value doc return type new mcs name bases clsdict return super modulemetaclass mcs new mcs name bases clsdict def call cls args kwargs call new such that we have an un initialized module instance that we can ,ensure custom metaclasses are supported with tf module piperorigin revid , tf data service support for tf data dataset piperorigin revid change id icccbcbdbcfaadbee
3180,class tridiagonalsolveop public linearalgebraop scalar static cast int64 cost bool const final return false void computematrix opkernelcontext context const constmatrixmaps inputs matrixmaps outputs final const auto diagonals inputs 0 ,disable input forwarding in tridiagonal op and fix a flaky test piperorigin revid , xla gpu support for the layout inference piperorigin revid change id icccbcbdbcfaadbee
3181,t ellint f imp t phi t k const policy pol boost math instrument variable k boost math instrument variable function if abs k 1 return policies raise domain error t function got k 1 function requires k 1 k pol bool invert false if phi 0 t ellint f imp t phi t k const policy pol t sinp sin rphi sinp sinp if sinp k k 1 return policies raise domain error t function got k 2 sin 2 phi 1 but the function requires this 1 sinp k k pol t cosp cos rphi cosp cosp boost math instrument variable sinp ,elliptic integrals extend range of ellint see https github com boostorg math issues , fix a bug in the previous commit case the previous commit is not used by the current code
3182,static status inferencecontext c c set output 0 c matrix inferencecontext kunknowndim reduce dim learner config num classes 1 learner config num classes c set output 1 c vector inferencecontext kunknowndim c set output 1 c unknownshape return status ok ,remove the backward incompatible shape checks piperorigin revid , fix a bug in the new delegate piperorigin revid
3183,static const char devname dev dtrace helper static const char devices pseudo dtrace 0 helper static const char modname name of this load object static int gen dof helper generation dtrace dof init void if fd devname o rdwr 0 dprintf 1 failed to open helper device s devname if the device path wasn't explicitly set try again with the old device path if p null return devname if fd devname o rdwr 0 dprintf 1 failed to open helper device s devname return return if gen ioctl fd dh 1 ,remove needless support for the back compatibility device , fix a bug in the new parser test for the new code
3184,status run const graphoptimizationpassoptions options graphdebuginfo debug info mlir mlircontext context graphimportconfig specs specs graph as function true tf assign or return auto module options graph debug info ,use graph as function in mlir bridge which eliminates arg and retval nodes piperorigin revid change id , tf data service support for tf data service piperorigin revid
3185,def sparseaddgrad op grads return none a val grad none none b val grad none none ops registergradient sparsetensordenseadd def sparsetensordenseadd op out grad sp indices op inputs 0 sparse indices sparse values sparse shape dense return none array ops gather nd out grad sp indices none out grad ops registergradient sparsetensordensematmul def op grad gradients for the dense tensor in the sparsetensordensematmul op ,implement sparsetensor dense tensor usage tf sparse add sp tensor tensor cpu only for now the newly introduced can later be extended to handle scatternd update add sub ops similar to the existing gathernd op change , tf data saveable shape inference for tf data dataset piperorigin revid
3186,class public clientlibrarytestbase public testing withparaminterface std tuple primitivetype int test p doit xla test p doit const auto spec getparam const auto element type std get 0 spec const int64 num elements std get 1 spec class iotar2test public clientlibrarytestbase public testing withparaminterface std tuple primitivetype int int test p iotar2test doit xla test p iotar2test doit const auto spec getparam const auto element type std get 0 spec const int64 num elements std get 1 spec class public clientlibrarytestbase public testing withparaminterface std tuple primitivetype int int test p doit xla test p doit const auto spec getparam const auto element type std get 0 spec const int64 num elements std get 1 spec ,use xla test p instead of test p in iota test this address github pr piperorigin revid , xla gpu support for the xla client piperorigin revid change id icedffaceeaeacfbd
3187,ins complete c 0 column where searched text starts colnr col cursor column intn intsave w wrow compl direction ins compl c if compl started ins complete c find next match and following matches save w wrow curwin w wrow n ins compl next true ins compl c ins compl use match c may undisplay the popup menu ins complete c redrawingdisabled may be set when invoked through complete n redrawingdisabled redrawingdisabled 0 if the cursor moved we need to remove the pum first setcursor if save w wrow curwin w wrow ins compl del pum ins compl show pum setcursor redrawingdisabled n ,updated for version problem in some situations the popup menu can be displayed wrong solution remove the popup menu if the cursor moved lech lorens , patch problem when using a terminal window is a bit solution add a test for the mouse engine
3188,without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license from future import division print function absolute import from future import absolute import from future import division from future import print function import tensorflow as tf ,reformat future imports change , add a test for the new op op piperorigin revid
3189,import os import shutil import tempfile from tensorflow contrib data python kernel tests serialization import dataset serialization test base from tensorflow python data experimental kernel tests serialization import dataset serialization test base from tensorflow python data ops dataset ops import matchingfilesdataset from tensorflow python platform import test ,move matching files dataset serialization test py to tf data experimental , fix a bug in the docstring of the test case piperorigin revid
3190,class structuredfunctionwrapper object resource tracker tracking resourcetracker with tracking resource tracker scope resource tracker self function wrapper fn get concrete function internal garbage collected todo jsimsa garbage collecting functions containing pyfunc nodes triggers use after free figure out why and stop excluding functions with pyfunc nodes from garbage collection for node in self function function def node def if node op in pyfunc pyfuncstateless eagerpyfunc self function garbage collector release todo b switch to using garbage collection self function wrapper fn get concrete function internal if add to graph self function add to graph ops get default graph ,tf data disabling garbage collection of function graphs and in some cases the function graph is collected prematurely piperorigin revid , fix a bug in the test case piperorigin revid
3191,void const model model strides mutable list add i src op stride height strides mutable list add i src op stride width strides mutable list add i 1 todo b to return a working tf graphdef we should be returning the correct spacetobatchnd and batchtospacend operation before and after the conv since tf doesn't support dilations todo b to return a working tf graphdef we should be returning the correct spacetobatchnd and batchtospacend operation before and after the conv since tf doesn't support dilations if src op dilation width factor 1 src op dilation height factor 1 auto dilations op mutable attr dilations ,fix missing todo piperorigin revid , add a test for the graph and the graph and the graph is not enabled piperorigin revid
3192,static char features static int included patches add new patch number below this line 93 92 ,patch non ms windows cannot interrupt gdb when program is running problem non ms windows cannot interrupt gdb when program is running solution only use debugbreak on ms windows , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3193,class timedistributed wrapper inner input shape nest map structure lambda tensor self get shape tuple 1 tensor 2 inputs inner inputs nest map structure up to inputs array ops reshape inputs inner input shape inputs inner input shape output mask self layer compute mask inner inputs inner mask if output mask is none if mask is none ,fix wrong continued indentation , fix a bug in the docstring of the docstring of the new api change
3194,status settensorvalue datatype dtype int value tensor tensor undef handle case status const nodedef node const string key if node attr count key 0 return errors invalidargument node ' node name ' lacks ' key ' attr node shortdebugstring return status ok status const nodedef node absl span const string keys for const string key keys tf return if error node key return status ok end namespace grappler end namespace tensorflow ,cleanup don't crash when querying node for non existing attributes piperorigin revid , fix a bug in the graph piperorigin revid
3195,test tensormaptest tm insert k2 v2 std vector tensor keys tm keys expect eq keys size 2 test expecttensorequal int32 keys 0 k expect eq keys 0 shape k shape expect eq keys 1 shape k shape test tensormaptest copy ,working list keys test , fix a bug in the test case piperorigin revid
3196,void gpuexecutable computethunkannotations for thunk thunk thunk schedule totalorder const hloinstruction hlo thunk hlo instruction check hlo thunk annotations thunk absl strformat s tf op s hlo op s hlo module s hlo tostringwithcanonicalnamemap hloprintoptions canonical canonical name map hlo metadata op name hlo name hlo getmodule name thunk annotations thunk absl strformat s tf op s s hlo op s hlo module s hlo tostringwithcanonicalnamemap hloprintoptions canonical canonical name map hlo metadata op name hlo metadata op type hlo name hlo getmodule name ,xla gpu encode tf op type as part of thunk annotation piperorigin revid , xla python fix a bug in the hlo module piperorigin revid change id iaedafbbcdebd
3197,namespace tensorflow tensor int64 v if v std numeric limits int32 max tensor shape dt int32 tensorshape 1 tensor shape dt int64 tensorshape 1 shape vec int64 0 v return shape else tensor shape dt int64 tensorshape 1 shape vec int64 0 v tensor shape dt int32 tensorshape 1 shape vec int32 0 v return shape ,fix typo in random op test benchmark so it prefers ints this fixes the benchmark so it works on gpus without this change we try to instantiate a randomuniform over ints on gpus and that doesn't exist change , xla gpu support for the cpu backend piperorigin revid change id id icfecdffaddccbded
3198,class inferenceenvironment std vector int64 t in refs optional can be nullptr std vector int64 t out refs optional can be nullptr virtual absl status newinferencebuilder const std vector uint8 t serialized model const absl span const uint8 t serialized model std unique ptr inferencebuilder builder std vector int64 t in refs std vector int64 t out refs 0 ,change the type of serialized model in to absl span so the data does not necessarily need to be stored in a vector piperorigin revid change id , xla python fix a bug in the client backend piperorigin revid change id iefecfafdafabefecbd
3199,class test testcase if name ' main ' bazel sets these environment variables to very long paths tempfile uses them to create long paths and in turn multiprocessing library tries to create sockets named after paths delete whatever bazel writes to these to avoid tests failing due to socket addresses being too long for var in 'temp' if var in os environ del os environ var test main ,hack around a bug caused by bazel tempfile multiprocessing piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3200,static int screen resize int new rows int new cols void user static cb screen null damage null moverect null null settermprop null bell screen resize resize screen sb pushline sb pushline null null damage null moverect null null settermprop null bell screen resize resize screen sb pushline sb pushline null int main int argc char argv ,patch comments in libvterm are inconsistent problem comments in libvterm are inconsistent solution use comments update the table of combining characters , patch problem when using a popup window with a terminal window solution add a test for the cursor
3201,class lookuptableop public opkernel return ctx status if ctx track allocations ctx record device persistent memory allocation container memoryused ctx record host persistent memory allocation container memoryused table handle allocatedbytes ret container return status ok class hashtable public initializablelookuptable return status ok int64 memoryused const override if table const int64 num elements table size return num elements sizeof k sizeof v else return 0 private std unique ptr std unordered map k v table ,properly track the persistent memory usage of lookup tables change , fix a bug in the test case piperorigin revid
3202,class scopedstepcontainer step id the unique id of this step doesn't have to be sequential just has to be unique cleanup callback to delete a container of this name prefix optional string prefix to disambiguate step containers scopedstepcontainer const int64 step id std function void const string cleanup name strings strcat per step step id cleanup cleanup scopedstepcontainer const int64 step id std function void const string cleanup const string prefix name strings strcat prefix per step step id cleanup cleanup scopedstepcontainer cleanup name const string name const return name ,add an optional prefix param to scopedstepcontainer to avoid possible name clashes piperorigin revid , xla python python python python python piperorigin revid change id ifdfebeffeebfcdeae
3203,limitations under the license include tensorflow compiler tf2xla xla op registry h include tensorflow compiler xla util h include tensorflow core common runtime function h include tensorflow core framework bounds check h include tensorflow core framework graph def util h include tensorflow core framework memory types h include tensorflow core framework node def pb h limitations under the license include tensorflow core graph algorithm h include tensorflow core graph control flow h include tensorflow core graph graph constructor h include tensorflow core kernels bounds check h include tensorflow core lib gtl cleanup h include tensorflow core lib strings stringprintf h include tensorflow core public version h ,update references to bounds checks h piperorigin revid , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
3204,class binaryopshared public opkernel coefficient wise binary operations device e g cpudevice gpudevice functor defined in cwise functors h e g functor add2 functor defined in cwise ops h e g functor add template typename device typename functor class binaryop public binaryopshared public class public opkernel coefficient wise unary operations device e g cpudevice gpudevice functor defined in cwise functors h e g functor sqrt functor defined in cwise ops h e g functor sqrt template typename device typename functor class unaryop public opkernel public ,minor code doc fix cwise ops common h , fix a bug in the test piperorigin revid
3205,class tfetest test util tensorflowtestcase def setup self super tfetest self setup ops device none enter context reset context configure virtual cpus class test util tensorflowtestcase def setup self super self setup ops device none enter context reset context configure virtual cpus class eagertensorcachetest test util tensorflowtestcase def setup self super eagertensorcachetest self setup ops device none enter context reset context configure virtual cpus ,remove ops device none enter from eager core test those statements are not necessary for the test to consistently pass piperorigin revid change id , tf data fix a bug in the graph piperorigin revid
3206,class pendingcounts void operator const pendingcounts delete pendingcounts handle pendingcounts layout int max pending count int max dead count inline pendingcounts handle pendingcounts layout int max pending count int max dead count handle result if max pending count max dead count ,add missing inline to pendingcounts layout change , fix a bug in the new delegate test piperorigin revid
3207,xlajit make unary rsqrt xla rsqrt x xlajit make unary sigmoid xla logistic x returns 0 if x is nan 0 if x is 0 1 if x 0 and 1 if x 0 static xla xlaop sign xla xlabuilder b xla xlaop x return b reporterrororreturn xla statusor xla xlaop tf assign or return auto shape b getshape x if xla primitive util iscomplextype shape element type return xla sign x auto gt xla gt x xla zeroslike x auto lt xla lt x xla zeroslike x return xla convertelementtype gt shape element type xla convertelementtype lt shape element type xlajit make unary sign sign b x returns nan if x is nan 0 if x is 0 1 if x 0 and 1 if x 0 xlajit make unary sign xla sign x xlajit make unary sinh xla sinh x static xla xlaop softplus xla xlabuilder b xla xlaop features ,tfxla align sign with tensorflow tf sign nan should be nan via xla to match tensorflow's normal behavior piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id iaaffafbceeeafc
3208,static void parse proc devices void else if strcmp character devices n line 0 block 0 else if sscanf line d s major 1 if p strchr line ' n' null p 0 if p strrchr line ' ' null continue p ,parse proc devices cut off device string on newline i didn't see that the device name includes the newline so that map dev will fail this was kind of hard to see unless you have a driver and you know how the command ids should look like , fix a bug in the watchdog page
3209,op delete oparg t oap oap end curwin w cursor curwin w cursor oap start if has mbyte mb adjust opend oap if oap line count 1 delete characters within one line ,patch c with 'virtualedit' set does not include multi byte char problem c with 'virtualedit' set does not include multi byte char solution include the whole multi byte char nobuhiro takasaki closes , patch problem when using a terminal window is a bit solution add a few more tests to the new code
3210,from tensorflow python framework import ops from tensorflow python ops import array ops from tensorflow python ops import gen linalg ops from tensorflow python ops import linalg ops from tensorflow python ops import linalg ops impl from tensorflow python ops import math ops from tensorflow python ops import special math ops from tensorflow python util tf export import tf export eigvalsh linalg ops self adjoint eigvals einsum special math ops einsum expm gen linalg ops matrix exponential tf export 'linalg expm eye linalg ops eye eye linalg ops impl eye inv linalg ops matrix inverse gen linalg ops matrix logarithm tf export 'linalg ,move eye to linalg ops impl , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3211,limitations under the license include tensorflow core framework op h include tensorflow core framework types h include tensorflow core kernels ops testutil h include tensorflow core lib core status test util h include tensorflow core lib strings str util h include tensorflow core platform test h ,add a number of missing headers being transitively pulled in this enables a few headers to be removed from implementations and in turn simplify the build graph some piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3212,def main argv get the data data sets mnist read data sets flags directory dtype tf uint8 reshape false reshape false validation size flags validation size convert to examples and write the result to tfrecords convert to data sets train 'train' ,parameterize validation size change , fix a bug in the docstring of the new module piperorigin revid
3213,def init run config config tf config don't use distribute coordinator if it is local training or cluster has a master job or train distribute is not specifed if not tf config or 'master' in cluster spec jobs or if not cluster spec or 'master' in cluster spec jobs or not config train distribute config distribute coordinator mode none config init distributed setting from environment var tf config ,allow setting model dir using tf config in local training piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the example change
3214,static char features static int included patches add new patch number below this line 1834 1833 ,patch pyeval is deprecated in python problem pyeval is deprecated in python solution do not call pyeval in python and later ken takata closes avoid warnings for functions , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3215,string allocatorstats debugstring const this num allocs this max alloc size constexpr size t allocator kallocatoralignment allocator allocator if true cpu allocator collects more stats ,added a format for saving an inference graph that can be memmapped and an utility to convert a graph into this format change , fix a bug in the test case piperorigin revid
3216,def map defun fn elems output dtypes output shapes elems ops convert to tensor e for e in elems output shapes tensor shape tensorshape s for s in output shapes if not all s is fully defined for s in output shapes raise valueerror all fn output shapes must be fully defined return gen dataset ops map defun elems output dtypes output shapes fn ,accept unknown output shapes for mapdefun op piperorigin revid , fix a bug in the docstring of the docstring of the keras model piperorigin revid
3217,instantiate tests sub instantiate tests split instantiate tests div instantiate tests transpose instantiate tests lstm instantiate tests mean instantiate tests squeeze instantiate tests strided slice ,generate example for basic lstm cell in tflite piperorigin revid , xla gpu support for the layout of the hlo evaluator piperorigin revid
3218,class testissymbolictensor test testcase self input input self value ops convert to tensor 42 property def dtype self return self value dtype ops register tensor conversion function foo lambda x args kwargs x value tf utils register symbolic tensor type foo class testissymbolictensor test testcase tensor y model ops convert to tensor 7 self assertisinstance y foo confirm that custom loss sees foo instance not tensor obtained prediction box none def custom loss y obs y pred del y obs obtained prediction box 0 y pred return y pred apparently compile calls the loss function enough to trigger the side effect model compile 'sgd' loss custom loss self assertisinstance obtained prediction box 0 foo class test testcase ,add a unit test that custom loss functions can accept non tensor objects emitted from models piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3219,inline int clamp const int v const int lo const int hi inline void stridedslicepadindices tflite stridedsliceparams p int dim count add indices and mask bits to fully include extra dimensions tflite check le dim count 5 tflite check le dim count 4 tflite check ge dim count p start indices count tflite check eq p start indices count p stop indices count tflite check eq p stop indices count p strides count ,add d support to tflite strided slice piperorigin revid change id , fix a bug in the parser test piperorigin revid
3220,namespace tflite output types push back output type return tflite opsignature op op input types input types output types output types return tflite opsignature op input types output types class averagepool ,do not use designated initializer for windows build piperorigin revid , fix a bug in the new delegate piperorigin revid
3221,class flatbufferbuilder cond flatbuffers internal template typename t struct tablekeycomparator tablekeycomparator vector downward buf buf buf tablekeycomparator const tablekeycomparator other buf other buf bool operator const offset t a const offset t b const auto table a reinterpret cast t buf data at a o auto table b reinterpret cast t buf data at b o class flatbufferbuilder vector downward buf private tablekeycomparator operator const tablekeycomparator tablekeycomparator operator const tablekeycomparator other buf other buf return this endcond ,clang definition of implicit copy constructor for deprecated , fix a bug in the parser delegate to the new delegate piperorigin revid change id idbeeaeaafcaeeaafafffe
3222,limitations under the license include vector include tensorflow contrib tensorrt convert utils h include tensorflow contrib tensorrt log trt logger h include tensorflow contrib tensorrt resources trt allocator h include tensorflow contrib tensorrt resources trt int8 calibrator h include tensorflow core framework graph pb h ,implement something similar to std align since it's not supported piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3223,from tensorflow python ops import check ops from tensorflow python ops import control flow ops from tensorflow python ops import math ops from tensorflow python ops import sparse ops from tensorflow python util tf export import tf export def remove squeezable dimensions def remove squeezable dimensions return labels predictions tf export 'confusion matrix' def confusion matrix labels predictions num classes none dtype dtypes int32 name none weights none computes the confusion matrix from predictions and labels ,adding tf export decorators calls to tensorflow functions and constants piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3224,std string genlookupkeygetter flatbuffers fielddef key field if key field value type base type base type string key getter comp functionstart 'c' key getter genoffsetgetter key field key getter key bb n key getter bb n else auto get val gengetter key field value type void genstruct structdef struct def std string code ptr code code vectoroffset gentypeget key field value type code key bytebuffer bb n code byte if lang language idloptions kjava code key getbytes standardcharsets utf 8 n else code system text encoding utf8 getbytes key n code int vectorlocation genbytebufferlength bb code vectoroffset value n int span code bb functionstart 'g' etint vectorlocation ,fix lookupbykey improve , fix a bug in the parser test piperorigin revid
3225,def custom gradient f none return upstream dz dx upstream dz dy z x y return z grad x tf constant 2 0 dtype tf float32 y tf constant 3 0 dtype tf float32 with tf gradienttape persistent true as tape x tf constant 2 0 dtype tf float32 y tf constant 3 0 dtype tf float32 with tf gradienttape persistent true as tape tape watch x tape watch y z bar x y z 6 tf tensor shape dtype float32 numpy 6 0 tape gradient z x 3 tf tensor shape dtype float32 numpy 3 0 tape gradient z y 2 tape gradient x y none tf tensor shape dtype float32 numpy 2 0 nesting custom gradients can lead to unintuitive results the default behavior does not correspond to n th order derivatives for example ,fixed indentation errors , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
3226,def one hot input text filters ' t n' lower true split ' ' one hot encodes a text into a list of word indexes of size n this function receives as input a string of text and returns a list of encoded integers each corresponding to a word or token def one hot input text input text input text string n int size of vocabulary filters list or concatenation of characters to filter out such as punctuation default t n includes basic punctuation tabs and newlines punctuation default ' t n includes basic punctuation tabs and newlines lower boolean whether to set the text to lowercase split str separator for word splitting ,fix the code block escaping see https www tensorflow org api docs python tf keras preprocessing text text to word sequence hl en piperorigin revid change id , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary solution add a test for the line
3227,from tensorflow python platform import tf logging as logging todo b temporary shim to optionally initialize the tpu this increases the odds our session is initialized but shouldn't be needed test rewrite op none def maybe initialize tpu session global test rewrite op try try to use cached version to avoid another ground of graph optimization test rewrite op test rewrite op if test rewrite op is none or test rewrite op 0 graph ops get default graph def test op return constant op constant 1 constant op constant 1 def test op return constant op constant 1 constant op constant 1 test rewrite op tpu rewrite test op test rewrite op test rewrite op session run tpu rewrite test op session run test rewrite op except errors failedpreconditionerror as session run tpu initialize system ,fixed the issue that each invocation of model fit evaluate predict modifies the graph piperorigin revid , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3228,def max pool value ksize strides padding data format nhwc name none with ops name scope name maxpool value as name value ops convert to tensor value name input return gen nn ops max pool v2 value return gen nn ops max pool value ksize ksize strides strides padding padding ,reverting the switch to max pool v in python , fix a bug in the documentation of the documentation of the test piperorigin revid
3229,def dynamic rnn loop cell final outputs nest pack sequence as structure cell output size flat sequence final outputs if not in graph mode final outputs array ops stack final outputs axis 0 final outputs nest map structure up to cell output size lambda x array ops stack x axis 0 final outputs return final outputs final state ,fixes eager mode of dynamic rnn for rnncells with unbalanced output piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3230,tflitestatus flatbufferintvectortoarray op name return ktfliteerror else int num dimensions flat vector size size t num dimensions flat vector size if num dimensions max size of buffer sizeof int error reporter report found too many dimensions in the input array of operation ' s' n op name return ktfliteerror else for int i 0 i num dimensions i for size t i 0 i num dimensions i buffer i flat vector get i ,internal change piperorigin revid change id , add support for int int piperorigin revid
3231,def absolute difference predictions targets weight 1 0 scope none if the shape of weight is invalid with ops op scope predictions targets scope sum of squares loss as scope scope absolute difference as scope predictions get shape assert is compatible with targets get shape if weight is none raise valueerror weight cannot be none ,fixing absolute difference default scope name change , fix a bug in the docstring of the docstring of the docstring of the tf nn rnn api piperorigin revid
3232,eval7 if arg ' ' recursive ret eval func arg s len rettv flags null else if flags eval constant ret fail else if evaluate ret get var tv s len rettv null true false else ,patch vim no error when variable initializer is not a constant problem vim no error when variable initializer is not a constant solution return fail when trying to get a variable value do not execute a script when an error is in the first or second phase , patch vim cannot use a function to be used problem vim cannot use a terminal window with a terminal window solution add a test for the terminal window
3233,class featurecolumntest test testcase expected shape id tensor shape output rank 1 vocab size self assertequals expected shape list one hot value shape def self ids fc sparse column with keys ids marlo omar stringer one hot fc one hot column ids features 'ids' constant op constant shape 1 3 one hot tensor feature column ops input from feature columns features one hot with self test session as sess sess run variables global variables initializer sess run lookup ops tables initializer self assertallequal 1 1 0 one hot tensor eval def self ids fc sparse column with keys ids marlo omar stringer weighted ids fc weighted sparse column ids weights ,tst add unit test for , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
3234,class workerheartbeatmanager object default timeout is set to allow other shutdown triggered operations log flushing etc to finish before terminating the worker def shutdown self wait time in ms 60000 def shutdown self wait time in ms 60000 exit code none logging info 'shutting down s ' self req event pb2 workerheartbeatrequest watchdog config event pb2 watchdogconfig timeout ms wait time in ms shutdown mode event pb2 shutdown after timeout shutdown mode event pb2 shutdown after timeout exit code event pb2 requestedexitcode exit code exit code if exit code is not none else none self configure req wait for workers to shutdown ,add support for specifying a custom exit code in piperorigin revid , fix a bug in the new delegate test piperorigin revid
3235,bool range values region limit void value orig value replacement region region calls callback for each use of a value within region or its descendants that was defined at the ancestors of the limit void region region region limit function ref void opoperand callback calls callback for each use of a value within any of the regions provided that was defined in one of the ancestors void llvm mutablearrayref region regions function ref void opoperand callback fill values with a list of values defined at the ancestors of the limit region and used within region or its descendants void getusedvaluesdefinedabove region region region limit ,refactor getusedvaluesdefinedabove to expose a variant taking a callback nfc this will allow clients to implement a different collection strategy on these values including collecting each uses within the region for example piperorigin revid , add support for int int piperorigin revid
3236,limitations under the license define eigen use threads include limits include numeric include vector include third party eigen3 unsupported eigen cxx11 tensor ,include what you use numeric for std iota change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3237,class momentumoptimizer optimizer optimizer name optional name prefix for the operations created when applying gradients defaults to momentum use nesterov if true use nesterov momentum see sutskever et al 2013 see sutskever et al 2013 http jmlr org proceedings papers v28 sutskever13 pdf ,update momentum py fixed a typo in the documentation , update docstring for tf nn rnn py
3238,class object return value hasfield tensor spec value def do decode self value decode fn name value tensor spec value name return tensor spec tensorspec shape decode fn struct pb2 class object dtype decode fn struct pb2 tensor dtype value value tensor spec value dtype name value tensor spec value name name name if name else none structurecoder register codec ,in fixed bug where a tensorspec with name none would get deserialized with name '' piperorigin revid , fix a bug in the docstring of the test piperorigin revid
3239,class layer module module version utils layerversionselector keep track of metric instance created in subclassed layer from tensorflow python keras import metrics as metrics module pylint disable g import not at top for val in nest flatten value if isinstance val metrics module metric if isinstance val metrics module metric and hasattr self ' metrics' self metrics append val todo scottzhu need to track module object as well for weight tracking ,check for metrics in case is resetting metrics property piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
3240,status lhlodialectemitter handlefusion hloinstruction fusion arg values push back body builder create mlir tensorloadop getlocation fusion function getargument i hlodialectemitter hlo emitter body builder arg values hlodialectemitter hlo emitter emission context body builder arg values tf assign or return auto result ,create locations using the helper from the piperorigin revid change id , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
3241,void test spots realtype if decdigits 0 decdigits is not defined for example real concept so assume precision of most test data is double for example decdigits numeric limits double digits10 15 decdigits numeric limits double digits10 15 for 64 bit if decdigits 15 numeric limits double digits10 15 is the accuracy of the test data ,shows commit needed not sure why but probably comment only svn r , fix a bug in the parser test for the new parser test
3242,include syscalls h include syscall h include trinity h include utils h include compat h if f getlk64 f getlk define have lk64 endif static const unsigned long fcntl o flags o append o async o direct o noatime o nonblock unsigned int random fcntl setfl flags void unsigned int val 0 if rand bool val o append if rand bool val o async if rand bool val o direct if rand bool val o noatime if rand bool val o nonblock return val return set rand bitmask array size fcntl o flags fcntl o flags static void sanitise fcntl struct syscallrecord rec ,make random fcntl setfl flags use set rand bitmask , move the syscall process to the syscall process
3243,class test testcase run config create run config with cluster spec tf config self assert equal session config run config session config ' job ps' ' job worker' ' job chief' ' job master' run config session config ' job ps' ' job worker' ' job chief' ' job master' def test evaluator session config self tf config ,fixed indentation in test ps session config , fix a bug in the docstring of the test case piperorigin revid
3244,se devicememoryallocator toc se allocator allocate void ctx int device ordinal uint64 t size bool retry on failure int64 t memory space se scopeddevicememory memory se status se status tf status se status auto allocation reinterpret cast stream executor devicememoryallocator ctx allocate device ordinal size retry on failure memory space se devicememoryallocator toc se allocator deallocate void ctx se devicememorybase base int device ordinal se status se status int device ordinal tf status se status auto status reinterpret cast stream executor devicememoryallocator ctx deallocate device ordinal apiconverter fromc base if status ok ,change all se status to the common tf status for better compatibility piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
3245,eval7 arg skipwhite arg handle following ' ' ' ' and ' ' for expr expr expr name expr expr expr expr expr name expr if ret ok ret handle subscript arg rettv evaluate true eval method locate the method name name arg for len 0 ascii isalnum name len name len ' ' len for len 0 eval isnamec name len len if len 0 eval method arg len todo if name is a function reference resolve it vim memset funcexe 0 sizeof funcexe funcexe evaluate evaluate funcexe basetv base ,patch cannot use a user defined function as a method problem cannot use a user defined function as a method solution pass the base as the first argument to the user defined function after partly by fujiwara takuya , patch problem when using a terminal window doesn't work solution add a test for the job
3246,headers list find files ' proto' 'tensorflow compiler' list find files ' proto' 'tensorflow core' list find files ' proto' 'tensorflow python' list find files ' h' 'tensorflow cc' list find files ' h' 'tensorflow compiler' list find files ' h' 'tensorflow core' list find files ' h' 'tensorflow python' ,tf pip include tensorflow cc saved model h in tensorflow pip includes tested built build pip package locally and verified the wheel contains the required files piperorigin revid change id , xla python fix for the xla client client client piperorigin revid
3247,class dequantizeop public xlaopkernel op requires ok ctx ctx getattr axis axis op requires ctx axis 1 errors invalidargument axis must be 1' is axis op requires ok ctx ctx getattr dtype dtype dequantizeop override default class dequantizeop public xlaopkernel xla xlaop input ctx input 0 xla xlaop output todo ylc support bfloat16 output xla convertelementtype input xla f32 auto scale scalarlike output scale factor class dequantizeop public xlaopkernel output xla add xla mul xla add output halfrange scale scalarlike output min range if dtype dt bfloat16 output xla convertelementtype input xla bf16 ctx setoutput 0 output private datatype dtype register xla op name dequantize typeconstraint t kquantizedtype ,support dequantize to bfloat introduce dequantizev which allows user to specify the output dtype float bfloat piperorigin revid change id , xla gpu support for the xla client piperorigin revid
3248,def cudnn gru inputs init h kernel recurrent kernel bias mask time major seq axis batch axis 0 1 else seq axis batch axis 0 1 if time major else 1 0 for init h cudnn expects one more dim of num layers before or after batch dim for time major or batch major inputs respectively init h array ops expand dims init h axis seq axis weights array ops split kernel 3 axis 1 def cudnn lstm inputs init h init c kernel recurrent kernel bias mask seq axis batch axis 0 1 else seq axis batch axis 0 1 if time major else 1 0 for init h and init c cudnn expects one more dim of num layers before or after batch dim for time major or batch major inputs respectively init h array ops expand dims init h axis seq axis init c array ops expand dims init c axis seq axis ,add comments on shapes of init h c , tf data saveable dataset to be used by default piperorigin revid
3249,class versiontest tf test testcase self assertequal type tf version str self assertequal type tf version str this pattern will need to grow as we include alpha builds etc self assertregexpmatches tf version r' d d d w ' self assertregexpmatches tf version r' d d d w ' self assertregexpmatches tf version r' d d d w head ' self assertregexpmatches tf version r' d d d w head ' def testgraphdefversion self version tf graph def version ,update versions and versions test to allow , fix a bug in the docstring of the test case piperorigin revid
3250,const char tf servertarget tf server server endif void tf deleteserver tf server server delete server void tf deleteserver tf server server ifndef android delete server endif end extern c ,make tf check for android too this should avoid a incomplete warning piperorigin revid , fix a bug in the test case piperorigin revid
3251,static char features static int included patches add new patch number below this line 973 ,patch problem when using diffsplit the cursor jumps to the first line solution put the cursor on the line related to where the cursor was before the split , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3252,except importerror pass try from tensorflow python keras api v2 import keras from python keras api v2 import keras current module path module util get parent dir keras current module path setattr current module keras keras ,automated rollback of commit piperorigin revid , fix a bug in the docstring of the test piperorigin revid
3253,def load tf config port host index hosts index current host assign ports hosts f host port for host in hosts hosts s s host port for host in hosts tf config cluster key worker key hosts task key type key worker key index key host index class clusterresolver creates a new args port string optional override default port usage of port integer optional override default port usage of task type string optional overrides the task type task id integer optional overrides the task index rpc layer string optional overrides the rpc layer tensorflow uses class clusterresolver self task id task id self rpc layer rpc layer self environment environment self port port self port str port property def task type self ,ordering build targets replacing f string formatting , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
3254,string conditional name const status functionalizecond const node node if node int port nodebuilder id builder name identity id builder input if node port string outside compilation if getnodeattr if node def kxlaoutsidecompilationattrname outside compilation ok id builder attr kxlaoutsidecompilationattrname outside compilation node id tf return if error nodebuilder name identity input if node port finalize graph id tf return if error id builder finalize graph id state map resetcondid id state map lookupcondid if node state map id state map if node return status ok ,in case that if node is in outside compilation block mark identity node for merge with outside compilation as well piperorigin revid , fix a bug in the test case piperorigin revid
3255,int const cluster cluster int num gpus 0 for const auto device devices if device second type gpu if device second environment find architecture device second environment end const string arch device second environment at architecture todo yaozhang enable for volta gpus compute capability version 7 if arch 7 num gpus num gpus return num gpus ,enable for all gpus piperorigin revid , xla python add a test for the cpu backend piperorigin revid
3256,class rate object def variables self return self vars def safe div self numerator denominator name t math ops truediv numerator denominator zero array ops zeros like t dtype denominator dtype condition math ops greater denominator zero zero math ops cast zero t dtype return array ops where condition t zero name name def add variable self name shape none dtype none if self built class rate object state ops assign self prev values values state ops assign self prev denominator denominator return self safe div self numer self denom name safe rate return math ops div no nan self numer self denom negative to zero true name safe rate ,cln replace safe div method by div no nan , fix a bug in the docstring of the keras model piperorigin revid
3257,void switchop compute opkernelcontext context tf call all types register cpu switch tf call all types register cpu ref switch tf call quantized types register cpu switch tf call number types no int32 register gpu switch tf call number types no int32 register gpu ref switch ,registering cpu switch for quantized types change , fix a bug in the new delegate piperorigin revid
3258,do put if y type mblock gchar cursor intc gchar cursor colnr 0 if dir forward c nul ,patch put on multi byte character misplaced problem when a multi byte character ends in a zero byte putting text puts it before the character instead of after it solution use int instead of char for the character under the cursor luchr closes add a test , patch problem when using a terminal window is a bit slow solution add a test for the gui
3259,static void post inotify init struct syscallrecord rec return new alloc object new eventfd fd new inotifyfd fd add object new obj local obj fd inotify ,fix cut n paste error in inotify syscall post , fix a bug in the syscall page
3260,class mlirgeneratedunaryop public opkernel op ctx k kernel name data type kernel define register and generate kernel kernel name data type native data type namespace generate op kernel for kernel name data type register kernel builder name kernel name device device gpu typeconstraint native data type t define register and generate unary kernel kernel name data type native data type namespace generate op kernel for kernel name data type register kernel builder name kernel name device device gpu typeconstraint native data type t mlirgenerated kernel name data type op namespace tensorflow ,refactor kernel gen macros this moves the primary tensor handling logic out of macros and into a common base class for unary and binary ops piperorigin revid change id , xla gpu support for the layout of the hlo computation piperorigin revid
3261,status datasetopstestbase createtensorslicedataset datasetbase tensor slice dataset std unique ptr opkernel tensor slice dataset kernel datatypevector dtypes dtypes reserve components size std vector partialtensorshape shapes shapes reserve components size for const auto t components dtypes push back t dtype gtl inlinedvector int64 4 partial dim sizes ,reduce the code , fix a bug in the test case piperorigin revid
3262,from tensorflow python ops import variable scope from tensorflow python platform import tf logging as logging from tensorflow python summary import summary from tensorflow python training import session run hook from tensorflow python training import training util keys name 'keys' class session run hook sessionrunhook run context session graph get operation by name loss name outputs 0 return session run hook sessionrunargs 'global step' contrib framework get global step 'global step' training util get global step 'current loss' loss def after run self run context run values ,updates get global step per deprecation warning in tensorflow contrib framework python ops variables py piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3263,in tl scrollback are no longer used todo make argument list work on ms windows 1954 to set bs correctly check get stty pass the fd of the pty for the gui fill termios with default values perhaps like http launchpad net trunk view head main c ex terminal exarg t eap cmd skipwhite p if cmd null cmd nul cmd p sh if eap addr count 2 ,patch term without argument does not work problem term without argument does not work solution use shell for empty command yasuhiro matsumoto closes , patch problem when using a terminal window doesn't work solution add a test for the command line
3264,def auto shard dataset dataset num shards index elif hasattr dataset map func todo priyag make this check more robust by enforcing some common property on all map flatmap interleave datasets map func def dataset map func function def map func def dataset map func definition for node in map func def node def if node op in reader dataset ops found reader op true ,automated rollback of commit piperorigin revid , fix a bug in the docstring of the docstring of the tf data strategy piperorigin revid
3265,copyright 2015 google inc all rights reserved licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license you may obtain a copy of the license at http www apache org licenses license 2 0 unless required by applicable law or agreed to in writing software distributed under the license is distributed on an as is basis without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license import random import numpy as np ,added license headers , fix a bug in the new module of the dtrace hdl is not used in the dtrace hdl piperorigin revid change id ibcaccabdeabcbbeae
3266,class pfortestcase class pfortestcase def test read var self self skiptest b flaky x 1 2 3 4 5 y 2 5 z resource variable ops resourcevariable 5 ,disable flaky test piperorigin revid change id , tf data vectorization for tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3267,static void alg setsockopt struct sockopt so unused struct socket triplet so level sol alg struct netproto proto alg const struct netproto proto alg name alg socket alg rand socket setsockopt alg setsockopt ,constify struct netproto , proto zmalloc conversion
3268,class saver object 'latest filename' collides with 'save path' ' s' and ' s' latest filename save path if not gfile isdirectory os path dirname os path abspath save path if not gfile isdirectory os path dirname save path raise valueerror parent directory of doesn't exist can't save format save path class saver object return logging info restoring parameters from s save path sess run self saver def restore op name self saver def filename tensor name os path abspath save path self saver def filename tensor name save path staticmethod def add collection def meta graph def key export scope none ,revert added absolute path expansion of parent directory check in saver py ‚Ä¶ , fix a bug in the docstring of the docstring of the docstring change
3269,test threadpool parallelforwithworkerid pool parallelforwithworkerid kworkitems khugecost threads running work num threads int64 begin int64 end threads running work int64 begin int64 end int64 id store true for the current thread and assert that another thread is not running with the same id ,remove unused lambda capture , xla gpu support for the same dimension of the input piperorigin revid
3270,f rand typval t argvars typval t rettv static uint32 gy gz static false listitem t lx ly lz lw uint32 tx y z w t result uint32 tx 0 y z w t result if argvars 0 v type var unknown ,patch warning for uninitialized variable problem warning for uninitialized variable solution initialize the variable , patch problem when using a popup window with a terminal window solution add a test for the mouse flag
3271,const char generate pathname void newpath 0 ' ' newpath 1 ' ' void strncpy newpath 2 pathname len len 2 ,increase length of string when prefixing with , fix a bug in the watchdog process
3272,def walk top in order true tf export io gfile walk def walk v2 top topdown onerror none def walk v2 top topdown true onerror none recursive directory tree generator for directories args ,add default value for of io gfile walk the default exists in python's os walk and in the v gfile too piperorigin revid , fix a bug in the docstring of the docstring of the new api change
3273,class parallelmapiterator public datasetbaseiterator return false if deterministic iterate through in flight results and returns the first one that is found to be available and not end of input if the first result in order is end of input we know that all earlier iterations have already been completed so it is safe to return that result for the caller to process end of iteration for auto it invocation results begin it invocation results end it if it notification hasbeennotified ,tf data add comment to for the nondeterministic case to explain the condition it's checking for piperorigin revid change id , fix a bug in the test case piperorigin revid
3274,popup adjust position win t wp wp w width 1 for lnum wp w topline lnum wp w buffer b ml ml line count lnum int len vim strsize ml get buf wp w buffer lnum false count tabs for what they are worth int len win linetabsize wp ml get buf wp w buffer lnum false colnr t maxcol if wp w p wrap ,patch popup window width is wrong when using tabs problem popup window width is wrong when using tabs paul jolly solution count tabs correctly closes , patch problem when using a popup window with a popup window solution add a test for the mouse command
3275,from future import print function import time import numpy as np import portpicker import tensorflow as tf from tensorflow python util import net lib def create local cluster num workers num ps protocol grpc worker ports net lib pick unused port or die for in range num workers ps ports net lib pick unused port or die for in range num ps worker ports portpicker pick unused port for in range num workers ps ports portpicker pick unused port for in range num ps cluster dict worker localhost s port for port in worker ports ps localhost s port for port in ps ports ,use portpicker library when getting a port in localhost cluster performance test and sync replicas optimizer test change , fix a bug in the test case piperorigin revid
3276,class concatoptest test testcase t1 1 2 3 4 5 6 t2 7 8 9 10 11 12 c gen array ops concat v2 t1 t2 constant op constant 1 dtype dtype c gen array ops concat v2 t1 t2 constant op constant 1 dtype dtype self assertequal 2 6 c get shape as list output c eval self assertallequal 1 2 3 7 8 9 4 5 6 10 11 12 output ,change gen array ops concat v to gen array ops concat v as is not needed any more signed off by yong tang yong tang github outlook com , fix a bug in the test case piperorigin revid
3277,def train and evaluate estimator train spec eval spec hidden units 1024 512 256 input pipeline for train and evaluate def train input fn returns x y def train input fn returns x y please shuffle the data pass def eval input fn eval returns x y def eval input fn returns x y pass train spec tf estimator trainspec input fn train input fn max steps 1000 ,improved documentation piperorigin revid , update docstring for tf nn rnn py
3278,out unlock close cachefile exit 10 return ret ,remove debug code that crept in , fix a bug in the parser test piperorigin revid
3279,class tobigtableop public asyncopkernel op requires async ctx failures empty mutation status ok errors unknown failure while writing to bigtable errors unknown failure while writing to cloud bigtable mutation status error code mutation status error message mutation status error details ,tf data bigtable renamed bigtable class to for clarity this removes the confusion between bigtable and bigtable naming also cleaned up all other uses of bigtable in error messages piperorigin revid , fix a bug in the graph piperorigin revid
3280,get win info win t wp short tpnr short winnr dict add number dict winnr winnr dict add number dict winid wp w id dict add number dict height wp w height dict add number dict winrow wp w winrow dict add number dict winrow wp w winrow 1 ifdef feat menu dict add number dict winbar wp w winbar height endif dict add number dict width wp w width dict add number dict wincol wp w wincol dict add number dict wincol wp w wincol 1 dict add number dict bufnr wp w buffer b fnum ifdef feat terminal ,patch getwininfo and win screenpos return different numbers problem getwininfo and win screenpos return different numbers solution add one to wincol and winrow from getwininfo , patch problem when using a terminal window is a bit slow solution add a test for the gui
3281,def get dummy gan model discriminator fn none def dummy loss fn gan model def dummy loss fn gan model add summaries true return math ops reduce sum gan model discriminator real outputs gan model discriminator gen outputs ,tfgan respect use loss summaries in ganestimator since the refactor done in the use loss summaries argument of ganestimator isn't respected anymore this pr restores the original behavior and passes use loss summaries down to the loss functions , fix a bug in the docstring of the test case piperorigin revid
3282,t arg3 insert arg list or blob arg item of prev arg number functions that return the return type of a builtin function note that argtypes is null if argcount is zero static type t ret void int argcount unused type t argtypes unused internal func check arg types type t types int idx int argcount return ok call the f function to obtain the return type of function idx argtypes is the list of argument types or null when there are no arguments type t internal func ret type int idx int argcount type t argtypes ,patch compiler warning for uninitialized variable problem compiler warning for uninitialized variable john marriott solution initialize with null , fix a bug in the parser test for the new code svn r
3283,shapeinference inferdegeneratedimensionbroadcastshape shapeutil humanstring rhs c str if shapeutil rank lhs shapeutil rank rhs broadcast dimensions empty return invalidargument broadcast dimensions field should not be set on binary operations with operands of the same rank if shapeutil rank lhs shapeutil rank rhs std vector int64 identity dims shapeutil rank lhs std iota identity dims begin identity dims end 0 if broadcast dimensions empty broadcast dimensions identity dims return invalidargument broadcast dimensions field must either be not set or be the identity on binary operations with operands of the same rank if shapeutil compatible lhs rhs ,xla allow broadcast dims argument to binary operations to be the identity mapping where the inputs are the same rank allowing the identity is well defined and useful as a base case piperorigin revid , xla gpu support for xla hlo layout piperorigin revid change id iadedaeafbeab
3284,limitations under the license include tensorflow compiler xla service interpreter executor h include tensorflow stream executor device options h include tensorflow stream executor lib initialize h include tensorflow stream executor lib ptr util h include tensorflow stream executor lib status h include tensorflow stream executor lib status macros h include tensorflow stream executor multi platform manager h ,se remove port makeunique wrapunique use absl instead piperorigin revid , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
3285,do incsearch highlighting int firstc incsearch state t is state strncmp cmd global p cmd 0 strncmp cmd vglobal p cmd 0 check for global if cmd 'g' p ' ' p if skipwhite p nul return false p skipwhite p delim p end skip regexp p delim p magic null ,patch 'incsearch' highlighting does not work for g problem 'incsearch' highlighting does not work for g solution skip the exclamation mark hirohito higashi , patch problem when using a terminal window is a bit slow solution add a test for the gui
3286,const absl string view kinputpipeline input pipeline const absl string view koverviewpage overview page const absl string view kkernelstats kernel stats const absl string view kmemoryprofile memory profile const absl string view xplane template typename proto void addtooldata absl string view tool name const proto tool output status convertxspacetoprofileresponse const xspace xspace profileresponse response absl flat hash set absl string view tools req tools begin req tools end addtooldata xspace response if tools empty return status ok if tools contains ktraceviewer trace trace ,move trace processing from server to the client side for sampling mode piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id icfecdffaddccbded
3287,class ndarray composite tensor compositetensor pylint disable invalid name todo wangpeng handle graph mode if not isinstance self data ops eagertensor raise typeerror using symbolic tensor is not allowed' return np asscalar self data numpy return self data numpy item def tolist self return self data numpy tolist ,replace deprecated np with item , tf data service support for tf data dataset piperorigin revid
3288,def get name scope returns a string representing the current name scope if context in eager mode if context executing eagerly return context context scope name rstrip return get default graph get name scope ,cleanup replace an errant in eager mode with executing eagerly piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3289,throwsmessage const literals e g throwsmessage message return internal exceptionmatcherimpl err property description std exception what property what std exception what matchercast std string template typename err typename message std string throwsmessagehassubstr const internal message message expected an std exception derived class return internal exceptionmatcherimpl err property description std exception what hassubstr message property what std exception what hassubstr message endif gtest has exceptions ,small improvements code style and property name , xla python fix a bug in the client client piperorigin revid
3290,class tensorflowtrainer object self loss loss self global step global step pylint disable redefined variable type if exponential decay is not none if isinstance exponential decay dict self learning rate tf train exponential decay class tensorflowtrainer object raise valueerror exponential decay must be a dict type else self learning rate tf get variable learning rate initializer tf constant initializer learning rate learning rate initializer tf constant initializer learning rate params tf trainable variables self gradients tf gradients loss params if clip gradients 0 0 ,locally disable pylint for redefined variable type , fix a bug in the docstring of the docstring of the documentation of the example change
3291,flag createflag const char name benchmarkparams params const std string usage return flag name params name const t val params set t name val params get t name usage params get t name usage flag optional benchmarks a model ,refactors tool piperorigin revid change id , fix a bug in the new op test piperorigin revid
3292,public mlfunction return the statement of this mlfunction const operationstmt getreturnstmt const operationstmt getreturnstmt methods for support type inquiry through isa cast and dyn cast static bool classof const function func return func getkind function kind mlfunc ,add mlfunction piperorigin revid , xla gpu support for the hlo instruction piperorigin revid change id icabdabcccecababba
3293,std pair float float splitf64tof32 double x only values within the range of f32 are supported unless it is infinity small values with large negative exponents would be rounded to zero check std isfinite x f32 x if std isfinite x f32 log warning out of range f64 constant detected x the high float is simply the double rounded to the nearest float because we are rounding to nearest with ties to even the error introduced in ,xla log a warning for out of range f constants instead of a check failure piperorigin revid change id , xla gpu support for the layout of the layout is a bit piperorigin revid
3294,class prefetchtodeviceiterator object with ops device device buffer resource handle prefetching ops function buffering resource f prefetch fn output types data nest flatten sparse as dense types self input dataset output types self input dataset output classes target device target device string arg input iterator handle buffer size buffer size ,sets the output alloc attrs on the remote function call in the functionbufferingresource this allows for types such as strings that are always in host memory to be returned from the functionbufferingresource fixes piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3295,namespace functor typedef eigen gpudevice gpudevice typedef std complex float complex64 typedef std complex double complex128 partial specialization of unaryfunctor device gpudevice functor template typename functor ,add further changes for complex support , add support for int int piperorigin revid
3296,include time h include errno h include fcntl h include unistd h void init watchdog void static const struct timespec ts tv nsec 100000000 100ms pid t pid fflush stdout void init watchdog void watchdog never returns while shm watchdog pid 0 sleep 0 1 nanosleep ts null output 0 d started watchdog thread d n getpid shm watchdog pid ,really sleep ms when spawning watchdog , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
3297,class object def print list name iterable get name if iterable print format name len iterable file res print n join get name elem for elem in iterable file res print n join format get name elem for elem in iterable file res else print empty format name file res ,added copy with input replacements and graph replace change , fix a bug in the docstring of the docstring of the docstring of the tf nn rnn api piperorigin revid
3298,namespace tflite namespace gpu namespace metal computetaskdescriptor quantizeanddequantize const operationdef definition const quantizeanddequantizeattributes attr computetaskdescriptor desc definition computetaskdescriptor desc desc is linkable true desc shader source r flt4 linkable 0 flt4 value int linear index uint3 gid float3 params computetaskdescriptor quantizeanddequantize desc addsrctensor definition src tensors 0 desc adddsttensor definition dst tensors 0 desc addsrctensor desc adddsttensor desc uniform buffers constant float3 attr const std vector bhwc src shapes ,added operationdef to all task descriptors piperorigin revid change id , xla gpu support for the layout interface piperorigin revid change id idacdededdbdcfbcdb
3299,boost auto test case naive monte carlo test if defined test test 12 test radovic double 2 test radovic double 3 endif if defined test test 13 test radovic double 4 test radovic double 5 endif if defined test test 14 test alternative rng float 3 test alternative rng double 3 endif ,naive monte carlo test cpp split into smaller units so we get fewer object size too large errors and hopefully zero in on persistent but non test failures , fix a bug in the new parser test for the new parser change id tested
3300,public using denseset affinemap affine binary op expression uniquing we don't need to unique dimensional affine binary op expression uniquing figure out uniquing of dimensional or symbolic identifiers std tuple doesn't work with denseset affinebinaryopexpr std tuple doesn't work with densemap using nested pair densemap std pair unsigned std pair affineexpr affineexpr affinebinaryopexpr ,clean up an mlircontext comment piperorigin revid , fix a bug in the parser parser test piperorigin revid
3301,const char const xla cpu optimize for size const char const xla llvm dot tiling factor const char const xla force enable experimental llvm ir gemm const char const xla use linalg for dot const char const xla llvm ir gemm tile size namespace bool const hlomoduleconfig config return extra options map count 0 bool const hlomoduleconfig config const auto extra options map config debug options xla backend extra options return extra options map count 0 static absl string view absl string view str absl string view suffix check ge str size suffix size ,xla cpu lower small matmul through mlir linalg by default benchmarks are neutral to positive piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id id ibaaeabeded
3302,without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license include tensorflow contrib lite delegates flex buffer map h include tensorflow contrib lite delegates eager buffer map h include gmock gmock h include gtest gtest h limitations under the license include tensorflow contrib lite util h namespace tflite namespace flex namespace eager namespace using testing elementsare test buffermaptest tensorflowoverwritestflite namespace namespace flex namespace eager namespace tflite int main int argc char argv ,automated rollback of commit piperorigin revid , add a test for the new op op piperorigin revid
3303,def upload status successes failures unstable 'templates' failures f name for f in failures successes s name for s in successes unstable p name for p in unstable data 'projects' failures successes ,infra unwrapping value , fix a bug in the file in the file file
3304,class session run hook sessionrunhook if self saver return self saver savers ops get collection ops graphkeys savers 0 savers ops get collection ops graphkeys savers if not savers return none if not isinstance savers list return savers assert len savers 1 'only one saver supported ' if len savers 1 logging error 'multiple savers in the savers collection on demand checkpointing ' 'will be disabled pass an explicit saver to the constructor to ' 'override this behavior ' return none return savers 0 def after run self run context run values ,fix bug in handling of collection for shutdown hook piperorigin revid , fix a bug in the docstring of the test piperorigin revid
3305,class garbagecollectiontest test util tensorflowtestcase test has no leak def test no new objects decorator self class object def init inner self pylint disable no self argument inner self assertequal self assertequal pylint disable invalid name inner self accumulation test util assert no new pyobjects executing eagerly def test has leak self self accumulation append 1 test util assert no new pyobjects executing eagerly def test has no leak self self not accumulating 1 with self assertraises assertionerror test has leak test has no leak if name main googletest main ,fix another eager pyobject leak this one was also due to pysequence getitem piperorigin revid , fix a bug in the test case piperorigin revid
3306,status datasetopstestbase initthreadpool int thread num the thread num argument should be positive but got thread num thread pool absl make unique thread threadpool env default threadoptions intra op thread pool thread num env default threadoptions test thread pool thread num return status ok ,rename the name of thread pool in datasetopstestbase to test thread pool and revise test case , fix a bug in the test case piperorigin revid
3307,static int message initialize if oracle version hex oracle version 11 1 dvoid querydescriptor udt messagequery query ocicoll queries sb4 numqueries ocicoll queries sb4 numqueries endif sword status ,remove tabs in favor of spaces in order to be consistent with all of the other files , patch problem when using a terminal window doesn't work solution add a test for the mouse command
3308,std vector absl string view absl string view metadata std vector absl string view key value pairs std stack char quotes size t start 0 end 0 for static cast size t end metadata size end for end metadata size end char ch metadata end switch ch case ' ' ,update parse annotation cc , xla gpu support for the layout inference piperorigin revid change id id iaaeabfdfedfeacedf
3309,static unsigned int plus minus two unsigned int num now munge it for off by ones switch rand 5 switch rand 4 case 0 num 2 break case 1 num 1 break case 2 return num case 3 num 1 case 2 num 1 break case 4 num 2 case 3 num 2 break return num ,remove value modification decision from plus minus two , fix a bug in the watchdog process
3310,class public nvinfer1 const char const override return namespace c str protected template typename t void writetobuffer const t val char buffer const reinterpret cast t buffer val buffer sizeof t template typename t t const char buffer t val reinterpret cast const t buffer buffer sizeof t return val private std string namespace ,add plugin for the cast op the bridge between the converter and the plugin will be added in a separate change later piperorigin revid , fix a bug in the delegate of the delegate piperorigin revid
3311,bool infershapeforsingleoperation operation op dialect tf dialect std vector const tensorflow tensor input tensors op getnumoperands std vector tensorflow partialtensorshape input shapes op getnumoperands std vector tensorflow tensor tensors std vector tensorflow tensor tensors op getnumoperands for auto it llvm enumerate op getoperands value operand it value size t index it index bool infershapeforsingleoperation operation op dialect tf dialect if the operand is constant then convert it to tensor elementsattr attr if matchpattern operand m constant attr tensors emplace back tensorflow tensor input tensor tensors back tensorflow tensor input tensor tensors index auto status tensorflow attr input tensor if status ok input tensors index input tensor ,fix populating tensors to be passed to inferencecontext in tf mlir shape inference pass by the tensors vector there will be no undefined behavior resizing vector for input tensors being copied and used for shape inference piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id id idadabbfadafcd
3312,bool functionlibrarydefinition contains const string func const const functiondef functionlibrarydefinition find const string func const tf shared lock l mu return func fdef auto result func if result return result fdef else return nullptr std shared ptr functionlibrarydefinition functiondefandopregistration ,fix undefined behavior in functionlibrarydefinition find with some combinations of compiler options though surprisingly not just enabling asan taking the address of the first member through a null std shared ptr fails piperorigin revid , add a test for the tf data service piperorigin revid
3313,import sys from google protobuf import text format from tensorflow contrib import receptive field from tensorflow contrib receptive field import receptive field api as receptive field from tensorflow core framework import graph pb2 from tensorflow python platform import app from tensorflow python platform import gfile ,add missing tf contrib receptive field dependencies piperorigin revid , fix a bug in the test case piperorigin revid
3314,docfiles license txt readme txt build txt history txt html samples test method for checking a potential oracle home def checkoraclehome directorytocheck global oraclehome oracleversion oraclelibdir struct global oraclehome oracleversion oraclelibdir import os import struct import sys if sys platform in win32 cygwin subdirs bin filestocheck class bdist rpm distutils command bdist rpm bdist rpm class build distutils command build build def finalize options self global distutils os sys withunicode global withunicode import distutils util import os import sys platspecifier s s s distutils util get platform sys version 0 3 oracleversion ,added support for building with python x from an independently created setup py as for cx oracledbatools for example , patch problem when using a popup window with a terminal window solution add a test for the mouse flag
3315,gtest os aix ibm aix gtest os cygwin cygwin gtest os freebsd freebsd gtest os fuchsia fuchsia gtest os hpux hp ux gtest os linux linux gtest os linux android google android typedef struct rtl critical section gtest critical section to disable threading support in google test add dgtest has pthread 0 to your compiler flags define gtest has pthread gtest os linux gtest os mac gtest os hpux gtest os qnx gtest os freebsd gtest os nacl gtest os netbsd define gtest has pthread gtest os linux gtest os mac gtest os hpux gtest os qnx gtest os freebsd gtest os nacl gtest os netbsd gtest os fuchsia endif gtest has pthread if gtest has pthread ,detect fuchsia and set gtest has pthread on gtest os fuchsia , fix a bug in the parser test piperorigin revid
3316,class test testcase dataset with dataset ops dataset from tensor slices x train y train dataset with dataset with batch 32 strategy mirrored strategy mirroredstrategy devices ' device cpu 0' ' device gpu 0' prefetch on device false ' device gpu 0' model compile loss keras losses mean squared error optimizer gradient descent gradientdescentoptimizer 0 5 ,turn off prefetching for predict calls since it is currently not deterministic piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3317,public instruction getinstruction const return state instruction getinstruction return state return the context this operation belongs to mlircontext getcontext return getinstruction getcontext the source location the operation was defined or derived from location getloc const return state getloc ,add a convenience getcontext method in opstate to reduce boilerplate on clients piperorigin revid , xla gpu support for the hlo instruction piperorigin revid change id icabdabcccecababba
3318,namespace tflite std pair builtinoptions flatbuffers offset void createbuiltinunion flatbuffers flatbufferbuilder fbb enum builtinoperator op void builtin op data const tflitenode node void builtin op data switch op include tensorflow lite experimental writer option writer generated h subgraphwriter exportoperators flatbuffers flatbufferbuilder fbb builtin auto builtin options and type createbuiltinunion fbb static cast enum builtinoperator registration builtin code node builtin data node node builtin data builtin options builtin options and type second builtin options type builtin options and type first else ,automated g rollback of changelist piperorigin revid change id , fix a bug in the parser delegate piperorigin revid
3319,required packages 'absl py 0 1 6' 'astor 0 6 0' 'gast 0 2 0' 'grpcio 1 8 6' 'numpy 1 12 1' 'six 1 10 0' 'protobuf 3 4 0' ,add grpcio as a pip dependency of tensorflow piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3320,class withparaminterface references static data to reduce the opportunity for incorrect uses like writing 'withparaminterface bool getparam ' for a test that uses a fixture whose parameter type is int const paramtype getparam const return parameter const paramtype getparam const gtest check parameter null getparam can only be called inside a value parameterized test did you intend to write test p instead of test f return parameter private sets parameter value the caller is responsible for making sure the value ,prints a useful message when is called in a non parameterized test , fix a bug in the file file
3321,void parseuniontest table v x u root type v x a 1 x type t true unions must be with prefixed namespace flatbuffers parser parser2 test eq parser2 parse namespace n table a namespace union u n a table b e u root type b e type n a e true void conformtest ,added union namespacing test case change id tested on linux , fix a bug in the parser test piperorigin revid
3322,class binaryopstest xlatestcase def disabled testsparsematmul self binary wrappers for sparse matmul with different hints def a b return tf sparse matmul a b a is sparse true return math ops sparse matmul a b a is sparse true def a b return tf sparse matmul a b b is sparse true return math ops sparse matmul a b b is sparse true def a b return tf sparse matmul a b a is sparse true b is sparse true return math ops sparse matmul a b a is sparse true b is sparse true self tf sparse matmul self math ops sparse matmul self self self ,import tensorflow as tf import tensorflow as tf import tensorflow as tf from contextlib import contextmanager remove the last remaining change to pytf , xla gpu support for the xla client piperorigin revid
3323,namespace xla namespace gpu namespace void const hloinstruction instr std vector hloinstruction params if instr opcode hloopcode kfusion ,remove extra whitespace , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3324,include shm h include trinity h perf related fds see also perf c syscalls perf event open c static int rand perf fd void return shm perf fds rand max perf fds epoll related fds static void open epoll fds void ,move rand pipe fd into perf c , proto syscall syscall syscall
3325,def binary crossentropy target output from logits false if not from logits if isinstance output ops eagertensor variables module variable or output op type 'sigmoid' try target get shape merge with output get shape except valueerror raise valueerror target and output must have the same shape s vs s target get shape output get shape target get shape assert is compatible with output get shape epsilon constant to tensor epsilon output dtype base dtype output clip ops clip by value output epsilon 1 epsilon ,change from try catch to assert is compatible with based on review comment signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the docstring of the tf contrib image ops piperorigin revid
3326,finish incsearch highlighting restore viewstate is state old viewstate highlight match false by default search all lines search first line 0 search last line maxlnum p magic is state magic save validate cursor needed for tab if call update screen update screen some valid else redraw all later some valid p magic is state magic save ,patch wrong highlight when 'incsearch' set and cancelling s problem wrong highlight when 'incsearch' set and cancelling s solution reset search line range hirohito higashi masamichi abe , patch problem when using a terminal window is a bit slow solution add a test for the mouse engine
3327,class sdcamodel object logging ops scalar summary 'approximate duality gap' self approximate duality gap logging ops scalar summary 'examples self hashtable size def symmetric l1 regularization self return self options 'symmetric l1 regularization' ,add examples seen summary for the number of distinct examples we have encountered change , tf data service support for tf data dataset piperorigin revid
3328,bool isnested const xevent event const xevent parent return xeventtimespan parent includes xeventtimespan event void int64 metadata id int64 value xevent event xstat findoraddmutablestat int64 metadata id xevent event for auto stat event mutable stats if stat metadata id metadata id stat set int64 value value return return stat xstat stat event add stats stat set metadata id metadata id stat set int64 value value void int64 metadata id absl string view value xevent event for auto stat event mutable stats if stat metadata id metadata id stat set str value std string value return xstat stat event add stats stat set metadata id metadata id stat set str value std string value return stat void removeplane xspace space const xplane plane ,add to xplane utils remove int str stat piperorigin revid change id , xla gpu support for the hlo hlo client piperorigin revid change id idadedfddaccd
3329,class controlflowtest test testcase self assertallequal 42 0 grad eval feed dict c 1 self assertallequal 3 0 grad eval feed dict c 3 def testcondgrad 3 self with self test session c array ops placeholder dtypes int32 shape ox constant op constant 10 0 pred math ops less c 2 def fn1 x m x x return gradients impl gradients m ox 0 fn2 lambda math ops multiply ox 3 0 y math ops multiply 7 0 ox r control flow ops cond pred lambda fn1 y fn2 self assertallequal 980 0 r eval feed dict c 1 self assertallequal 30 0 r eval feed dict c 3 def testnestedcond simple self with self test session x constant op constant 0 name x ,add gradient in cond test to match piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3330,def make strided slice np style tests options shape 21 15 7 spec slice 3 7 2 slice none 2 ellipsis ellipsis 3d dtype tf float32 shape 21 15 7 spec slice 3 7 2 ellipsis spec slice 3 7 2 ellipsis ellipsis slice 3 7 2 slice 1 11 3 ellipsis slice 3 7 2 ellipsis 4d dtype tf float32 shape 21 15 7 9 spec slice 3 7 2 ellipsis ellipsis slice 3 7 2 slice 1 11 3 ellipsis slice 3 7 2 all combinations ,add ellipsis mask transformation in mlir for tflite piperorigin revid change id , tf data dataset dataset to be a single function piperorigin revid
3331,class timelinetest tf test testcase self validatetrace ctf def testtimelinegpu self if not tf test is gpu available if not tf test is gpu available cuda only true return run options tf runoptions trace level tf runoptions full trace ,extended the is gpu available function to cover opencl gpus in addition to cuda gpus added a gpu device name function generalized a couple of tests to support non cuda gpus change , tf data dataset dataset to tf data dataset piperorigin revid
3332,static void fork children void shm ready true static void log child signalled int childno pid t pid int sig static void log child signalled int childno pid t pid int sig unsigned long op nr struct msg childsignalled childmsg init msgchildhdr childmsg hdr child signalled pid childno childmsg sig sig childmsg op nr op nr sendudp char childmsg sizeof childmsg static void handle childsig int childno int childstatus bool stop else debugf got a signal from child d pid d s n childno pid strsignal wtermsig childstatus log child signalled childno pid wtermsig childstatus log child signalled childno pid wtermsig childstatus child op nr reap child shm children childno ,log the last operation number a child did when we get a signal , make the syscall page we can be a child process
3333,tflitestatus prepare tflitecontext context tflitenode node const tflitetensor input getinput context node kinputtensor const tflitetensor filter getinput context node kweightstensor tflitetensor bias getoptionalinputtensor context node kbiastensor const tflitetensor bias getoptionalinputtensor context node kbiastensor tflitetensor output getoutput context node koutputtensor check all the parameters of tensor match within themselves and match the tflitestatus eval tflitecontext context tflitenode node const tflitetensor input getinput context node kinputtensor const tflitetensor filter getinput context node kweightstensor tflitetensor bias getoptionalinputtensor context node kbiastensor const tflitetensor bias getoptionalinputtensor context node kbiastensor tflitetensor output getoutput context node koutputtensor switch filter type already know in out types are same ,making getoptionalinput from kernel util h return a pointer to const data piperorigin revid , add support for int int piperorigin revid
3334,builtinopresolver builtinopresolver addbuiltin builtinoperator scatter nd register scatter nd addbuiltin builtinoperator densify register densify addbuiltin builtinoperator segment sum register segment sum addbuiltin builtinoperator batch matmul register batch matmul addbuiltin builtinoperator batch matmul register batch matmul min version 1 max version 2 addcustom numericverify tflite ops custom register numeric verify todo andrewharp ahentz move these somewhere more appropriate so that custom ops aren't always included by default ,full int quantization batchmatmul piperorigin revid change id , add support for int int piperorigin revid
3335,namespace detail struct struct struct vectortypestorage struct struct rankedtensortypestorage struct struct memreftypestorage public rankedtensortype and unrankedtensortype class tensortype public vectorortensortype public using impltype detail using vectorortensortype vectorortensortype return true if the specified element type is ok in a tensor ,remove declaration and unused reference to non existent type nfc piperorigin revid , fix a bug in the toy tutorial change id ibacfeebdbeaada
3336,see the license for the specific language governing permissions and limitations under the license from future import division print function absolute import import numpy as np ,update to imports in skflow , add a test for the new op op piperorigin revid
3337,bool isfreeofsideeffect const nodedef node return false return modifiesinputsinplace node bool modifiesinputsinplace const nodedef node some nodes do in place updates on regular tensor inputs if getboolattr node in place getboolattr node inplace stringpiece op name starts with inplace return false string op name node op std transform op name begin op name end op name begin tolower if stringpiece op name contains inplace return true return true return getboolattr node in place getboolattr node inplace bool modifiesframeinfo const nodedef node ,make the cse node deduping pass in arithmeticoptimizer more robust in the presence of ops that modify their inputs in place do not dedup nodes if the underlying buffers for their outputs may be passed to an in place op piperorigin revid , add a test for the cost of the graph piperorigin revid
3338,class backproptest test testcase tensor shape tensorshape s as proto for s in shape list backprop make attr pywrap tensorflow tf attr shape shape list def testmultivalueconverttotensor self x resource variable ops resourcevariable initial value array ops constant 1 0 name 'x' def fn tape watch variable x a math ops add x value 1 0 make sure convert to tensor works correctly with list of b array ops stack a a axis 0 return math ops reduce mean b grad backprop implicit grad fn 0 1 self assertallequal 1 0 grad numpy if name ' main ' test main ,fix convert to tensor problem for list of current code fail to error out in convert to tensor when multiple are passed in piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
3339,stream stream streamexecutor parent stream stream vlog call temporary memory manager ensure the stream is completed auto status blockhostuntildone if status ok log warning error blocking host until done in stream destructor status temporary memory manager if allocated parent this ,se ensure we blockhostuntildone before we deallocate temporary memory piperorigin revid , xla gpu support for the xla cpu backend piperorigin revid change id idaceccfcbacfece
3340,class sparsefeaturecrossop public opkernel indices list in i shape debugstring at position i op requires context indices list in i shape dim size 1 2 errors invalidargument expected d2 of index to be 2 got errors invalidargument expected d2 of index to be 2 got indices list in i shape dim size 1 at position i ,revert non compiler changes , fix a bug in the new delegate piperorigin revid
3341,layout createdefaultlayoutforrank int64 rank return status ok if layout format invalid format if layout format invalid format format isvalid layout format return invalidargument layout does not have a valid format layout s shape s layout shortdebugstring shape shortdebugstring ,xla added xla combining loading module from proto and verifying it with hloverifier piperorigin revid , xla gpu support for the xla client piperorigin revid
3342,test f parallelinterleavedatasetoptest iteratoroutputprefix todo b 130309946 re enable once deflaked test p parameterizedparallelinterleavedatasetoptest disabled roundtrip test p parameterizedparallelinterleavedatasetoptest roundtrip int thread num 2 cpu num 2 const testcase test case getparam tf assert ok initthreadpool thread num ,make sure the in flight calls in finish when saving destructing wait for all in flight calls in do not affect the parallelism of , fix a bug in the test case piperorigin revid
3343,class ds fn 5 8 verify exhausted false save checkpoint at end false self assertsequenceequal outputs range 8 if is memory outputs outputs 5 outputs extend self gen outputs ds fn self num outputs 5 ckpt saved true verify exhausted false self assertsequenceequal outputs self expected outputs else restoring from checkpoint and running getnext should return now because the lockfile already exists with self assertraises errors alreadyexistserror outputs outputs 5 outputs extend self gen outputs ds fn self num outputs 5 ckpt saved true verify exhausted false verify exhausted false self assertsequenceequal outputs self expected outputs parameterized named parameters 'memory' true ,fix the serialization test for , fix a bug in the docstring of the test case piperorigin revid
3344,def padding sequences num unroll else only have sparsetensors sparse lengths value dense shape 0 for value in sequences dict values if isinstance value sparse tensor sparsetensor length math ops maximum sparse lengths length math ops reduce max math ops to int32 sparse lengths unroll array ops constant num unroll padded length length unroll length unroll unroll ,replace usage of math ops maximum with math ops reduce max when getting max length from sparsetensors piperorigin revid , tf data service support for tf data dataset piperorigin revid
3345,class resourcemgr resource otherwise invokes creator to create the resource the caller takes the ownership of one ref on resource warning creator must not call any methods on resourcemgr during its execution because a non lock is held during the creator call in order to guarantee atomicity of lookuporcreate requires std is base of resourcebase t requires resource nullptr template typename t ,add warning to lookuporcreate about reentrancy issue piperorigin revid , tf data service support for tf data dataset piperorigin revid
3346,copyright 2016 google inc all rights reserved licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license you may obtain a copy of the license at http www apache org licenses license 2 0 unless required by applicable law or agreed to in writing software distributed under the license is distributed on an as is basis without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license include tensorflow tools benchmark benchmark model h int main int argc char argv return tensorflow benchmark model main argc argv ,added a test to model benchmarking and refactored code change , fix a bug in the new dtrace dtrace kernel for the dtrace dtrace is enabled the same as the same value of the dtrace dtrace is enabled piperorigin revid
3347,def report uninitialized resources resource list none resource list shared resources local resources with ops name scope name run all operations on cpu local device os environ get tf local device cpu 0 local device os environ get tf device for uninitialized variable reporting cpu 0 with ops device local device if not resource list return an empty tensor so we only need to check for returned tensor ,change the key to 'tf device for uninitialized variable , fix a bug in the docstring of the documentation of the documentation of the tf data dataset piperorigin revid
3348,int64 const hlomodule module int64 next channel id 1 for const hlocomputation comp module computations for const hloinstruction hlo comp instructions if dyncast hlochannelinstruction hlo next channel id std max next channel id hlo channel id 1 const hlochannelinstruction channel instr dyncast hlochannelinstruction hlo if channel instr channel instr channel id next channel id std max next channel id channel instr channel id 1 ,fix msan failure piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idfbdfbcdacfbeebb
3349,constexpr bool instantiatetypedtestcase p isdeprecated return true namespace testing namespace std some standard library implementations use struct tuple size and some use class tuple size clang warns about the mismatch https llvm org ifdef clang pragma clang diagnostic push pragma clang diagnostic ignored wmismatched tags endif template typename ts class tuple size testing internal flattuple ts public std integral constant size t sizeof ts struct tuple size testing internal flattuple ts std integral constant size t sizeof ts ifdef clang pragma clang diagnostic pop endif namespace std define gtest message at file line message result type ,googletest export disable wmismatched tags warning for struct class tuple size piperorigin revid , fix a bug in the test case piperorigin revid
3350,static char features static int included patches add new patch number below this line 1312 ,patch problem sock t is not defined without the channel feature solution always define it , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3351,gui outstr nowrap intcol gui col ifdef feat sign icons intdraw sign false intsigncol col intsigncol char uextra 18 ifdef feat netbeans intg intmulti sign false gui outstr nowrap ifdef feat netbeans intg s multisign byte endif ifdef feat netbeans intg if s multisign byte gui outstr nowrap col len int strlen s if len 2 signcol col len 3 right align sign icon in the number column right align sign icon in the number column signcol col len 3 else signcol col draw sign true highlight mask 0 ,patch sign column not always properly aligned problem sign column not always properly aligned solution use col only after it was calculated yee cheng chin closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
3352,class public opkernel public explicit opkernelconstruction context opkernel context op requires ok context context getattr error msg error msg op requires ok context context getattr exit without error exit without error void compute opkernelcontext context override check false abort op intentional failure error msg if exit without error check false abort op intentional failure error msg else log warning exiting the process error msg exit 0 private string error msg bool exit without error register kernel builder name abort device device cpu ,added an option to the to make it exit the process normally change , xla gpu support for the layout inference piperorigin revid change id ifedfbcdcccfcfbbc
3353,class mixture distribution distribution batch size static batch shape num elements else batch shape self batch shape tensor batch size array ops reduce prod batch shape batch size math ops reduce prod batch shape static event shape self event shape if static event shape is fully defined event shape np array static event shape as list dtype np int32 ,fix for with unit test distributions mixture may have a partially known batch shape and there was no unit test checking this case and a bug in the code bug fixed unit tests added change , tf data saveable shape for tf data dataset piperorigin revid
3354,namespace flatbuffers public bytebuffer bb get private set re init the internal state with an external buffer code bytebuffer and an offset within public struct int i bytebuffer bb public struct int i bytebuffer bb this bb bb bb pos i ,fixed struct initialization error on older versions of c 'this' object cannot be used before all of its fields are assigned to change id , fix a bug in the parser test svn r
3355,include trinity h include utils h struct map map static void sanitise mprotect int childno unused struct syscallrecord rec void common set mmap ptr len childno map common set mmap ptr len childno if we successfully did an mprotect update our record of the mappings prot bits static void post mprotect int childno struct syscallrecord rec static void post mprotect unused int childno struct syscallrecord rec struct map map struct map shm children childno scratch if rec retval 0 map prot rec a3 shm children childno scratch 0 struct syscallentry syscall mprotect ,remove usage of scratch from mprotect , move the syscall process to the syscall process
3356,public const std string get const return value private additionalmessage operator additionalmessage std string value ,avoid implicit move operator , xla gpu support for the hlo parser piperorigin revid change id icabdabcccecababba
3357,static int get interesting 16bit value void return num unsigned int get interesting 32bit value void static unsigned int get interesting 32bit value void unsigned int num 0 ,make get interesting bit value static all calls to get interesting bit value should now be made to get interesting value to help simplify generating interesting values , make the syscall process from the child process
3358,class baselookuptabletest lookup ops keyvaluetensorinitializer a 1 dtypes string dtypes int64 default val test util run v1 only test util run v1 only cached sessions not available in tf2 0 def self with self cached session default val 1 class baselookuptabletest with self assertraisesoperror table not initialized self evaluate output test util run v1 only test util run v1 only cached sessions not available in tf2 0 def self with self cached session default val 1 class baselookuptabletest self gethashtable lookup ops keyvaluetensorinitializer keys values default val test util run v1 only test util run v1 only sessions not available in tf2 0 def self start a server server server lib server localhost 0 ,provide for skipping test in v piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
3359,find wl entry win lnum inti if win w lines valid 0 for i 0 i win w lines valid i if win w lines i wl valid if lnum win w lines i wl lnum return 1 if lnum win w lines i wl return i for i 0 i win w lines valid i if win w lines i wl valid if lnum win w lines i wl lnum return 1 if lnum win w lines i wl return i return 1 ,updated for version problem redundant check for w lines valid solution remove the if lech lorens , patch problem when using a terminal window is a bit solution add a test for the current buffer
3360,class object typical usages of the python updater tf compat v1 saved model export dir updater tf compat v1 saved model signature def utils export dir update all signature defs with key foo in all meta graph defs updater replace method name signature key foo method name regress update a single signature def with key bar in the meta graph def with ,internal cleanup for docstring piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring change
3361,test directsessionwithtrackingalloctest costmodeltest expect eq 2 shape dim 0 size expect eq 1 shape dim 1 size if node name y name expect eq 7 cm allocationid node 0 expect eq 9 cm allocationid node 0 else expect eq 8 cm allocationid node 0 expect eq 10 cm allocationid node 0 expect le 0 cm maxexecutiontime node ,mark all nodes processed by addopsrewrite stages with a tag piperorigin revid , xla gpu support for the same dimension of the input piperorigin revid
3362,const logicalbuffer copyinsertion ensures root points to set is unambiguous and distinct const auto points to points to analysis getpointstoset instruction dcheck points to dcheck points to colocated set push back points to element index 0 return colocated set back ,rollback copy insertion change because it results in a dcheck with an internal model end public begin public automated g rollback of changelist piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id id ibebfcffdcbdbdafeb
3363,limitations under the license if google cuda if google tensorrt include cuda include cuda runtime api h include third party gpus cuda include cuda runtime api h include tensorrt include nvinfer h namespace tensorflow namespace tensorrt ,copying cublas and cudnn headers into separate directories make cuda cudnn headers available under third party gpus cuda cudnn instead of cuda piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3364,int main int argc char argv tensorflow port initmain argv 0 argc argv sets the minimum duration ms and tracing attempts to one int duration ms max flags duration ms 1 int remaining attempts max flags num tracing attempts 1 int duration ms std max flags duration ms 1 int remaining attempts std max flags num tracing attempts 1 tensorflow profileoptions opts opts set include dataset ops flags include dataset ops tensorflow profileresponse response ,fix build add std to max in tensorflow contrib tpu profiler capture tpu profile cc piperorigin revid , fix a bug in the watchdog process
3365,no case 'i' intelligence 1 setup fds exit 1 break case 'l' ,remove some debug code that crept in , patch problem when using a terminal window doesn't work solution add a test for the cursor
3366,status convertmatmulhelper opconverterparams params transpose b input b is weights input b gettrtdims nbdims 2 return errors invalidargument cannot currently transpose input if it is a non 2d constant cannot currently transpose constant input if it is not 2 dimensional if a is a tensor we can only transpose if it is at least 3d in tf ,adds additional test cases for matmul , add a test for the new op op piperorigin revid
3367,f has typval t argvars typval t rettv arabic endif autocmd ifdef feat autochdir autochdir endif ifdef feat autoservername autoservername endif ,patch autochdir feature not reported by has or version problem autochdir feature not reported by has or version solution add the feature in the list , patch problem when using a terminal window is a bit slow solution add a test for the gui
3368,void installstacktracehandler else todo bmzhao this elif should ideally be just a else due to the globbing in tf additional lib srcs windows stacktrace handler cc is compiled and linked in addition to this implementation leading to an odr violation this elif is a temporary hack to prevent this once we fully refactor platform build and core build this should no longer exist elif defined platform windows void installstacktracehandler endif defined tf generate stacktrace ,adding a stacktrace handler for windows piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id iefaaedbcfceefdda
3369,static char features static int included patches add new patch number below this line 1123 1122 ,patch no way to avoid filtering for autocomplete function problem no way to avoid filtering for autocomplete function causing flickering of the popup menu solution add the equal field to complete items closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3370,namespace tensorflow status const string str value activationmode value if str value sigmoid if str value none value none else if str value sigmoid value sigmoid else if str value relu value relu ,add int version of fused convd bias activation operator for the forward phase and support side input and scaling parameters in float and int versions piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id id icfecdffaddccbded
3371,current search count forward ml get curwin w buffer b ml ml line count p ws old p ws start pos pos current search count forward if visual active visual start pos p ws old p ws curwin w cursor pos visual active true visual mode 'v' ,updated for version problem cgn does not wrap around the end of the file dimitrov dimitrov solution restore earlier christian brabandt , patch problem when using a terminal window is a bit slow solution add a test for the gui
3372,class unaryopstest xla test xlatestcase lambda x gen nn ops bias add grad x data format nchw np array 1 2 3 4 5 6 7 8 dtype np float32 expected np array 10 26 dtype np float32 expected np array 14 22 dtype np float32 def self shapes 4 2 3 2 0 4 ,tf xla correctly handle biasadd in tfxla with varying space dimensions this is adding the functionality added for tensorflow in piperorigin revid , xla gpu support for the xla client piperorigin revid
3373,class object num epochs none if len placeholders len dataframe columns 1 raise valueerror expected placeholders got format len dataframe columns len placeholders len dataframe columns 1 len placeholders self index placeholder placeholders 0 self col placeholders placeholders 1 self dataframe dataframe ,fix python valueerror len dataframe columns , fix a bug in the docstring of the docstring of the docstring of the tf nn rnn api piperorigin revid
3374,declare graph transformation resolveconstantstridedslice declare graph transformation resolveconstantfill declare graph transformation resolveconstantgather declare graph transformation resolvemultiplybyzero declare graph transformation declare graph transformation dequantize declare graph transformation unpartitionembeddinglookup ,reorder element wise operators across reshape operators this allows batch norm folding to work across reshape operators piperorigin revid , tf data optimization optimization for tf data optimizer piperorigin revid change id idadabbfadafcd
3375,register op maximum input x t input y t output z t attr t bfloat16 half float double int32 int64 attr t bfloat16 half float double int16 int32 int64 setshapefn shape inference broadcastbinaryopshapefn note this op is not commutative w r t to all its inputs register op minimum input x t input y t output z t attr t bfloat16 half float double int32 int64 attr t bfloat16 half float double int16 int32 int64 setshapefn shape inference broadcastbinaryopshapefn register op mod ,rollback of changelist to resubmit pr pr add int support for tf math minimum and tf math maximum imported from github pr https github com tensorflow tensorflow pull update tf generated ops td to add int to the operations piperorigin revid change id , tf data dataset support for tf data dataset piperorigin revid
3376,def lift unlifted variables graph variable holder mutable collection index lifted variables get id current current if not resource variable ops is resource variable mutable collection index logging warning logging log first n logging warn unable to create a python object for variable because it is a reference variable it may not be visible to training apis if this is a problem consider rebuilding the savedmodel after running tf compat v1 enable resource variables format mutable collection index mutable collection index 5 todo allenl make this trackable ,limit the number of warnings when using wrap function on something with reference variables also limits the number of warnings when loading savedmodels with references variables piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3377,def pool tf export nn atrous conv2d def atrous conv2d value filters rate padding name none atrous convolution a k a convolution with holes or dilated convolution this function is a simpler wrapper around the more general tf nn convolution and exists only for backwards compatibility you can ,atrous convd doc fix newline , fix a bug in the docstring of the documentation of the documentation of the tf nn rnn api to the test piperorigin revid
3378,using tfliteinterpreter system intptr using tfliteinterpreteroptions system intptr using tflitemodel system intptr using tflitetensor system intptr using tflitedelegate system intptr namespace tensorflowlite namespace tensorflowlite int num threads dllimport tensorflowlibrary private static extern unsafe tfliteinterpreteroptions tfliteinterpreteroptionsadddelegate tfliteinterpreteroptions options tflitedelegate delegate dllimport tensorflowlibrary private static extern unsafe tfliteinterpreter tfliteinterpretercreate tflitemodel model namespace tensorflowlite dllimport tensorflowlibrary private static extern uint tflitetensor tensor dllimport tensorflowlibrary private static extern unsafe intptr tflitetensor tensor dllimport tensorflowlibrary private static extern unsafe intptr tflitetensor tensor ,remove native binding methods , fix a bug in the parser test piperorigin revid
3379,from google protobuf message import message as from tensorflow python util import tf inspect a regular expression capturing a python a regular expression capturing a python identifier identifier re ' a za z a za z0 9 ' class parts self keyword ' n' parts append self header for key value in self items parts append ' ' key ' ' parts append ' ' key ' ' parts append value return '' join parts def parse function details docstring pairs list gen pairs parts 1 function details item re re compile r' w ' re multiline item re re compile r' w s s' re multiline for keyword content in pairs content item re split content ,fix docs parser to handle keras docs most keras files use space indentation for the args raises returns block these were rendering as code cells on the website switched the doc parser to allow to spaces piperorigin revid , fix a bug in the file file
3380,retry unlock rec lock if syscalls todo if shm total syscalls done syscalls todo if shm stats total syscalls done syscalls todo shm exit reason exit reached count ,move statistics out to separate structure , fix a bug in the watchdog page
3381,void runcudnnbatchnormforwardinferenceimpl saved mean nullptr saved inv var nullptr is training false var to inv var nullptr inv var to var nullptr reserve space allocator nullptr workspace allocator nullptr void runcudnnbatchnormforwardtrainingimpl saved mean params output mean saved inv var params output inv stddev is training true var to inv var nullptr inv var to var nullptr reserve space allocator nullptr workspace allocator nullptr ,remove vestigial code from cudnn in stream executor piperorigin revid change id , fix a bug in the new delegate test piperorigin revid
3382,register op output handle variant attr n int 2 attr num experiments int attr output types list type 1 attr output shapes list shape 1 setshapefn shape inference scalarshape register op ,tf data add output types and output shapes attr to piperorigin revid , fix a bug in the test case piperorigin revid
3383,def convert tf2 model flags model keras models load model flags keras model file converter lite tfliteconverterv2 from keras model model if flags experimental new converter converter experimental new converter true todo b 145312675 enable the new converter by default it requires to add a new command line argument like experimental legacy converter converter experimental new converter flags experimental new converter convert the model tflite model converter convert ,tflite convert always propagate the experimental new converter flag this is a non functional change for now because the new converter is disblaed by default the change is for smoothening the flow when we enable it in the future piperorigin revid change id , fix a bug in the docstring of the docstring of the docstring change
3384,public the terminator in their custom syntax for class moduleterminatorop public op moduleterminatorop optrait zerooperands optrait zeroresult optrait isterminator optrait hasparent moduleop impl optrait isterminator public using op op static stringref getoperationname return module terminator static void build builder operationstate logicalresult verify ,nfc simplify by using the hasparent trait piperorigin revid , fix a bug in the parser test piperorigin revid
3385,class convpowervr public gpuoperation tuningtype tuning type const deviceinfo device info const kernelinfo kernel info std vector int3 work groups const override absl status bindarguments override absl status bindarguments argumentsbinder args override int3 getgridsize const override convweightsdescription getconvweightsdescription const ,signature of bindarguments changed to use argument instead of class member piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id icccbcbdbcfaadbee
3386,tfl interpreter tfl newinterpreter tfl interpreteroptions kdefaultnumthreads interpreter setnumthreads optional options num threads for auto delegate optional options delegates if interpreter modifygraphwithdelegate delegate ktfliteok return nullptr return new tfl interpreter model impl std move optional error reporter ,add delegate support to external c api add tfl to allow delegate injection during interpreter creation piperorigin revid , add support for int ops piperorigin revid
3387,enc alias table unix idx euc jp idx euc jp shift idx idx sun idx euc kr idx euc kr sun ks c idx euc cn ,updated for version problem sun locale is not solution add in the table , patch problem when using a terminal window is a bit solution add a few more tests to the new code
3388,vim isidc c int vim iswordc c int c return vim iswordc buf c curbuf int vim iswordc buf c buf intc buf t buf ifdef feat mbyte if c 0x100 vim iswordc c return utf class c 2 endif return c 0 c 0x100 get chartab curbuf c 0 return c 0 c 0x100 get chartab buf c 0 vim iswordp p if defined feat syn hl defined proto int vim iswordc buf p buf vim iswordp buf p buf char u p buf t buf ,updated for version problem ml get error when searching caused by curwin not matching curbuf solution avoid changing curbuf lech lorens , patch problem when using a terminal window is a bit slow solution add a test for the command line
3389,def gather params a tensor has the same type as params del validate indices if compat forward compatible 2019 6 10 if compat forward compatible 2019 7 10 if axis is none axis batch dims if axis 0 ,delay the tf gather using the batch dims enabled c kernel piperorigin revid , tf data fix a bug in the graph piperorigin revid
3390,invoke callback channel t channel char u callback typval t argv call func callback int strlen callback rettv 2 argv 0l 0l dummy true null clear tv rettv if an echo command was used the cursor needs to be put back where it belongs setcursor ,patch problem the job exit callback is not implemented solution add the exit cb option , patch problem when using a terminal window is a bit slow solution add a test for the command line
3391,find match int lookfor linenr t ourscope int get expr indent void intindent intindent 1 char u inde copy pos tsave pos colnr tsave curswant ,patch warning for uninitialized variable problem warning for uninitialized variable john marriott solution initialize indent , patch problem when using a terminal window is a bit slow solution add a test for the gui
3392,class singlesequenceexampleparserop public opkernel register kernel builder name device device cpu singlesequenceexampleparserop ifndef is mobile platform when using lite protos on mobile decoding json is not available class public opkernel public explicit opkernelconstruction ctx opkernel ctx class public opkernel register kernel builder name device device cpu endif namespace tensorflow ,exclude json parsing from android all ops change , fix a bug in the test case piperorigin revid
3393,class kerneldefbuilder required specify the type of device this kernel supports returns this kerneldefbuilder device const char device type kerneldefbuilder device devicetype device type specify that this kernel supports a limited set of values for a particular type or list type attr a further restriction than ,delete stray commented line piperorigin revid change id , fix a bug in the test piperorigin revid
3394,static char features static int included patches add new patch number below this line 71 70 ,patch memory test often fails on cirrus ci problem memory test often fails on cirrus ci solution allow for more tolerance in the upper limit remove sleep , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3395,tensorflow gtl mutablearrayslice half literal half support in protobuf auto values mutable f16s return tensorflow gtl mutablearrayslice half reinterpret cast half values 0 values size sizeof half reinterpret cast half values 0 values size template ,xla fix f implementation in literal class piperorigin revid , xla python add a test for the xla cpu backend piperorigin revid
3396,void appendmarkforcompilationpassflagsinternal std vector flag flag list maximum number of operators in an xla compilation flag tf xla supported ops mark for compilation flags tf xla supported ops experimental limit the operations clustered by xla to these operations if multiple separate them with commas shortcuts pw all point wise operations void appendmarkforcompilationpassflagsinternal std vector flag flag list lrn lrngrad bn tf fusedbatchnorm operations fusible all tf operations that xla can fuse all the above you can also put any tf operation name you can also put any tf operation name e g 'fusible matmul' flag tf xla clustering debug mark for compilation flags tf xla clustering debug dump graphs during xla compilation ,better documentation of the new parameter , xla python fix a bug in the test piperorigin revid
3397,boost auto test case template test arithmetic relations t test types polynomial t const b d1a begin d1a end boost check equal a t 2 a a boost check equal a b b a note the following tests fail for int but pass for double boost check equal a 0 5 a 2 0 boost check equal a a a a boost check equal a a a a boost check equal a b b a ,make an explicit note of which unit tests currently fail , fix a bug in the parser test for the new parser test
3398,dt update dtrace hdl t dtp const char line define var x strncmp var x strlen x 0 if strcmp sym name per cpu start 0 strcmp sym name per cpu end 0 strcmp sym name per cpu user mapped start 0 strcmp sym name per cpu user mapped end 0 strcmp sym name stack union 0 sym name crc sym name ,dtrace eliminate new related spurious symbol at address these symbols crept in as a consequence of the patches they the userspace page table per cpu region orabug signed off by nick alcock nick alcock oracle com , fix a bug in the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
3399,class multideviceiterator object ds self create device dataset i reset the device iterator resources with the new dataset ds variant ds variant tensor gen dataset ops make iterator ds variant self device iterators i resource gen dataset ops make iterator ds variant self device iterators i iterator resource property def element structure self ,making get next as optional work in eager mode and ensuring test coverage for that as well piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3400,class hlocustomcallinstruction public hloinstruction hlocomputation to apply absl string view custom call target string opaque constructor for a custom call with multiple computations hlocustomcallinstruction const shape shape absl span hloinstruction const operands absl span hlocomputation const called computations absl string view custom call target string opaque const window window const override check window nullptr return window ,support multiple computations in custom call piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id iffcbbabfbaeecaeaa
3401,static int open socket unsigned int domain unsigned int type unsigned int prot nr sockets if nr sockets nr socket fds goto skip bind sometimes listen on created sockets if rand bool int ret one 1 ,if we've filled the socket array don't try to bind another fd , make the syscall page we can be a child process
3402,from tensorflow python platform import gfile from tensorflow python platform import test def teardownmodule gfile deleterecursively test get temp dir class test util tensorflowtestcase def self ,fix flaky tests change , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3403,forward binop xor forward binop shiftleft forward binop shiftrightarithmetic forward binop shiftrightlogical forward binop atan2 forward binop pow forward unop not forward unop abs forward unop exp forward unop sign forward unop cos forward unop sin forward unop tanh forward unop sqrt forward unop square forward binop pow forward unop isfinite forward unop reciprocal forward unop neg forward unop sort forward unop sqrt forward unop rsqrt forward unop square forward unop reciprocal forward unop erfc forward unop erf forward unop erfinv forward unop lgamma forward unop digamma forward unop acos forward unop asin forward unop atan forward unop tan forward unop acosh forward unop asinh forward unop atanh forward unop cosh forward unop sinh undef forward undef forward unop ,xla add xla math library primitives to local python client piperorigin revid , xla python fix for the compiler warning in the compiler warning piperorigin revid
3404,xla test f simple xla errorspec 1e 4 xla test f xla xlabuilder builder testname xla array2d float a vals 4 6 8 10 4 39 62 73 0 0 146 166 4 6 8 320 float expected 15 xla xlaop a auto a data creater2parameter float a vals 0 a builder a xla logdet a computeandcomparer0 float builder expected a data get xla errorspec 1e 4 xla test f xla xlabuilder builder testname ,xla client make logdet work for non positive definite matrices by transforming the matrix with multiplication by its conjugate transpose piperorigin revid change id , xla gpu support for the xla client piperorigin revid
3405,def batch reduce destination x creating default strategy singleton false class strategyv1 def init self if not creating default strategy singleton raise runtimeerror should only create a single instance of defaultdistributionstrategy super self init defaultdistributionextended self def deepcopy self memo del memo raise runtimeerror should only create a single instance of defaultdistributionstrategy class defaultdistributionstrategy strategy class defaultdistributionstrategy strategyv1 def init self ,make a v default strategy piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
3406,class layer base layer layer use resource use resource or self use resource variables or scope use resource if initializer is none initializer scope initializer variable super layer self add weight name shape dtype dtypes as dtype dtype initializer initializer or scope initializer initializer initializer trainable trainable constraint constraint partitioner partitioner ,initializer might be a tensor so do not try to convert it to a boolean piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
3407,class dartgenerator public basegenerator auto code code ptr if indent code indent for auto it dc begin it dc end it if indent code indent class dartgenerator public basegenerator std string type name field value type struct def defined namespace field false gendoccomment field doc comment code gendoccomment field doc comment code code type name get field name if field value type base type base type union ,fix multi line comments for cpp enums fix csharp comments generation fix python comments generation fix lua comments generation fix php comments generation fix dart comments generation add brief description of color enum add multi line comments to the monster color , fix a bug in the parser test piperorigin revid
3408,t legendre imp unsigned l t x const policy pol bool second false template class t class policy t legendre p prime imp unsigned l t x const policy pol t pn nullptr if l 0 static const char function boost math p prime 1 unsigned 1 error handling if x 1 x 1 return policies raise domain error t function the legendre polynomial is defined for 1 x 1 but got x 1 x pol if l 0 if pn ,hook up concept checks for legendre p prime fix errors from above add domain error handling to the function , fix a bug in the previous commit
3409,void test spots t static cast t 1 static cast t 0 static cast t 0 tolerance bug cases from boost check close boost math beta static cast t 2 static cast t 24 ldexp static cast t 1 52 static cast t 2 32l tolerance boost check close boost math ibeta static cast t 2 static cast t 24 ldexp static cast t 1 52 static cast t 1 tolerance ,incomplete beta fix corner cases identified by rocco romeo , fix a bug in the parser test for the new parser test
3410,static char features static int included patches add new patch number below this line 627 626 ,patch python cannot handle function name of script local function problem python cannot handle function name of script local function solution use snr instead of the special byte code ozaki kiichi closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3411,ex startinsert exarg t eap curwin w cursor lnum 1 set cursor for append to line ifdef feat terminal ignore this when running in an active terminal if term job running curbuf b term return endif ignore the command when already in insert mode inserting an expression register that invokes a function can do this ,patch startinsert in a terminal window used later problem startinsert in a terminal window used later solution ignore startinsert in a terminal window closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
3412,limitations under the license namespace xla localclientoptions localclientoptions perftools gputools platform platform int number of replicas int intra op parallelism threads platform platform number of replicas number of replicas intra op parallelism threads intra op parallelism threads localclientoptions localclientoptions set platform perftools gputools platform platform platform platform ,xla remove replica count setting flag piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3413,expandfromcontext expand commands get command name false true expand behave get behave arg true true expand messages get messages arg true true ifdef feat cmdhist expand history get history arg true true endif ,patch problem no completion for messages solution complete clear argument hirohito higashi , patch problem when using a terminal window is a bit slow solution add a test for the gui
3414,tfop parsetfopfullname absl string view tf op fullname tf op category parts 0 parts 1 else if isjaxoptype parts 1 tf op category parts 0 parts 1 else if parts 1 empty tf op name parts 0 remove trailing ' ' return tf op ,handle trailing ' ' in piperorigin revid change id , xla python add a test for the xla client client piperorigin revid
3415,class tfliteconverterbasev2 tfliteconverterbase we only support integer types for post training integer quantization as we have statistical information to quantize the input and output if quant mode is post training integer quantize all types default types constants int8 constants int16 constants quantized uint8 all types default types constants int8 constants quantized uint8 constants int16 if self inference input type not in all types or self inference output type not in all types all types names tf t name for t in all types ,addressed reviewer's comments change id , fix a bug in the test case piperorigin revid
3416,def where condition x none y none name none raise valueerror x and y must both be non none or both be none tf export v1 where v2 v2 where def where v2 condition x none y none name none return the elements either from x or y depending on the condition if both x and y are none then this operation returns the coordinates of ,expose where v as v where v v where signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the test case piperorigin revid
3417,status instantiatefunctionfortest const string name return status ok std unordered map string node buildnodeindex const graph graph std unordered map string node index for node node graph nodes index node name node return index namespace tensorflow ,graph optimization pass that creates xlalaunch ops for the computations that have been explicitly marked to be compiled via xla compile piperorigin revid , xla python fix a bug in the graph piperorigin revid
3418,class xlasortop public xlaopkernel explicit xlasortop opkernelconstruction context xlaopkernel context void compile xlaopkernelcontext context override context setoutput 0 xla sort context input 0 context setoutput 0 xla sort context input input register xla op name xlasort xlasortop class xlakeyvaluesortop public xlaopkernel public explicit xlakeyvaluesortop opkernelconstruction context xlaopkernel context void compile xlaopkernelcontext context override xla xlaop result xla sort context input keys context input values context setoutput 0 xla gettupleelement result 0 context setoutput 1 xla gettupleelement result 1 register xla op name xlakeyvaluesort xlakeyvaluesortop namespace namespace tensorflow ,update xlasort to match the underlying hlo piperorigin revid , xla gpu support for the xla client piperorigin revid change id id icccbcbdbcfaadbee
3419,globpath path file expand options copy option part path buf maxpathl if strlen buf strlen file 2 maxpathl ifdef win3264 if defined mswin defined msdos using the platform's path separator makes vim incorrectly treat it as an escape character use ' ' instead if buf nul after pathsep buf buf strlen buf ,make find completion work better with the build nazri ramliy , patch problem when using a popup window with a terminal window solution add the option to the current line
3420,class datasetopstestbase public testing test creates a new tensorslicedataset op kernel status createtensorslicedatasetkernel stringpiece node name datatypevector dtypes std vector partialtensorshape shapes const stringpiece node name const datatypevector dtypes const std vector partialtensorshape shapes std unique ptr opkernel tensor dataset kernel creates a new tensorslicedataset status createtensorslicedataset stringpiece node name std vector tensor components status createtensorslicedataset const stringpiece node name std vector tensor components datasetbase tensor slice data fetches the dataset from the operation context ,change some function params to be const reference , fix a bug in the test case piperorigin revid
3421,qf msg qf info t qi int which char lead if title null while strlen buf 34 strcat buf vim strcat buf title iosize size tlen strlen buf if len 34 vim memset buf len ' ' 34 len buf 34 nul vim strcat buf char u title iosize trunc string buf buf columns 1 iosize msg buf ,patch problem compiler warning for char char u conversion tony mechelynck inefficient code solution use more lines to fill with spaces nikolai pavlov add type cast , patch problem when using a terminal window is a bit slow solution add a test for the gui
3422,bool propagatearraydatatypes run model model std size t op index case operatortype kgreaterequal case operatortype kequal case operatortype case operatortype kany case operatortype klogicaland case operatortype these operators unconditionally produce bool outputs setdatatypeforalloutputs model op arraydatatype kbool break ,import export support for any and ops piperorigin revid , fix a bug in the graph piperorigin revid
3423,static char features static int included patches add new patch number below this line ,patch vim readdir expression doesn't accept bool problem vim readdir expression doesn't accept bool solution merge with code for readdirex closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3424,class unaryopstest xla test xlatestcase np array 1 2 dtype dtype expected np array 0 540297 0 41614 dtype dtype confirm that log1p will remain precise across a range of small values self assertopoutputmatchesexpected math ops log1p np array 1e 14 1e 15 0 6 dtype dtype expected np log1p np array 1e 14 1e 15 0 6 dtype dtype astype dtype rtol 1e 4 atol 1e 6 np array 1e 14 1e 15 0 6 2 x 1e 5 for x in range 1 20 dtype dtype expected np log1p np array 1e 14 1e 15 0 6 2 x 1e 5 for x in range 1 20 dtype dtype astype dtype rtol 1e 15 if dtype np float64 else 1e 4 atol 1e 15 if dtype np float64 else 1e 4 self assertopoutputmatchesexpected math ops rint ,improve precision of logp in the range e e piperorigin revid change id , xla gpu support for the xla client piperorigin revid
3425,class grpceagerclientcache public eagerclientcache int assigned index target grpceagerclientthread thread threads assigned index get auto worker new grpceagerclient shared thread it clients emplace target worker first core refcountptr eagerclient worker new grpceagerclient shared thread it clients emplace target std move worker first it second ref ,fix kokoro build piperorigin revid change id , xla python fix a bug in the new implementation of the new implementation of the tf data service piperorigin revid change id iecadcdfcfeceeb
3426,static logicalresult type type1 type type2 check unranked tensor cases if type1 isa unrankedtensortype type2 isa unrankedtensortype return failure return success check normal vector tensor cases if auto type1 dyn cast shapedtype ,don't fail verifying unranked shapes as being the same as this could be valid at runtime tensor xf could be a tensor xf at runtime but this would return failure and say function is invalid piperorigin revid , fix a bug in the toy tutorial piperorigin revid change id icfcccdcbedbaacf
3427,limitations under the license include tensorflow core framework register types h include tensorflow core kernels fill functor h this header file is part of mkl ml need equivalent file in mkl dnn ifndef do not use ml include mkl cblas h else class mklmatmulop public opkernel int index transa transa 1 0 int index transb transb 1 0 vlog 2 mkl dnn sgemm called using the api of mkldnn since tf is in row major layout reversing the order of a and b mkl dnn only supports the api and requires column major while tensorflow uses row major so we reverse the order a and b mkldnn sgemm index transb index transa n m k alpha b ldb a lda beta c ldc else mkl ml binary uses cblas api cblas sgemm cblasrowmajor transa cblastrans cblasnotrans transb cblastrans cblasnotrans m n k alpha a lda b ldb beta c ldc ,updated based on github comments , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3428,class funcgraph ops graph if ops use c shapes if isinstance tensor ops eagertensor handle data tensor handle data if handle data handle data handle data serializetostring else handle data c api tensor graph c graph tensor as tf output ,more handle data fixing i'm not sure why our existing tests didn't catch this piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
3429,static status compiletolocalexecutable tf return if error rm lookuporcreate xlacompilationcache rm default container xla cache cache xlacompilationcache cache return ctx platform info cache return ctx device platform info cache hold the reference to the jit during evaluation we could probably free it because the resourcemgr will retain a reference but ,tfxla nfc simplify piperorigin revid change id , xla python fix a bug in the graph piperorigin revid
3430,class variablescopetest test testcase w variable scope get variable w self assertequal w dtype base dtype dtypes float16 def self with context eager mode store variable scope eagervariablestore with store as default v variable scope get variable v shape trainable true w variable scope get variable w shape trainable false self asserttrue v in store variables self asserttrue w in store variables self asserttrue v in store trainable variables self assertfalse w in store trainable variables test util run in graph and eager modes def testinitfromnontensorvalue self v variable scope get variable v4 initializer 4 dtype dtypes int32 ,eagervariablestore trainable variables piperorigin revid , fix a bug in the docstring of the docstring of the test case piperorigin revid
3431,static char features static int included patches add new patch number below this line 2316 ,patch problem normal mode tests fail on ms windows solution do some tests only on unix set 'fileformat' to unix , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3432,class tensormap return tensors values size std vector tensor keys std vector tensor keys const std vector tensor keys keys reserve tensors values size absl flat hash map tensorkey tensor iterator it tensors values begin while it tensors values end keys push back it first keys push back dummy it return keys ,compiling listkeys op , fix a bug in the test case piperorigin revid
3433,class flatset std pair iterator bool insert const key k return insert k std pair iterator bool insert key k return insert std move k template typename inputiter void insert inputiter first inputiter last for first last first class flatset std pair iterator bool insert const key k template typename k std pair iterator bool insert k k rep auto r rep k auto r rep std forward k k const bool inserted r found return iterator r b rep limit r index inserted ,add missing flatset insert key overload piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3434,static const char get proto name unsigned int family unsigned int proto const struct protocol netlink proto netlink route netlink route netlink unused netlink unused netlink netlink netlink netlink ,add missing netlink route decoding , patch problem when using a terminal window doesn't work solution add a test for the mouse event
3435,namespace tensorflow using quantilestream core boosted trees quantiles weightedquantilesstream float float boosted trees quantiles weightedquantilesstream float float quantile stream resource for a list of streams sharing the same number of quantiles maximum elements and epsilon ,change the namespace for core boosted trees quantiles piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id iefecfafdafabefecbd
3436,retry tasksize end we already check for overlap in do mremap asmlinkage long sys splice int fd in loff t user off in int fd out loff t user off out size t len unsigned int flags len must be 0 fdin fdout must be file handles void sanitise splice unsigned long a1 unused unsigned long a2 unsigned long a3 unused unsigned long a4 unused unsigned long a5 unused unsigned long a6 first param is fdin a1 get random fd third param is fdout a3 get random fd asmlinkage long sys sync file range int fd loff t offset loff t nbytes unsigned int flags ,fd is provided generically , patch problem when using a popup window with a popup window solution add the option to the right window
3437,showmatches expand t xp int wildmenu unused got int false only int the completion not the cmd line ifdef feat wildmenu else if wildmenu win redr status matches xp num files files found 0 showtail win redr status matches xp num files files found 1 showtail endif else ,patch highlight wrong text when includes longest problem when is set and 'wildmode' has longest then the first file name is highlighted even though the text shows the longest match solution do not highlight the first match lemonboy closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
3438,do check cursorbind void ifdef feat diff if curwin w p diff curwin w cursor lnum diff get corresponding line old curbuf line curbuf curwin w cursor lnum curwin w cursor lnum diff get corresponding line old curbuf line else endif curwin w cursor lnum line ,patch problem in diff mode the cursor may end up below the last line resulting in an ml get error solution check the line to be valid , patch problem when using a terminal window is a bit slow solution add a test for the gui
3439,luav window newindex lua state l luav checksandbox l endif w w cursor col v 1 w w set curswant true update screen valid else if strncmp s width 5 0 ,patch preferred cursor column not set in interfaces problem preferred cursor column not set in interfaces solution set w set curswant when setting the cursor david closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
3440,utf char2cells int c 0x20000 static convertstruct toupper 1 64 1 32 return the upper case equivalent of a which is a ucs 4 character use simple case folding ,patch problem unicode table for double width is outdated solution update to the latest unicode standard , patch problem when using a terminal window doesn't work solution add a test for the cursor
3441,class autocastvariabletest test testcase parameterized testcase self assertallclose 3 self evaluate x assign sub 3 assign multiple times this currently only works if no strategy is used if not ds context has strategy assign x assign 1 self assertallclose 1 self evaluate assign ,add comment about ignoring distributed multi assignment , fix a bug in the documentation of the test case piperorigin revid
3442,read viminfo up to marks virp forceit writing buf t buf ifdef feat cmdhist prepare viminfo history forceit 9999 0 prepare viminfo history forceit 9999 0 writing endif eof viminfo readline virp while eof virp vir line 0 ' ' read viminfo up to marks virp forceit writing case ' ' case ' ' ifdef feat cmdhist eof read viminfo history virp eof read viminfo history virp writing else eof viminfo readline virp endif read viminfo up to marks virp forceit writing ifdef feat cmdhist finish reading history items finish viminfo history if writing finish viminfo history endif change file names to buffer numbers for fmarks ,updated for version problem still problems for viminfo history solution do not merge lines when writing don't write old viminfo lines , patch problem when using a terminal window is a bit slow solution add a test for the command line
3443,class parallelinterleavedatasetop dataset public datasetbase thread pool schedule this if ctx stats aggregator thread pool schedule this threads initialized true class parallelinterleavedatasetop dataset public datasetbase l std chrono milliseconds if cancelled break return num current active workers num current active workers num current workers num current workers ,wait for the stats thread to terminate in interleave destructor piperorigin revid change id , fix a bug in the test case piperorigin revid
3444,class devicememoryallocator a stream or do we have to wait for the computation to complete first virtual bool allowsasynchronousdeallocation const return false returns nullable stream pointer if the pointer is non null then it is always safe to access the memory allocated by the allocator on the returned stream this condition is not required though as streams could be synchronized by other means todo cheshire clean up the interface it might be cleaner to explicitly pass the stream to compiler virtual stream getstream const return nullptr protected const platform platform ,xla propagate the tf stream to the xla compiler via the allocator gpu bfc allocator xla gets from tf should only be used on a main tf stream otherwise data races are possible xla needs access to this stream during the compilation otherwise data races are possible piperorigin revid , fix a bug in the new delegate piperorigin revid change id iadedefebebccbd
3445,class sparsecolumn def insert transformed feature self columns to tensors sparse id values string ops string to hash bucket sparse id values string ops string to hash bucket fast columns to tensors self name values self bucket size name self name lookup ,update feature column to use string to hash bucket fast instead of the deprecated and not stable string to hash bucket change , fix a bug in the docstring of the docstring of the test case piperorigin revid
3446,statusor std unique ptr executable runbackend vlog 1 run backend hlo module name tf return if error hlo module get typically you would visit the hlo graph building up a compiled equivalent in this case we are using an hloevaluator at execution time so we don't need to compile anything ,xla remove the extra in runbackend piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3447,limitations under the license ifndef tensorflow framework dataset h define tensorflow framework dataset h include tensorflow core lib core status h namespace tensorflow namespace dataset registry for stateful ops that need to be used in dataset functions ,whitelisting stateful op for dataset checkpointing temporarily piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3448,class hlomodulegroupmetadata tracks the instruction mapped to a given computation and the computation class hlomodulegroupmetadata status hloinstruction hloinstruction checks whether a communicating instruction is placed in a valid position within the graph status checkcommunicatinginstruction hloinstruction instruction const retrieves a pointer to the stored trackedinstruction associated with a tracked computation or nullptr in case such computation is not tracked const trackedinstruction gettrackedinstruction ,allow instructions within a kcall computation piperorigin revid , xla python python python python client piperorigin revid
3449,class keras parameterized testcase model layers input shape 10 x np ones 10 10 'float32' y np zeros 10 1 'float32' y np ones 10 1 'float32' optimizer rmspropoptimizer learning rate 0 001 model compile ,internal change piperorigin revid change id , fix a bug in the docstring of the keras model piperorigin revid
3450,channel close channel t channel int invoke close cb first invoke the close callback increment the refcount to avoid the channel being freed halfway channel ch refcount ch log channel invoking callbacks before closing for part part sock part part err part while may invoke callback channel part channel close on error channel t channel int part char func if channel ch part part ch mode mode raw channel ch part part ch mode mode nl channel save channel part char u detach msg raw channel save channel part out char u detach msg raw int strlen detach msg raw false put when reading from stdout is not possible assume the other side has ,patch problem test out close cb sometimes fails solution always write detach to out not err , patch problem when using a terminal window is a bit slow solution add a test for the command line
3451,public final class tensor return index nativehandle returns the name of the tensor within the owning link interpreter hide public string name return name nativehandle copies the contents of the provided code src object to the tensor public final class tensor private static native int index long handle private static native string name long handle static tensorflowlite init ,add name function in tensor class piperorigin revid , fix a bug in the parser api piperorigin revid
3452,static attribute foldslice sliceop op i values opfoldresult sliceop fold arrayref attribute operands check if the sliceop is a noop operation auto operand shape getoperand gettype cast shapedtype getshape auto operand type getoperand gettype cast shapedtype auto result type getresult gettype cast shapedtype auto result shape result type getshape if result type hasstaticshape operand shape result shape if operand type hasstaticshape result type hasstaticshape operand type getshape result type getshape return getoperand ,fix mhlo sliceop fold to not crash on unknown shapes piperorigin revid change id , xla gpu support for the hlo backend piperorigin revid change id iaaffafbceeeafc
3453,include sys mman h include sys types h include sys stat h include trinity h page size include arch h include maps h include log h ,shm h cleanup split exit stuff from trinity h out to separate file , dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
3454,statusor xlaop mlirhlobuilder return makexlaop op statusor xlaop mlirhlobuilder const shape shape xlaop operand xlaop val int64 dimension tf assign or return mlir type ty convertshapetotype mlir rankedtensortype shape builder auto op builder create mlir mhlo loc ty getvalue operand getvalue val builder geti64integerattr dimension return makexlaop op statusor xlaop mlirhlobuilder rngopinternal randomdistribution distribution absl span const xlaop parameters const shape shape ,enable fallback legalization for op override in hlomlirbuilder piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id iadbdbdeeebea
3455,eval vars buf t buf intvalid valid head valid path assume valid result inttilde file false idx ifdef feat modify fname inttilde file false intskip mod false endif char 30 eval vars else result curbuf b fname ifdef feat modify fname tilde file strcmp result 0 endif break eval vars else result buf b fname ifdef feat modify fname tilde file strcmp result 0 endif break ,patch compiler warning for variable set but not used problem compiler warning for variable set but not used solution move tilde file inside ifdef hirohito higashi closes , patch problem when using a terminal window is a bit slow solution add a test for the command line
3456,inline int int num dims tensorformat format note the vect w is not counted as an independent spatial dim here since it just a component of the width dimension return num dims 3 exclude n c default log fatal unknown format format return 1 avoid compiler warning about missing return value inline int gettensordimsfromspatialdims int num spatial dims case format nchw vect c case format nhwc vect w return num spatial dims 3 include n c default log fatal unknown format format return 1 avoid compiler warning about missing return value ,compilation warnings removed from tensor format h removed compilation warnings , fix a bug in the parser test piperorigin revid
3457,class deffunctiontest test testcase concrete compute get concrete function tensor spec tensorspec none dtypes float32 self assertallclose 4 concrete constant op constant 2 input signature compute cached input signatures input signature concrete structured input signature self assertequal tuple input signature tensor spec tensorspec none dtypes float32 class deffunctiontest test testcase f constant op constant 3 4 constant op constant 2 f constant op constant 3 4 5 constant op constant 2 concrete functions f list all concrete functions for serialization signatures for serialization c structured input signature 0 for c in concrete functions self assertequal set f cached input signatures set signatures for serialization set tensor spec tensorspec 1 2 dtypes float32 tensor spec tensorspec 1 dtypes float32 tensor spec tensorspec 1 3 dtypes int32 ,refactoring get signature directly from concrete function we can do this now because signature is stored on the function and it will clean the list all concrete functions return value piperorigin revid , fix a bug in the test case piperorigin revid
3458,from future import print function import numpy as np from tensorflow contrib tensorrt python import trt convert from tensorflow contrib tensorrt test import tf trt integration test base as trt test from tensorflow python compiler tensorrt import trt convert from tensorflow python compiler tensorrt test import tf trt integration test base as trt test from tensorflow python framework import constant op from tensorflow python framework import dtypes from tensorflow python framework import ops ,move tf trt python apis to python compiler tensorrt piperorigin revid , fix a bug in the test case piperorigin revid
3459,ifdef undef endif ifdef ngettext undef ngettext endif ifdef n undef n endif ,patch build error on problem build error on with small features and gnome solution undefine ngettext hirohito higashi , patch problem when using a terminal window is a bit solution add a few more tests to the new code
3460,def load data dirname 10 batches py' origin 'https www cs edu kriz cifar 10 python tar gz' path get file dirname origin origin untar true path get file dirname origin origin untar true file hash num train samples 50000 ,updating urls and of some piperorigin revid , fix a bug in the docstring of the docstring of the new api change
3461,checkederror parser parsefield structdef struct def if token ' ' next if isscalar type base type return error default values currently only supported for scalars if isscalar type base type struct def fixed return error default values currently only supported for scalars in tables echeck parsesinglevalue field value if isfloat field value type base type ,disallow defaults on structs change id context https github com google flatbuffers issues tested on linux , fix a bug in the parser test piperorigin revid
3462,class dataset object the elements generated by generator must be compatible with the given output types and optional output shapes arguments for example python import itertools def gen for i in itertools count 1 yield i 1 i ds dataset from generator gen tf int64 tf int64 tf tensorshape tf tensorshape none value ds make one shot iterator get next sess run value 1 array 1 sess run value 2 array 1 1 args generator a callable object that takes no arguments and returns an object that supports the iter protocol ,delete tf contrib training python input it has been replaced by tf contrib data dataset from generator piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3463,from future import absolute import from future import division from future import print function from tensorflow contrib framework import deprecated from tensorflow python framework import dtypes from tensorflow python ops import array ops as array ops from tensorflow python ops import math ops deprecated '2016 12 01' 'use tf one hot instead ' def one hot matrix tensor in num classes on value 1 0 off value 0 0 encodes indices from given tensor as one hot tensor ,add deprecation notices on learn ops with suggested replacements change , fix a bug in the test case piperorigin revid
3464,void const ptr absl string view name if we failed reset cuda error status to avoid cuda streams if err cudasuccess cudagetlasterror bool points to host memory err cudaerrorinvalidvalue attributes memorytype cudamemorytypedevice attributes type cudamemorytypedevice check eq is host ptr points to host memory absl streamformat s pointer is not actually on s p name is host ptr cpu gpu reinterpret cast const void ptr ,fixed cuda runtime deprecation warning in cuda attribute is deprecated in of type , xla gpu support for the xla client piperorigin revid change id id idfbdfbcdacfbeebb
3465,void fabricate onepage struct char page void regenerate random page void unsigned int i unsigned int type rand 3 sometimes return a page that looks kinda like a struct if rand 100 50 fabricate onepage struct page rand return unsigned int type rand 4 the rest of the time return a page of complete trash switch type void regenerate random page void page rand i unsigned char rand return case 3 sometimes return a page that looks kinda like a struct fabricate onepage struct page rand return default bug unreachable n return ,clean up the page rand some , fix a bug in the syscall page
3466,class session run hook sessionrunhook class tpuestimator estimator lib estimator def init self model fn none model dir none class tpuestimator estimator lib estimator params none use tpu true if use tpu if not isinstance config tpu config runconfig raise valueerror ' config must be tpu config runconfig ' model function wrapped model fn model fn config else model function model fn super tpuestimator self init model fn model function model dir model dir config config params params if not isinstance config tpu config runconfig raise valueerror ' config must be tpu config runconfig ' def create global step self graph creates a global step suitable for tpus ,moved tpu config runconfig check to inside of use tpu block , fix a bug in the docstring of the test piperorigin revid
3467,interpreter tflitedelegateptr creategpudelegate return interpreter tflitedelegateptr tflitegpudelegatecreate options tflitegpudelegatedelete endif defined android interpreter tflitedelegateptr creatennapidelegate return interpreter tflitedelegateptr interpreter tflitedelegateptr creatennapidelegate tflitedelegate endif defined android namespace void profilinglistener tflite interpreter interpreter benchmarktflitemodel tflitedelegateptrmap benchmarktflitemodel getdelegates endif if params get bool use nnapi if defined android delegates emplace nnapi creatennapidelegate else tflite log warn nnapi acceleration is unsupported on this platform endif return delegates ,disable nnapi support for non android benchmark platforms piperorigin revid , xla gpu support for the layout interface piperorigin revid change id idacdededdbdcfbcdb
3468,class converter std unordered map string trt tensororweights trt tensors the trt builder used to create the network and build the engine not owned nvinfer1 ibuilder trt builder trtuniqueptrtype nvinfer1 ibuilder trt builder the trt network being built trtuniqueptrtype nvinfer1 inetworkdefinition trt network ,move builder to converter class , fix a bug in the test case piperorigin revid
3469,class typedef typename internal stlcontainerview rawcontainer type value type element const matcher const element matchers matchercast const element e1 return makematcher new container matchers 1 nokia's symbian compiler has a nasty bug where the object put in a one element local array is not destructed when the array goes out of scope this leads to obvious badness as we've added the linked ptr in it to our other linked ptrs list hence we implement specially to avoid using a local array const matcher const element matcher matchercast const element e1 return makematcher new container matcher 1 private ,makes gmock work on symbian both rd th original patch contributed by mika raento , fix a bug in the new delegate piperorigin revid change id idacdededdbdcfbcdb
3470,def check penalty number x if not isinstance x float int raise valueerror value is not a valid regularization penalty number expected an int or float value format x value is not a valid regularization penalty number expected an int or float value format x if math isinf x or math isnan x raise valueerror value is not a valid regularization penalty number a positive negative infinity or nan is not a property value format x value is not a valid regularization penalty number a positive negative infinity or nan is not a property value format x ,fix code style , fix a bug in the docstring of the docstring of the documentation of the example change
3471,class partitionedvariable object returns tensor containing the concatenated value if self as tensor is none be sure to cache the concatenated tensor to not do computations with ops control dependencies none self as tensor self concat return self as tensor with ops control dependencies none return self concat staticmethod def tensorconversionfunction v dtype none name none as ref false ,remove caching mechanism for as tensor call change , fix a bug in the docstring of the test piperorigin revid
3472,limitations under the license include tensorflow core profiler convert op metrics db combiner h include tensorflow core profiler protobuf hardware types pb h include tensorflow core profiler protobuf op stats pb h include tensorflow core profiler utils step interval h include tensorflow core profiler utils step intersection h namespace tensorflow namespace profiler void combinecoreidmap int src host id const coreidmap src coreidmap dst combine the src opstats into the dst opstats void combineopstats bool no accelerator in system int src host id hardwaretype hardware type stepinterval step intersection const opstats src opstats dst const stepintersection step intersection const opstats src opstats dst opmetricsdbcombiner host op metrics db combiner opmetricsdbcombiner device op metrics db combiner opmetricsdbcombiner hlo metrics db complete steps only combiner ,profiler combining steps across hosts by matching step times piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3473,class datasetv2 tracking base trackable composite tensor compositetensor if not callable generator raise typeerror generator must be callable if output types is none and output spec is none raise typeerror either output types or output spec must be specified if output spec is not none if output types is not none raise typeerror output types can not be used together with output spec if output shapes is not none raise typeerror output shapes can not be used together with output spec if not all isinstance type spec typespec for in nest flatten output spec raise typeerror all the elements of output spec must be a tf typespec objects else if output types is none and output shapes is not none raise typeerror output shapes can not be used alone without output types if output spec is none if output shapes is none ,verify correctness , fix a bug in the documentation of the test case piperorigin revid
3474,void grpcrpcfactory startcall const tensor address t const tensor method t get stub index completion queue get method ptr index call request call response done call const status s call done s call call opts nullptr threadpool fail fast timeout in ms nullptr threadpool fail fast timeout in ms 0 max retries namespace tensorflow ,tf grpc add rpc caching and retries for tf worker service adds rpc state tracking and caching to the tf grpc worker service and enables client side retrying of worker operations for recoverable errors piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id iefaaedbcfceefdda
3475,status graphproperties inferdynamically cluster cluster return inferfromcostgraph metadata cost graph status graphproperties annotateoutputshapes graphdef output graph def status graphproperties annotateoutputshapes graphdef output graph def const output graph def item graph for int i 0 i output graph def node size i auto node output graph def mutable node i ,refactor function optimize piperorigin revid , xla python add a test for the cpu backend piperorigin revid
3476,limitations under the license namespace tensorflow namespace boosted trees todo nponomareva consider using vector struct splitcandidate splitcandidate index in the list of the feature ids int64 feature idx 0 index in the tensor of node ids for the feature with idx feature idx int64 candidate idx 0 float gain 0 0 int32 threshold 0 0 int32 dimension id 0 float left node contrib 0 0 float right node contrib 0 0 the split type i e with missing value to left right string split type namespace boosted trees static bool const float g1 const float g2 const float 1e 15 return std abs g1 g2 ,enable equality split for piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3477,expand filename if n 2 ifdef unix only for unix we check for more than one file name for other systems spaces are considered to be part of the file name only check here if there is no wildcard otherwise expandone will check for errors this allows e ls ve c on unix if has wildcards for p eap arg p p skip escaped characters if p 1 p ' ' p ctrl v p else if vim iswhite p errormsgp char u only one file name allowed return fail endif halve the number of backslashes this is vi compatible for unix and os 2 when wildcards are expanded this is ,patch e is not actually useful problem e is not actually useful it's only on unix anyway solution remove the check and the error , patch problem when using a terminal window is a bit solution add a test for the cursor
3478,include boost config hpp include boost limits hpp include boost math tools precision hpp include boost math policies policy hpp include boost math special functions math fwd hpp inline boost math concepts std real concept tanh boost math concepts std r namespace std include boost math special functions round hpp include boost math special functions trunc hpp include boost math special functions modf hpp include boost math tools precision hpp namespace boost namespace math namespace concepts ,add some previously missing tests and fix up the remaining concept failures for the new distributions svn r , fix a bug in the new parser test svn r
3479,inline void lstmstephybrid tensor utils batchquantizefloats output gate scratch n batch n cell quantized cell state ptr scaling factors zero points asymmetric quantize inputs for int b 0 b n batch b scaling factors scratch b scaling factors b projection weights scale tensor utils matrixbatchvectormultiplyaccumulate projection weights ptr n output n cell quantized cell state ptr scaling factors scratch n batch output state ptr projection weights scale scaling factors n batch output state ptr per channel scale nullptr asymmetric quantize inputs zero points nullptr accum scratch ptr projection weights row sums compute row sums context projection weights row sums compute row sums scaling factors scratch context if params proj clip 0 0 tensor utils clipvector output state ptr n batch n output ,use the separate matrix vector scaling factor version of matrixbatchvectormultiplyaccumulate in projection too piperorigin revid change id , fix a bug in the parser test piperorigin revid
3480,static char features static int included patches add new patch number below this line 637 ,patch nsis file no longer used problem nsis file no longer used solution remove the file ken takata , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3481,except from distutils extension import extension define build constants build version 7 0 0 build version 7 1 0 dev setup extra link and compile args extralinkargs ,bump version to dev now that changes have been made from version , patch problem when using a terminal window is a bit solution add a test for the file
3482,class im2colconvfunctor int filter top offset if padding valid filter left offset output width 1 stride filter width input width 2 output width 1 stride filter width input width 1 2 filter top offset output height 1 stride filter height input height 2 output height 1 stride filter height input height 1 2 else filter left offset output width 1 stride filter width input width 2 ,fix filter position for imcol fixed the filter position for the reference class but the same problem exists in the imcol class this patch makes the calculation of the filter position consistent with the reference quantized class and the gemm fused conv ops classes , fix a bug in the test case piperorigin revid
3483,namespace boost else if q expm1 log1p dist success fraction trials if q boost math expm1 boost math log1p dist success fraction trials q cdf complement dist 0 pdf dist 0 return 0 so the only reasonable result is zero and root finder would fail otherwise ,added some boost math qualifiers to disambiguate between expm and boost math expm svn r , fix a bug in the previous commit
3484,import numpy as np from tensorflow python framework import dtypes from tensorflow python framework import errors from tensorflow python framework import ops from tensorflow python framework import test util from tensorflow python ops import array ops from tensorflow python ops import gen math ops class test util tensorflowtestcase def test negative self unsorted segment sum will only report invalidargumenterror on cpu with self cached session with self cached session ops device cpu 0 with self assertraises errors invalidargumenterror self evaluate math ops bincount 1 2 3 1 6 8 ,run bincount op test on gpus resolves piperorigin revid , tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3485,status algebraicsimplifiervisitor handlereduce hloinstruction hlo convert reduce dot x y to dot x y if any of the dimensions reduced were batch dimensions of the dot the transformation supports reducing other dimensions as well if match arg m dot dot m op lhs m op rhs if options enable dot strength reduction match arg m dot dot m op lhs m op rhs match reduce to apply root instruction m add m parameter m parameter absl c any of reduce dimensions int64 dim ,xla predicate reduce dot under enable dot strength reduction piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id iffcbbabfbaeecaeaa
3486,shapeinference inferdegeneratedimensionbroadcastshape hloopcode operation tf return if error expectarray rhs absl strcat rhs of binary operation hloopcodestring opcode switch opcode case hloopcode kadd case hloopcode kmaximum case hloopcode kminimum case hloopcode kmultiply return inferelementwisebinaryopshape opcode lhs rhs broadcast dimensions case hloopcode ksubtract case hloopcode kadd case hloopcode katan2 case hloopcode kpower case hloopcode kdivide case hloopcode kremainder case hloopcode kmultiply case hloopcode kshiftleft case hloopcode kshiftrightarithmetic case hloopcode kshiftrightlogical ,xla add mixed precision dot and convolution support to the hlo evaluator piperorigin revid change id , xla gpu support for xla hlo layout piperorigin revid change id iadedaeafbeab
3487,void const unsigned char obj bytes size t count namespace namespace internal2 namespace internal delegates to to print the bytes in the given object the delegation simplifies the implementation which void printbytesinobjectto const unsigned char obj bytes size t count obj bytes count os namespace internal2 namespace internal depending on the value of a char or wchar t we print it in one of three formats as is if it's a printable ascii e g 'a' '2' ' ' ,googletest export simplify the fallback printing logic to have a single sequence of printers piperorigin revid , fix a bug in the file page
3488,def make slice tests options 4 d with size 1 dtype tf float32 tf int32 tf int64 index type tf int32 tf int64 dtype tf float32 index type tf int32 input shape 4 4 4 4 begin 0 0 0 0 ,reduced slice test case to dtype float and index int , fix a bug in the docstring of the test case piperorigin revid
3489,void trtengineop compute opkernelcontext context std vector int trt shape dims nbdims 1 trt shape 0 num batch for int j 0 j dims nbdims j trt shape j 1 dims d j tensorshapeutils makeshape trt shape data trt shape size output shape op requires ok context tensorshapeutils makeshape trt shape data trt shape size output shape else log fatal output node not found at output nodes i break ,make build happy by adding missing op requires ok and if tensorrt , add support for int ops piperorigin revid
3490,class model network network set distributionstrategy specific parameters self distributed model cache if self distribution strategy is not none if not context executing eagerly and self distribution strategy is not none ensures a session is created and configured correctly for distribution strategy k configure and create distributed session self distribution strategy ,skip configuring the session in eager mode in keras piperorigin revid , update keras layers to keras piperorigin revid
3491,include sys epoll h include sys eventfd h include perf h include random h include shm h include files h include pids h include net h include log h include sanitise h include net h include params h include perf h include pids h include random h include sanitise h include shm h include trinity h pipe fd related functions static void open pipes void int get random fd void regen if shm fd lifetime 0 shm current fd get new random fd shm fd lifetime rand shm max children 5 shm fd lifetime rand max children 5 else shm fd lifetime ,max nr children doesn't need to be in the shm , proto zmalloc conversion
3492,static char features static int included patches add new patch number below this line 1352 1351 ,patch dead urls in the help go unnoticed problem dead urls in the help go unnoticed solution add a script to check urls in the help files christian brabandt , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3493,class attrbuilder return this attrbuilder set stringpiece attr name const attrvalue value attr name value cached cache key absl nullopt return this retrieves the attribute value note that get can involve a linear scan of all attributes with the same value type in this node this is not an issue because get is used rarely ,make multiple changes to enable running an inference model on tfrt for fallback op serialize all attributes to a string and under node def allow chain all tfrt ops piperorigin revid change id , xla python python client client client client client piperorigin revid
3494,status vectorization initialize const functiondef outer scope nodebuilder status vectorization wrappedtensor unstacked result if unstacked node output type unstacked output index dt variant todo b expanddims doesn't work with variant tensors return errors unimplemented cannot stack tensor with variant type note that all these nodes are necessary as the size of the batch may not be constant if unstacked stacked ,tf data vectorization bug fix piperorigin revid , xla python fix a bug in the graph piperorigin revid
3495,if name main in such case winograd nonfused algorithm is added as one option of the conv autotune and cudnn version is smaller than 7 the following tests will fail 1 400 400 128 3 3 128 768 1 400 400 768 1 400 400 1 1 1 1 256 1 400 400 256 setattr conv2dtest no winograd nonfused 1 same gpu only true setattr conv2dtest no winograd nonfused ,reduce size of the no winograd tests but still large enough that returns true piperorigin revid , patch problem when using a terminal window is a bit solution add a test for the current line
3496,limitations under the license include tensorflow lite delegates gpu cl inference context h include tensorflow lite delegates gpu cl kernels converter h include tensorflow lite delegates gpu cl opencl wrapper h include tensorflow lite delegates gpu cl precision h include tensorflow lite delegates gpu cl tensor h include tensorflow lite delegates gpu cl tensor type util h include tensorflow lite delegates gpu common data type h include tensorflow lite delegates gpu common precision h include tensorflow lite delegates gpu common shape h include tensorflow lite delegates gpu common task tensor desc h include tensorflow lite delegates gpu common tensor h ,moved gpu cl gpu common piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3497,comp botline win t wp ifdef feat syn hl static linenr tlast cursorline 0 void reset cursorline void last cursorline 0 endif ,patch cursorline highlight not removed in some situation problem cursorline highlight not removed in some situation solution reset last cursorline when resetting 'cursorline' christian brabandt closes , patch problem when using a terminal window is a bit slow solution add a few more tests to the new code
3498,limitations under the license include gmock gmock h include gtest gtest h include absl types optional h include tensorflow core common runtime step stats collector h include tensorflow core framework step stats pb h include tensorflow core lib core status test util h include tensorflow core platform env h ,break dependency of profiler backends on core core cpu lib piperorigin revid change id , xla python fix a bug in the client client piperorigin revid change id icbbdbfafcdfcae
3499,test f constantfoldingtest materializebroadcastgradientargs else if node name p1 found expect eq 1 node input size expect eq constantfolding i 0 node input 0 expect eq i node input 0 else if node name p2 found expect eq 1 node input size expect eq i 1 node input 0 else if node name constantfolding i 0 found expect eq const node op expect eq 1 node input size expect eq i node input 0 expect eq 0 tensorshape node attr at value tensor tensor shape num elements expect eq 7 found expect eq 6 found test f constantfoldingtest materializereductionindices ,materialize broadcastgradientargs by default instead of just doing so in aggressive mode this ensures that we optimize gradient computations in the presence of variable batch sizes piperorigin revid , fix a bug in the test case piperorigin revid
3500,register op maxpoolgradwithargmax attr ksize list int 4 attr strides list int 4 attr getpaddingattrstring attr include batch in index bool false attr targmax int32 int64 input input t input grad t register op attr ksize list int 4 attr strides list int 4 attr getpaddingattrstring attr include batch in index bool false attr targmax int32 int64 input input t input grad t ,enh add include batch in index for gradient of max pool with argmax , fix a bug in the test case piperorigin revid
3501,class randombinomialtest test testcase def sampler self num counts probs dtype seed none def func rng stateful random ops generator seed seed binomial rng stateful random ops generator from seed seed binomial shape 10 num counts counts probs probs dtype dtype ret array ops reshape rng 10 num ret self evaluate ret class randombinomialtest test testcase self assertallequal sx sy def self rnd stateful random ops generator seed 12345 binomial 0 rnd stateful random ops generator from seed 12345 binomial 0 self assertequal 0 rnd shape as list def testshape self rng stateful random ops generator seed 12345 rng stateful random ops generator from seed 12345 scalar parameters rnd rng binomial shape 10 counts np float32 2 probs np float32 0 5 self assertequal 10 rnd shape as list ,added alternative ways to initialize and reset a generator other than seed piperorigin revid , fix a bug in the test case piperorigin revid
3502,class loss object notimplementederror 'must be implemented in subclasses ' tf export 'keras losses class meansquarederror loss def call self y true y pred invokes the meansquarederror instance ,adding v api for loss deprecating v losses apis piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3503,std string getminimumruntimeversionformodel const model model operatortype kbatchtospacend 1 1 6 0 operatortype kbatchtospacend 2 1 14 0 operatortype kbatchmatmul 1 kpendingreleaseopversion operatortype kbatchmatmul 3 kpendingreleaseopversion operatortype kcast 1 1 5 0 operatortype kconcatenation 1 1 5 0 operatortype kconcatenation 2 1 14 0 ,remove unnecessary versioning of in deprecated file , fix a bug in the test case piperorigin revid
3504,def maybe download urllib urlretrieve https archive edu ml machine learning databases data train file name pylint disable line too long train file name train file name train file close print training data is to s train file name print training data is downloaded to s train file name if flags test data test file name flags test data def maybe download urllib urlretrieve https archive edu ml machine learning databases test test file name pylint disable line too long test file name test file name test file close print test data is to s test file name print test data is downloaded to s test file name return train file name test file name ,fix typos in print statements in wide deep tutorial , fix a bug in the docstring of the documentation of the new api change
3505,include boost math special functions gamma hpp include boost array hpp include cmath namespace boost namespace math inline unsigned max factorial template class t t factorial unsigned i using std using namespace std if i max factorial t return unchecked factorial t i t result boost math tgamma i 1 if result tools max value result return result overflowed value tgamma will have signalled the error already return floor result 0 5 return floor result 0 5 template ,cleaned up bgrat table size fixed typos in factorials hpp added needed using declarations in gamma ratios cygwin fix for test hpp svn r , fix a bug in the new parser test svn r
3506,class quantizeanddequantizev2op public opkernel tensor output nullptr op requires ok ctx ctx allocate output 0 input shape output tensor input min tensor ctx input 1 tensor input max tensor ctx input 2 tensor input min tensor tensor input max tensor if range given input min tensor ctx input 1 input max tensor ctx input 2 auto min val input min tensor scalar t auto max val input max tensor scalar t op requires ctx min val max val errors invalidargument invalid range input min min val input max max val else op requires ok ctx ctx allocate temp datatypetoenum t value tensorshape input min tensor op requires ok ctx ctx allocate temp datatypetoenum t value tensorshape input max tensor functor quantizeanddequantizeonescalefunctor device t f ,ensure that doesn't alter modify input tensors when range given is false change , fix a bug in the test case piperorigin revid
3507,std vector computetaskdescriptorptr fullyconnected auto filters options storage precision runtimeoptions precision fp32 getbytebuffer filters reordered vectorfloattohalf filters reordered auto biases options storage precision runtimeoptions precision fp32 getbytebuffer attr bias data vectorfloattohalf attr bias data desc immutable buffers device flt4 const matrix filters device flt4 const biases biases device flt4 const biases getbytebufferconvertedresized attr bias data options storage precision attr weights shape o desc uniform buffers ,ios metal delegate support no biases in fully connected piperorigin revid , fix a bug in the delegate piperorigin revid
3508,static char features static int included patches add new patch number below this line 2216 ,patch text property in wrong place after substitute problem text property in wrong place after substitute solution pass the new column instead of the old one christian brabandt closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3509,void dump childnos void child shm children i j if child pid empty pidslot if child pid empty pidslot sptr sprintf sptr empty else if pid alive child pid 1 sptr sprintf sptr s ansi red ,special case the dumping of empty pid slots , fix a bug in the syscall page
3510,string sanitizethreadsuffix string suffix return clean bool istimelessthan double new time double old time const char epsilon str getenv tf autotune epsilon double epsilon 0 03 if epsilon str nullptr strings safe strtod epsilon str epsilon if old time new time old time epsilon return true return false namespace tensorflow ,fixed the issue of the autotuning process , xla python fix a bug in the client client client piperorigin revid
3511,class public nodeshader generatedcode parameters objects alpha makereadonlybuffer alpha data objects alpha makereadonlyobject alpha data declare workload explicitly because shader depends on gid z workload ,fix which sometimes only generates buffer storage for alpha piperorigin revid , fix a bug in the delegate piperorigin revid
3512,static char features static int included patches add new patch number below this line ,updated for version problem some files missing in the list of distributed files solution add lines for new files , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3513,void expected results largest type long s double endif add expected result compiler stdlib platform real concept test type s atanh test data group 6 2 test function add expected result compiler stdlib platform largest type test type s atanh test data group 6 1 test function add expected result compiler stdlib void expected results compiler stdlib platform test type s largest type test type s test data group 4 1 test function ,update expected error rates for bit long double platforms svn r , fix a bug in the previous commit piperorigin revid
3514,class testobjectvar basetestcase self assertequal str objtype attributes 0 cx oracle numbervalue def self test trim number of elements from collection self connection gettype udt subobject arraytype self connection gettype udt data 1 ab 2 3 4 ijk arraytype for numval strval in data subobj subobj subnumbervalue numval subobj substringvalue strval append subobj self assertequal self data trim 2 self assertequal self data 2 trim 1 self assertequal self data 1 trim 0 self assertequal self data 1 trim 1 self assertequal self ,added test cases for aq transformations and collections , patch problem when using a terminal window is a bit solution add a test for the job
3515,def unsorted segment n data segment ids num segments of segment entries with 0 entries set to 1 to allow division by n bincount doesn't support negative indices so we use unsorted segment sum ones tensor array ops ones segment ids shape dtype data dtype segment ids shape array ops shape internal segment ids ones tensor array ops ones segment ids shape dtype data dtype n gen math ops unsorted segment sum ones tensor segment ids num segments add dimensions for all non reduced axes ndims output data shape ndims segment ids shape ndims ,compute shape of segment ids dynamically in unsorted segment n piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3516,class context object def device name self index self device index return none if index 0 else self devices index return cpu 0 if index 0 else self devices index def devices self def eager mode return get default context mode eager mode pylint disable protected access todo agarwal get rid of this and use ops name scope instead contextlib contextmanager def namescope name ,make tf resourcevariable tf constant op tf identity tf colocate with tf name scope tf device tf control dependencies eager friendly piperorigin revid , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3517,tensorflow status service execute const arg return tensorflow status ok tensorflow status service executegraph const arg result return unimplemented execute graph is not yet implemented tensorflow status service executeasync const arg result vlog 1 running execute async request arg shortdebugstring ,xla add a whole graph execution interface piperorigin revid , xla python add a xla interface to the xla client piperorigin revid change id idaceccfcbacfece
3518,struct numtraits tensorflow bfloat16 ifdef use tstring template struct numtraits tensorflow tstring tensorflow tstring enum 1 addcost mulcost static inline int digits10 return 0 private static inline tensorflow tstring epsilon static inline tensorflow tstring dummy precision static inline tensorflow tstring lowest static inline tensorflow tstring highest static inline tensorflow tstring infinity static inline tensorflow tstring quiet nan endif use tstring using tensorflow operator using tensorflow operator ,added eigen numtraits tensorflow tstring to framework numeric types h piperorigin revid change id , xla gpu support for the hlo client piperorigin revid change id iaaffafbceeeafc
3519,int kernel taint initial 0 int check tainted void int fd unsigned int ret unsigned int ret 0 char buffer 11 buffer 10 0 make sure that we can fit the whole int fd open proc sys kernel tainted o rdonly if fd 0 return 1 goto out ret read fd buffer 10 close fd int check tainted void we should never fail but if we do assume untainted ret 0 out return ret ,assume if we fail to open the tainted , fix a bug in the watchdog process
3520,class llvmirgentestbase public codegentestbase const string pattern bool match optimized ir compiles the given hlo with optimizations and verifies that optimized hlo matches the given filecheck pattern void matchoptimizedhlo absl string view hlo absl string view pattern bool print operand shape false likematchoptimizedhlo but checks operand shapes as well void matchoptimizedhlowithshapes absl string view hlo absl string view pattern matchoptimizedhlo hlo pattern print operand shape true compiles and returns module with optimizations from a given hlo statusor std unique ptr hlomodule getoptimizedmodule absl string view hlo private llvmcompiler ,xla move utilities for matching hlo in tests to in order to share between cpu gpu tests piperorigin revid , xla gpu support for the layout of the client backend piperorigin revid change id idddefebfaaab
3521,class bidirectionalsequencelstmtest test util tensorflowtestcase curr input image lite output class tf float32 as datatype enum tflite tf lite toco convert curr tflite input outputs allow custom ops false converter tf lite tfliteconverter curr tflite input outputs tflite converter convert interpreter tf lite interpreter model content tflite ,internal cleanup piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3522,class linearoperatortoeplitztest skip solve tests as these could have better stability currently exercises the base class todo srvasude enable these when solve is implemented return cholesky inverse solve solve with broadcast return cholesky cond inverse solve solve with broadcast staticmethod def operator shapes infos ,disable cond test for linearoperatortoeplitz piperorigin revid change id , fix a bug in the parser test piperorigin revid
3523,void launchfusedconv2dbiasactivationop gpudevice t biastype scaletype format oihw filter param shape format hwio maybe transformed filter functor transformfilter gpudevice t int 4 ctx eigen device gpudevice to32bit filter param tensor t 4 ctx eigen device gpudevice format oihw to32bit filter param tensor t 4 to32bit maybe transformed filter tensor t 4 filter maybe transformed filter ,generalize method in preparation of nhwc conv support piperorigin revid , fix a bug in the new delegate piperorigin revid change id ibafafbfadfbb
3524,static char features static int included patches add new patch number below this line 588 587 ,patch putty does not use sgr 'ttymouse' by default problem putty does not use sgr 'ttymouse' by default solution make sgr the default for putty christian brabandt closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3525,getcmdline firstc count indent ifdef feat cmdwin if c key c k cmdwin open a window to edit the command line and history c ex window some key typed true if ex normal busy 0 got int false open a window to edit the command line and history c ex window some key typed true ifdef feat digraphs else ,updated for version problem endless loop and other problems when is set to ctrl c solution do not call ex window when ex normal busy or got int was set yasuhiro matsumoto , patch problem when using a terminal window is a bit solution add a test for the gui
3526,class baselayertest test testcase layer base layers layer name 'my layer' trainable false self assertequal layer trainable false test util run in graph and eager modes def self layer base layers layer name 'my layer' dtype 'int64' layer add variable 'my var' 2 2 self assertequal layer name 'my layer' test util run in graph and eager modes def self layer base layers layer name 'my layer' ,make default weights initializer in base layers layer suitable for their dtype piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
3527,class dataset object def shuffle self buffer size seed none reshuffle each iteration none randomly the elements of this dataset this dataset fills a buffer with buffer size elements then randomly samples elements from this buffer replacing the selected elements with new elements for perfect shuffling a buffer size greater than or equal to the full size of the dataset is required args buffer size a tf int64 scalar tf tensor representing the number of elements from this dataset from which the new ,improve docstring for tf data dataset shuffle piperorigin revid , fix a bug in the docstring of the docstring of the test case piperorigin revid
3528,bool cudablas doblasgemm stream stream blas transpose transa cublasmath t math type cublas default math else cublasmath t math type cublas tf32 tensor op math int cc major cc minor if stream parent getdevicedescription cuda compute capability cc major cc minor cc major 8 todo reedwm remove or make this vlog 1 once tensorfloat 32 is more well tested log first n info 1 tensorfloat 32 will be used for the matrix multiplication this will only be logged once endif return doblasinternalimpl ,log if tf is used for matmul piperorigin revid change id , xla python fix a bug in the graph piperorigin revid
3529,static char features static int included patches add new patch number below this line 1822 1821 ,patch confusing error message when range is not allowed problem confusing error message when range is not allowed solution with addr none give e change e to e for consistency , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3530,class onestest tf test testcase class tf test testcase def self for dtype in tf float32 tf float64 tf int32 for dtype in tf float32 tf float64 tf int32 tf uint8 tf int16 tf int8 tf complex64 tf complex128 tf int64 tf complex64 tf complex128 tf int64 numpy dtype dtype as numpy dtype with self test session creates a tensor of non zero values with shape 2 x 3 ,revert changed brackets , fix a bug in the docstring of the test case piperorigin revid
3531,class cancellationmanager if this cancellationmanager has any children this member points to the head of a doubly linked list of its children cancellationmanager first child not owned cancellationmanager first child nullptr not owned bool cancellationmanager child ,cancellationmanager initialize state first child to nullptr piperorigin revid change id , xla python fix a bug in the client client piperorigin revid
3532,class threadedtcprequesthandler socketserver baserequesthandler return if len response 0 self request sendall response self request sendall response encode 'utf 8' write the into the file so that the test can knows the command was sent with open a as myfile ,patch problem netbeans test fails with python jonathonf solution encode the string before sending it closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
3533,statusor mlir operation hlofunctionimporter importinstruction instruction tuple index makeandreturn gettupleelementop case hloopcode kgetdimensionsize attributes push back builder getnamedattr dimension builder getintegerattr builder getintegertype 32 instruction dimension makeandreturn getdimensionsizeop case hloopcode ktranspose attributes push back builder getnamedattr permutation convertdimensions instruction dimensions ,add getdimensionsize hlo op piperorigin revid change id , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
3534,status env getmatchingpaths const string pattern status s fs getchildren current dir children ret update s for const string child children if child empty continue const string child path io joinpath current dir child if the child is a directory add it to the queue if fs isdirectory child path ok ,fix file io get matching files for gcsfilesystem change , xla python fix a bug in the test piperorigin revid
3535,for example path list gc get paths tmp parser contains all ten paths every fifth gc mod export version 5 print every fifth path list shows tmp 0 tmp 5 print every fifth path list shows tmp 0 tmp 5 largest three gc largest export versions 3 print largest three all paths shows tmp 7 tmp 8 tmp 9 print largest three all paths shows tmp 7 tmp 8 tmp 9 both gc union every fifth largest three print both all paths shows tmp 0 tmp 5 tmp 7 tmp 8 tmp 9 print both all paths shows tmp 0 tmp 5 tmp 7 tmp 8 tmp 9 delete everything not in to delete gc negation both for p in to delete all paths ,improve examples for python compatibility , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary solution add a test for the line
3536,struct left right child right parent parent an interval tree that can query buffers overlapping in time class chunk specified void add int64 start int64 end const chunk chunk remove the interval from the tree returns true if the chunk is removed bool remove int64 start int64 end const chunk chunk returns vector of allocated chunks that overlap with the given time interval std vector chunk int64 start int64 end const getroot return root private root nullptr std list node storage ,xla add a remove method in heap interval tree needed by memory space assignment piperorigin revid change id , fix a bug in the file page
3537,def recursive assert same structure nest1 nest2 check types is sequence nest1 is sequence nest1 if is sequence nest1 is sequence nest2 raise valueerror the two structures don't have the same nested structure first structure s second structure s nest1 nest2 the two structures don't have the same nested structure n n first structure s n structure s nest1 nest2 if not is sequence nest1 return finished checking def assert same structure nest1 nest2 check types true len nest2 len flatten nest2 if is sequence nest2 else 1 if len nest1 len nest2 raise valueerror the two structures don't have the same number of elements first structure s second structure s nest1 nest2 elements n structure i elements s n n second structure i elements s len nest1 nest1 len nest2 nest2 recursive assert same structure nest1 nest2 check types ,nest raise exceptions with more readable messages piperorigin revid , fix a bug in the docstring of the documentation of the new api change
3538,class composablemodel object grads gradients gradients loss my vars if self gradient clip norm grads clip ops clip by global norm grads self gradient clip norm self optimizer self get optimizer return self optimizer apply gradients zip grads my vars return self get optimizer apply gradients zip grads my vars def get feature columns self if not self feature columns class composablemodel object def get optimizer self if self optimizer is none or isinstance self optimizer six string types self optimizer self get default optimizer self optimizer optimizer self get default optimizer self optimizer elif callable self optimizer self optimizer self optimizer return self optimizer optimizer self optimizer else optimizer self optimizer return optimizer def get default optimizer self optimizer name none raise notimplementederror ,removed caching of optimizer since optimizer may depend on a graph element global step change , fix a bug in the docstring of the test case piperorigin revid
3539,class bernoullitest tf test testcase np sqrt var 0 5 np sqrt var 0 4 dtype np float32 def testbernoullibernoullikl self with self test session as sess batch size 6 a p np array 0 5 batch size dtype np float32 b p np array 0 4 batch size dtype np float32 a tf contrib distributions bernoulli p a p b tf contrib distributions bernoulli p b p kl tf contrib distributions kl a b kl val sess run kl kl expected a p np log a p b p 1 a p np log 1 a p 1 b p self assertequal kl get shape batch size self assertallclose kl val kl expected if name main tf test main ,add bernoulli bernoulli kl remove extra op in log pmf broadcasting change , fix a bug in the docstring of the test case piperorigin revid
3540,class variablestore object shape tensor shape as shape shape if initializing from value shape initializer get shape shape shape merge with initializer get shape if not reuse without partition if not shape is fully defined ,internal only change change , fix a bug in the docstring of the test case piperorigin revid
3541,status segmentgraph const graph tf graph log info msg for more information see https docs nvidia com deeplearning dgx integrate tf trt index html support ops dgx tf trt user guide index html supported ops the segmentation algorithm below visits nodes in reverse topological order and attempts to merge nodes along output edges that means that subgraphs ,fix link to tf trt docs , add a test for the graph and the graph piperorigin revid
3542,class generateboundingboxproposals public tensorflow opkernel to generate char dev boxes keep flags flat int8 data const int generated to generate const int roi cols box dim const int max std min generated post nms topn tensor dev image boxes tensor dev image scores tensor dev image boxes keep list register kernel builder name generateboundingboxproposals hostmemory pre nms topn tensorflow generateboundingboxproposals namespace tensorflow endif no newline at end of file endif ,fix error 'unused variable 'max , fix a bug in the test case piperorigin revid
3543,class rangetest test testcase math ops range 0 0 1 dtype dtypes float64 dtype dtypes float64 def testmixeddtype self test case for github issue 29867 with self cached session use gpu true tf ans math ops range constant op constant 5 dtype dtypes float32 self assertallequal self evaluate tf ans np arange np int32 5 dtype np float32 todo vrv move to sequence ops test class linspacetest test testcase ,add test case for github issue signed off by yong tang yong tang github outlook com , tf data saveable shape for tf data dataset piperorigin revid
3544,void regenerate random page unsigned int i j sometimes return a page of complete trash if rand 2 0 for i 0 i page size i page rand i unsigned char rand return sometimes return a page that looks kinda like a struct for i 0 i page size i j rand 4 switch j ,return in the random page sometimes , fix a bug in the syscall page
3545,void opemitter opmethodbody body if body formatv if 0 name n if and attr if attr if this is a raw value then we need to wrap it in an attribute instance fmtcontext fctx ,nfc use instead of and piperorigin revid change id , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
3546,class iremitterunnested public iremitter absl span hloinstruction const reduce instructions llvm type index type void emitprologueforonereduction hloinstruction unnested hlo hloinstruction reduce inst int reduce idx reductioncodegeninfo kernel info gpuelementaliremitter elemental emitter wraps up the code generation for a tile block of a reduction kernel write the calculated output into the output tensor void emitepilogueforreduction ,xla gpu nfc minor reduction emitter refactoring inline a method remove unused method add some comments piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3547,def variable scope name or scope use when doing asynchronous distributed training returns a scope that can be to captured and reused a scope that can be captured and reused raises valueerror when trying to reuse within a create scope or create within ,fixing typo piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the docstring change
3548,class hloinstruction unimplemented error status note this may change to an iterator in the future for purposes todo b stop passing in information about the visited instruction that is accessible from the instruction object itself class dfshlovisitor public dfshlovisitor class dfshlovisitor virtual status hloinstruction abs return handleelementwiseunary abs virtual status handleatan2 hloinstruction atan2 hloinstruction y hloinstruction x virtual status handleatan2 hloinstruction atan2 return handleelementwisebinary atan2 virtual status handleround hloinstruction round ,tf xla don't pass hlo operands in this makes it consistent with the rest of the visit methods where we only pass the hlo itself piperorigin revid , xla gpu support for the xla client piperorigin revid
3549,buf check timestamp buf focus buf b mtime 0 stat res mch stat char buf b ffname st 0 time differs long st st mtime buf b mtime st st size buf b orig size ifdef have st mode int st st mode buf b orig mode else ,updated for version problem when doing update just before running an external command that changes the file the timestamp may be unchanged and the file is not solution also check the file size , patch problem when using a terminal window is a bit slow solution add a test for the gui
3550,namespace ntl boost math tools digits ntl rr inline ntl rr fmod ntl rr x ntl rr y this is a really version of fmod we rely on lots of digits to get us out of trouble ntl rr factor floor x y return x factor y namespace ntl ,big initial commit of the polynomial and associated functions from tr svn r , fix a bug in the new parser test svn r
3551,std unique ptr hloinstruction hloinstruction clonewithnewoperands return shape new operands case hloopcode kparameter return createparameter parameter number shape parameter name unsupported ops for cloning case hloopcode kbatchnormtraining check eq new operands size 3 return shape new operands 0 new operands 1 new operands 2 epsilon feature index unsupported ops for cloning case hloopcode krecv case hloopcode ksend case hloopcode kupdate ,implement batchnorm hlos on parallel cpu perhaps surprisingly implementing hloinstruction clonewithnewoperands was sufficient to pass the checked in test cases piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3552,class s3randomaccessfile public randomaccessfile auto getobjectoutcome this s3 client getobject getobjectrequest if getobjectoutcome issuccess auto error getobjectoutcome geterror if error getresponsecode aws http httpresponsecode requested range not satisfiable if error getresponsecode aws http httpresponsecode forbidden return errors failedprecondition aws credentials have not been set properly unable to access the specified s3 location else if error getresponsecode aws http httpresponsecode requested range not satisfiable n 0 result stringpiece scratch n return status error out of range read less bytes than requested ,add forbidden error check , fix a bug in the test case piperorigin revid
3553,class squarelinearoperatorcompositiontest self rtol dtypes float32 1e 4 self rtol dtypes complex64 1e 4 property def tests to skip self cholesky not implemented return cholesky def operator and matrix self build info dtype use placeholder sess ops get default session shape list build info shape either 1 or 2 matrices depending ,add cholesky factorization to linearoperator piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3554,static char features static int included patches add new patch number below this line 434 433 ,patch clang version not correctly detected problem clang version not correctly detected solution adjust the configure script kazunobu kuriyama , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3555,class test util tensorflowtestcase self assertequal ops get name scope inner self assertequal ops get name scope def self with context eager mode with ops graph as default with context graph mode with ops init scope self asserttrue context executing eagerly def self with context eager mode def foo ,tweak the context stack so init scope works with eager graphs previously breaking out into graphs created with eager execution enabled would enter the graph but not re enable eager execution piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3556,class mkllayoutrewritepass public graphoptimizationpass it includes those we support std vector string fused ops dcheck eq getnodeattr n def fused ops fused ops ok true tf check ok getnodeattr n def fused ops fused ops return fused ops biasadd fused ops relu fused ops biasadd relu ,changing dcheck eq to tf check ok , fix a bug in the delegate of the delegate to the new delegate piperorigin revid
3557,def to tensor x dtype returns a tensor return ops convert to tensor x dtype dtype return ops convert to tensor v2 x dtype dtype keras export 'keras backend is sparse' class eagerexecutionfunction object raise valueerror 'you must feed a value for placeholder s' tensor if not isinstance value ops tensor value ops convert to tensor value dtype tensor dtype value ops convert to tensor v2 value dtype tensor dtype if value dtype tensor dtype temporary workaround due to convert to tensor not casting floats see b ,update ops convert to tensor to use the tf public symbol in keras piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
3558,status clientsession runcallable callablehandle handle run metadata status clientsession runcallable callablehandle handle const std vector tensor feed tensors std vector tensor fetch tensors runmetadata run metadata const thread threadpooloptions options return impl session runcallable handle feed tensors fetch tensors run metadata options status clientsession releasecallable callablehandle handle return impl session releasecallable handle ,automated rollback of commit piperorigin revid , xla gpu support for the cpu backend piperorigin revid change id iaaffafbceeeafc
3559,struct avgpoolmeanreducer packet packetcount template typename device struct reducer traits avgpoolmeanreducer float device enum cost 1 if eigen arch i386 eigen arch x86 64 defined cudacc we only support packet access for floats packetaccess true else packetaccess false endif template struct reducer traits avgpoolmeanreducer float gpudevice enum cost 1 packetaccess false namespace internal if defined eigen has index list ,backported some changes to the reduction code from upstream eigen to keep the code in sync change , fix a bug in the parser interface piperorigin revid change id icaabbeacfcfdbfaba
3560,def main print ' test images ' for i test filename in enumerate test filenames if predictions i test ground truth i argmax print ' s' test filename image lists keys predictions i print ' s' test filename list image lists keys predictions i write out the trained graph and labels with the weights stored as constants output graph def graph util convert variables to constants ,fix bug in image retraining example retrain py so that the print test images flag now works properly in python , fix a bug in the docstring of the docstring of the new api change
3561,class projectorapitest tf test testcase create a dummy configuration config tf contrib tensorboard plugins projector projectorconfig config model checkpoint path 'test' emb1 config embedding add emb1 config embeddings add emb1 tensor name emb1 metadata path class projectorapitest tf test testcase tf contrib tensorboard plugins projector projectorconfig text format parse f read self assertequal config if name main tf test main ,fix projector api test ensuring it runs this test was missing a call to tf test main so the test wasn't being run this commit also fixes the test with s embedding embeddings , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
3562,class errorreporter reduce binary size define tf lite strip error strings when compiling and every call will be stubbed out taking no memory ifndef tf lite strip error strings define tf lite report error reporter do reporter report va args define tf lite report error reporter do static cast tflite errorreporter reporter report va args while false else tf lite strip error strings define tf lite report error reporter ,fix error reporter macro to allow passing a reference to error reporter piperorigin revid change id , fix a bug in the test case piperorigin revid
3563,static char features static int included patches add new patch number below this line 1669 1668 ,patch vim memory leak when storing a value fails problem vim memory leak when storing a value fails solution free the value when not storing it , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3564,def non max suppression lite boxes iou threshold ops convert to tensor iou threshold name 'iou threshold' score threshold ops convert to tensor score threshold name 'score threshold' return gen image ops non max suppression lite boxes scores return gen image ops non max suppression lite boxes scores max output size per class max total size iou threshold score threshold pad to max total size score threshold pad to max total size ,updated kernel unit tests to account for bounding box , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary solution add a test for the line
3565,datatype xlahelpers sumaccumulationtype const datatype dtype if dtype dt bfloat16 dtype dt half return dt float upcast small integer types to 32 bit to avoid overflow if dtype dt int8 dtype dt int16 return dt int32 if dtype dt uint8 dtype dt uint16 return dt uint32 return dtype ,try to avoid overflows in accumulation results this can be done by to an integer type with more bits piperorigin revid change id , fix a bug in the new delegate implementation of the new delegate kernel piperorigin revid change id idffeafcaaffbee
3566,def convert entity to ast o program ctx keyed by their symbol name raises notimplementederror if the object conversion is not yet supported valueerror if the entity type is not supported logging log 1 'converting s' o ,add documentation for undocumented exception the undocumented exception was notimplementederror the exception is raised when a conversion in the function entity to is not yet supported , fix a bug in the docstring of the docstring of the docstring change
3567,namespace benchmark struct options specifies the default time to run the benchmark and is used if neither max iters nor max micros is set static const int64 3000000 static constexpr int64 3000000 int64 max iters 0 maximum iterations to run ignored if 0 int64 max micros 0 maximum microseconds to run ignored if 0 ,some const declarations changed to constexpr piperorigin revid change id , fix a bug in the new delegate piperorigin revid change id iefaaedbcfceefdda
3568,class layout element size in bits value return this static constexpr int64 0 int64 memory space const return memory space layout set memory space int64 value memory space value ,xla propagate memory space to the called computations in layout assignment piperorigin revid , xla gpu support for the xla client piperorigin revid
3569,def ndlstm base unrolled inputs scope none reverse false if reverse inputs u list reversed inputs u for i in xrange length with tf variable scope scope inputs u i output state lstm cell inputs u i state output u output if i 0 tf get variable scope reuse variables output state lstm cell inputs u i state output u output if reverse output u list reversed output u outputs tf pack output u def sequence to final inputs scope none name none reverse false if reverse inputs u list reversed inputs u for i in xrange length with tf variable scope scope inputs u i output state lstm inputs u i state if i 0 tf get variable scope reuse variables output state lstm inputs u i state outputs tf reshape output batch size name name return outputs ,fix for incorrect variable sharing occurred during porting change , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
3570,tokkind hlolexer lexidentifier auto consumable regexpstringpiecefrompointers token start buf end will be advanced iff its prefix matches the pattern static lazyre2 shape pattern r w d d dense sparse d r w d d s dense sparse d s if re2 consume consumable shape pattern auto status or shape shapeutil stringpiecefrompointers token start consumable begin ,xla allow whitespace in shapes and layouts in hlo text piperorigin revid , xla gpu support for xla hlo client piperorigin revid
3571,class sparsesoftmaxcrossentropylossgradientfunction public gradientfunction absl makespan sm outputs name c str todo amturati fix error where we have to return the softmax loss as the 2nd grad for the labels to avoid mangled stack trace 2nd grad for the labels to avoid mangled stack trace also avoid running forward operation again check to see if forward outputs are being passed sparsesoftmaxcrossentropyloss returns loss vals grads so return 2nd output grad outputs 0 sm outputs 1 return backprop for scores grad outputs 1 sm outputs 0 nullptr nullptr causes mangled stack trace grad outputs 1 sm outputs 0 nullptr causes mangled stack trace counter 1 return status ok ,fixing nit comment for softmax , fix a bug in the test case piperorigin revid
3572,int main int argc char argv close fd vterm free vt return 0 ,patch libvterm code lags behind master problem libvterm code lags behind master solution sync to head solve merge problems , fix a bug in the watchdog process
3573,namespace enum snapshotmode reader 0 writer 1 passthrough 2 defaults to 10 gib per shard const int64 kdefaultshardsizebytes 10l 1024 1024 1024 const size t kheadersize sizeof uint64 const char ksnapshotfilename snapshot metadata class snapshotdatasetop public unarydatasetopkernel op requires ok ctx ctx getattr pending snapshot expiry seconds pending snapshot expiry seconds if shard size bytes 1 shard size bytes kdefaultshardsizebytes default to 1 day expiry for snapshots if pending snapshot expiry seconds 1 pending snapshot expiry seconds 86400 op requires ctx compression io compression knone ,fix build error on windows caused by potential int overflow piperorigin revid , fix a bug in the new delegate piperorigin revid
3574,bool isfreeofsideeffect const nodedef node return false queue ops modify the queue which is a side effect if node op find queue std string npos return false return modifiesinputsinplace node ,mark queue related ops as having side effect piperorigin revid , add a test for the cost of the graph piperorigin revid
3575,def gather params if compat forward compatible 2019 6 10 if axis is none axis batch dims return gen array ops gather v2 params indices axis batch dims batch dims name name if axis 0 return gen array ops gather v2 params indices axis batch dims batch dims name name try todo apassos find a less bad way of detecting resource variables without introducing a circular dependency return params sparse read indices name name except attributeerror return gen array ops gather v2 params indices axis name name if batch dims 0 with ops name scope name gather params indices axis ,removed the test for tf gather does not allow indices with unknown rank when batch dims is specified piperorigin revid , tf data fix a bug in the graph piperorigin revid
3576,class public baserecvtensorcall const bool on host dst device tensorflow gpu device info nullptr recv args alloc attrs on host status s remote memory manager remote memory manager const cast tensor tensor transport options dst device recv args device context on host if s ok mutex lock l mu status update s log error cannot find pinned memory region from allocator dst device getallocator recv args alloc attrs name recv args device context on host this recv done const status s if s ok mutex lock l mu status update s log error cannot find pinned memory region from allocator dst device getallocator recv args alloc attrs name recv done return if s ok mutex lock l mu ,gdr eliminate several unnecessary sync barriers , xla gpu support for the layout inference piperorigin revid change id icccbcbdbcfaadbee
3577,free jumplist wp set last cursor win win t win win w buffer b last cursor win w cursor if win w buffer null win w buffer b last cursor win w cursor if defined exitfree defined proto ,updated for version problem set last cursor may encounter w buffer being null matt solution check for null , patch problem when using a terminal window is a bit slow solution add a test for the gui
3578,namespace tensorflow class xlacpudevicefactory public devicefactory public status listphysicaldevices std vector string devices override status createdevices const sessionoptions options const string name prefix std vector std unique ptr device devices override status xlacpudevicefactory listphysicaldevices std vector string devices devices push back absl strcat physical device device xla cpu 0 return status ok status xlacpudevicefactory createdevices const sessionoptions session options const string name prefix std vector std unique ptr device devices ,expose apis to list and configure devices the new apis allow listing devices as prior to the initialization of the runtime and logicaldevice once the runtime is initialized we also allow configuring virtual devices memory limits as well as visibility piperorigin revid , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
3579,static int open drm fds void closedir dir done if no objects obj fd drm true if objects empty obj fd drm true drm fd provider enabled false return true static int get rand drm fd void struct object obj check if drm unavailable disabled if no objects obj fd drm true if objects empty obj fd drm true return 1 obj get random object obj fd drm obj global ,objects rename no objects and trivially simplify it while at it no objects is slightly confusing regarding the name and i believe changing it to objects empty serves better signed off by davidlohr bueso dbueso suse de , make the watchdog process to the syscall process
3580,def fused batch norm mean constant op constant if variance is none variance constant op constant add 1e 12 to epsilon when epsilon 1e 5 to prevent cudnn exception epsilon epsilon if epsilon 1e 5 else epsilon 1e 12 set a minimum epsilon to 1 5 which is a requirement by cudnn to prevent exception see cudnn h min epsilon 1 5 epsilon epsilon if epsilon min epsilon else min epsilon pylint disable protected access y batch mean batch var gen nn ops fused batch norm x ,update the minimum requirement of for batch norm piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the input shape is not used piperorigin revid
3581,from tensorflow python util tf export import tf export from tensorflow python util tf export import tf export tf export 'compat as bytes' 'compat as str' def as bytes bytes or text encoding 'utf 8' converts either bytes or unicode to bytes using utf 8 encoding for text ,removed tf export signed off by yong tang yong tang github outlook com , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
3582,example error handling using student's t function boost math domain error policy is set to throw on error message from thrown exception was error in function boost math students t distribution double students t distribution degrees of freedom argument is 1 but must be 0 error in function boost math students t distribution double students t distribution degrees of freedom argument is 1 but must be 0 alternatively let's build with ,big proof read of policy docs moved all examples into separate source files and made sure they compile etc svn r , fix a bug in the documentation of the documentation of the new code change
3583,static void use fpu void int this child 0 static void setup page maps void unsigned long page unsigned int i page void page maps for i 0 i page size sizeof unsigned long i struct map map map get map page i unsigned long map ptr static void oom score adj int adj file fp void init child int childno shm mappings childno zmalloc sizeof struct map init list head shm mappings childno list setup page maps generate random page page rand shm syscall childno state unknown ,kill off page zeros page xff just use page rand to generate them randomly , make the watchdog process to the syscall process
3584,struct fullyconnectedparams float activation params float float activation min float float activation max mark the operands as cacheable if they are unchanging e g weights bool lhs cacheable bool rhs cacheable weights format ,fullyconnected marks lhs rhs as cacheable if appropriate piperorigin revid change id , fix a bug in the new delegate piperorigin revid
3585,next search hl win shl lnum mincol cur match t shl points to search hl or a match linenr t lnum colnr t mincol minimal column for a match matchitem t cur to retrieve match if any matchitem t cur to retrieve match positions if any linenr tl colnr next search hl win shl lnum mincol cur else if cur null next search hl pos shl lnum cur pos matchcol else 0 if 0 shl lnum 0 no match found ,updated for version problem unitialized variables causing some problems solution initialize the variables dominique pelle , patch problem when using a terminal window is a bit slow solution add a test for the gui
3586,def pfor loop fn iters parallel iterations none this is an experimental feature and currently has a lot of limitations there should be no data between the different iterations for there should be no data dependency between the different iterations for example a future iteration should not depend on a value or side effect of a previous iteration stateful kernels may mostly not be supported since these often imply a ,properly register pfor converters for and matrixsetdiagv update array test to cover v ops fix a typo in control flow ops py piperorigin revid , fix a bug in the test case piperorigin revid
3587,namespace builtin add and mul are used to test simple branch tfliteregistration register add tfliteregistration register mul add and mul are used to test dynamic sized subgraphs pad is used to test dynamic sized subgraphs tfliteregistration register pad namespace builtin namespace custom ,fix a typo in comment piperorigin revid , fix a bug in the new delegate piperorigin revid
3588,static unsigned long handle arg mode t void static unsigned long fill arg int childno int call int argnum static unsigned long fill arg int childno int call unsigned int argnum enum argtype argtype 0 if argnum syscalls call entry num args return 0 switch argnum case 1 argtype syscalls call entry arg1type break ,don't fill out args that don't exist not sure how i never noticed this before , fix a bug in the watchdog page
3589,include sys types h include sys socket h include sys un h include netinet in h include linux x25 h include stdlib h include maps h page rand void gen x25 unsigned long addr unsigned long addrlen struct sockaddr x25 x25 unsigned int len x25 malloc sizeof struct sockaddr x25 if x25 null return x25 sx25 family pf x25 len rand 15 memset page rand len 0 1 strncpy x25 sx25 addr x25 addr page rand len addr unsigned long x25 addrlen sizeof struct sockaddr x25 ,move x sockaddr code out to own file , move the dtrace proto to the dtrace provider to the dtrace process to the dtrace process to be used in the dtrace process this is a bit more than the dtrace dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
3590,static irarray index getunnormalizedindex if the normalization only add a new dimensions of size 1 generate simpler indexing llvm doesn't always simplify the more complicated indexing and this prevents it from vectorizing some cases if unnormalized shape rank 2 cases we do this only for major to minor memory layout if unnormalized shape rank 2 unnormalized shape has layout unnormalized shape dimensions 0 normalized shape index dims 1 unnormalized shape dimensions 1 normalized shape index dims 2 unnormalized shape layout minor to major 1 0 dcheck eq normalized shape index dims 0 0 auto multidim normalized shape index multidim return irarray index multidim 1 multidim 2 unnormalized shape ,do a simple only for row major memory format and exact shape , fix a bug in the new parser test piperorigin revid
3591,def monitored train graph 'step' global step tensor name every n iter log every steps def make saver return tf saver saver sharded true max to keep keep checkpoint max defer build true scaffold monitored session scaffold init op init op init feed dict init feed dict init fn init fn saver tf saver saver sharded true max to keep keep checkpoint max defer build true saver monitored session scaffold get or default 'saver' ops graphkeys savers make saver if not supervisor is chief session creator monitored session ,facilitate using a custom checkpointsaverhook by not adding the default hook when one is already present and by build ing the saver before calling change , fix a bug in the docstring of the docstring of the docstring change
3592,syntax start wp lnum if invalid state current state syn sync wp lnum last valid first stored current lnum syn block b syn sync if current lnum 1 first line is always valid no matter first stored 1 else need to parse lines before state can be considered valid to store first stored current lnum syn block b syn sync else first stored current lnum ,updated for version problem on a bit system syn sync is very slow bjorn solution store the state when starting to parse from the first line , patch problem when using a terminal window is a bit slow solution add a test for the cursor
3593,void decnet gen sockaddr struct sockaddr addr socklen t addrlen addrlen sizeof struct sockaddr dn void decnet rand socket struct socket triplet st static void decnet rand socket struct socket triplet st if rand bool st type sock seqpacket void decnet setsockopt struct sockopt so todo set optlen correctly struct netproto proto decnet name decnet socket decnet rand socket ,convert pf decnet to struct netproto , proto zmalloc conversion
3594,static char features static int included patches add new patch number below this line 1775 1774 ,patch error message may be empty in filetype test problem error message may be empty in filetype test solution use v exception instead daniel hahler closs , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3595,void xlacomputationlaunchcontext populateinputs check xla tensor xla tensor has shaped buffer arg ptrs i const cast shapedbuffer xla tensor shaped buffer else check xla shapeutil equal shape on device shape check xla shape equal minortomajoronlyinlayout shape on device shape on device shape xla shapeutil humanstringwithlayout on device shape not the same as on host shape ,change more to piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id iebdeaedebeebedaa
3596,pbuild file symtab struct ps prochandle p file info t fptr name fptr file pname void objectfile name sizeof objectfile else if defined sun void snprintf objectfile sizeof objectfile s d object s procfs path int p pid fptr file pname else void snprintf objectfile sizeof objectfile s d exe procfs path int p pid endif ,shujing zhao pearly zhao oracle com libproc common psymtab c file symtab replace proc object a out with proc exe libproc common c replace proc path a out with proc exe remove libproc common makefile remove o , patch problem when using a popup window with a popup window solution add the cursor to the current window
3597,status runbenchmark const std vector inputlayerinfo inputs int tensor int tensor constant 0 0 break case dt uint8 auto int tensor input tensor flat uint8 int tensor int tensor constant 0 0 break default log fatal unsupported input type input data type ,add support for benchmarking with uint input types change , tf data service support for tf data experimental piperorigin revid
3598,namespace mlir gpu class lhlogentest public test f lhlogentest const compileandverifyir r hlomodule const entry const s32 100 const 0 s32 constant 10 root broadcast 0 s32 100 0 broadcast s32 const 0 dimensions r check func constant arg0 memref i32 check xla lhlo constant arg0 value dense 10 tensor i32 check func broadcast arg1 memref i32 arg2 memref check xla lhlo broadcast in dim arg1 arg2 broadcast dimensions dense tensor loweringstage lhlo test f lhlogentest r ,add constop to mlir gpu lhlo gen test piperorigin revid change id , xla gpu support for the hlo hlo instruction piperorigin revid change id idadedfddaccd
3599,logicalresult stringref stub name step 7 remove all the removable ops where reachable by outputs reachable by inputs as removable and the rest ops are not removable we also need to make sure all the output identity nodes are there llvm denseset operation identity nodes for auto output ophint composite op identity nodes insert output auto operation op if llvm is contained reachable by inputs op llvm is contained reachable by outputs op if reachable by inputs count op 0 reachable by outputs count op 0 identity nodes count op 0 op dropalldefinedvalueuses op dropallreferences op erase ,make sure all ophint output identity nodes are presented after ophint extraction piperorigin revid , xla gpu support for the hlo client piperorigin revid change id iebdeaedebeebedaa
3600,class testdistributionstrategywithdatasets test testcase dataset dataset repeat 100 dataset dataset batch 10 with self assertraisesregex valueerror with the layer' with self assertraisesregex valueerror 'is incompatible with' model fit dataset epochs 1 steps per epoch 2 verbose 0 combinations generate ,enable input spec checking for functional models piperorigin revid change id , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the input piperorigin revid
3601,grad fn accepts none for indices def record gradient op name inputs attrs results ctx name def record gradient op name inputs attrs results name records gradients for a tensorflow operation args def record gradient op name inputs attrs results ctx name attrs a tuple with alternating string attr names and attr values for this operation results the results of the operation as a flat list ctx the value of context context name customized name for the operation returns def record gradient op name inputs attrs results ctx name output grads orig outputs gradients result return result inputs ops internal convert to tensor x ctx ctx for x in inputs tape record operation op name results inputs grad fn if tracing print computed op name if name else op name inputs inputs ,removes unnecessary eager mode call to convert to tensor in record gradient piperorigin revid , add a test for the gradient of the gradient of the gradient of the shape inference piperorigin revid
3602,class gmm estimator estimator transformermixin initial clusters specifies how to initialize the clusters for training see gmm ops gmm for the possible values covariance type one of full diag batch size see tensorflowestimator steps see tensorflowestimator continue training see tensorflowestimator config see tensorflowestimator verbose see tensorflowestimator batch size see estimator steps see estimator continue training see estimator config see estimator verbose see estimator trains a gmm clustering on x note see tensorflowestimator for logic for continuous training and graph note see estimator for logic for continuous training and graph construction across multiple calls to fit args ,remove tensorflowestimator and subclasses change , update docstring for tf nn rnn py
3603,def build standardized signature def input tensors output tensors classes get classification classes output tensors scores get classification scores output tensors if classes is none and scores is none classes output tensors items items output tensors items if items 0 1 dtype dtypes string classes items else scores items return signature def utils classification signature def examples classes scores elif is regression problem problem type input tensors output tensors ,small improvement of verification heuristics piperorigin revid , fix a bug in the docstring of the new api change
3604,tflitestatus populategroundtruth std string proto str std istreambuf iterator char t std istreambuf iterator char objectdetectiongroundtruth ground truth proto proto2 textformat parsefromstring proto str ground truth proto google protobuf textformat parsefromstring proto str ground truth proto for auto image ground truth ground truth proto detection results ground truth mapping image ground truth image name ,copybara fix for proto namespace in object detection stage piperorigin revid , fix a bug in the delegate piperorigin revid
3605,std vector tensor grapplertest evaluatenodes return output tensors std vector tensor grapplertest const grappleritem item sessionoptions options std unique ptr tensorflow session session newsession options tf check ok session create item graph runoptions run options if item init ops empty std vector tensor dummy tf check ok session run run options item init ops dummy nullptr std vector tensor output tensors tf check ok session run run options item fetch output tensors nullptr tf check ok session close return output tensors void grapplertest addnode const string name const string op const std vector string inputs graphdef graph auto node graph add node ,use optimized ops to handle gpu memory swapping this avoids the need for pairs of extra send recv nodes which speeds things up a bit this also ensures that performance doesn't depend on the recv scheduling built in tf which isn't always optimal piperorigin revid , xla gpu support for the same dimension of the input piperorigin revid
3606,class addsigntest test testcase run 7 steps of addsign first 4 steps with positive gradient last 3 steps with negative gradient sign should be 1 for t in range 1 4 for t in range 1 8 if t 5 update run else class addsigntest test testcase var0 np m0 addsign update numpy var0 np grads0 np grads0 np if t 5 else grads0 np m0 learning rate alpha alpha class addsigntest test testcase var1 np m1 addsign update numpy var1 np grads1 np grads1 np if t 5 else grads1 np m1 learning rate alpha alpha ,tf xla add implementation of and resourceapplyaddsign piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
3607,ex args exarg t eap alist new if ends excmd eap arg if eap arg nul args file define new argument list handle like next ,patch args foo works like args without argument problem args foo works like args without argument solution fix check for empty argument closes , patch problem when using a terminal window is a bit slow solution add a test for the test
3608,class pylocalclient int device count const return devices size int local device count const return local devices size const std vector std shared ptr device devices return devices const std vector std shared ptr device local devices const std vector std shared ptr device devices const return devices const std vector std shared ptr device local devices const return local devices const std map int std shared ptr device id to device const ,xla python add dlpack import export support to the xla python client this allows jax to communicate on device arrays with other libraries such as and piperorigin revid change id , fix a bug in the graph piperorigin revid
3609,class public dfshlovisitorwithdefault hlocomputation primitivetype primitive type hloopcode opcode hlocomputation builder b scalar computation hlocomputation builder b scalar computation auto scalar lhs b addinstruction hloinstruction createparameter 0 shapeutil makeshape f32 scalar lhs 0 shapeutil makeshape f32 scalar lhs auto scalar rhs b addinstruction hloinstruction createparameter 1 shapeutil makeshape f32 scalar rhs 1 shapeutil makeshape f32 scalar rhs auto scalar op b addinstruction hloinstruction createbinary shapeutil makeshape primitive type opcode scalar lhs scalar rhs ,xla elide whitespace in symbols in batchnormrewriter piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3610,searchit pos lnum 1 pos lnum buf b ml ml line count pos col maxcol 2 ptr ml get buf buf pos lnum false pos col if ptr nul ptr ml get buf buf pos lnum false if int strlen ptr pos col start char len 1 else start char len mb ptr2len ptr start char len mb ptr2len ptr pos col endif else ,patch accessing invalid memory with it problem accessing invalid memory with it dominique pelle solution avoid going over the end of the line christian brabandt closes , patch problem when using a terminal window is a bit slow solution add a test for the command line
3611,regenerate unlock cachefile cachefile drop the reader lock close cachefile unlink cachefilename close sockets ret generate sockets return ret regenerate fd open socket domain type protocol if fd 0 output 1 cachefile is stale need to regenerate n close sockets goto regenerate ,always close sockets opened so far before regenerating otherwise we overflow the fd struct , fix a bug in the parser build piperorigin revid
3612,window makewindow absl span const int64 sizes return window window makewindow absl span const int64 sizes absl span const int64 strides window window check eq sizes size strides size for auto nb 0 nb sizes size nb auto dimension window add dimensions dimension set size sizes nb dimension set stride strides nb dimension set base dilation 1 dimension set window dilation 1 return window paddingconfig absl span const int64 sizes paddingconfig config for int64 size sizes ,add fct window util sizes strides , xla gpu support for the layout of the layout computation piperorigin revid change id id iacfcbedffdac
3613,static char features static int included patches add new patch number below this line 1286 1285 ,patch running tests leaves tabpage file behind problem running tests leaves tabpage file behind solution delete the right file closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3614,define boost math int value suffix rv suf rv suf endif test whether to support float128 if we don't have quadmath h then this can't currently work ifndef boost math use float128 ifdef has include if has include quadmath h define boost math disable float128 endif elif defined boost arch x86 define boost math disable float128 endif endif and then the actual configuration if defined glibcxx use float128 defined boost gcc defined strict ansi ,change quadmath h config to not use it at all if we don't have has include as gcc may be configured with disable libquadmath but still signal that it supports float , fix a bug in the new parser test piperorigin revid
3615,executable exists char name char u path int use path if mch getperm name 1 mch isdir name if path null path vim strsave char u name if mch isfullname name path vim strsave char u name else path fullname save char u name false return true return false ,patch test for v progpath fails on ms windows problem test for v progpath fails on ms windows solution expand to full path also add exe when the path is an absolute path , patch problem when using a terminal window is a bit solution add a test for the file
3616,def size internal input name none optimize true out type dtypes int32 if context in eager mode and not isinstance input sparse tensor sparsetensor sparse tensor sparsetensorvalue size 1 for dim in ops convert to tensor input shape tuple pylint disable protected access size dim return size return np prod ops convert to tensor input shape tuple pylint disable protected access with ops name scope name size input as name if isinstance input sparse tensor sparsetensor sparse tensor sparsetensorvalue ,benchmark regression piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3617,class dartgenerator public basegenerator code const name enum def tostring ev n code static get values code static const values for auto it enum def vals begin it enum def vals end it auto ev it code enum def tostring ev ev name ,dart generate constant values map for enums dart schema compiler generated a static getter for enum values which always created a new map instance for its callers see now it generates const map for better performance and readability , fix a bug in the parser test piperorigin revid
3618,namespace boost namespace math namespace detail if a 0 a ceil a return detail hypergeometric 1f1 generic series a b z pol log scaling function return 1 z b exp z return b z exp z b if a 1 b 2 ,hypergeometrics fix up some testing and conceptual errors flagged up by first ci run , fix a bug in the new parser test svn r
3619,estack pop void is sfile is true for sfile itself char u estack sfile int is sfile estack sfile int is sfile unused estack t entry ifdef feat eval ,patch compiler warning for unused argument in small version problem compiler warning for unused argument in small version solution add unused , fix a bug in the watchdog page
3620,ui breakcheck force int force if save updating screen updating screen true else reset updating screen false after updating screen false recursive false ,patch listener callbacks may be called recursively problem listener callbacks may be called recursively solution set updating screen while listener callbacks are invoked , patch problem when using a terminal window is a bit slow solution add a test for the gui
3621,test test auto model auto model tensortype int8 change model type flatbuffers flatbufferbuilder builder ,added missing argument , fix a bug in the test case piperorigin revid
3622,test convertxplanetotraceevents convert expect eq trace trace events size 3 test convertxplanetotraceevents drop trace trace for int i 0 i 100 i trace add trace events set timestamp ps 100 i 50 trace 150 expect eq trace trace events size 100 no dropping trace 50 expect eq trace trace events size 50 for const auto event trace trace events expect lt event timestamp ps 25 namespace namespace profiler namespace tensorflow ,make sure we capture up to trace events to avoid crashing the trace viewer add an unit test piperorigin revid change id , xla python fix a bug in the test piperorigin revid
3623,function cpp mlir function classes copyright 2019 the mlir authors licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license you may obtain a copy of the license at http www apache org licenses license 2 0 unless required by applicable law or agreed to in writing software distributed under the license is distributed on an as is basis without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license todo include mlir ir function h using namespace mlir function function ,sketch out a new repository for the mlir project go mlir piperorigin revid , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
3624,class dataset dataset ops dataset python preprocess 4 files concurrently and interleave blocks of 16 records from each file filenames var data file1 txt var data file2 txt filenames var data file1 txt var data file2 txt dataset dataset from tensor slices filenames interleave lambda x textlinedataset x map parse fn num parallel calls 1 ,fixed typo in function documentation , fix a bug in the docstring of the test case piperorigin revid
3625,device eigen strong inline void flipped true box box x1 x2 and y1 y2 starting from scoring box mark any box which has iou threshold with given box each thread processes a boxes per stride and each box has bitmask of overlaps of bit mask len given box each thread processes a boxes per stride and each box has bitmask of overlaps of length bit mask len template bool flip box launch bounds 4 global void const box d desc sorted boxes const int num boxes ,separate gpu tests from cpu tests , add support for int ops piperorigin revid
3626,def make slice tests options dtype tf float32 tf int32 tf int64 index type tf int32 tf int64 input shape 4 4 4 4 begin 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 size 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 begin 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 size 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ,fixed ci sanity build , fix a bug in the docstring of the test case piperorigin revid
3627,static int dpiconn close dpiconn conn int mode const char tag if dpioci transrollback conn propagateerrors error 0 return dpi failure handle connections created with an external handle if conn externalhandle conn sessionhandle null handle standalone connections if conn standalone else if conn standalone end session and free session handle if dpioci sessionend conn propagateerrors error 0 ,a connection created using an external handle should not have any oci calls made against it to close the session with the database , patch problem when using a terminal window is a bit solution add a test for the cursor
3628,function gettask task gulp task 'compile' gettask 'compile' gulp task gettask gulp task gettask true tslint permissive warns without failing gulp task 'tslint permissive' gettask false gulp task 'first compile' gettask 'compile' gulp task 'first compile' gettask 'compile' gulp task 'test gettask 'test' if you don't want to lint etc gulp task 'test' 'compile' gettask 'test' ,remove gulp typings since it errors and simplify the environment preparation run runs install bower install typings change , xla gpu support for the layout inference piperorigin revid change id id icfecdffaddccbded
3629,do bufdel if addr count 2 if arg both range and argument is not allowed return e trailing return ex errmsg e trailing arg arg start else addr count 1 ,patch ex command error cannot contain an argument problem ex command error cannot contain an argument solution add ex errmsg and translate earlier use e trailing arg where possible , patch problem when using a terminal window is a bit slow solution add a test for the gui
3630,public iterator begin const return nodes begin iterator end const return nodes end dump the the graph in a human readable format dump the graph in a human readable format void dump const void print raw ostream os const ,fix typo piperorigin revid change id , fix a bug in the parser test piperorigin revid
3631,def ctc greedy decoder inputs sequence length merge repeated true merge repeated boolean default true returns a tuple decoded log probabilities where a tuple decoded neg sum logits where decoded a single element list decoded 0 is an sparsetensor containing the decoded outputs s t decoded indices indices matrix total decoded outputs x 2 def ctc greedy decoder inputs sequence length merge repeated true the vector stores the decoded classes decoded shape shape vector size 2 the shape values are batch size max decoded length log probability a float matrix batch size x 1 containing sequence log probabilities neg sum logits a float matrix batch size x 1 containing for the sequence found the negative of the sum of the greatest logit at each outputs gen ctc ops ctc greedy decoder inputs sequence length merge repeated merge repeated ,fix doc for ctc greedy fix doc for ctc greedy the output is the minus the sum of the logits and the sentence , fix a bug in the docstring of the docstring of the docstring change
3632,class public opkernel opkernel context void compute opkernelcontext ctx override tensor val ctx input 0 const tensor val ctx input 0 int64 id ctx session state tensorstore tk val id def device op requires ok ctx ctx tensor store addtensor def name tk ,adds const in one place where it's possible change , fix a bug in the test case piperorigin revid
3633,get cterm attr idx int attr int fg int bg ifdef feat termguicolors at en ae u cterm fg rgb invalcolor at en ae u cterm bg rgb invalcolor at en ae u cterm ul rgb invalcolor endif at en ae attr attr at en ae u cterm fg color fg at en ae u cterm bg color bg at en ae u cterm ul color invalcolor return get attr entry cterm attr table at en endif get tgc attr idx int attr guicolor t fg guicolor t bg at en ae u cterm fg rgb fg at en ae u cterm bg rgb bg at en ae u cterm ul rgb invalcolor return get attr entry cterm attr table at en endif ,patch no color in terminal window when is set problem no color in terminal window when is set solution clear the underline color closes , patch problem when using a terminal window doesn't work solution add a test for the gui
3634,syntime report void sort on total time qsort ga ga data size t ga ga len sizeof time entry t sort on total time skip if there are no items to avoid passing null pointer to qsort if ga ga len 1 qsort ga ga data size t ga ga len sizeof time entry t syn compare syntime msg puts title total count match average name pattern ,patch ubsan complains about null pointer problem when sorting zero elements a null pointer is passed to which ubsan warns for solution don't call if there are no elements dominique pelle , patch problem when using a terminal window is a bit slow solution add a test for the command line
3635,from future import division from future import print function import os path import pathlib from absl testing import parameterized import numpy as np from tensorflow python platform import gfile from tensorflow python platform import test class pathlike object def init self name self name name def fspath self return self name run all path types parameterized named parameters str os path join pathlib lambda paths pathlib path os path join paths pathlike lambda paths pathlike os path join paths class fileiotest test testcase parameterized testcase ,fix fileio test for python , tf data service support for tf data dataset piperorigin revid
3636,init changedtick buf t buf if di null di di flags di flags lock di flags fix di flags ro di di flags di flags fix di flags ro di di tv v type var number di di tv v lock var fixed di di tv vval v number 0 ,patch 'd does not work problem 'd does not work solution make it work , patch problem when using a terminal window is a bit slow solution add a test for the command line
3637,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2020 12 1 forward compatibility horizon datetime date 2020 12 2 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
3638,struct cropandresize cpudevice t continue if method name bilinear const int top y index in y const int bottom y index in y const float y lerp in y top y index ,update tensorflow core kernels image crop and resize op cc , fix a bug in the new delegate piperorigin revid
3639,class sparsetensorspec type spec batchabletypespec not tf2 enabled return sparsetensorvalue tensor list else result sparsetensor tensor list augment the static dense shape with the shape carried by the spec result dense shape default result dense shape default merge with pylint disable protected access self shape return result return sparsetensor tensor list the sparsetensorspec tensor list encoding uses de serialize sparse ops to un box the component tensors in a way that allows for batching ,sparsetensor when deserializing from component tensors propagate the static dense shape from the typespec piperorigin revid change id , tf data dataset dataset dataset to be used by default piperorigin revid
3640,gui mch init void exits on failure but that's a non issue because we already called gtk init check in gui mch init check if using gnome gnome program init vimpackage vim version short module gui argc gui argv null if defined feat float defined lc numeric make sure strtod uses a decimal point not a comma gnome init may change it if setlocale lc numeric null char c setlocale lc numeric c endif endif vim free gui argv gui argv null ,updated for version problem when building with gnome locale gets reset solution set locale after gnome program init christian brabandt , patch problem when using a terminal window is a bit slow solution add a test for the gui
3641,def add to collection name value wrapper for graph add to collections using the default graph ,make tf add to collections visible piperorigin revid , update the version of the documentation of the documentation of the new version of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the default value of the same value piperorigin revid
3642,unsigned int fd idx 0 unsigned int fds left to create max fds void open pipes void static void open pipes void int pipes max pipe fds 2 unsigned int i void open pipes void void setup fds void static void close pipes void open pipes open sockets open files unsigned int i int fd for i 0 i max pipe fds i 2 fd shm pipe fds i shm pipe fds i 0 close fd fd shm pipe fds i 1 shm pipe fds i 1 0 close fd static int get random fd void regen return shm current fd void setup fds void open pipes open sockets open files void regenerate fds void close pipes close files close sockets setup fds ,regenerate needs to close pipes sockets too , make the syscall page we can be a bit more than the syscall process
3643,class test testcase profile str f read gfile remove outfile self assertequal set 15 50 100 set get profiles op keys with lib os path join test get temp dir profile 100 as profiler profiler profile operations options opts ,add a method for getting in memory profiles from piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3644,status mastersession calloptions opts const runsteprequest req log error cleanup partition error s rcg unref mutex lock l mu partial runs erase prun handle mutex lock l mu partial runs erase prun handle return s ,partial run support for grpc runtime tests for distributed partial run added in session test py change , tf data service support for tf data service piperorigin revid change id idaceccfcbacfece
3645,class contextadjuster gast nodetransformer return self generic visit node def visit subscript self node self apply override node self ctx override gast load node value self visit node value self ctx override none return self generic visit node def visit comprehension self node class replacetransformer gast nodetransformer def convert to ast n note when generating ast nodes from strings in isolation ctx is unknown ctx must be filled in according to the template being used see replacetransformer visit name if isinstance n str note the node will receive the ctx value from the template see replacetransformer visit name return gast name id n ctx none annotation none if isinstance n qual names qn return n ast ,fix context setting in pyct templates replace for subscript expressions piperorigin revid , fix a bug in the test case piperorigin revid
3646,class reducedatasetop public asyncopkernel ctx setstatus status return op requires async ctx state size output types size errors invalidargument the number of result elements does not match the size of output types state size vs output types size done op requires async ctx state size output shapes size errors invalidargument the number of result elements does not match the size of output shapes state size vs output shapes size done for int i 0 i state size i op requires async ctx state i dtype output types i ,check if the size of outputs matches with the size of output shapes and output dtypes , add support for int ops piperorigin revid
3647,bool iswhitelistedflexop const std string tensorflow op name padv2 paralleldynamicstitch parseexample parseexamplev2 parsesingleexample ,include parseexamplev in flex ops set piperorigin revid change id , fix a bug in the graph piperorigin revid
3648,import java lang import java util import com google flatbuffers suppresswarnings unused public final class monster extends table public static monster getrootasmonster bytebuffer bb return getrootasmonster bb new monster public static monster getrootasmonster bytebuffer bb monster obj bb order byteorder little endian return obj init bb getint bb position bb position bb ,added support for imports and many other proto features change id tested on linux , xla python fix a bug in the hlo client client piperorigin revid
3649,static char features static int included patches add new patch number below this line 2344 ,patch problem for mingw ruby api ver long isn't set correctly many default version numbers are outdated solution set ruby api ver long to ruby ver long use latest stable releases for defaults ken takata , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3650,def header paths include linux gnu extras cupti include include cuda cupti local cuda extras cupti include def library paths lib linux gnu lib x64 extras cupti local cuda lib64 local cuda extras cupti lib64 def find cuda config base paths required version nvcc path nvcc version find versioned file base paths bin local cuda bin nvcc name cuda version get nvcc version nvvm path find file base paths nvvm libdevice share cuda lib nvidia cuda toolkit libdevice local cuda nvvm libdevice libdevice 10 bc cupti header path find file base paths header paths cupti h ,add more alternative path to find cuda library , fix a bug in the file file in the file file in the file piperorigin revid change id idaddffdfdccebadaad
3651,from future import print function import six from tensorflow python eager import context from tensorflow python framework import composite tensor from tensorflow python framework import ops from tensorflow python framework import smart cond as smart module from tensorflow python framework import sparse tensor from tensorflow python framework import tensor shape from tensorflow python framework import tensor util from tensorflow python ops import control flow ops def is symbolic tensor tensor if isinstance tensor variables variable return not context executing eagerly if isinstance tensor ops tensor sparse tensor sparsetensor if isinstance tensor composite tensor compositetensor return tensor is graph tensor pylint disable protected access if isinstance tensor ops tensor return hasattr tensor 'graph' if isinstance tensor tuple user convertible tensor types return hasattr ops convert to tensor tensor 'graph' ,add support for compositetensors internally to keras models ie between layers this cl updates tf utils py to properly attach history to compositetensors in graph mode and adds a test that validates support for both ragged and sparsetensors internally to a model piperorigin revid , fix a bug in the test case piperorigin revid
3652,def test eigvalsh use placeholder shapes info dtype atol self atol dtype pylint disable protected access rtol self rtol dtype pylint disable protected access if dtype dtypes float32 or dtype dtypes complex64 atol 1e 5 rtol 1e 5 atol 1e 4 rtol 1e 4 self assertallclose op eigvals v mat eigvals v atol atol rtol rtol return test eigvalsh ,lower of eigvalsh for float complex piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3653,class estimatorspec for key value in six iteritems eval metric ops if isinstance value metric vars to add update value variables convert metric instances to value tensor update op tuple eval metric ops key value result value updates 0 remove variables that are in the local variables collection already vars to add vars to add difference local vars for v in vars to add ,convert the new metric instances to value op update op tuple in the estimatorspec piperorigin revid , fix a typo in the docstring of the docstring piperorigin revid
3654,void create shm void shm p shm prot pages page size void create child structs void unsigned int i shm children alloc shared max children sizeof struct childdata for each child i shm children i struct childdata alloc shared sizeof struct childdata void init shm void unsigned int i void init shm void set seed in parent thread set seed null shm children alloc shared max children sizeof struct childdata for each child i struct childdata child shm children i struct childdata child struct syscallrecord syscall previous child alloc shared sizeof struct childdata shm children i child syscall child syscall previous child previous ,fold create child structs into init shm , make the syscall page we can be a bit more than the syscall process
3655,public protected factory implementation class boost log no vtable boost symbol visible impl class boost symbol visible impl public attribute impl private ,removed attribute which is no longer valid , fix a bug in the parser parser test for the parser and the parser has been removed from the same class piperorigin revid change id ieadfcffeeccd
3656,class mkllayoutrewritepass public graphoptimizationpass datatype type getnodeattr perm node def dtype type here we directly access to the tensor context rather than here we directly access to the tensor content rather than int val this is because we find int val is not set properly under some circumstances if type dt int32 ,fix a typo co authored by wenxizhu wenxi zhu intel com , fix a bug in the delegate of the delegate piperorigin revid
3657,std unique ptr kernelthunk iremitterunnested llvm type int8 double pointer llvm pointertype get b getint8ptrty 0 for int64 idx gte index loc loc int8 double pointer loc b loc int8 double pointer loc load loc b getint64 idx void iremitterunnested llvm type shuffled value type element type isstructty b bit width element type auto convert pointer for shuffle llvm value ptr return return b ptr shuffled value type getpointerto llvm value partial result ,address review feedbacks removed interface changes in ir builder update comments rename to , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3658,void genstruct const parser parser structdef struct def code n code type flatbuffers bytebuffer n code n code this bb undefined n code this bb null n code n code n code type number n ,reverting part of pr this is because it trips up the closure compiler with errors like error assignment to property bb of found undefined required flatbuffers bytebuffer null this bb undefined change id , fix a bug in the parser test piperorigin revid
3659,bool isopallowedtf2xlafallback operation op typeid get tf eluop typeid get tf typeid get tf erfcop typeid get tf typeid get tf erfop typeid get tf expm1op typeid get tf bool isopallowedtf2xlafallback operation op typeid get tf typeid get tf mulop typeid get tf multinomialop typeid get tf typeid get tf negop typeid get tf nextafterop typeid get tf nonmaxsuppressionv4op ,enable fallback legalization for erfinv and ndtri ops piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id icbecbbdcaecdf
3660,def unused grad return none ops registergradient ceil def unused grad return none ops registergradient round def unused grad return none ops registergradient rint def unused grad the gradient of rint is zero ,add missing gradients to tf ceil and tf round change , tf data dataset dataset to tf data dataset piperorigin revid
3661,typedef int small rect typedef int textmetric typedef int uint typedef int wchar typedef int typedef int word typedef int wparam typedef void void ,patch proto files are not in sync with the source code problem proto files are not in sync with the source code solution update the proto files , patch problem when using a popup window with a terminal window solution add a test for the cursor
3662,public final class stat extends table public long val int o offset 6 return o 0 bb getlong o bb pos 0 public boolean mutateval long val int o offset 6 if o 0 bb putlong o bb pos val return true else return false public int count int o offset 8 return o 0 bb getshort o bb pos 0xffff 0 public boolean mutatecount short count int o offset 8 if o 0 bb putshort o bb pos count return true else return false public boolean mutatecount int count int o offset 8 if o 0 bb putshort o bb pos short count return true else return false public static int createstat flatbufferbuilder builder int id ,begin to correct c bytebuffer behavior , fix a bug in the parser test piperorigin revid
3663,class eageroprewritetest absl make unique staticdevicemgr devicefactory newdevice cpu job localhost replica 0 task 0 device cpu 0 bool async false bool lazy remote tensor copy false tensorflow rendezvous rendezvous new tensorflow intraprocessrendezvous device mgr get std unique ptr tensorflow eagercontext eager ctx class eageroprewritetest sessionoptions tensorflow contextdeviceplacementpolicy device placement silent tensorflow contextmirroringpolicy mirroring none async device mgr get false rendezvous lazy remote tensor copy device mgr get false rendezvous getdefaultcustomkernelcreator eagerexecutor executor false ,fixing compilation error in eager test , xla python python gpu support to be enabled piperorigin revid
3664,static char features static int included patches add new patch number below this line 606 605 ,patch cannot set the context for a specified quickfix list problem cannot set the context for a specified quickfix list solution use the list index instead of the current list yegappan lakshmanan , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3665,class tfetensortest test util tensorflowtestcase self assertin id d shape s dtype s numpy n r t id t shape t dtype name t numpy tensor repr def disabled testtensorstrreprobeynumpyprintoptions self def testtensorstrreprobeynumpyprintoptions self orig threshold np get printoptions threshold orig edgeitems np get printoptions edgeitems np set printoptions threshold 2 edgeitems 1 ,fix another bad merge artifact , tf data dataset dataset dataset to be a single tensor piperorigin revid
3666,void populatehlotolhloconversionpattern hlotolhloopconverter xla hlo copyop hlotolhloopconverter xla hlo cosop hlotolhloopconverter xla hlo divop hlotolhloopconverter xla hlo dotop hlotolhloopconverter xla hlo expop hlotolhloopconverter xla hlo imagop hlotolhloopconverter xla hlo iotaop ,add legalization from hlo dot to lhlo dot piperorigin revid change id , xla gpu support for xla hlo ir piperorigin revid change id idadedfddaccd
3667,class tflitetensorbuffer public basetflitetensorbuffer class stringtflitetensorbuffer public basetflitetensorbuffer public explicit stringtflitetensorbuffer const tflitetensor tensor stringtflitetensorbuffer tensor tensor data raw nullptr getstringcount tensor data raw 0 stringtflitetensorbuffer tensor tensor data raw nullptr getstringcount tensor 0 stringtflitetensorbuffer override class stringtflitetensorbuffer public basetflitetensorbuffer if data tensorflow tstring p static cast tensorflow tstring data for size t i 0 i num strings p i auto ref getstring tensor data raw i auto ref getstring tensor i p assign ref str ref len ,use tensor and tensor i instead of the raw pointer overloads where applicable piperorigin revid , fix a bug in the delegate piperorigin revid
3668,export class minimap continue for let i 0 i length i i n remove tf selectors from the i replace tf w g n catch e if e name ,fix minimap due to how the new polymer version handles shadow dom styles change , fix a bug in the documentation of the new version of the default of the default value of the default value of the default value of the same value piperorigin revid
3669,def foldl fn elems initializer none parallel iterations 10 back prop true lambda i a i n compute i a parallel iterations parallel iterations back prop back prop swap memory swap memory swap memory swap memory maximum iterations n todo akshayka remove the in graph mode check once caching devices are supported in eager def fn elems initializer none parallel iterations 10 back prop true compute i a parallel iterations parallel iterations back prop back prop swap memory swap memory swap memory swap memory maximum iterations n todo akshayka remove the in graph mode check once caching devices are supported in eager ,similar to cl specify the maximum iterations to tf while loop in tf foldl and tf foldr to be compatible with xla piperorigin revid , fix a bug in the docstring of the docstring of the tf data strategy piperorigin revid
3670,class feature enum auto control deps 'insert of control dependencies in the generated code ' decorators 'allow decorators in local functions note that special decorators ' 'allow decorators in local functions note that special decorators ' ' like ag convert or tf function are allowed regardless of this toggle ' error rewriting 'rewrite errors that occur in the generated code to indicate the source' ' code to which the failing code corresponds ' lists 'convert list idioms like initializers slices append etc ' name scopes 'insert name scopes that name ops according to context like the' ' function they were defined in ' def repr self return self name ,move the error rewriting and auto name scoping mechanisms to experimental piperorigin revid , fix a bug in the documentation of the documentation of the new api change
3671,static char features static int included patches add new patch number below this line 1858 1857 ,patch test for multi byte mapping fails on some systems problem test for multi byte mapping fails on some systems solution test in another way , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3672,class bbargument basic blocks form a graph the cfg which can be through predecessor and successor edges class basicblock public llvm ilist node with parent basicblock cfgfunction public irobjectwithuselist public llvm ilist node with parent basicblock cfgfunction public explicit basicblock basicblock ,implement the groundwork for predecessor successor iterators on basic blocks give basicblock a use def list making references to them in into a type that maintains the list piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id iefecfafdafabefecbd
3673,void dump pid slots void printf slot d d n i shm pids i int pid is valid pid t pid if pid 65535 pid 1 output sanity check failed found pid d n pid return false return true define debugf if debug true printf static void fork children static void handle children if pid empty pidslot continue if pid is valid pid false return pid waitpid pid childstatus wuntraced wcontinued wnohang if pid 0 handle child pid childstatus ,factor out the pidmap sanity check and call it when we're in handle children as well as from the watchdog this should fix a rare bug where we corrupt the pidmap just after reaching the maximum syscall count and get stuck because pidmap empty never returns true , make the syscall page we can be a child process
3674,class session the sessionoptions target field virtual status close 0 note ashankar as of july 2017 this is was a method added to faciliate some experimentation reconsider re evaluate after september 2017 note ashankar as of july 2017 this method was added to faciliate some experimentation reconsider re evaluate after september 2017 sets output to the devicemgr that owns accessible devices in the address space of the caller ,fix comment piperorigin revid , tf data service support for tf data dataset piperorigin revid
3675,static char features static int included patches add new patch number below this line 1215 ,patch mouse middle click is not tested problem mouse middle click is not tested solution add a test dominique pelle closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3676,struct spatialavgpooling typename ttypes t 4 consttensor input int window rows int window cols int row stride int col stride const eigen paddingtype padding because we swap the layout we swap the row cols as well output swap layout device d eigen spatialavgpooling input swap layout window cols window rows col stride row stride padding if eigen internal is same device eigen gpudevice value use 32bit indexing to speed up the computations to32bit output swap layout device d eigen spatialavgpooling to32bit input swap layout window cols window rows col stride row stride padding else because we swap the layout we swap the row cols as well output swap layout device d eigen spatialavgpooling input swap layout window cols window rows col stride row stride padding ,use bit indexing to perform average pooling this improves the performance of the inception model by almost on my gtx titan black change , fix a bug in the new delegate piperorigin revid
3677,class onehotcolumn featurecolumn math ops equal array ops rank dense id tensor 2 tensor should be of shape batch max num values with ops control dependencies check shape op one hot must be float for tf concat reasons since all other inputs to input layer are float32 one hot id tensor array ops one hot dense id tensor depth self length on value 1 off value 0 dense id tensor depth self length on value 1 0 off value 0 0 reduce to get a multi hot per example reduce to get a multi hot per example return math ops reduce sum one hot id tensor reduction indices 1 pylint disable unused argument ,cast output of one hot column to float so that it works in with float columns added test to catch errors like this in the future change , fix a bug in the docstring of the test case piperorigin revid
3678,channel parse messages void if channel ch killing channel free contents channel channel free channel channel channel ch job jv channel null channel free channel else channel free channel channel has been freed start over channel first channel continue ,patch channel contents might be freed twice problem channel contents might be freed twice solution call either channel free channel or channel free not both nobuhiro takasaki closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
3679,limitations under the license include tensorflow lite delegates gpu delegate h endif define log x std cerr define log severity std cerr severity namespace tflite namespace label image ,lite improve log macro definition in label image example in particular output the as a prefix e g info on the message logged piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
3680,llvm function iremitterunnested buildkernelprototype the last argument is a pointer to the temporary buffer memory block we know that it doesn't alias any of the escaped arguments the inputs the result we also know how many bytes can be dereferenced in it const llvm argument temp buffer kernel back const llvm argument temp buffer std prev kernel arg end int64 temp buffer arg no temp buffer getargno if const bufferallocation allocation ir emitter context buffer assignment ,update xla for removal of targetoptions llvm r removes in favor of args etc in xla llvm r change , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
3681,absl status gpuoperationfromnode const gpuinfo gpu info conv op operation selectconvolutiontransposedwithdynamicweights attr gpu info conv def conv weights desc int aligned output alignbyn weights shape b conv weights desc output group size 4 const int out group size conv weights desc layout conv weights desc output group size 1 int aligned output alignbyn weights shape b out group size 4 int aligned input alignbyn weights shape c 4 gpu subgraph new tensors bhwc 1 1 1 ,added selectors for optimized versions of convolutions transposed with dynamic weights piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id idaceccfcbacfece
3682,void mul const float input1 data const dims 4 input1 dims output activation max output data output dims inline void mul const int32 input1 data const dims 4 input1 dims const int32 input2 data const dims 4 input2 dims int32 output activation min int32 output activation max int32 output data const dims 4 output dims gemmlowp scopedprofilinglabel label mul int32 const int flat size matchingflatsize input1 dims input2 dims output dims for int i 0 i flat size i output data i activationfunctionwithminmax input1 data i input2 data i output activation min output activation max template fusedactivationfunctiontype ac void mul const int32 input1 data const dims 4 input1 dims const int32 input2 data const dims 4 input2 dims ,add int support for mul piperorigin revid , xla gpu support for the cpu backend piperorigin revid change id id idaceccfcbacfece
3683,class jstsgenerator public basegenerator generate mapping between enumname int if reverse code enum def tostring ev code ' enum def tostring ev ' code lang language idloptions kts code ' ev name ' else ,javascript fix syntax error for signed enum wrap quotes to enum name map to prevent syntax when enum value is negative add a test that covers signed enum case , fix a bug in the parser test piperorigin revid
3684,class deffunctiontest xla test xlatestcase self assertallclose 40 0 f 2 0 self assertallclose 40 0 28 0 g 2 0 self assertallclose 40 0 f get concrete function 2 0 2 0 self assertallclose 40 0 28 0 g get concrete function 2 0 2 0 def self ,tfxla inject xlacontrolflowcontext in concretefunction as it can be called directly bypassing function piperorigin revid change id , fix a bug in the graph piperorigin revid
3685,class batchnormalizationbase layer if self virtual batch size is not none virtual batches aka ghost batches can be simulated by reshaping the tensor and reusing the existing batch norm implementation original shape d if d is not none else 1 for d in inputs shape as list original shape 1 original shape 1 expanded shape self virtual batch size 1 original shape 1 original shape array ops shape inputs original shape array ops concat constant op constant 1 original shape 1 axis 0 expanded shape array ops concat constant op constant self virtual batch size 1 original shape 1 axis 0 will cause errors if virtual batch size does not divide the batch size inputs array ops reshape inputs expanded shape ,update to use tf shape to get the shape of the tensor from review comment signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the test case piperorigin revid
3686,inline realtype cdf const complemented2 type inverse gaussian distribution realt return result if false detail check location function mean result policy return result if false detail check x function x result policy if false detail check positive x function x result policy return result normal distribution realtype n01 ,update more distribution tests from inverse down to gamma refs svn r , fix a bug in the new parser test svn r
3687,void dump syscall tables void outputstd syscalls d 64 bit n max nr 64bit syscalls for each 32bit syscall i outputstd entrypoint d s 32 bit outputstd entrypoint d s 32 bit syscalls 32bit i entry number syscalls 32bit i entry name show state syscalls 32bit i entry flags active void dump syscall tables void outputstd n for each 64bit syscall i outputstd entrypoint d s 64 bit outputstd entrypoint d s 64 bit syscalls 64bit i entry number syscalls 64bit i entry name show state syscalls 64bit i entry flags active ,add back a missing space that got inadvertantly dropped , make the syscall page we can be a bit more than the syscall process
3688,entry test expect true runandcompare errorspec 0 001 todo b enable this test for the gpu backend once the bug is fixed xla test f disabled on gpu constexpr char r hlomodule testmodule entry test output f32 3 3 64 64 parameter 0 kernel f32 672 7 7 64 parameter 1 reverse f32 672 7 7 64 3 2 1 0 reverse f32 672 7 7 64 3 2 1 0 kernel dimensions 1 2 root convolution f32 672 9 9 64 3 2 1 0 convolution f32 3 3 64 64 3 2 1 0 output f32 672 7 7 64 3 2 1 0 reverse window size 7x7 pad 6 6 dim labels expect true runandcompare errorspec 0 01 0 01 namespace namespace xla ,add convolution test to reproduce a bug the gpu backend matches this to a backward input convolution and then the call to cudnn fails piperorigin revid , xla gpu support for xla hlo client piperorigin revid
3689,did set string option skip optional filename after 'k' and 's' while s s ' ' s ' ' if s ' ' if s ' ' s 1 nul s s ,patch illegal memory access when 'complete' ends in a backslash problem illegal memory access when 'complete' ends in a backslash solution check for trailing backslash dominique pelle closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
3690,statusor std unique ptr thunk iremitterunnested if the literal is 8 or 16 bits wide we can emit a 32 bit memset by repeating the literal 4 or 2 times so long as the destination buffer is an even multiple of 32 bits long const shape output shape shapeutil getsubshape hlo shape index if num bytes 1 num bytes 2 shapeutil bytesizeof hlo shape 4 0 shapeutil bytesizeof output shape 4 0 uint16 pattern16 if num bytes 1 uint8 b literal bytes front ,xla gpu pick the right shape for emitting for elements with size otherwise this could would be wrong for multi output fusions of fp or bf we currently never use those for reduce fusions on gpu piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3691,error logger error fatal logger fatal info logger info warn logger warn warning logger warn warning logger warning level names fatal ,replaced logger warn with logger warning , fix a bug in the documentation of the new version of the client client client piperorigin revid
3692,def add gradients summaries grads and vars else grad values grad summaries append summary histogram var op name ' gradient' grad values summary histogram var op name ' gradient' grad values summaries append summary histogram var op name ' gradient norm' summary histogram var op name ' gradient norm' clip ops global norm grad values else logging info 'var s has no gradient' var op name ,update summary names in add gradients summaries to conform to the new summary api convention change , fix a bug in the docstring of the docstring of the test case piperorigin revid
3693,class subgraph interpreter tflitestatus setvariables std vector int variables adds a node with the given parameters and returns the index of the new node in node index optionally interpreter will take ownership of builtin data and destroy it with free ownership of 'init data' class subgraph return nodes and registration node index change the dimensionality of a given tensor note this is only acceptable for tensor indices that are inputs returns status of failure or success class subgraph return ktfliteok the default capacity of tensors vector static constexpr int ktensorsreservedcapacity 128 the capacity headroom of tensors vector before calling ops' ,changing subgraphs to vector of unique ptrs piperorigin revid , fix a bug in the test piperorigin revid
3694,status algebraicsimplifiervisitor handlesort hloinstruction sort if it is key value sort the output of sort is a tuple return replacewithnewinstruction sort hloinstruction createtuple operand sort mutable operand 1 sort hloinstruction createtuple sort operands return status ok ,xla add documentation and hlo level support for multi value sort no support in any of the backends and not yet exposed through xlabuilder piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3695,tensorflow status convertcalibgraphtoinfergraph return tensorflow errors failedprecondition need to run graph with calibration data first tensorflow core scopedunref calib sc cres if cres calibrator cres calibrator cres thr join tensorflow status convertcalibgraphtoinfergraph return tensorflow errors unknown can't get trtcalibrator from resource manager cres unref tf return if error calib rm cleanup container name ,use scopedunref in convert graph cc to unref resource on error piperorigin revid , xla python add a test for the xla client piperorigin revid
3696,void findconstantfoldablenodes const graph graph typedef std pair node int given the constant foldable nodes in returns a new graph 'g' 'g' will contain copies of the nodes in in addition if there is an edge going from a node 'n' in to another node in graph' but not in ,remove redundant typedef of it was already defined in the header some compilers are less to give you the benefit of the when there's a type with the same name declared in tensorflow and tensorflow anonymous namespace change , add a new method to the tf function piperorigin revid
3697,static void ioctl mangle cmd int childno static void ioctl mangle arg int childno the argument could mean anything because ioctl sucks like that switch rand bool case 0 shm a3 childno rand32 break case 1 shm a3 childno unsigned long page rand generate random page page rand break default break if rand bool shm a3 childno rand32 else shm a3 childno unsigned long get non null address static void generic sanitise ioctl int childno ,ioctl don't use page rand directly using get non null address gives more variation , fix a bug in the syscall page
3698,namespace boost else if n 0 return octonion t 1 return octonion t static cast t 1 else n 0 return pow octonion t 1 o n return pow octonion t static cast t 1 o n ,cast arguments to quaternion constructors so they still work when there's no implicit conversion available fixes svn r , fix a bug in the parser test for the new parser test
3699,class dirichletmultinomialtest tf test testcase self assertless 5 pmf different eval pmf same eval self assertequal pmf same get shape def self make totally invalid input with self test session alpha 1 2 alpha should be positive counts 1 0 0 1 counts should be non negative n 5 3 n should be a non negative integer equal to counts sum dist tf contrib distributions dirichletmultinomial n alpha strict false dist pmf counts eval should not raise if name ' main ' tf test main ,implement kwarg in dirichlet multinomial change , fix a bug in the test case piperorigin revid
3700,test f analyticalcostestimatortest simpletest costs summary tf assert ok estimator predictcosts item graph cost graph summary expect eq costs nanoseconds summary execution time expect eq costs nanoseconds 9136 summary execution time expect false summary inaccurate ,estimate cost for element wise ops and a minimum compute cost for dummy execution time piperorigin revid , fix a bug in the graph piperorigin revid
3701,valid spellfile char u val char u s for s val s nul s if vim isfilec s s ' ' if vim isfilec s s ' ' s ' ' return false return true ,patch cannot use a space in 'spellfile' problem cannot use a space in 'spellfile' filipe brandenburger solution permit using a space closes , patch problem when using a channel to be a dictionary of a terminal window solution add a test for the command line
3702,include boost assert hpp include boost config hpp include boost config suffix hpp include boost function hpp include boost lambda lambda hpp include boost math tools rational hpp ,polynomial hpp should not be including private boost config header , fix a bug in the new parser test svn r
3703,status inferencecontext shapehandle input shape tf return if error withrankatmost input input idx 1 input shape requested input tensor as partial shape input idx true request input tensor as partial shape input idx const int input tensors as shapes size input tensors as shapes size if input idx input tensors as shapes size input tensors as shapes input idx isset status inferencecontext makeshapefromshapetensor int input idx shapehandle input shape tf return if error withrank input input idx 1 input shape requested input tensor as partial shape input idx true request input tensor as partial shape input idx const int input tensors as shapes size input tensors as shapes size if input idx input tensors as shapes size input tensors as shapes input idx isset ,support constant folding across arg nodes during shape inference on nested function calls piperorigin revid change id , fix a bug in the graph optimizer piperorigin revid
3704,def matrixtriangularsolvegrad op grad def selfadjointeigv2grad op grad e grad v e op outputs 0 v op outputs 1 compute v op get attr compute v a op inputs 0 which satisfies a v i e i v i with ops control dependencies grad e op grad v op if grad v is not none if compute v v op outputs 1 construct the matrix f i j i j 1 e i e j 0 notice that because of the term involving f the gradient becomes infinite or nan in practice when eigenvalues are not unique def selfadjointeigv2grad op grad e grad v v adjoint b true else v linalg ops self adjoint eig op inputs 0 grad a math ops matmul v math ops matmul array ops matrix diag grad e v adjoint b true ,add unit tests and fix broken gradient calculation for tf self adjoint update documentation to warn the user that there is no advantage to using tf self adjoint over tf self adjoint eig the opposite in fact if through it fixes piperorigin revid , tf data dataset dataset to tf data dataset piperorigin revid
3705,limitations under the license include llvm ir llvmcontext h include llvm ir legacypassmanager h include llvm ir module h include llvm h include llvm h include llvm ir verifier h include llvm linker linker h include llvm passregistry h include llvm support commandline h limitations under the license include llvm target targetmachine h include llvm transforms h include llvm transforms h include llvm transforms passmanagerbuilder h include llvm transforms h include llvm transforms passmanagerbuilder h include llvm transforms scalar h include tensorflow compiler xla types h include tensorflow core lib core stringpiece h include tensorflow core lib io path h ,include more appropriate llvm headers piperorigin revid , xla gpu support for the client client piperorigin revid change id icbbdbfafcdfcae
3706,set one cmd context break endif ifdef feat eval case cmd const case cmd let case cmd if case cmd elseif ,patch const cannot be followed by endif problem const cannot be followed by endif solution check following command for const closes also fix completion after const , patch problem when using a terminal window is a bit slow solution add a test for the gui
3707,t newton raphson iterate f f t guess t min t max int digits boost uintmax t shift delta 0 result min 2 result max 2 if result 0 fabs shift fabs result delta sign delta result protect against huge jumps delta sign delta fabs result protect against huge jumps delta sign delta result protect against huge jumps failed for negative result https github com math issues 216 else delta shift ,tentative fix for failure to converge https github com boostorg math issues , fix a bug in the parser test that the test fails on the same case of the same value of the same value of the same value of the same value of the same value of the same value of the same value
3708,class cpuelementaliremitter public elementaliremitter const hlotoelementgeneratormap operand to generator const override protected statusor llvm value emitfloatunaryop const hloinstruction op llvm value operand value const override statusor llvm value emitatan2 primitivetype prim type llvm value lhs llvm value rhs const override statusor llvm value emittanh primitivetype prim type llvm value value const override iremitter ir emitter ,xla make tanh emission more like the other ops no reason for tanh to be the odd one out piperorigin revid , xla gpu support for the hlo client piperorigin revid change id icabdabcccecababba
3709,using std cout using std endl using namespace boost math policies or using boost math policies policy possible errors using boost math policies overflow error using boost math policies domain error using boost math policies pole error using boost math policies denorm error using boost math policies evaluation error using boost math policies ignore error define a custom policy to ignore just overflow ,changed to avoid using namespace boost math svn r , fix a bug in the parser parser test for the parser and the parser has been removed from the same class piperorigin revid change id ieadfcffeeccd
3710,vterm get special pty type placeholder void the rest added by paul evans static const struct interval fullwidth include fullwidth inc internal int vterm unicode width uint32 t codepoint if codepoint fullwidth sizeof fullwidth sizeof fullwidth 0 1 return 2 return function codepoint ,patch libvterm code lags behind the upstream version problem libvterm code lags behind the upstream version solution include revision , patch problem when using a terminal window is a bit slow solution add a test for the gui
3711,class public resourcebase return status ok attrvaluemap attr values func attr attrvalue v v set s target device addattr target v attr values return lib instantiate func name attrslice attr values handle return lib instantiate func name attrslice attr values target device handle returns true if we've got to the end of the sequence and exhausted the ,add functionlibraryruntime instantiateoptions struct this new struct allows optional arguments to be passed to the functionlibraryruntime instantiate api the new struct is now used to configure the target device for a function instantiation instead of an attr piperorigin revid , xla gpu support for the layout of the layout is a bit piperorigin revid
3712,static void emitoperandserialization const operator op arrayref smloc loc os tabs auto argid getvalueid arg n os tabs if argid n os tabs formatv emiterror 0 getloc operand 1 has a use before def n opvar operandnum formatv return emiterror 0 getloc operand 1 has a use before def n opvar operandnum os tabs n os tabs formatv 0 push back argid n operands os n ,spirv properly return when finding error in serialization piperorigin revid , fix a bug in the new code of the new code piperorigin revid
3713,def make neg tests options test parameters input dtype tf float32 tf int32 input shape 1 3 4 3 5 input shape 1 3 4 3 5 def build graph parameters ,add scalar graph test for lite neg , tf data dataset dataset dataset to be used for tf data dataset piperorigin revid
3714,from future import absolute import from future import division from future import print function from tensorflow python client import device lib from tensorflow python distribute cluster resolver cluster resolver import clusterresolver from tensorflow python distribute cluster resolver cluster resolver import format master url from tensorflow python training import server lib class kubernetesclusterresolver clusterresolver on internal systems return '' def num accelerators self task type none task index none accelerator type 'gpu' config proto none todo frankchn make querying non local accelerators work if task type is not none or task index is not none raise notimplementederror 'querying non local accelerators is not yet' 'implemented ' local devices device lib list local devices config proto return sum d device type accelerator type for d in local devices ,unify num accelerators for all cluster resolvers piperorigin revid , fix a bug in the test case piperorigin revid
3715,void const std string tflite path if for micro if builtin ops empty include tflite path experimental micro kernels micro ops h n include tflite path micro kernels micro ops h n include tflite path experimental micro micro mutable op resolver h n micro micro mutable op resolver h n else if builtin ops empty include tflite path ,tfl selective registration fix include path for micro related code micro code has been moved outside the experimental folder this tool has been used manually for tflm no integrated target so we don't have a ci to catch this issue piperorigin revid change id , xla python fix a bug in the hlo computation piperorigin revid change id id iaaeabfdfedfeacedf
3716,class var public resourcebase tensor shape debugstring only used in the resource variable path in resource variables tensor isinitialized can be true i e have memory allocated to it while there is not a good value there due to a race condition and it's possible to upon this during variable initialized value so it's best to just store directly whether the variable is initialized bool is initialized false guarded by mu but doesn't like it private mutex mu tensor tensor ,fix subtle race condition in resourcevariable is initialized piperorigin revid , fix a bug in the test case piperorigin revid
3717,test commonshapefnstest biasaddshapetest finalize def inferencecontext c tf graph def version def op def s 8 6 4 2 3 4 5 s 3 tf expect ok biasaddshape c shapehandle output c output 0 expect eq 8 6 4 2 3 4 5 c debugstring output expect false biasaddshape c ok ,fix incorrect shape test in common shape fns test cc signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the test case piperorigin revid
3718,unsigned int user specified children 0 bool do specific domain false bool no domains trinity pf max bool dry run false bool show syscall list false bool show ioctl list false unsigned char quiet level 0 static const struct option longopts dropprivs no argument null 'x' debug no argument null 'd' disable fds required argument null 0 dry run no argument null 0 enable fds required argument null 0 exclude required argument null 'x' group required argument null 'g' void parse args int argc char argv if strcmp enable fds longopts opt index name 0 process fds param optarg true if strcmp dry run longopts opt index name 0 dry run true break ,add a dry run argument to disable the 'do the syscall' path , fix a bug in the syscall page
3719,declare graph transformation resolveconstantshapeorrank declare graph transformation resolveconstantstack declare graph transformation resolveconstantstridedslice declare graph transformation resolveconstantfill declare graph transformation resolveconstantgather declare graph transformation resolvemultiplybyzero declare graph transformation dequantize declare graph transformation unpartitionembeddinglookup ,adding support for constant gather ops piperorigin revid , tf data optimization optimization optimization piperorigin revid change id idadabbfadafcd
3720,limitations under the license namespace tensorflow namespace using inlinefunctionbodyoptions using outputcontrolsrc inlinefunctionbodyoptions outputcontrolsource constexpr const char const status node n graph g note ezhulenev we explicitly choose not to deal with symbolicgradient because it has been deprecated for a long time inlinefunctionbodyoptions inline options inline options keep caller fetchable keep caller fetchable inline options keep caller node keep caller fetchable if n multi device function calls partitionedcall or statefulpartitionedcall ,add an option to keep inlined function call node piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3721,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2019 12 27 forward compatibility horizon datetime date 2019 12 28 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
3722,dictionaryassitem if dict add dict di fail vim free di dictitem free di raise key add fail key py xdecref todecref ,patch python double free when adding item to dict fails problem python double free when adding item to dict fails solution remove vim free call , patch problem when using a terminal window doesn't work solution add a test for the command line
3723,status gcsfilesystem getchildren const string dirname return errors internal unexpected json format 'items name' is missing or not a string result push back strings strcat gs bucket name asstring c str the names should be relative to the that means the 'object prefix' which is part of should be removed from the beginning of 'name' string name str name asstring result emplace back name str begin object prefix size name str end return status ok ,changing to not return names with complete gs path change , xla python add a test for the xla client client piperorigin revid
3724,endif endif c 11 specifies that initializer list provides std initializer list use that if gtest is used in c 11 mode and isn't very old binaries targeting os x 10 6 can build with clang but need to use if gtest lang cxx11 defined glibcxx glibcxx define gtest has std initializer list 1 endif brings in definitions for functions used in the testing internal posix namespace read write close chdir isatty stat we do not currently use them on windows mobile ,distinguish between c language and library support for initializer list fix spelling repositary repository , patch problem when using a terminal window is a bit solution add a test for the cursor
3725,viewop linalg value view auto viewtype view gettype dyn cast viewtype void viewtype assert viewtype isa viewtype expected a viewtype while auto slice view getdefiningop dyn cast sliceop while auto slice dyn cast sliceop view getdefiningop view slice assert viewtype isa viewtype expected a viewtype std pair mlir value unsigned linalg value view void viewtype assert viewtype isa viewtype expected a viewtype assert dim viewtype getrank dim exceeds rank if auto viewop view getdefiningop dyn cast viewop if auto viewop dyn cast viewop view getdefiningop return std make pair viewop getindexing dim dim auto sliceop view getdefiningop cast sliceop ,add support for using llvm dyn cast cast isa for operation casts and replace usages of operation dyn cast with llvm dyn cast piperorigin revid , xla gpu support for the hlo ir piperorigin revid change id icabdabcccecababba
3726,namespace gpu namespace cl namespace test f opencloperationtest mean test f opencloperationtest tensorfloat32 src tensor src tensor shape bhwc 1 2 2 1 src tensor data 1 0f 2 0f 3 0f 4 0f meanattributes attr attr dims insert axis height attr dims insert axis width for auto storage env getsupportedstorages for auto precision env getsupportedprecisions test f opencloperationtest mean op def src tensors push back data type storage layout hwc op def dst tensors push back data type storage layout hwc tensorfloat32 dst tensor mean operation createmean op def env getdeviceptr info mean operation createmean attr op def env getdeviceptr getinfo assert ok executegpuoperation src tensor creation context absl make unique mean std move operation ,added support of reduction in any axis beside channels for mean in opencl piperorigin revid change id , xla gpu support for the hlo evaluator piperorigin revid change id icabdabcccecababba
3727,class indexedslices internal nativeobject composite tensor compositetensor gradients for operations that have sparse gradients e g tf gather v tf variable 0 1 2 2 3 4 4 5 6 6 7 8 with tf gradienttape as tape r tf gather v 1 3 index slices tape gradient r v index slices indexedslices object index slices indices numpy array 1 3 dtype int32 index slices values numpy array 1 1 1 1 1 1 dtype float32 contrast this representation with tf sparse sparsetensor which uses multi dimensional indices and scalar values ,add an example of an indexedslices piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
3728,def resize images images new width const tensor util constant value new width new height const tensor util constant value new height if new width const is not none and new height const is not none and width new width const and height new height const if we can determine that the height and width will be unmodified by this transformation we avoid performing the resize if all x is not none for x in new width const width new height const height and width new width const and height new height const if not is batch images array ops squeeze images squeeze dims 0 return images ,fix the futurewarning in tf image resize images for real this time any of the new and old could be none i e unknown at graph construction time so we must check that they are all non none before using them in a comparison change , fix a bug in the docstring of the test case piperorigin revid
3729,class experiment object steps self eval steps metrics self eval metrics name name use checkpoint latest path checkpoint path latest path todo soergel further throttle how often export happens self maybe export eval result ,fix experiment arg for evaluate change , fix a bug in the docstring of the docstring of the docstring change
3730,static void emittile irarray index source idx tile origin index addoffsettodim start offset x kernelmappingscheme dimx b true when we all threads will always unroll true when all threads will always execute all instructions so we do not need to emit condition bool always full unroll false if mapping scheme getdimsinelems 2 tile size x 0 always full unroll true bool always full tile mapping scheme getdimsinelems 2 tile size x 0 ksl for loop name y in tile static void emittile constant j step x kernelmappingscheme dimx b the if statement below always evaluates to true for the blocks where the entire processed tile fits within the input buffer if always full unroll if always full tile ksl if loop name x in tile b createicmpult x loc tile width emit elem function source idx x y loc x loc j else ,clearer code following code review , fix a bug in the parser test piperorigin revid
3731,limitations under the license include tensorflow compiler xla metric table report h include cctype include unordered map include absl strings ascii h include absl strings str cat h include absl strings str format h include tensorflow core platform logging h string metrictablereport metricstring double metric string output copy leading non digit characters unconditionally this picks up the leading sign while sp1 empty isdigit sp1 0 while sp1 empty absl ascii isdigit sp1 0 output push back sp1 0 sp1 remove prefix 1 ,xla don't rely on for characters instead use the ascii routines in absl this makes the code do the same thing regardless of how the locale is configured piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3732,optimizers v1 and v2 optimizers v1 optimizers v2 graph and eager modes graph eager optimizers v1 and v2 optimizers v1 optimizers v2 def distributions and v1 optimizers return combinations combine ,remove duplicate optimizer combinations piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
3733,from future import print function import copy from tensorflow python frozen keras engine import legacy base layer from tensorflow python keras import layers as layer module from tensorflow python keras engine import base layer from tensorflow python keras engine import input layer class sequential training model if isinstance origin layer input layer inputlayer layer origin layer if not isinstance layer base layer layer if not isinstance layer base layer layer legacy base layer legacybaselayer raise typeerror 'the added layer must be ' 'an instance of class layer ' 'found ' str layer ,update sequential model to accept base layer from frozen copy piperorigin revid change id , fix a bug in the test case piperorigin revid
3734,class hlomodule const hloschedule schedule const return schedule hloschedule schedule return schedule status const private hlocomputation addcomputationinternal std unique ptr hlocomputation computation bool is entry ,xla outline the code that checks the computations and instructions of a module have unique names and ids to a member function of hlomodule piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3735,register op scaleandtranslate t int8 uint8 int16 uint16 int32 int64 bfloat16 half float double attr kernel type string attr antialias bool true setshapefn register op scaleandtranslategrad output output t attr t float attr kernel type string attr antialias bool true setshapefn inferencecontext c c set output 0 c input 1 return status ok ,wrapper for new resize operation that fixes the half pixel bug in previous resize method adds new sampling kernels and an anti aliasing option fixes piperorigin revid , fix a bug in the test case piperorigin revid
3736,def toco convert impl input data input tensors output tensors args return data tf export lite toco convert tf export v1 lite toco convert deprecation deprecated none use lite tfliteconverter instead def toco convert input data input tensors output tensors args kwargs convert a model using toco ,add support for tfliteconverter in piperorigin revid , fix a bug in the documentation of the documentation of the tf data dataset piperorigin revid
3737,int main int argc char argv exit exit success rotate doesn't work with nofork if opmode mode rotate nofork 0 page size getpagesize if seed ,clear f when in rotate mode because we can't carry on where we left off in the new child , fix a bug in the watchdog page
3738,def matmul a sparse matmul types dtypes bfloat16 dtypes float32 use sparse matmul a dtype in sparse matmul types and b dtype in sparse matmul types if a dtype dtypes bfloat16 or b dtype dtypes bfloat16 and if a dtype dtypes bfloat16 or b dtype dtypes bfloat16 and a dtype b dtype matmul currently doesn't handle mixed precision inputs use sparse matmul true ,fix the bug that when both a and b are bfloat tf matmul will use sparse matmul piperorigin revid , tf data optimizer to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3739,def generate combinations we use ordereddicts in combine and times to ensure stable order of keys in each dictionary assert isinstance combination ordereddict name join name join sorted format join filter str isalnum key join filter str isalnum str value for key value in combination items named combinations append ordereddict list combination items testcase name ,fix non determinism in test naming when using combinations piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3740,including negligence or otherwise arising in any way out of the use of this software even if advised of the possibility of such damage author gmail com author a gmail com google test widget cc widget widget int number const std string name name name widget widget float widget const return number float widget const int widget const return static cast int number std string widget getstringvalue const return name ,updating the xcode samples , fix a bug in the parser test piperorigin revid
3741,class testmodule tf module check same arg0 tensor f32 tf saved model index path 0 check same arg1 tensor tf resource tensor f32 tf saved model bound input var check same arg2 tensor tf resource tensor f32 tf saved model bound input const check same tensor f32 tf saved model index path check same tensor xf32 tf saved model index path check same attributes tf saved model exported names some function tf function input signature tf tensorspec tf float32 def some function self x ,flip behavior for savedmodel importer to not use shape inference on import shape inference during import will get deprecated and standalone pass used instead piperorigin revid change id , xla python python python python client piperorigin revid change id idedeaebfbbdabebae
3742,test poolingtest attr type poolingtype max attr output indices true singleopmodel model tostring operationtype max unpooling 2d attr input output indices singleopmodel model tostring operationtype pooling 2d attr input output indices assert true model populatetensor 0 1 2 1 2 3 4 3 4 7 8 7 8 5 6 5 6 assert ok model invoke test poolingtest attr strides hw 2 2 attr type poolingtype max singleopmodel model tostring operationtype max unpooling 2d attr input output singleopmodel model tostring operationtype pooling 2d attr input output assert true model populatetensor 0 1 2 1 2 3 4 3 4 7 8 7 8 5 6 5 6 assert ok model invoke ,ios metal delegate added max pooling indices tests opengl fixed max pooling tests piperorigin revid , fix a bug in the test case piperorigin revid
3743,win line attr pri true ifdef line attr if area attr 0 char attr hl combine attr line attr area attr ifdef feat syn hl if syntax attr 0 char attr hl combine attr syntax attr char attr endif else if search attr 0 char attr hl combine attr line attr search attr ifdef feat syn hl if syntax attr 0 char attr hl combine attr syntax attr char attr endif ifdef feat text prop else if text prop type null ,patch syntax attributes not combined with visual highlighting problem syntax attributes not combined with visual highlighting arseny nasokin solution combine the attributes closes , patch problem when using a terminal window is a bit slow solution add a test for the mouse engine
3744,static struct map get map struct list head head unsigned int max return m j return 0 return null struct map get map void ,get map returns a pointer so return null not , fix a bug in the watchdog process
3745,operationinst operationinst create location location operationname name auto inst unsigned inst gettrailingobjects unsigned unsigned void for if we encounter a sentinal branch to the next operand update the count ,fix variables only used in assertions piperorigin revid , xla gpu support for the hlo instruction piperorigin revid
3746,class dataset dataset ops dataset d d shard flags num workers flags worker index d d repeat flags num epochs d d shuffle flags shuffle buffer size d d repeat d d interleave tf data tfrecorddataset cycle length flags num readers block length 1 d d map parser fn num parallel calls flags num map threads ,remove extra repeat in tf data dataset documentation end public unless i am missing something begin public if num epochs is this isn't needed anyway and if num epochs then this will be buggy because it will cause the output dataset to repeat for more than num epochs piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3747,find help tags d s if tag contains or tag terminates at the this is for help on functions e g abs expr if s ' ' s 1 ' ' s 1 ' ' break if tag starts with ' toss everything after a second ' fixes ctrl on would include the trailing ' ' ,patch problem the help for functions require a space after the solution make ctrl on a function name ignore the arguments hirohito higashi , patch problem when using a terminal window is a bit slow solution add a test for the gui
3748,include random h include sanitise h include shm h include udp h define max inotify fds 5 static void inotify destructor struct object obj static void inotify dump struct object obj unused bool global struct inotifyobj io obj inotifyobj struct msg objmsg output 0 inotify fd d flags x n io fd io flags init msgobjhdr objmsg hdr obj created inotify global obj objmsg fd io fd objmsg flags io flags sendudp char objmsg sizeof objmsg static int open inotify fds void ,log decode inotify objects , move the dtrace proto to the dtrace process to the dtrace process to the dtrace process to be used in the dtrace process to the dtrace process and dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
3749,void moduleprinter location loc if return if the location is not unknown then print it if loc isa unknownloc os printlocation loc os printlocation loc void moduleprinter printlocationinternal location loc ,change trailing locations printing to also print unknown locations this will allow for truly round tripping debug locations given that we assign locations while parsing ir piperorigin revid , xla gpu support for the hlo hlo client piperorigin revid change id idadedfddaccd
3750,limitations under the license define eigen use sycl include tensorflow core framework register types h include tensorflow core framework tensor types h include tensorflow core kernels cwise ops h include tensorflow core platform logging h ,registered add div mul sub ops for sycl device , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3751,prefetchautotuner prefetchautotuner int64 initial buffer size buffer limit initial buffer size if initial buffer size model kautotune mode mode buffer limit std max 1ll buffer size min buffer limit std max int64 1 buffer size min ,use braced integer literal rather than suffixes to ensure compilation regardless of the definition of int piperorigin revid change id , tf data service support for tf data dataset piperorigin revid
3752,void buildprofilersubmodule py module m def static is enabled tracemewrapper isenabled bool if ndebug return true else return false endif ndebug namespace pybind11 module xla extension m pybind11 module xla extension m m def get distributed runtime client m def collect garbage globalpyrefmanager collectgarbage m def is optimized build nolint readability fn size namespace xla ,xla python add is optimized build function that returns true iff xla was built with optimization this is to help track down issues like https github com google jax issues piperorigin revid change id , fix a bug in the new module piperorigin revid
3753,see the license for the specific language governing permissions and limitations under the license include tensorflow core common runtime gpu cupti wrapper h include tensorflow core platform default gpu cupti wrapper h if google cuda limitations under the license include tensorflow core platform stream executor h namespace tensorflow namespace gputracer namespace perftools namespace gputools namespace profiler namespace dynload cuptiresult cuptiwrapper unsubscribe cupti subscriberhandle subscriber return dynload cuptiunsubscribe subscriber namespace gputracer namespace tensorflow namespace profiler namespace gputools namespace perftools endif google cuda ,refactor cupti wrapper dependencies change , add a test for the new op op piperorigin revid
3754,def make tensor into per replica input tensor def normalize value destination pairs value destination pairs result value destination pairs list value destination pairs if not isinstance value destination pairs list tuple raise valueerror value destination pairs should be a list or tuple for pair in value destination pairs ,handle the case when value destination pairs is zip in cross device ops piperorigin revid , tf data dataset to use tf data dataset piperorigin revid
3755,def mean log values def expectation f samples log prob none use reparametrization true axis 0 keep dims false name none computes the monte carlo approximation of e p f x this function computes the monte carlo approximation of an expectation i e ,fix missing r string the docs generator is not happy about the a in is becoming a alert escape sequence this should also fix a lot of the mathjax rendering on this page https www tensorflow org api docs python tf contrib bayesflow monte carlo expectation piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
3756,bool istrivialop const nodedef node const mutablegraphview graph view if isnoop node node input empty return true const nodes are always executed before anything else so if they only have control outputs we can remove them if isconstant node graph view node include nodes false 0 return true return isaddn node numnoncontrolinputs node 1 bool canremovenode const nodedef node const mutablegraphview graph view if isnoop node node input empty return true if isconstant node graph view node include nodes false 0 return true if removalincreasesedgecount node graph view return false ,prune constant nodes that only have control outputs in model pruner these would eventually get pruned in dependency optimizer but it is cheaper and faster to do it in model pruner run pruner again at the end of meta optimizer piperorigin revid , tf data optimization to use the graph piperorigin revid
3757,class iremitterunnested public iremitter absl span const int64 reduced output dims absl span const int64 tiled param ids codegen a tiling kernel for an unnested hlo instruction emits a kernel for the hlo instruction using the given kernel mapping scheme void emittilingkernel const kernelmappingscheme mapping scheme llvm type index ty tileelementgenerator tile element generator kernel prologue generator kernel epilogue generator void emitblock const kernelmappingscheme mapping scheme kernelsupportlibrary ksl llvm value y llvm value x llvm type index ty tileelementgenerator tile generator emits code to process a tensor element in a tile for the given kcopy hlo that performs a 0 2 1 transpose void ,xla gpu nfc remove method the name is problematic it emits the whole thing not just a block and function ends up not doing any actual codegen with it instead decomposed in a number of other functions and called them from piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3758,func value bool false in which case the op will return 3 dimensional tensors and will truncate animated gif files to the first frame note if the first frame of an animated gif does not the entire canvas maximum frame width x maximum frame height then it fills the in the first frame with zeros black for frames after the first frame that does not the entire canvas it uses the previous frame to fill the arguments contents 0 d the encoded image bytes ,go update generated wrapper functions for tensorflow ops piperorigin revid change id , fix a bug in the test case piperorigin revid
3759,std vector interthreadconnectinfo createinterthreadconnectinfolist hosteventtype kfunctionrun hosteventtype kexecutorstateprocess stattype kstepid hosteventtype kfunctionrun hosteventtype kexecutordonecallback stattype kstepid hosteventtype ksessionrun hosteventtype kexecutorstateprocess stattype kstepid hosteventtype ksessionrun hosteventtype kexecutordonecallback stattype kstepid hosteventtype kexecutorstateprocess hosteventtype kiteratorgetnextop stattype kstepid stattype kiternum std vector interthreadconnectinfo createinterthreadconnectinfolist hosteventtype kexecutorstateprocess stattype stattype kstepid connect info list push back event type hosteventtype kexecutordonecallback stattype stattype kstepid return connect info list ,stitch the executor finish event piperorigin revid change id , fix a bug in the test case piperorigin revid
3760,test f variables sm variables kdevicename variables device db expect eq variables gpu gpu expect eq variables gpu gpu test f ,update documentation about the possible values of support status piperorigin revid change id , fix a bug in the test case piperorigin revid
3761,test f variables sm variables kdevicename variables device db expect eq variables gpu gpu expect eq variables gpu gpu test f ,update documentation about the possible values of support status piperorigin revid change id , fix a bug in the test case piperorigin revid
3762,void phonet gen sockaddr struct sockaddr addr socklen t addrlen addrlen sizeof struct sockaddr pn void phonet rand socket struct socket triplet st static void phonet rand socket struct socket triplet st st protocol 0 if rand bool void phonet rand socket struct socket triplet st else st type sock seqpacket struct netproto proto phonet name phonet socket phonet rand socket ,convert pf phonet to use struct netproto , proto zmalloc conversion
3763,class microbenchmarks test benchmark def run self func num iters execution mode none call func to maybe warm up the gpu ctx context context with ctx execution mode execution mode with context execution mode execution mode func if execution mode context async ctx async wait ,modify benchmarks to use new execution mode api piperorigin revid , tf data service support for tf data dataset piperorigin revid
3764,class kerasinitializerstest test testcase target max none target min none variable keras backend variable init shape output keras backend get value variable lim 3e 2 if target std is not none self assertgreater lim abs output std target std if target mean is not none self assertgreater lim abs output mean target mean if target max is not none self assertgreater lim abs output max target max if target min is not none self assertgreater lim abs output min target min test serialization assumes deterministic behavior config init get config reconstructed init init class from config config ,consolidate all keras initializers into ops init ops piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid change id iffafdbbcddfebbeac
3765,static char features static int included patches add new patch number below this line 1650 1649 ,patch problem quickfix test fails solution accept any number of matches , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3766,statusor bool multioutputfusion run hlomodule module changed true clean up state in case this pass is wrapped in an hlopasspipeline candidates clear candidates index clear all fusion candidates clear reachability reset return changed ,xla reset the state of multioutput fusion after run since it may be inside an hlo pipeline piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3767,redo put the pum below row if possible if there are few lines decide on where there is more room if row above row below row row if row 2 below row pum height row above row below row above row 2 pum above row ,patch problem popup menu always appears above the cursor when it is in the lower half of the screen matt gardner solution compute the available space better hirohito higashi closes , patch problem when using a channel to be a character of a character solution add a test for the cursor
3768,number width wp return n endif return the current cursor column this is the actual position on the screen first column is 0 int screen screencol return screen cur col return the current cursor row this is the actual position on the screen first row is 0 int screen screenrow return screen cur row ,updated for version problem cannot properly test conceal mode solution add the and functions use them in test simon ruderich , patch problem when using a terminal window is a bit slow solution add a test for the command line
3769,limitations under the license include tensorflow core profiler convert xplane to trace events h include tensorflow core profiler internal profiler factory h include tensorflow core profiler lib profiler utils h include tensorflow core profiler utils group events h endif namespace tensorflow status profilersession serializetostring string content profiler trace trace if defined is mobile platform uint64 end time ns envtime nownanos profiler grouptfevents xspace event group name map nullptr profiler convertxspacetotraceevents start time ns end time ns xspace trace endif ,automated rollback of commit piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3770,inline void meanimpl const tflite meanparams op params temp sum optimized ops multiplybyquantizedmultiplier4rows temp sum multiplier shift temp sum multiplybyquantizedmultiplier4rows temp sum multiplier shift temp sum val 0 vaddq s32 temp sum val 0 bias dup temp sum val 1 vaddq s32 temp sum val 1 bias dup ,migrate to common piperorigin revid change id , fix a bug in the new api of the new delegate piperorigin revid change id icfcccdcbedbaacf
3771,void calculateactivationrangeuint8 tflitefusedactivation activation act max void calculateactivationrangeint8 tflitefusedactivation activation tflitetensor output int32 t act min int32 t act max const int32 t qmin std numeric limits int8 t min const int32 t qmax std numeric limits int8 t max activation qmin qmax output act min act max bool havesameshapes const tflitetensor input1 const tflitetensor input2 return tfliteintarrayequal input1 dims input2 dims ,create quantized averagepool with asymmetric quantization with int as input and output piperorigin revid , fix a bug in the test case piperorigin revid
3772,static char features static int included patches add new patch number below this line 1261 1260 ,patch program in terminal window gets nl instead of cr problem program in terminal window gets nl instead of cr lifepillar solution check the tty setup more often closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3773,bool hardcodeminmax run model model std size t op index changed model op 0 255 256 break case operatortype ktanh we hardcode quantization params to zero point 127 scale 1 128 this choice of minmax is the one that is equivalent to that changed model op 127 128 1 0 break default break ,support for quantized lstm models piperorigin revid , add a test for the new op api piperorigin revid
3774,class chainbijectortest test testcase def testshapegetters self with self test session bijector chain softmaxcentered event ndims 1 validate args true softmaxcentered event ndims 0 validate args true softmaxcentered validate args true softmaxcentered validate args true x tensor shape tensorshape x tensor shape tensorshape 1 y tensor shape tensorshape 2 1 self assertallequal y bijector forward event shape x self assertallequal ,breaking change remove bijector solely works on vector events and supports broadcasting sigmoid exists for event ndims cases piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3775,class fileiotest tf test testcase file contents file io read file to string file path self assertequal b testing file contents def self file path os path join self base dir temp file file io atomic write string to file file path testing self asserttrue file io file exists file path file contents file io read file to string file path self assertequal b testing file contents def self file path os path join self base dir temp file with file io fileio file path mode w as f ,adding an atomic write method to file io which uses a temp file and renaming to atomically write to a file fixes this in training util py which is used by saver py change , fix a bug in the docstring of the test case piperorigin revid
3776,tfliteregistration register detection postprocess namespace builtin const tfliteregistration builtinopresolver findop tflite builtinoperator op int version const return mutableopresolver findop op version const tfliteregistration builtinopresolver findop const char op int version const return mutableopresolver findop op version builtinopresolver builtinopresolver addbuiltin builtinoperator abs register abs addbuiltin builtinoperator hard swish register hard swish ,remove redundant override of virtual function piperorigin revid change id , add support for int ops piperorigin revid
3777,see the license for the specific language governing permissions and limitations under the license from future import absolute import from future import division ,update sdca optimizer in core to its v version and migrate linear optimizer from contrib to core piperorigin revid , add a test for the new op op piperorigin revid
3778,the output will be register op fill input dims int32 input dims index type input value t output output t attr t type attr index type int32 int64 dt int32 setshapefn inferencecontext c datatype index type tf return if error c getattr index type index type shapehandle unused tf return if error c withrank c input 0 1 unused tf return if error c withrank c input 1 0 unused register op fill const tensor t c input tensor 0 if t nullptr for int i 0 i t numelements i if t vec int32 i 0 if index type dt int32 t vec int32 i 0 index type dt int64 t vec int64 i 0 return errors invalidargument fill dimensions must be 0 ,implements the fill op for int indices piperorigin revid , fix a bug in the test case piperorigin revid
3779,bool hloparser parseconvolutiondimensionnumbers return tokenerror convolution lhs rhs and output must have the same rank if rank 3 return tokenerror convolution rank must 3 if rank 2 return tokenerror convolution rank must 2 auto is unique string str bool ,hlo parser allow rank convolution dimension lables piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3780,def convolution2d transpose add variables to collections add variable to collections layer kernel variables collections 'weights' if layer bias if layer bias is not none add variable to collections layer bias variables collections 'biases' if normalizer fn is not none def convolution3d transpose add variables to collections add variable to collections layer kernel variables collections 'weights' if layer bias if layer bias is not none add variable to collections layer bias variables collections 'biases' if normalizer fn is not none def separable convolution2d variables collections 'weights' add variable to collections layer pointwise kernel variables collections 'weights' if layer bias if layer bias is not none add variable to collections layer bias variables collections 'biases' ,avoid using variables as booleans similarly to tensors piperorigin revid , tf data dataset dataset dataset to be used for tf data dataset piperorigin revid
3781,def batch gather with default params result ragged rank max indices ragged rank params ragged rank example python params tf ragged constant 'a' 'b' 'c' 'd' 'e' indices tf ragged constant 1 2 1 0 10 batch gather with default params indices 'foo' 'b' 'c' 'foo' 'e' 'foo' params tf ragged constant 'a' 'b' 'c' 'd' 'e' indices tf ragged constant 1 2 1 0 10 batch gather with default params indices 'foo' tf raggedtensor b'b' b'c' b'foo' b'e' b'foo' with ops name scope name params ragged tensor convert to tensor or ragged tensor ,fix more docstrings to be compatible with the doctest format piperorigin revid , fix a bug in the docstring of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
3782,status const attr offset int2 attr padding prepended w attr padding prepended h window h attr kernel h window w attr kernel w multiplier 1 0f static cast float attr kernel h attr kernel w std string source r int window size 0 for int a 0 a window h a for int b 0 b window w b ivec2 coord gid xy stride offset ivec2 b a if coord x 0 coord y 0 coord x input data 0 w coord y input data 0 h value 0 input data 0 coord x coord y gid z window size value 0 multiplier if window size 0 window covered nothing this situation is a sign of incorrectly constructed operation nans are expected as output value 0 float window size generated code parameters std move parameters ,tflite gpu fix average pooling window size calculation piperorigin revid , fix a bug in the graph piperorigin revid
3783,def make tensor proto values dtype none shape none verify shape false a tensorproto depending on the type it may contain data in the tensor content attribute which is not directly useful to python programs to access the values you should convert the proto back to a numpy ndarray with tensor util makendarray proto with tf make ndarray proto if values is a tensorproto it is immediately returned dtype and shape are ignored ,update make tensor proto docs to reference public symbol for make ndarray piperorigin revid , tf data dataset to tf data dataset dataset piperorigin revid
3784,show pat in path endif ifdef feat viminfo return the last used search pattern at idx spat t get spat int idx return spats idx return the last used search pattern index int get spat last idx void ,patch viminfo not sufficiently tested problem viminfo not sufficiently tested solution add more test cases clean up comments yegappan lakshmanan closes , patch problem when using a terminal window is a bit slow solution add a test for the test
3785,limitations under the license include tensorflow core platform macros h include tensorflow core platform mutex h include tensorflow core platform status h include tensorflow core profiler lib profiler interface h include tensorflow core profiler lib profiler session h include tensorflow core profiler profiler service grpc pb h include tensorflow core profiler profiler service pb h ,add tf profiler pywrap cc library wrapper macro piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3786,setup 'programming language python 3 5' 'programming language python 3 6' 'programming language python 3 7' 'programming language python 3 8' 'topic scientific engineering' 'topic scientific engineering mathematics' 'topic scientific engineering artificial intelligence' setup ext modules ext install requires 'numpy 1 16 0' 2 4 3' cmdclass 'build ext' custombuildext ,update setup py and setup with bazel py for tflite runtime package there is no runtime dependency on pybind and has ext modules lambda true is needed to generate proper platform dependent wheel name e g cp macosx x instead of py none any piperorigin revid change id , fix a bug in the documentation of the new module piperorigin revid
3787,class uniquetest test base datasettestbase parameterized testcase for test case expected in test cases current test case test case self assertdatasetproduces dataset compat as bytes element if dtype dtypes string else element compat as bytes element if dtype dtypes string else element for element in expected class uniquetest test base datasettestbase parameterized testcase def self raises internalerror when dtypes don't match note generating the following expected outputs can be considered taken up as an in the experimental api with self assertraises errors internalerror self dtypes string hello 1 2 1 hello ,updated test comment and addressed lint issue , fix a bug in the test case piperorigin revid
3788,see the python math ops guide segment min segment max segment mean to complex128 to complex64 unsorted segment sum unsorted segment max unsorted segment mean unsorted segment min unsorted segment prod unsorted segment sqrt n ,add ops to api that have tf export decorators but haven't been added to api piperorigin revid , fix a bug in the test case piperorigin revid
3789,status decodelin16waveasfloatvector const string wav string bad audio format for wav expected 1 pcm but got audio format tf return if error uint16 wav string channel count offset if channel count 1 return errors invalidargument bad number of channels for wav expected at least 1 but got channel count tf return if error uint32 wav string sample rate offset uint32 bytes per second tf return if error uint32 wav string bytes per second offset ,prevent an integral division by zero undefined behavior piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id iefecfafdafabefecbd
3790,popup adjust position win t wp wp w height wp w maxheight if wp w height rows wp w winrow wp w height rows wp w winrow if wp w height org height win comp scroll wp if center vert f popup getpos typval t argvars typval t rettv dict add number dict scrollbar wp w has scrollbar dict add number dict firstline wp w topline dict add number dict lastline wp w botline 1 dict add number dict visible win valid wp wp w popup flags popf hidden 0 ,patch ctrl u and ctrl d don't work in popup window problem ctrl u and ctrl d don't work in popup window solution initialize add lastline in popup getpos closes , patch problem when using a popup window with a popup window solution add a test for the mouse command
3791,test f remappertest test expecttensornear float tensors 0 tensors expected 0 1e 6 test f remappertest fuseconv2dwithbiasandactivationongpu todo b fix flaky test test f remappertest disabled fuseconv2dwithbiasandactivationongpu if google cuda gtest skip no cuda skip on gpu endif google cuda ,disable flaky test third party tensorflow core grappler optimizers remapper test gpu piperorigin revid change id , fix a bug in the test case piperorigin revid
3792,class image itemhandler return parsing ops decode raw image buffer out type self dtype def decode jpg assert self dtype dtypes uint8 'jpeg decoder can only be used to decode to tf uint8 but s 'requested for a jpeg image ' self dtype if self dtype dtypes uint8 raise valueerror 'jpeg decoder can only be used to decode to tf uint8 but s was ' 'requested for a jpeg image ' self dtype return image ops decode jpeg image buffer self channels for rgba images jpeg is not a valid decoder option class tfexampledecoder data decoder datadecoder example parsing ops parse single example serialized example self keys to features print example keys reshape non sparse elements just once for k in self keys to features ,add test for assertion error when trying to decode jpegs at bit change , fix a bug in the docstring of the test case piperorigin revid
3793,entry entry auto ds allof op dynamicslice op pad op gettupleelement op parameter 0 op constant op constant op multiply op constant op constant op constant op reshape op constant op constant op shape f32 320 7 16 128 auto partial output allof op add op gettupleelement op parameter 0 entry entry auto ds allof op dynamicslice op pad op gettupleelement op parameter 0 op constant op constant op multiply op constant op constant op reshape op constant op shape f32 4096 17 128 auto partial output allof op add op gettupleelement op parameter 0 ,xla spmd fix wrong offsets of windowed dot reduce scatter case piperorigin revid change id , xla gpu support for xla hlo client piperorigin revid
3794,template typename optype class oppointer template typename objecttype typename elementtype class operanditerator template typename objecttype typename elementtype class resultiterator class function class instruction class statement operations represent all of the arithmetic and other basic computation in mlir this class is the common implementation details behind operationinst public bool constantfold arrayref attribute operands smallvectorimpl attribute results const methods for support type inquiry through isa cast and dyn cast static bool classof const instruction inst static bool classof const statement stmt protected operation bool operationname name arrayref namedattribute attrs mlircontext context ,add a pattern x x generalize canonicalize to address a few todos and add some casting support to operation piperorigin revid , fix a bug in the toy tutorial piperorigin revid change id icfcccdcbedbaacf
3795,struct softmaxeigenimpl eigen dsizes int 2 one by class 1 num classes else eigen indexlist eigen type2index along class eigen indexlist eigen type2index 1 depth dim eigen indexlist int eigen type2index 1 batch by one batch by one set 0 batch size eigen indexlist eigen type2index 1 int one by class ,unused variable removed in softmax op functor h , fix a bug in the new delegate piperorigin revid
3796,bool istpudevice const string device string const absl flat hash set std string static const auto place on tpu ops new absl flat hash set std string identity identityn enter exit switch merge nextiteration shape nextiteration shape retval return place on tpu ops ,place retval node on tpu if it has no explicit device assignment piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id id icfecdffaddccbded
3797,copyright 2020 google inc licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license you may obtain a copy of the license at http www apache org licenses license 2 0 unless required by applicable law or agreed to in writing software distributed under the license is distributed on an as is basis without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license include stdint h include stddef h include stdlib h include h include ftw h define included by main module 1 include config h include gpg h include common types h ,gnupg adds sqlite as gnupg dependency adds as gnupg dependency latest sqlite for gnupg adds to gnupg fuzz targets remove sqlite package for gnupg gnupg fuzz targets need included by main module remove sqlite add license to gnupg fuzz targets , fix a bug in the dtrace dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
3798,from tensorflow python distribute import combinations from tensorflow python distribute import strategy combinations from tensorflow python eager import backprop from tensorflow python eager import def function from tensorflow python eager import test from tensorflow python keras optimizer v2 import adam from tensorflow python ops import random ops from tensorflow python ops import variables as variables lib from tensorflow python platform import test from tensorflow python training saving import checkpoint options from tensorflow python training tracking import util as trackable utils ,update keras test to use public tf test testcase and tf test main piperorigin revid change id , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3799,status remapper optimize cluster cluster const grappleritem item infer properties lazily in case they are not needed if ctx inferred graph properties requiresinferredshapes ctx i const bool assume valid feeds opt level rewriterconfig aggressive todo rmlarsen get rid of tensor value copies tf return if error ctx graph properties inferstatically assume valid feeds aggressive shape inference false ,automated rollback of commit piperorigin revid , add a test for the cost of the graph piperorigin revid
3800,class loggingopstest test testcase self evaluate out class printv1test test testcase test util run in graph and eager modes def testprintonetensor self with self cached session tensor math ops range 10 with self capturewritestostream sys stderr as printed print op logging ops print v1 tensor self evaluate print op expected 0 1 2 7 8 9 self asserttrue expected n in printed contents class printv2test test testcase test util run in graph and eager modes ,add simple test for print v function , fix a bug in the docstring of the test case piperorigin revid
3801,class fileio object pywrap tensorflow set tf status from status status ret status self writable file none property def seekable self return true ,add property to based on review comment signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the test case piperorigin revid
3802,static void getscalarfieldoftable const structdef struct def getter bool getter code indent indent indent return getter n auto defaultvalue is bool false field value constant code indent indent return defaultvalue n n std string default value if is bool default value field value constant 0 false true else default value field value constant code indent indent return default value n n get a struct by initializing an existing struct ,python fix default bool value python fix default bool value small style tweak , fix a bug in the new code of the new code
3803,class importtest public testing test builder createstring tensor one q auto t2 tflite createtensor builder builder createvector int 2 1 tflite tensortype float32 2 tflite tensortype float32 0 builder createstring tensor two q return builder createvector std vector offset tflite tensor t1 t2 ,adds checks for graph consistency in tflite verify piperorigin revid , xla python fix a bug in the test piperorigin revid
3804,from tensorflow tools docs import doc controls as doc controls return op def lib result append auto ops text cleaned ops debugstring absl ops text result append str util stringreplace ops text n n true result append n strings appendf result op def lib b s n absl cescape cleaned ops serializeasstring c str return result ,remove debug string information from gen files piperorigin revid , tf data service support for tf data dataset piperorigin revid
3805,f undofile argvars rettv rettv v type var string ifdef feat persistent undo rettv vval v string u get undo file name get tv string argvars 0 false char u ffname fullname save get tv string argvars 0 false if ffname null rettv vval v string u get undo file name ffname false vim free ffname else rettv vval v string null endif ,use full path in undofile updated docs , patch problem when using a terminal window is a bit solution add a few more tests to the new code
3806,struct operationhandle public capturablehandle of mlir without duplicating the type system or the op definitions template typename op typename args static operationhandle create args args template typename op typename args static op createop args args generic create for a named operation static operationhandle create stringref name arrayref valuehandle operands operationhandle operationhandle create args args getoperation template typename op typename args op operationhandle createop args args return cast op operationhandle scopedcontext getbuilder create op scopedcontext getlocation args getoperation getoperation template typename op typename args valuehandle valuehandle create args args operation op scopedcontext getbuilder ,add lowering linalg for to llvm ir this cl adds lowering of linalg for to llvm ir and adds an ir test this also replaces the usage of affine for with linalg for and enables the llvm ir path in the integration test piperorigin revid , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
3807,class test util tensorflowtestcase with g as default x constant op constant 1 1 2 4 4 4 7 8 8 dtype dtypes double y gen array ops unique x y gen array ops unique x self assertequal types pb2 dt double types pb2 dt int32 y op output types pylint disable protected access ,update test cases as unique and uniquev are hidden redirect to gen array ops unique and gen array ops unique v signed off by yong tang yong tang github outlook com , fix a bug in the docstring of the test case piperorigin revid
3808,class mutation void using mutablenodeviewdiff internal mutablegraphview adds a mutation to the node mutation function mutate fn must return true if it actually does any mutations if it returns false mutation will be ignored void mutablenodeview node std function void mutablenodeviewdiff mutate fn std function bool mutablenodeviewdiff mutate fn mutablegraphview graph view nullptr int mutation counter 0 ,grappler graphview add only if mutation is not a no op piperorigin revid change id , xla gpu support for the cpu backend piperorigin revid change id icbbdbfafcdfcae
3809,class interpretertest public testing test protected tflitecontext getinterpretercontext return interpreter context tflitecontext getinterpretercontext return interpreter context interpreter interpreter ,automated rollback of commit piperorigin revid , xla gpu support for the layout inference piperorigin revid change id icccbcbdbcfaadbee
3810,start redo long count int old redo if c '1' c '9' c add char buff c the expression register should be re evaluated if c ' ' add char buff car cmd silent true c read redo false old redo ,patch repeating put from expression register fails problem repeating put from expression register fails solution re evaluate the expression register andy massimino closes , patch problem when using a terminal window is a bit slow solution add a test for the gui
3811,xlacomputation primitivetype type const xlaop rhs return or lhs rhs xlacomputation primitivetype type xlabuilder builder xlacomputation reducer primitive util isintegraltype type type pred type builder type builder return reducer xlaop any xlaop predicates xlabuilder builder predicates builder return builder reporterrororreturn statusor xlaop ,xla create helper for using reductions as slice like operations piperorigin revid , xla gpu support for the hlo hlo pipeline piperorigin revid change id idadedfddaccd
3812,static char features static int included patches add new patch number below this line 2240 ,patch problem tests using the sleep time can be flaky solution use if available partly by shane harper , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3813,limitations under the license define tensorflow kernels maxpooling op h functor definition for maxpoolingop must be compilable by nvcc include tensorflow core framework numeric types h include tensorflow core framework tensor types h include tensorflow core framework type traits h include tensorflow core kernels eigen pooling h include tensorflow core platform types h struct spatialmaxpooling template typename device struct spatialmaxpooling device qint8 void operator const device d typename ttypes qint8 4 tensor output typename ttypes qint8 4 consttensor input int window rows int window cols int row stride int col stride const eigen paddingtype padding namespace functor namespace tensorflow ,add an nchw vect c kernel to and piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3814,status convolutionvisitor handleconvolution hloinstruction convolution we want to repeat 'filter' in the 'input feature dim' dimension count' times if filter expansion if is cost viable convolution filter expansion shape reshaped filter shape shapeutil kernel input feature dim filter shape auto reshaped filter ,feature group expansion change piperorigin revid , xla python add a xla interface to the xla client piperorigin revid
3815,func value bool computes the qr decomposition of each inner matrix in tensor such that tensor q r currently the gradient for the qr decomposition is well defined only when the first p columns of the inner matrix are linearly independent where p is the minimum of m and n the 2 inner most of tensor python a is a tensor q is a tensor of orthonormal matrices ,go update generated wrapper functions for tensorflow ops piperorigin revid change id , fix a bug in the test case piperorigin revid
3816,limitations under the license include vector include tensorflow core framework attr value pb h include tensorflow core framework function pb h include tensorflow core framework graph pb h include tensorflow core framework node def pb h include tensorflow core framework types pb h ,add missing include tensorflow functiondef only happens to be available in this header because it happens to be forward declared in one of the other proto h headers but it's not actually used there and will go away piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3817,class quantileaccumulator saver basesaverbuilder saveableobject init stamp token epsilon num quantiles max elements none name none container none class quantileaccumulator saver basesaverbuilder saveableobject self quantile accumulator handle init stamp token epsilon epsilon max elements max elements num quantiles num quantiles is initialized op gen quantile ops quantile accumulator is initialized self quantile accumulator handle ,add an option to override maximum number of elements in the quantile accumulator piperorigin revid , fix a bug in the docstring of the docstring of the new api change
3818,static const struct child funcs child ops fixme when we have different child ops we're going to need to redo the progress detector static bool handle sigreturn int childno static bool handle sigreturn void struct syscallrecord rec static unsigned int count 0 static bool handle sigreturn int childno bust lock rec lock check if we're blocked because we were stuck on an fd if check if fd childno true if check if fd rec true avoid doing it again from other threads shm fd lifetime 0 void child process int childno ret sigsetjmp ret jump 1 if ret 0 if handle sigreturn childno false if handle sigreturn false return exit the child things are getting too weird ,convert check if fd to work on instead of , fix a bug in the watchdog page
3819,class tpuclusterresolver clusterresolver if service is none and should resolve if not google api client installed raise importerror 'googleapiclient must be installed before using the ' 'tpu cluster resolver execute pip install ' ' upgrade google api python client to install with ' 'pip ' raise importerror 'googleapiclient and oauth2client must be installed ' 'before using the tpu cluster resolver execute ' ' pip install upgrade google api python client ' 'and pip install upgrade oauth2lclient to ' 'install with pip ' final discovery url self discoveryurl or discovery url if final discovery url ,amend cluster resolver error to suggest as a possible issue piperorigin revid , tf data service support for tf data dataset piperorigin revid
3820,statusor bool whileloopconstantsinking whileutil getinvariantgtesforwhilebody while body int64 index invariant gte tuple index const hloinstruction invariant value init value operand index should have at least one user that's not while body root if invariant gte user count 1 continue if invariant value opcode hloopcode kconstant auto constant instr while body addinstruction invariant value clone suffix ,xla cpu don't create dead constants in we run this in a pipeline together with dce dead constants mean that the will never be reached piperorigin revid , xla gpu support for the xla client piperorigin revid
3821,bool parser parse const char source const char include paths files being parsed push source filename if include paths const char current directory nullptr static const char current directory nullptr include paths current directory source cursor source ,fixed possible crash from reference to non static variable change id tested on linux , fix a bug in the parser test piperorigin revid
3822,from tensorflow python lib io import tf record from tensorflow python ops import data flow ops from tensorflow python ops import io ops from tensorflow python ops import variables from tensorflow python platform import resource loader from tensorflow python platform import test from tensorflow python training import coordinator from tensorflow python training import input as input lib from tensorflow python training import queue runner impl from tensorflow python util import compat prefix path resource loader get path to datafile core lib prefix path tensorflow core lib pylint disable invalid name tfrecordcompressiontype tf record tfrecordcompressiontype ,use resource loader to access in tree data piperorigin revid change id , tf data vectorization to use tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental tf data experimental v piperorigin revid
3823,from tensorflow python keras engine import base layer from tensorflow python keras engine import base layer utils from tensorflow python ops import variable scope as vs from tensorflow python ops import variables as tf variables from tensorflow python training checkpointable import base as checkpointable from tensorflow python util import function utils from tensorflow python util import nest from tensorflow python util import tf contextlib class layer base layer layer setattr result k copy deepcopy v memo return result def setattr self value name by pass the automatic dependency tracking performed by the parent layer super checkpointable checkpointablebase self setattr value name def add elements to collection elements collection list if context executing eagerly ,disable automatic dependency tracking for the legacy tf layers layer class piperorigin revid , tf data optimizer to use the keras api piperorigin revid
3824,class userdevicespec object dev func self device name or function func name function utils get func name dev func func code function utils get func code dev func self display name s s d func name func code co filename func code co firstlineno if func code fname func code co filename lineno func code co firstlineno else fname unknown lineno 1 self display name s s d func name fname lineno self function self device name or function if not self device name or function is none or ,make function utils get func code more tolerant of strange objects like partial piperorigin revid , fix a bug in the docstring of the docstring of the tf nn rnn api piperorigin revid
3825,static pyobject cxoconnection cxoconnection conn if value py return none return cxopystring fromencodedstring value valuelength conn encodinginfo encoding conn encodinginfo encoding null ,add support for specifying the errors parameter to the decode that takes place internally when fetching strings from the database https github com oracle python cx oracle issues , fix a bug in the test case
3826,tflitestatus eval tflitecontext context tflitenode node case ktfliteint64 tile int64 t input dims input multipliers output break case ktflitebool tile bool input dims input multipliers output break default context reporterror context type ' s' is not supported by tile tflitetypegetname output type ,tile add support for booleans piperorigin revid , add support for int int piperorigin revid
3827,pybind11 module pywrap utils m return tensorflow pyoorthrow tensorflow swig registertype type name ptr type ptr m def registerpyobject const py handle name const py handle type return tensorflow pyoorthrow tensorflow swig registerpyobject name ptr type ptr m def istensor const py handle o ,replace the mechanism used to register look up python types from c code in tensorflow python util h with one that supports non type symbols as well piperorigin revid change id , xla python python gpu support to be enabled piperorigin revid change id idedeaebfbbdabebae
3828,bool constantfolding isfoldable const nodedef node const return false only fold ops with a cpu implementation available if device types 0 devicetype device cpu if device types empty return false dcheck eq devicetype device cpu device types 0 folding not applicable to ops with no inputs if node input empty ,properly handle ops that don't have a cpu kernel piperorigin revid , xla gpu support for xla cpu piperorigin revid change id idfbdfbcdacfbeebb
3829,f job start typval t argvars unused typval t rettv theend ifdef use argv if argv null vim free argv vim free argv else vim free ga ga data endif ,patch problem coverity complains about uneccessary check for null solution remove the check , patch problem when using a terminal window is a bit slow solution add a test for the gui
3830,class test util tensorflowtestcase math ops add c c c2 constant op constant 2 0 with self assertraisesregexp typeerror contains objects other than typeerror graph tensors math ops add c2 c2 def self ,better error message when an eager op sees a graph tensor piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3831,from future import division from future import print function from tensorflow python import keras from tensorflow python framework import test util as tf test util from tensorflow python keras import keras parameterized from tensorflow python keras import testing utils from tensorflow python platform import test tf test util run all in graph and eager modes class noiselayerstest test testcase keras parameterized run all keras modes class noiselayerstest keras parameterized testcase def test gaussiannoise self testing utils layer test ,run noise layer tests in all execution modes piperorigin revid , tf data service support for tf data dataset piperorigin revid
3832,functiondef nonzero x t bool functiondef iszero x int64 bool functiondef iszerov2 x t int64 functiondef randomuniform functiondef xyxlessthanorequalton int64 n x t bool functiondef randomuniformless input dataset variant y filterdatasetop dataset functiondef makefilterdataset start int64 stop int64 step int64 y rangedatasetop dataset functiondef makerangedataset x t y tensorslicedatasetop dataset functiondef maketensorslicedataset ,add the functions to make rangedataset and filterdataset , fix a bug in the test case piperorigin revid
3833,static cl opt bool expected lines on the corresponding line cl init false static cl opt bool verifypasses verify each cl desc run the verifier after each transformation pass cl init true static std vector const mlir passregistryentry passlist enum optresult static optresult performactions sourcemgr sourcemgr mlircontext context return run each of the passes that were selected todo riverriddle make sure that the is run after each pass when it is no longer run by default within the passmanager passmanager pm passmanager pm verifypasses for const auto passentry passlist passentry addtopipeline pm if pm run module get ,add a flag to the passmanager that specifies if the ir should be verified after each pass this also adds a verify each flag to mlir opt to optionally disable running the verifier after each pass piperorigin revid , fix a bug in the parser test piperorigin revid
3834,static bool instruction inst funcbuilder b inst auto opinst cast operationinst inst if auto write opinst dyn cast vectortransferwriteop instantiate b write state state state return false auto clone instantiate b write state state state return clone nullptr else if auto read opinst dyn cast vectortransferreadop auto clone instantiate b read state state state if clone return true state insert std make pair read getresult clone getresult 0 return false ,mlir more graceful failure in even though it is unexpected except in pathological cases a nullptr clone may be returned this cl handles the nullptr return piperorigin revid , xla gpu support for the hlo instruction piperorigin revid change id icabdabcccecababba
3835,static int dpipool create dpipool pool const char username return dpi failure set context attributes if dpiconn setattributesfromcommoncreateparams authinfo if dpiutils setattributesfromcommoncreateparams authinfo dpi oci htype authinfo commonparams error 0 return dpi failure ,rename internal method dpiconn to as suggested it is not connection specific so makes more sense in a generic file , fix a bug in the client client client client
3836,class tensorshaperep tensorshaperep const tensorshaperep b void operator const tensorshaperep b move the specified shape after moving b is safe for destruction and move the specified shape after moving b is safe for destruction and can be into but its dimensions and number of elements can be nonsensical e g negative dimension sizes or number of elements not properly recomputed ,remove b interpreted as html tag under stricter clang checks piperorigin revid , fix a bug in the test piperorigin revid
3837,cudnn rnn common doc string canonical format this is a typical use case the user creates a cudnnrnn model the user query that parameter buffer size the user creates a variable of that size that serves as the parameter ,fix list formatting piperorigin revid , fix a bug in the test case piperorigin revid
3838,dict find dict t d char u key int len returns null if the entry doesn't exist or out of memory char u get dict string dict t d char u key int save dict get string dict t d char u key int save dictitem t di char u s get dict string dict t d char u key int save returns 0 if the entry doesn't exist varnumber t get dict number dict t d char u key dict get number dict t d char u key dictitem t di dict2string typval t tv int copyid int restore copyid return ok or fail returns notdone for expr int get dict tv char u arg typval t rettv int evaluate dict get tv char u arg typval t rettv int evaluate dict t d null typval ,patch using name for get dict number get dict string problem using name for get dict number get dict string solution rename to start with dict , patch problem when using a terminal window is a bit slow solution add a test for the command line
3839,getcmdline int ignore drag release true ' ' true no reduce keys true don't merge modifyotherkeys c get literal get next two character s no reduce keys false do abbr false don't do abbreviation now extra char nul may need to remove when composing char was typed ,patch merging modifier for modifyotherkeys is done twice problem merging modifier for modifyotherkeys is done twice solution remove the merging done in vgetc , patch problem when using a terminal window is a bit slow solution add a test for the gui
3840,main ifdef feat gui mswin shell delete ni endif vim free done else if stricmp argv i remote expr 0 ,patch vim using invalid index problem vim using invalid index solution check index for being valid fix memory leak , patch problem when using a popup window with a terminal window solution add the option to the current buffer when the cursor is set
3841,import collections import itertools import json import os import sys import threading import weakref def print tensor x message '' returns the same tensor x unchanged return logging ops print x x message if isinstance x ops tensor and hasattr x 'graph' with get graph as default op logging ops print v2 message x output stream sys stdout with ops control dependencies op return array ops identity x else logging ops print v2 message x output stream sys stdout return x graph manipulation ,make backend print utility v ready piperorigin revid , fix a bug in the test case piperorigin revid
3842,class thread blockingcounter const counter to decrement when ready void threadpool execute int task count task tasks ptrs void threadpool int task count int stride task tasks ruy dcheck ge task count 1 task 0 will be run on the current thread task count 1 counter to decrement when ready reset task count 1 for int i 1 i task count i threads i 1 tasks ptrs i auto task address reinterpret cast std uintptr t tasks i stride threads i 1 reinterpret cast task task address execute task 0 workload immediately on the current thread task last task tasks ptrs 0 last task run tasks 0 run wait for the threads submitted above to finish counter to decrement when ready wait ,change existing call sites of the old deprecated gemmlowp execute method which is a because it destroys the task object that it takes to the new more explicit name for the same behavior piperorigin revid , fix a bug in the test case piperorigin revid
3843,include compat h include shm h define msg cmsg compat 0x80000000 this message needs 32 bit fixups static void sanitise sendmsg int childno struct msghdr msg struct syscall syscall sendmsg arg3name flags arg3type arg list arg3list num 19 num 20 values msg msg peek msg msg msg trunc msg msg msg msg msg syn msg confirm msg msg msg nosignal msg more msg waitforone msg cmsg cloexec msg cmsg compat msg waitforone msg cmsg cloexec msg fastopen msg cmsg compat sanitise sanitise sendmsg flags need alarm ,socket flags cleanup remove duplicate definitions use system headers compat h for newer defs use fastopen , move the syscall process to the syscall process
3844,from future import print function import math import numpy as np import numpy as np avoids becoming a part of public tensorflow api from tensorflow compiler xla import xla data pb2 from tensorflow compiler xla python api import xla shape class sharding object something we really want to expose to users especially as the contract for tile assignment is very strict if not isinstance tile assignment np ndarray if not isinstance tile assignment np ndarray raise typeerror assignment must be of type np if not isinstance tile shape xla shape shape raise typeerror shape must be of type xla shape shape' ,public support input partition in tpuestimator relnotes n a piperorigin revid , fix a bug in the test case piperorigin revid
3845,from future import division from future import print function from tensorflow contrib import metrics as metrics lib from tensorflow contrib learn python learn estimators import constants from tensorflow contrib learn python learn estimators import estimator from tensorflow contrib learn python learn estimators import metric key from tensorflow contrib learn python learn estimators import model fn as model fn lib def get model fn with logistic metrics model fn thresholds thresholds else eval metric ops none return model fn lib modelfnops mode mode predictions predictions loss loss train op train op eval metric ops eval metric ops eval metric ops eval metric ops output alternatives 'head' constants problemtype logistic regression 'predictions' predictions return model fn ,add appropriate export signature for logistic regression change , tf data service support for tf data dataset piperorigin revid
3846,void select syscall tables void int setup syscall group unsigned int group unsigned int ret if biarch true ret setup syscall group biarch group return setup syscall group biarch group else ret setup syscall group uniarch group return ret return setup syscall group uniarch group const char print syscall name unsigned int callno bool is32bit ,remove unnecessary variable , fix a bug in the watchdog page
3847,private module std unique ptr llvm module llvmmodule protected mappings between original and translated values used for lookups llvm stringmap llvm function llvm densemap value llvm value valuemapping ,fix translation of nvvm special registers to intrinsics the original implementation did not map the return value of the intrinsics call to the result value of the special register op uses of the result value hence hit a piperorigin revid , xla gpu support for the hlo dialect piperorigin revid change id iaaffafbceeeafc
3848,costgraphdef mutable cost graph get proto log fatal cannot get a mutable protobuf for an return null size t num recvs const runmetadata mutable metadata return metadata runstepresponse get proto log fatal cannot get a mutable protobuf for an return null size t num tensors const ,allows tensorflow to be built directly from a visual studio solution on windows also enables debug builds for windows , fix a bug in the parser test piperorigin revid
3849,ex append exarg t eap intempty curbuf b ml ml flags ml empty if not in vim9 eap fail return the flag toggles if eap forceit curbuf b p ai curbuf b p ai ex change exarg t eap linenr tlnum if not in vim9 eap fail return if eap line2 eap line1 u save eap line1 1 eap line2 1 fail return ,patch vim accidentally using x causes vim to exit problem vim accidentally using x causes vim to exit solution disallow using x or in vim script closes , patch problem when using a terminal window is a bit slow solution add a test for the test
3850,from future import absolute import from future import division from future import print function import re import textwrap import gast def parse str src todo mdan this should exclude the module things are autowrapped in if six py2 and ' print ' in src if six py2 and re search ' wprint ' src this special treatment is required because gast parse is not aware of whether print function was present in the original context src 'from future import print function n' src ,more thoroughly search for print functions when deciding whether to add from import import print function piperorigin revid , fix a bug in the test case piperorigin revid
3851,static char features static int included patches add new patch number below this line 2408 ,patch syntax menu and build instructions outdated problem syntax menu and build instructions outdated solution update build instructions and syntax menu , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3852,class polymorphicmatcher template typename t inline matcher t makematcher const matcherinterface t impl return matcher t impl creates a polymorphic matcher from its implementation this is easier to use than the polymorphicmatcher impl constructor as it ,removes an unnecessary semi colon which causes a warning in gcc's pedantic mode , xla python support for the client client piperorigin revid
3853,void parseopdata const operator op builtinoperator op type break case builtinoperator transpose auto params mallocpod tflitetransposeparams if auto schema params op builtin options as const auto perm schema params perm flatbufferintvectortoarray sizeof params perm perm params perm error reporter params num dimensions perm length builtin data reinterpret cast void params break case builtinoperator mean ,make tflite transpose op have parity with tf transpose op piperorigin revid , fix a bug in the graph piperorigin revid
3854,port statusor void getcufftdsohandle return getdsohandle cufft getcudalibversion port statusor void getcusolverdsohandle return getdsohandle cusolver getcudaversion port statusor void getcusparsedsohandle return getdsohandle cusparse getcudaversion port statusor void getcuranddsohandle return getdsohandle curand getcudalibversion port statusor void getcufftdsohandle return result port statusor void getcusolverdsohandle static auto result new auto dsoloader getcusolverdsohandle return result port statusor void getcusparsedsohandle static auto result new auto dsoloader getcusparsedsohandle return result port statusor void getcuptidsohandle static auto result new auto dsoloader getcuptidsohandle return result ,remove kernels' explicit dependency on cusolver and cusparse add stubs for cusolver and cusparse use stub when if static is not set piperorigin revid , xla python fix a bug in the hlo client client piperorigin revid change id icbbdbfafcdfcae
3855,class streamexecutorinterface return absl nullopt clears the compilation cache from volatile memory returns ok if no compilation cache exists or if clearing the compilation cache is unsupported caches in non volatile storage are unaffected virtual port status return port status ok private se disallow copy and assign streamexecutorinterface ,provide an interface for flushing the compilation cache in an implementation independent way piperorigin revid , xla python fix a bug in the hlo computation piperorigin revid change id iefecfafdafabefecbd
3856,class datasetv2 tracking base trackable composite tensor compositetensor def shard self num shards index creates a dataset that includes only 1 num shards of this dataset for example python create a dataset with 60 elements a tf data dataset range 60 0 1 2 3 57 58 59 create 3 datasets each with 20 elements from dataset a b a shard num shards 3 index 0 0 3 6 9 51 54 57 c a shard num shards 3 index 1 1 4 7 10 52 55 58 d a shard num shards 3 index 2 2 5 8 11 53 56 59 there is no overlap between datasets b c and d shard is a deterministic operator the returned dataset depends only on the target dataset and the values of num shards and index this dataset operator is very useful when running distributed training as it allows each worker to read a unique subset ,add info about dataset deterministic nature , fix a bug in the documentation of the test case piperorigin revid
3857,class listwrapper list collections mutablesequence return copied pylint enable protected access def reduce ex self protocol return self class self storage def make storage self wrapped list return wrapped list ,also define reduce ex on listwrapper may fix an existing unit test in python piperorigin revid , fix a bug in the new version of the new module piperorigin revid
3858,using std endl using std locale include sstream using std stringstream using std stringstream include limits using std numeric limits int main stringstream ss both input and output ss imbue new locale double inf numeric limits double infinity ss inf write out double r ss r read back in double inf numeric limits double infinity ss inf write out double r ss r read back in assert inf r ok msvc 10 0 int main output nonfinite loopback ok j cpp fp facet fp facet debug nonfinite loopback ok exe nonfinite loopback ok j cpp fp facet fp facet debug nonfinite loopback ok exe ,tabs removed end newlines added and max min to meet inspection report comments svn r , xla gpu support for the hlo client piperorigin revid change id icabdabcccecababba
3859,see the license for the specific language governing permissions and limitations under the license this file is called at power up time to initialize the chip it in turn calls main which is the entry point into the application include stdint h include eta chip h include h extern uint32 t stack top attribute section vectors used void const void void void uint32 t sizeof stack pointer pointer void startup stack top reset handler the nmi handler ,added brief comment about this file , add a test for the new op op piperorigin revid
3860,class iotest googletest testcase labels dd from pandas labels npartitions 2 classifier skflow tensorflowlinearclassifier n classes 3 classifier fit data labels score accuracy score classifier predict data labels self assertgreater score 0 5 failed with score 0 format score todo deal with dask data in predict score accuracy score classifier predict data compute labels compute self assertgreater score 0 5 failed with score 0 format score if name ' main ' tf test main ,daskdatafeeder works with iris with same accuracy , fix a bug in the documentation of the documentation of the new version of the default value of the default value of the default value of the input is not used in the same function piperorigin revid
3861,namespace tf framework namespace define gen pass classes include tensorflow compiler mlir tools kernel gen transforms tf framework passes h inc include tensorflow compiler mlir tools kernel gen transforms kernel gen passes h inc static constexpr stringref tf entry ,make kernel gen opt its own tool with a cc file piperorigin revid change id , fix a bug in the graph piperorigin revid
3862,from future import print function import numpy as np from tensorflow python framework import constant op from tensorflow python framework import dtypes from tensorflow python ops import array ops from tensorflow python ops import image ops from tensorflow python platform import test class extractglimpsetest test testcase expected rows none none none 1 2 3 4 expected cols 56 57 58 59 60 def self img constant op constant np arange 25 reshape 1 5 5 1 dtype dtypes float32 with self test session result image ops extract glimpse img 3 3 2 2 centered false normalized false uniform noise false noise zero self assertallequal np asarray 0 0 0 0 0 0 0 0 0 result eval 0 0 if name ' main ' test main ,add test case for additional arg with extract glimpse signed off by yong tang yong tang github outlook com , fix a bug in the test case piperorigin revid
3863,getcount old mapped len typebuf maplen if an operation is pending handle it if an operation is pending handle it but not for k ignore do pending operator ca old col false if ca cmdchar k ignore do pending operator ca old col false wait for a moment when a message is displayed that will be overwritten ,patch gui when losing focus a pending operator is executed problem gui when losing focus a pending operator is executed solution do not execute an operator when getting k ignore closes , fix a bug in the new version of the new code piperorigin revid
3864,typical usage example python define features and transformations country sparse column with keys country us country embedding embedding column query word dimension 3 combiner sum country embedding embedding column country dimension 3 combiner sum query word sparse column with hash bucket query word hash bucket size int 1e6 query embedding embedding column query word dimension 16 combiner sum ,fix small typo in the usage documentation s query word country change , updated for version problem when using a dictionary of a dictionary of a dictionary of a dictionary solution add a test for the line
3865,class bernoullitest tf test testcase with self test session p 0 2 0 6 dist tf contrib distributions bernoulli p p n 1000 samples dist sample n seed 123 n 100000 samples dist sample n samples set shape n 2 self assertequal samples dtype tf int32 sample values samples eval self assertfalse np any sample values 0 self assertfalse np any sample values 1 self assertallclose p np mean sample values 1 axis 0 atol 1e 2 self asserttrue np all sample values 0 self assertrue np all sample values 1 note that the standard error for the sample mean is sqrt p 1 p n this means that the tolerance is very sensitive to the value of p as well as n self assertallclose p np mean sample values axis 0 atol 1e 2 self assertequal set 0 1 set sample values flatten def testmean self ,make bernoulli test and normal test more robust to randomness increased the number of samples taken as well as tweaked the initial parameters and tolerance such that the test rarely fails if i remove the seed the tests fail of the time change , fix a bug in the docstring of the test case piperorigin revid
3866,gui mch dialog inttype type of dialog entry gtk entry new gtk widget show entry make enter work like pressing ok gtk entry set activates default gtk entry entry true text convert to utf8 textfield gtk entry set text gtk entry entry const char text convert to utf8 free text ,updated for version problem gtk pressing enter in inputdialog doesn't work like clicking ok as documented solution call gtk entry set default , updated for version problem when using a channel to be a bit a bit solution add a test for the line
3867,limitations under the license include tensorflow core framework register types h include tensorflow core framework tensor shape pb h include tensorflow core framework tensor shape pb text h include tensorflow core framework types h include tensorflow core framework versions h include tensorflow core lib core coding h status bundlereader getbundleentryproto const string key parseentryproto iter key iter value entry copy if tensorshape isvalid entry copy shape return errors dataloss invaid tensor shape key entry copy shape shortdebugstring protoshortdebugstring entry copy shape entry entry copy ,tf checkpoint v ops the ops will be used to write and read checkpoints in the upcoming v format change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3868,void patternemitter emitmatchmethod dagnode tree auto entities appliedconstraint entities auto condition constraint getconditiontemplate auto cmd if 0 return matchfailure n auto cmd if 0 return matchfailure n if isa typeconstraint constraint auto self formatv 0 result type begin ,match expression to avoid operator precedence issues piperorigin revid , xla gpu support for the hlo client client piperorigin revid
3869,vim chdirfile char u fname the vim code assumes a trailing slash is only ignored for a directory static int illegal slash char name illegal slash const char name if name 0 nul return false no file name is not illegal vim stat const char name stat t stp on solaris stat accepts file as if it was file return 1 if the name ends in and it's not a directory return illegal slash n 1 stat n p return illegal slash name 1 stat name stp endif ,patch can't build on hpux problem can't build on hpux solution fix argument names in vim stat john marriott , patch problem when using a terminal window is a bit slow solution add a test for the test
3870,unsigned long rand64 void unsigned long r 0 if wordsize 32 return rand32 endif if rand bool 32 bit ranges r rand32 ,limit rand to bits when building on bit i might later change this to make this function return u if necessary but for now the rand consumers on bit don't care because they work on , make the syscall page we can be a bit more than the syscall process
3871,class constantfolding public graphoptimizer status runoptimizationpass cluster cluster const grappleritem item graphdef output applies partial constant folding for concat which is not commutative returns true if the transformation applied successfully bool partialconcatconstfolding graphdef optimized graph graphproperties properties nodedef node points to an externally provided device or to owned device rewriterconfig toggle opt level devicebase cpu device ,extracts into a method piperorigin revid , xla gpu support for the xla client piperorigin revid change id idaceccfcbacfece
3872,class checkpoint tracking autotrackable checkpoint management update checkpoint state internal save dir os path dirname file prefix model checkpoint path file path all model checkpoint paths file path all model checkpoint paths file path save relative paths true return file path def restore self save path ,use relative paths in checkpoint protos from tf train checkpoint save this makes it consistent with tf train checkpointmanager piperorigin revid , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
3873,def linear x returns the linear activation x note often used as last layer of regression networks return x ,revert doc for maximum improved this reverts commit , fix a bug in the docstring of the docstring of the docstring change
3874,get win info win t wp short tpnr short winnr dict add number dict winid wp w id dict add number dict height wp w height dict add number dict winrow wp w winrow 1 dict add number dict topline wp w topline dict add number dict botline wp w botline 1 ifdef feat menu dict add number dict winbar wp w winbar height endif ,patch relative cursor position is not calculated correctly problem relative cursor position is not calculated correctly solution always set topline also when window is one line only robert webb add more info to getwininfo for testing , patch problem when using a terminal window is a bit slow solution add a test for the gui
3875,status conv2dshape shape inference inferencecontext c shape function for conv3d like operations status conv3dshape shape inference inferencecontext c shape function for fusedconvbiasactivation operation status fusedconvbiasactivationshape shape inference inferencecontext c shape function for depthwiseconv2d like operations status depthwiseconv2dnativeshape shape inference inferencecontext c ,add fused convd bias activation operator for the forward phase piperorigin revid , add a test for the graph and the graph piperorigin revid
3876,class tensor temp tf return if error ctx allocate temp dt int8 temp tf return if error ctx allocate temp dt int8 tensorshape static cast int64 temp void workspace temp flat int8 data for int i 0 i batch size i ,explicit tensorshape in allocate temp fixes windows build , tf data service support for tf data experimental piperorigin revid
3877,win line wp lnum startrow endrow nochange ifdef feat rightleft wp w p rl col 0 endif col w width wp col ifdef feat conceal boguscols endif w width wp highlight until the right side of the window c ' ' ,conceal feature caused the 'cursorline' highlighting to stop early , patch problem when using a popup window with a terminal window solution add the option to the current buffer when the cursor is set
3878,def checkatleast3dimage image require static true check ops assert positive array ops shape image all dims of 'image shape' 'must be 0 ' 'must be 0 ' check ops assert greater equal array ops rank image 3 message 'image' must be at least three dimensional else return def image require static true if not image shape is fully defined return check ops assert equal array ops shape image 1 1 message last dimension of a grayscale image should be size 1 message last dimension of a grayscale image should be size 1 check ops assert greater equal array ops rank image 3 message a grayscale image must be at least three dimensional else return ,added dynamic rank assertion , fix a bug in the docstring of the docstring of the new api change
3879,def update td enum attrs path operand kinds filter list sort alphabetically according to enum name defs sort key lambda enum enum 0 only keep the definitions from now on defs enum 1 for enum in defs put definition at the very beginning because capability cases will be referenced later defs enum 1 for enum in defs if enum 0 enum 1 for enum in defs if enum 0 substitute the old section content content 0 enum section marker ' n n' ,spirv nfc reorder sections in td put extensions and capabilities at the very beginning because they will be referenced later by other definitions piperorigin revid change id , fix a bug in the documentation of the documentation of the new api change
3880,absl optional std string tfliteintarray shape return result builds intepreter for a model allocates tensors builds interpreter for a model allocates tensors absl status buildinterpreter const model model std unique ptr interpreter interpreter tflitestatus status ,nit fix some typos piperorigin revid change id , xla gpu support for xla cpu piperorigin revid change id idaceccfcbacfece
3881,class kerastpumodel models model self numpy to infeed manager list infeed managers try if not kwargs get ' pipeline' true logging info 'running non pipelined training loop pipeline s ' kwargs ' pipeline' pipeline kwargs get ' pipeline' true if ' pipeline' in kwargs kwargs pop ' pipeline' if not pipeline logging info 'running non pipelined training loop pipeline s ' pipeline return super kerastpumodel self fit x y batch size epochs verbose callbacks validation split validation data shuffle class weight sample weight ,keras tpu support fix usability issue the current code fails with the following code use pipeline magic function model fit pipeline use pipeline when use pipeline is true it's not pop out from kwargs thus causing exceptions in line piperorigin revid , update keras layers to keras piperorigin revid
3882,import org tensorflow contrib android tensorflowinferenceinterface a classifier specialized to label images using tensorflow public class implements classifier static system loadlibrary tensorflow demo private static final string tag only return this many results with at least this confidence ,android demo remove unecessary loadlibrary call from piperorigin revid , fix a bug in the test case piperorigin revid
3883,statusor hloinstruction if lhs contracting partitions rhs contracting partitions lhs contracting partitions num partitions output sharding dim 1 if output lhs non contracting partitions num partitions shapesizeinbytes rhs base shape options threshold for windowed einsum mib 1024 1024 output sharding dim 1 shapesizeinbytes output base shape options threshold for windowed einsum mib 1024 1024 if output lhs non contracting partitions num partitions return emit windowed dot general 0 1 false false true if output rhs non contracting partitions num partitions shapesizeinbytes lhs base shape options threshold for windowed einsum mib 1024 1024 if output rhs non contracting partitions num partitions return emit windowed dot general 1 0 false false true ,xla spmd fix contracting dim loop einsum threshold piperorigin revid change id , xla gpu support for xla hlo hlo emitters piperorigin revid change id idadedfddaccd
3884,static char features static int included patches add new patch number below this line 1175 1174 ,patch problem can't build with mingw and cygwin solution remove extra endif christian j robinson , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3885,qf open new cwindow qf info t qi int height set the options for the quickfix buffer window if not already done do this even if the quickfix buffer was already present as an autocmd might have previously deleted the quickfix buffer if bt quickfix curbuf if bt quickfix curbuf qf set cwindow options only set the height when still in the same tab page and there is no ,patch quickfix test fails problem quickfix test fails solution negate result of bt quickfix , patch problem when using a terminal window is a bit slow solution add a test for the gui
3886,endif include iostream nolint include locale include memory include string nolint include tuple gtest disable msc deprecated push inline int chdir const char dir return chdir dir endif inline file fopen const char path const char mode if gtest os windows std wstring convert std codecvt wchar t char std mbstate t converter std wstring wide path converter from bytes path std wstring wide mode converter from bytes mode return wide path c str wide mode c str else return fopen path mode endif gtest os windows if gtest os windows mobile inline file freopen const char path const char mode file stream ,googletest export addresses https github com google googletest issues by using on windows piperorigin revid , fix a bug in the new module of the dtrace dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
3887,static int open epoll fds void fd epoll create1 epoll cloexec if fd 1 shm epoll fds i fd output 2 fd d epoll n shm epoll fds i struct object obj obj alloc object obj perffd fd add object obj obj global obj fd epoll output 2 fd d epoll n fd i else not sure what happened static int open epoll fds void static int get rand epoll fd void return shm epoll fds rand max epoll fds struct object obj obj get random object obj fd epoll obj global return obj epollfd const struct fd provider epoll fd provider ,convert epoll fd code over to use the object cache , make the watchdog process to the syscall process
3888,def replicate model fn model fn the train op argument of estimatorspec loss reduction controls whether losses are summed or devices optional list of devices to replicate the model across this argument can be used to only on the subset of available gpus argument can be used to replicate only on the subset of available gpus if none then all available gpus are going to be used for replication if no gpus are available then the model is going to be placed on the cpu ,spelling error reverted in , fix a bug in the docstring of the keras model piperorigin revid
3889,static void add to namelist const char name newnode zmalloc sizeof struct namelist newnode name strdup name init list head newnode list list add tail newnode list names list ,init the list head before adding it to the list , patch problem when using a terminal window doesn't work solution add a test for the mouse command
3890,class gtest api unittest gets the number of tests that should run int test to run count const gets the time of the test program start in ms from the start of the unix epoch timeinmillis start timestamp const gets the elapsed time in milliseconds timeinmillis elapsed time const ,implements the timestamp attribute for the element in the output xml external contribution by , fix a bug in the parser build piperorigin revid
3891,register op resourcestridedsliceassign attr shrink axis mask int 0 setshapefn shape inference nooutputs register op tensorstridedsliceupdate input input t input begin index input end index input strides index input value t attr t type attr index int32 int64 attr begin mask int 0 attr end mask int 0 attr ellipsis mask int 0 attr new axis mask int 0 attr shrink axis mask int 0 setshapefn shape inference nooutputs register op tile input input t input multiples tmultiples ,added support for a new op , fix a bug in the test piperorigin revid
3892,std once flag flags init void allocateandparseflags flags new buildxlaopspassflags flags tf xla enable lazy compilation false flags tf xla enable lazy compilation true flag list new std vector flag flag tf xla enable lazy compilation flags tf xla enable lazy compilation ,enable tf xla lazy compilation by default if auto jit is enabled this should only affect auto jit not xla compile which always creates xlalaunch ops this was split out from cr piperorigin revid , xla python add a test for the xla client client piperorigin revid
3893,static char features static int included patches add new patch number below this line 1537 1536 ,patch memory error when using setcellwidths problem memory error when using setcellwidths solution use array and pointers correctly , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3894,class structuredfunctionwrapper object component nesteddatasetcomponent t flat classes append component flat shapes append component flat types append component if t options is not none pylint disable protected access warnings warn encountered a nested dataset with options these options will not be applied to the outer dataset flat types append component if t options options pylint disable protected access warnings warn encountered a nested dataset with non default options these options will not be propagated to the outer dataset else try t ops convert to tensor t ,tf data fix noisy warning piperorigin revid , fix a bug in the test case piperorigin revid
3895,def tf tensor len s return s shape dims 0 value static shape of unknown dimensions use dynamic shape but statically that it's a scalar check that it's a scalar shape array ops shape s assert shape shape 'shape tensor of zero size ' format shape ,fix small typo on tf tensor len , fix a bug in the docstring of the test case piperorigin revid
3896,status graphproperties symbolicshaperefiner shape refiner infer the shape of the second output once and for all since it never changes shapehandle out1 ic scalar ic set output 1 out1 if ic num outputs 2 ic set output 1 out1 shapehandle out ,added a guard to prevent from crashing for certain cases piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid
3897,struct select native long double defined fast math defined boost math disable std fpclassify defined boost intel defined sun defined sun defined vxworks define boost math use std fpclassify endif ,don't use std fpclassify on vxworks as well it doesn't , fix a bug in the parser test svn r
3898,limitations under the license include tensorflow core profiler convert post process single host xplane h if defined is mobile platform include tensorflow core profiler internal profiler factory h include tensorflow core profiler utils derived timeline h include tensorflow core profiler utils group events h include tensorflow core profiler utils xplane schema h include tensorflow core profiler utils xplane utils h endif namespace tensorflow namespace profiler ,move tf x profiler files out of top level profiler internal profiler interface profiler factory lib parse annotation utils traceme annotation stack internal cpu piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3899,value set code string 3 prune first newline and indent to match the docstring template ,remove these are unnecessary the doctest system no longer checks outputs if the author doesn't supply one piperorigin revid change id , fix a bug in the new delegate piperorigin revid
3900,class lstmexampletest test testcase self assertgreater predicted values 100 4 predicted values 115 4 amplitude of fifth component 0 4 0 2 if name main ,rolling forward a reduction in the number of strided slice constants fixes a test which flakes due to graph level seeding piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3901,static int open perf fds void fd syscall nr perf event open rec a1 rec a2 rec a3 rec a4 rec a5 if fd 1 shm perf fds i fd output 2 fd d perf n shm perf fds i struct object obj obj alloc object obj perffd fd add object obj obj global obj fd perf output 2 fd d perf n fd i else if enosys bail early rather than do max perf fds retries static int open perf fds void static int get rand perf fd void if shm perf fds 0 0 perf unavailable disabled struct object obj check if perf unavailable disabled if shm global objects obj fd perf num entries 0 return 1 return shm perf fds rand max perf fds obj get random object obj fd perf obj global return obj perffd const struct fd provider perf fd provider ,convert the perf fd code over to use the object cache , fix a bug in the watchdog page
3902,class loss object def init self reduction losses utils reductionv2 auto name none losses utils reductionv2 validate reduction self reduction reduction self name name ,add validation for loss reduction during creation we currently validate on call piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3903,namespace root is radius nodefilter const hloinstruction root int64 radius const std set const hloinstruction boundary const std set const hloinstruction boundary first find the of nodes with distance from root radius these nodes are our initial set of normal nodes absl flat hash map const hloinstruction nodefilterresult nodes nodefilter if depth radius continue if boundary count instr 0 if boundary count instr 0 continue string dumpgraph const hlocomputation computation const string label string const hloinstruction node int radius const std set const hloinstruction boundary const std set const hloinstruction boundary bool show backend config auto debug options node getmodule config debug options string label ,xla interactive graphviz pass constant param by reference instead of pointer , xla gpu support for the hlo client backend piperorigin revid change id ifcabdcdffbdfaaf
3904,def run cuda only func none def is gpu available cuda only false min cuda compute capability none def compute capability from device desc device desc ,improve description for tf test is gpu available , fix a bug in the docstring of the test piperorigin revid
3905,final class nativeinterpreterwrapper implements autocloseable usennapi interpreterhandle usennapi void setnumthreads int numthreads interpreterhandle gets index of an input given its name int string name if inputsindexes null final class nativeinterpreterwrapper implements autocloseable private static native void usennapi long interpreterhandle boolean state private static native void numthreads long interpreterhandle int private static native long int size private static native long string long errorhandle ,expose setnumthreads in the java api piperorigin revid , fix a bug in the test case piperorigin revid
3906,do ecmd fnum ffname sfname eap newlnum flags oldwin flags ecmd hide 0 dobuf unload ifdef feat autocmd autocommands may open a new window and leave oldwin open which leads to crashes since the above call sets oldwin w buffer to null if curwin oldwin oldwin aucmd win win valid oldwin oldwin w buffer null win close oldwin false ifdef feat eval if aborting autocmds may abort script processing ,updated for version problem using null buffer pointer in a window solution check for w buffer being null in more places bjorn winckler , patch problem when using a terminal window is a bit slow solution add a test for the gui
3907,pythonmod init void vim module py vim char null pyobject null python api version if populate module vim module pymodule addobject pyobject getattrstring if populate module vim module return 1 if init sys path ,updated for version problem python missing support for number unsigned solution add number unsigned add more tests various fixes zyx , patch vim cannot use a function to be used problem vim cannot use a terminal window when a terminal window is not tested solution add a test for the terminal window
3908,def build fuzzers impl pylint disable too many arguments command ' cap add' 'sys ptrace' env to docker args env if source path workdir workdir from dockerfile project name if workdir ' src' print 'cannot use local checkout with workdir src ' file sys stderr return 1 if not mount location if mount location command ' v' ' s s' get absolute path source path workdir ' s s' get absolute path source path mount location else if workdir ' src' print 'cannot use local checkout with workdir src ' file sys stderr return 1 command ' v' ' s s' get absolute path source path mount location ' s s' get absolute path source path workdir command ,bisector fixes copy src from host instead of checking out repo on host this fixes issues with dependencies in the main repo add some more logging , fix a bug in the file in the file
3909,def function def to graph def fdef input shapes none flat name format node def name flattened index nested to flat tensor name nested name flat name flattened index 1 control name node def name nested to flat tensor name control name control name control name node def name nested to flat tensor name control name control name update inputs of all nodes in graph for node def in graph def node ,fix for importing functions with a control dependency on an op with no outputs piperorigin revid , fix a bug in the docstring of the docstring of the docstring of the test py
3910,class linearoperatorudvhupdate linear operator linearoperator return self base operator def shape self return self base operator shape batch shape array ops broadcast static shape self base operator batch shape self u get shape 2 return batch shape concatenate self base operator shape 2 def shape tensor self return self base operator shape tensor batch shape array ops broadcast dynamic shape self base operator batch shape tensor array ops shape self u 2 return array ops concat batch shape self base operator shape tensor 2 axis 0 def apply self x adjoint false u self u ,fixed shape and shape dynamic to account for broadcasting between base operator and other args since tf matmul does not broadcast it may or may not be possible for this operator to broadcast apply and solve in all cases change , fix a bug in the docstring of the docstring of the docstring change
3911,limitations under the license the configuration through the environment variable example bazel test test env tensorflow use custom contraction kernel false test bazel test test env tensorflow use custom contraction kernel false path to test if defined tensorflow use custom contraction kernel namespace internal todo ezhulenev this is a temporary workaround for disabling custom kernels at runtime in tests we should always rely on compile time flags for that example test env tensorflow use custom contraction kernel false test example bazel test test env tensorflow use custom contraction kernel false path to test eigen device func eigen dont inline bool usecustomcontractionkernels static bool use custom contraction kernel true ,intenral copybara change piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3912,hloinstruction hloinstruction cloneandfuseinternal for hlocomputation computation instruction to fuse called computations if std find called computations begin called computations end computation called computations end called computations push back computation vlog 2 new clone n clone tostring return clone ,xla sanity check the list of called computations for fusion nodes called for a fusion node should only include the fusion computation that it calls piperorigin revid , xla gpu support for xla hlo ir piperorigin revid change id idadedfddaccd
3913,def register dataset service dataset compress the dataset elements to reduce the amount of data that needs to be sent over the network todo b 157105111 make this an autotuned parallel map when we have a way to limit memory usage dataset dataset map lambda x compression ops compress x dataset dataset map lambda x compression ops compress x num parallel calls dataset ops autotune prefetch one compressed element to reduce latency when requesting data from tf data workers todo b 157105111 set this to autotune when we have a way to limit ,tf data service autotune the number of compress threads autotune the number of compress threads to prevent compression from becoming the bottleneck piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
3914,class layer checkpointable checkpointablebase def loss for variable v with ops colocate with v with ops name scope name ' regularizer' regularization regularizer v with ops name scope name ' regularizer' regularization regularizer v return regularization if isinstance variable tf variables partitionedvariable ,remove colocate with in keras layer regularization piperorigin revid , fix a bug in the docstring of the keras model piperorigin revid
3915,static char features static int included patches add new patch number below this line 2106 ,patch vim some errors not tested problem vim some errors not tested solution add tests fix getting the right error , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3916,class test testcase serving input receiver fn export lib build parsing serving input receiver fn feature spec return exporter lib name serving input fn serving input receiver fn name serving input receiver fn serving input receiver fn def extract loss and global step self event folder ,update serving input fn argument name to serving input receiver fn piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3917,void const model model strides mutable list add i src op stride height strides mutable list add i src op stride width strides mutable list add i 1 todo b to return a working tf graphdef we should be returning the correct spacetobatchnd and batchtospacend operation before and after the conv since tf doesn't support dilations if src op dilation width factor 1 src op dilation height factor 1 auto dilations op mutable attr dilations dilations mutable list add i 1 dilations mutable list add i src op dilation height factor dilations mutable list add i src op dilation width factor dilations mutable list add i 1 string padding if src op padding type paddingtype ksame padding same ,toco transformations updated to support dilated depthwise convolution piperorigin revid , add a test for the graph and the graph and the graph is not enabled piperorigin revid
3918,static char features static int included patches add new patch number below this line 903 ,patch comparing winver does not work correctly problem comparing winver does not work correctly solution use expansion ozaki kiichi closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3919,test xlacompilationtest loops auto a ops placeholder root withopname a dt float auto b ops placeholder root withopname b dt float auto c ops add root withopname c a b auto enter ops enter root c aframe auto enter ops internal enter root c aframe auto next iter ops nextiteration root enter auto exit ops exit root next iter auto exit ops internal exit root next iter auto d ops add root withopname d c exit std unique ptr graph graph new graph opregistry global ,update generated c api this is a roll forward past cls that were commented out plus some new overrides change , fix a bug in the graph piperorigin revid
3920,static char features static int included patches add new patch number below this line 613 ,updated for version problem the nfa engine does not implement the 'redrawtime' time limit solution implement the time limit , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3921,limitations under the license include string include utility include vector include atomic include absl types optional h include re2 re2 h ,include atomic headers change made in order to fix , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3922,static char features static int included patches add new patch number below this line 1112 1111 ,patch duplicate code in quickfix file problem duplicate code in quickfix file solution move code into functions yegappan lakshmanan closes , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3923,limitations under the license define eigen use threads include limits include numeric include vector todo b fix non standard include order include numeric clang format off include third party eigen3 unsupported eigen cxx11 tensor include tensorflow core framework op kernel h ,reverse the order of include numeric and include vector change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3924,def histogram name values collections none pylint disable line too long outputs a summary protocol buffer with a histogram adding a histogram summary makes it possible to visualize your data's distribution in tensorboard you can see a detailed explanation of the tensorboard histogram dashboard here https www tensorflow org get started tensorboard histograms the generated summary https www tensorflow org code tensorflow core framework summary proto has one summary value containing a histogram for values ,add a tutorial that explains the tensorboard histogram dashboard piperorigin revid , fix a bug in the docstring of the docstring of the docstring change
3925,statusor elementsattr const tensorproto input tensor return converttensor t builder status arrayref int64 t shape tensorshapeproto output shape void arrayref int64 t shape tensorshapeproto output shape for auto d shape output shape add dim set size d return status ok converts an mlir opaque elements attribute to a tensorflow tensor proto status const elementsattr attr datatype output dtype tf return if error converttodatatype type output dtype output tensor set dtype output dtype tf return if error shape output tensor mutable tensor shape shape output tensor mutable tensor shape switch output dtype case dt float ,simplify return type of piperorigin revid , xla gpu support for the cpu backend piperorigin revid
3926,devicemgr devicemgr std unique ptr device device return vector devicemgr devicemgr release resources ahead of destroying the device manager as the resource destructors e g iteratorresource assume devices still exist for auto device devices device clearresourcemgr stringpiece devicemgr copytobackingstore stringpiece s size t n s size char space name backing store alloc n ,release resources when destroying device manager piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3927,tflitestatus prepare tflitecontext context tflitenode node tflitetensor output getoutput context node koutputtensor only int32 positions are supported tf lite ensure eq context positions type ktfliteint32 check that input and output types match tf lite ensure eq context input type output type todo mgubin only 0d or 1d positions are currently supported tf lite ensure context numdimensions positions 1 assign to output the input type output type input type todo mgubin only default axis 0 is supported tf lite ensure eq context params axis 0 check conditions for different types tflitestatus eval tflitecontext context tflitenode node tf lite gather int32 t int32 t break case ktflitestring todo mgubin currently support only for 1d output tensors dynamicbuffer buffer const int32 indexes positions data i32 const int num strings getstringcount input ,remove reduntant checks in gather op piperorigin revid , add support for int int piperorigin revid
3928,class aotcompilationmetadata public aotcompilationmetadata const aotcompilationmetadata delete aotcompilationmetadata operator aotcompilationmetadata const delete virtual std string tostring const return virtual aotcompilationmetadata default protected ,add a debug string to executable piperorigin revid change id , xla python fix a bug in the client backend piperorigin revid change id icccbcbdbcfaadbee
3929,status lowertftogpu mlir moduleop module bool gpu binary only approximate tanh using standard operations pm addnestedpass mlir funcop mlir mhlo move scalar operations into the launch to ensure smaller signatures pm addpass xla mlir gpu take launches to launches with kernels pm addpass mlir creategpukerneloutliningpass ,delete as this is now available upstream in mlir core piperorigin revid change id , xla gpu support for the hlo dialect piperorigin revid change id iebdeaedebeebedaa
3930,class deffunctiontest test testcase functools partial f constant op constant 1 self assertallequal func 5 6 def test complicated partial with defaults self def identity args return args def dynamic unroll core fn input sequence initial state sequence length none parallel iterations 1 swap memory false del core fn self assertis none sequence length self assertequal 1 parallel iterations self asserttrue swap memory return input sequence initial state input sequence random ops random uniform 1 1 1 initial state random ops random uniform 1 1 func def function function functools partial dynamic unroll identity swap memory true func input sequence initial state def test unspecified default argument self wrapped def function function lambda x y 2 x y ,fix bug in partial tf function this was caused by wrong alignment of arguments and default values also add one more assert to improve debuggability piperorigin revid , fix a bug in the test case piperorigin revid
3931,bool return false const apidef arg stringpiece name const apidef api def for int i 0 i api def in arg size i if api def in arg i name name return api def in arg i return nullptr struct opinfo graph op def the opdef used by the runtime has the names that must be used when calling nodebuilder ,move for apidef arg to op def util cc and cleanup python c references this method is currently duplicated in python code and will be used for typescript generation piperorigin revid , xla gpu support for the layout of the layout piperorigin revid
3932,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2019 11 7 forward compatibility horizon datetime date 2019 11 8 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
3933,inchar loop endif if resize func null resize func true ifdef feat clientserver if defined feat clientserver defined unix server waiting endif ifdef message queue ,patch gui build fails on ms windows problem gui build fails on ms windows solution adjust ifdef , patch problem when using a terminal window is a bit slow solution add a test for the gui
3934,import sys import tempfile import numpy as np import tensorflow as tf import tensorflow from tensorflow python import debug as tf debug tf tensorflow compat v1 def main sess tf session ,tfdbg fix examples test for tf relnotes n a piperorigin revid , fix a bug in the test case piperorigin revid
3935,limitations under the license include include json json h include tensorflow core lib core errors h include tensorflow core lib gtl map util h include tensorflow core lib gtl stl util h include tensorflow core lib io path h include tensorflow core lib strings numbers h include tensorflow core lib strings str util h ,remove unused header include gtl stl util piperorigin revid change id , xla python fix a bug in the client backend piperorigin revid change id iefaaedbcfceefdda
3936,struct thpool thpool init int num threads int n for n 0 n num threads n thread init thpool p thpool p threads n n printf created thread d in pool n n ifdef thpool debug printf thpool debug created thread d in pool n n endif wait for threads to initialize ,add thpool debug define mandatory for debug added this because some messages are ont designed to be printed while integrating thpool in an existing project , fix a bug in the file
3937,class tpuextended distribute lib strategyextendedv1 self steps per run steps per run self require static shapes true self experimental enable get next as optional true def validate colocate with variable self colocate with variable values validate colocate tpu variable colocate with variable self class tpuextended distribute lib strategyextendedv1 dataset self input workers self container strategy split batch by self num replicas in sync enable get next as optional true split batch by self num replicas in sync def make input fn iterator self class tpuextended distribute lib strategyextendedv1 input fn self input workers input contexts self container strategy enable get next as optional true self container strategy def experimental make numpy dataset self numpy input session return numpy dataset one host numpy dataset ,add an experimental enable get next as optional flag to distributionstrategy object piperorigin revid , tf data optimizer to use the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
3938,func differs intretval false if locked if new dir null locked return false if vim strchr p cpo cpo chdir null curbufischanged forceit ,patch cd with null argument crashes problem cd with null argument crashes solution check for null ken takata closes , updated for version problem when using a function to be a dictionary of a dictionary of a line solution add a test for the line
3939,class hloinstruction instruction to make it a bitcast bool couldbebitcast const sets param no for this parameter instruction sets the parent fusion instruction for this instruction precondition opcode hloopcode kparameter precondition opcode hloopcode kfusion void hloinstruction fusion instruction check eq hloopcode kfusion fusion instruction opcode parent fusion instruction fusion instruction ,xla fix incorrect comments change , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3940,status gradienttape gradient backwardfunction computegradient if persistent vspace trace backward function for gradient grad out gradients if grad nullptr vspace grad vlog 1 got in gradients size in gradients for trace input tensor id size sources ,plug an eager memory leak add tests for reference counts there are still some slightly less serious leaks will follow up with a fix once i track those down piperorigin revid , tf data vectorization to use tf data dataset piperorigin revid
3941,tensorflow provides ops to decode and encode jpeg and png formats encoded images are represented by scalar string tensors decoded images by 3 d uint8 tensors of shape height width channels tensors of shape height width channels png also supports uint16 the encode and decode ops apply to one image at a time their input and output are all of variable size if you need fixed size images pass the output of ,adds support for bit png encoding and decoding change , tf data fix a bug in the graph piperorigin revid
3942,call shell char u cmd int opt if cmd null p sxq nul if defined feat gui mswin defined feat terminal vim strchr p go go terminal null ifdef vimdll gui in use endif vim strchr p go go terminal null endif retval mch call shell cmd opt ,patch wrong shell command when building with vimdll and in problem wrong shell command when building with vimdll and in 'guioptions' solution add check for gui in use ken takata , patch problem when using a terminal window is a bit slow solution add a test for the test
3943,separate nextcmd exarg t eap ifdef feat eval p ' ' in vim9script eap argt ex p 1 ' ' p eap cmd vim iswhite p 1 endif ,patch vim cannot use in a mapping problem vim cannot use in a mapping solution do not remove a comment with the ex flag closes , patch problem when using a terminal window doesn't work solution add a test for the job
3944,class sparsetensor tensorlike dense shape a 1 d int64 tensor of shape ndims with ops name scope none sparsetensor indices values dense shape with ops name scope none sparsetensor indices values dense shape indices ops convert to tensor indices name indices dtype dtypes int64 always pass as ref true because we want to be able to update values later if it is a variableop todo touts consider adding mutable values when 'values' is a variableop and updating users of sparsetensor values ops internal convert to tensor values name values as ref true values ops internal convert to tensor values name values dense shape ops convert to tensor dense shape name dense shape dtype dtypes int64 self indices indices ,fix sparsetensor to work in eager mode avoid using reference variables during conversion fix tensorshape compatibility issues cleaned up some tests to work without graph mode piperorigin revid , tf data vectorization test for tf data dataset piperorigin revid
3945,class tfapichangespec ast edits apichangespec tf convert to tensor preferred dtype dtype hint tf nn pool dilation rate dilations mapping from function to the new name of the function class tfapichangespec ast edits apichangespec tf boolean mask tensor mask name axis tf convert to tensor value dtype preferred dtype name tf pad tensor paddings mode name constant values tf nn pool input window shape pooling type padding dilation rate strides name data format specially handled functions ,update the arguments for tf nn pool and exporting in v piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3946,from tensorflow python util tf export import tf export this value changes every day with an automatic cl it can be modified in code via forward compatibility horizon or with the environment variable tf forward compatibility delta days which is added to the compatibility date forward compatibility horizon datetime date 2019 11 23 forward compatibility horizon datetime date 2019 11 24 forward compatibility delta days var name tf forward compatibility delta days forward compatibility date number none ,compat update forward compatibility horizon to piperorigin revid change id , compat update forward compatibility horizon to piperorigin revid change id idfffafefeecffceded
3947,file mainlogfile static file open logfile const char logfilename file file char fullpath int len strlen logging args strlen logfilename 2 char fullpath p int len strlen logfilename 2 fullpath zmalloc len snprintf fullpath len s s logging args logfilename if logging args len strlen logging args p fullpath zmalloc len if logging args p snprintf fullpath strlen logging args 2 s logging args p snprintf p strlen logfilename 1 s logfilename unlink fullpath ,fix up null ptr when no l arg , fix a bug in the watchdog page we can be used in the syscall process
3948,class array returns the total number of elements in the array int64 num elements const return std accumulate sizes begin sizes end 1 return std accumulate sizes begin sizes end 1ll std multiplies int64 ,fix int to int truncation in std accumulate , xla python fix a bug in the test piperorigin revid
3949,class numerictest public clientlibrarytestbase void testmatrixdiagonal todo b 64798317 delete this test case once xla is converted to xla iota this test is already implemented for xla in xla tests iota test cc xla test f numerictest iota xlabuilder builder testname iota builder s32 10 computeandcomparer1 int32 builder 0 1 2 3 4 5 6 7 8 9 xla test f numerictest triangle xlabuilder builder testname array3d int32 input 2 3 4 ,xla switch to using kiota from tf we were using a broadcast of a constant instead of the kiota hlo to make switching to kiota practical we need to do a few things first don't constant fold kiota don't hoist kiota from loops without good cause piperorigin revid , xla python fix a bug in the test piperorigin revid
3950,static pytypeobject g include transforms c if oracle version hex oracle version 12 1 include booleanvar c endif include transforms c include stringvar c include longvar c include numbervar c ,added support for pl sql collections of booleans available only in , patch problem when using a popup window with a popup window solution add the option to the current window
3951,from future import absolute import from future import division def main options tf runoptions trace level tf runoptions full trace run metadata run metadata trace timeline timeline step stats run metadata step stats with open 'timeline ctf json' 'w' as trace file with open ' tmp timeline ctf json' 'w' as trace file trace file write trace generate chrome trace format else sess run train step feed dict x batch xs y batch ys ,mnist xla tutorial updated piperorigin revid , fix a bug in the test case piperorigin revid
3952,void executorstate finish device has finished all relevant work at this point if device allowssynconcompletion status update device refreshstatus if status ok in device async execution mode it's possible for device execution to behind executorstate scheduling so much that this is the first place a device execution error if so all executorstate nodedone calls have already happened with ok status this is the last where startcancel must be called to abort all computation still running on any device todo b always call finish in a separate thread so even if startcancel blocks the current execution we won't encounter deadlocks caused by inter op thread exhaustion if cancellation manager cancellation manager startcancel delete this runner done cb status return ,make sure device execution errors seen by device refreshstatus in executorstate finish properly invoke cancellation for devices that run in asynchronous execution mode piperorigin revid , xla python fix a bug in the test piperorigin revid
3953,gpucudamallocallocator gpucudamallocallocator delete base allocator void gpucudamallocallocator allocateraw size t alignment size t num bytes ifdef google cuda allocate with cudamalloc gpu cuda scopedactivateexecutorcontext scoped activation stream exec se cuda scopedactivateexecutorcontext scoped activation stream exec cudeviceptr rv 0 curesult res cumemalloc rv num bytes if res cuda success ,stop using gpu as an alias for stream executor also do a few related namespace cleanups piperorigin revid , fix a bug in the new parser test piperorigin revid
3954,limitations under the license namespace tensorflow static constexpr const char const lowerfunctionalopspass klowerusingswitchmergeattr static constexpr const char const lowerfunctionalopspass namespace constexpr const char const klowerusingswitchmergeattr ,fix loading break due to undefined symbol , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3955,class autocastvariabletest test testcase parameterized testcase self assertallclose 3 self evaluate x assign sub 3 assign multiple times this currently doesn't work in graph mode if context executing eagerly or ops inside function this currently doesn't work in graph mode if a strategy is used if not ds context has strategy or context executing eagerly assign x assign 1 self assertallclose 1 self evaluate assign self assertallclose 0 self evaluate assign assign 0 ,don't skip distributed test case in eager mode , fix a bug in the documentation of the test case piperorigin revid
3956,bool trygetnodeattr const attrslice attrs stringpiece attr name return true status getnodeattr const attrslice attrs stringpiece attr name padding value string str value tf return if error getnodeattr attrs attr name str value return getpaddingfromstring str value value namespace helper for inouttypesfornode template class ,switch tfrt forwarding to use android tensorflow lib lite no runtime this way we can also refactor to depend on common attr util between tfrt delegate and tfrt forwarding piperorigin revid change id , fix a bug in the graph piperorigin revid
3957,class directivestransformer converter base self state enter self state ast node node node self generic visit node edge case a loop with just one directive statement would become empty if not node body node body gast pass self state exit return node ,add a few tests for more complex cases of error handling piperorigin revid change id , fix a bug in the test case piperorigin revid
3958,void setup maps tmpmap next alloc map tmpmap tmpmap next output mapping d p p n num mappings 1 startaddr endaddr while feof f free the empty map on the end ,log the start end of each mapping , fix a bug in the syscall page
3959,class funcgraph ops graph tensor dtype shape tensor get shape name name pylint disable protected access if ops use c shapes handle data c api tensor graph c graph tensor as tf output if isinstance tensor ops eagertensor handle data tensor handle data else handle data c api tensor graph c graph tensor as tf output if handle data c api setresourcehandleshapeandtype ph graph c graph ph as tf output ,another handle data fix for graph mode functions piperorigin revid , tf data optimizer to use the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient of the gradient piperorigin revid
3960,exe path gtest test utils gettestexecutablepath 'gtest break on failure unittest ' utilities environ os environ copy def setenvvar env var value if value is not none environ env var value elif env var in environ del environ env var environ gtest test utils environ setenvvar gtest test utils setenvvar tests in this file run a google test based test program and expect it to terminate therefore they are incompatible with the premature exit file protocol by design unset the premature exit filepath to prevent google test from creating the file setenvvar gtest test utils premature exit file env var none def run command ,supports a protocol for catching tests that prematurely exit , patch problem when using a terminal window is a bit slow solution add a test for the gui
3961,status executorstate processoutputs const nodeitem item opkernelcontext ctx void executorstate propagateoutputs const taggednode tagged node const nodeitem item outputs taggednodeseq ready auto activity handle std unique ptr tracing handle if tf predict false trace collector nullptr trace collector false is expensive const string op name item kernel name intentionally using executorpropagateoutputs as the first key so that users are aware that it's not the op invocation return trace collector executorpropagateoutputs strings strcat op name id step id false is expensive else return nullptr const node node tagged node node framestate input frame tagged node input frame const int64 input iter tagged node input iter ,adds conditional tracing around executorstate piperorigin revid , fix a bug in the graph piperorigin revid
3962,class optimizer optimizer def apply gradients self grads and vars global step none name none gradients number of stale gradients stale counter variable scope get variable stale counter initializer init ops zeros initializer trainable false with ops colocate with global step stale counter variable scope get variable stale counter initializer init ops zeros initializer trainable false def with ops control dependencies ,this is a bug fix for multi replica training when there is any parameter servers and more than one replica replicas except the chief replica would complain un initialized stale counter variable since it doesn't live in parameter server piperorigin revid , update keras layers to keras piperorigin revid
3963,tfstatsdatabase convertopstatstotfstats const opstats op stats tf stats db mutable without idle generatetfstatstable host tf metrics db device tf metrics db kernel stats by op name ridge point exclude idle true tf stats db set device type op stats run environment device type return tf stats db ,add device type to piperorigin revid change id , fix a bug in the graph optimizer piperorigin revid change id iefecfafdafabefecbd
3964,t imp t dz policy const pol const l l mpl less equal precision type mpl int 0 mpl greater precision type mpl int 113 mpl int 0 typename mpl if is same l lanczos mpl int 113 mpl int 0 type typename mpl if mpl less equal precision type mpl int 64 mpl int 64 mpl int 113 type ,fixed gamma function regressions tidied up function calls in t distribution inv hpp tidied up casts in erf hpp svn r , fix a bug in the previous commit case the previous commit is not used by the number of the number of the number of the number of the number of the number of the number of the number of the number of the number of the number of the number of the number
3965,class collectprofilecandidates public dfshlovisitorwithdefault status handlecall hloinstruction call override tf return if error defaultaction call collectprofilecandidates candidates for call hlo to profile idx tf return if error call to apply root instruction accept candidates for call tf return if error call to apply accept candidates for call return status ok ,call hlocomputation accept instead of hloinstruction accept where appropriate relnotes n a piperorigin revid , xla gpu support for xla hlo client piperorigin revid change id idadedfddaccd
3966,dt pid create pid probes dtrace probedesc t pdp dtrace hdl t dtp pp dpp dpr dpr pp dpp pr dpr dpr proc pp dpp pcb pcb pp dpp 0 we can only trace dynamically linked executables since we've ,initialize the number of pid probe symbol matches to zero this is checked whether or not any symbols are necessarily found but only initialized when some are found the check is an equality comparison so this will only cause if you are very , patch problem can't build with ruby solution add ifdef zoltan arpadffy
3967,void init child mappings struct childdata child new name strdup m name new size m size new prot m prot new type trinity map local we leave type as until we change the mapping by mprotect mremap munmap etc new type trinity map initial list add tail new list this child mappings list this child num mappings ,when we copy the initial map list leave the type as map initial , fix a bug in the watchdog page
3968,class identitytest trt test tftrtintegrationtestbase return constant op constant np random randn shape dtype dtypes float32 def getparams self input name input input dims 100 32 g ops graph ,update comment in test , fix a bug in the graph piperorigin revid
3969,import abc import six from tensorflow python framework import constant op from tensorflow python framework import dtypes from tensorflow python framework import ops from tensorflow python saved model import signature def utils class raise valueerror ' update op must be a tensor or operation got ' format key metric op we must wrap any ops in a tensor before export as the signaturedef proto expects tensors only see b metric op tensor metric op if isinstance metric op ops operation with ops control dependencies metric op metric op tensor constant op constant name 'metric op wrapper' outputs val name metric val outputs op name metric op outputs op name metric op tensor return outputs ,add support for metric ops that are operations when exporting train or eval savedmodels piperorigin revid , fix a bug in the docstring of the docstring of the tf data strategy piperorigin revid
3970,void close sockets void struct linger ling l onoff false for i 0 i nr sockets i fixme this is a workaround for a weird bug where we hang waiting for bluetooth sockets when we setsockopt hopefully at some point we can remove this when someone figures out what's going on if shm sockets i triplet family pf bluetooth continue grab an fd and nuke it before someone else uses it fd shm sockets i fd shm sockets i fd 0 ,workaround a with bluetooth sockets , fix a bug in the watchdog process
3971,import six from tensorflow core framework import attr value pb2 from tensorflow core framework import variable pb2 from tensorflow python import pywrap tensorflow from tensorflow python import pywrap utils from tensorflow python eager import context from tensorflow python framework import dtypes ,added import of pywrap tensorflow before pywrap utils , fix a bug in the docstring of the test piperorigin revid
3972,shapeutil const shape shape pre return std make tuple deleted indices empty inserted indices empty deleted indices inserted indices return std make tuple true deleted indices inserted indices static std vector std pair int64 int64 ,xla no op reshapes should not return true for inserting or deleting one sized dimensions piperorigin revid change id , xla gpu support for the layout inference piperorigin revid change id id ibaaeabeded
3973,def while loop cond body loop vars shape invariants none i0 tf constant 0 m0 tf ones 2 2 c lambda i m i 10 b lambda i m i 1 tf concat v2 0 m m b lambda i m i 1 tf concat v2 m m axis 0 tf while loop c b loop vars i0 m0 shape invariants i0 get shape tensor shape tensorshape none 2 shape invariants i0 get shape tf tensorshape none 2 ,fixed incorrect example for tf while loop change , fix a bug in the docstring of the documentation of the tf data dataset piperorigin revid
3974,class test testcase penaltytest self assertalmostequal self expected loss loss 5 def test loss with gradient norm target self generated data array ops placeholder dtypes float32 shape none none real data array ops placeholder dtypes float32 shape none none loss tfgan losses wasserstein gradient penalty generated data real data self kwargs 'generator inputs' self kwargs 'discriminator fn' self kwargs 'discriminator scope' target 2 0 with self test session as sess variables global variables initializer run loss sess run loss feed dict generated data self generated data np real data self real data np self assertalmostequal 1 0 loss 5 def test reuses scope self num vars len ops get collection ops graphkeys global variables ,add gradient norm target arg to gradient penalty function this is in the progressive gan paper https arxiv org abs piperorigin revid , fix a bug in the docstring of the test case piperorigin revid
3975,def inceptionv3 returns a keras model instance example python extract image features with inceptionv3 from tensorflow keras applications inception v3 import inceptionv3 from tensorflow keras preprocessing import image from tensorflow keras applications inception v3 import preprocess input import numpy as np create a inceptionv3 model pre trained on imagenet model inceptionv3 weights 'imagenet' include top false process the input img path 'elephant example jpg' img image load img img path target size 224 224 x image img to array img x np expand dims x axis 0 x preprocess input x extract the features features model predict x model inceptionv3 weights none model name 'inception v3' raises valueerror in case of invalid argument for weights or invalid input shape ,add examples to inceptionv , fix a bug in the docstring of the docstring of the tf data dataset piperorigin revid
3976,bool filecopyallocation valid const return copied buffer nullptr memoryallocation memoryallocation const void ptr size t num bytes errorreporter error reporter allocation error reporter allocation type kmemory ifdef arm if reinterpret cast uintptr t ptr 16 0 the flat buffer schema has alignment requirements of up to 16 bytes to guarantee that data can be correctly accesses on 32 bit arm the buffer we get must also be 16 byte aligned otherwise the guarantee will not hold potentially resulting in a sigbus note that 64 bit arm may also suffer a performance impact but no crash that case is not checked error reporter report the supplied buffer is not 16 byte aligned buffer nullptr buffer size bytes 0 return endif arm buffer ptr buffer size bytes num bytes ,add check for correct memory alignment to memoryallocation memoryallocation on bit arm this will give a reasonable error message at model build time rather than a sigbus later piperorigin revid , xla gpu support for the layout interface piperorigin revid change id icccbcbdbcfaadbee
3977,static char features static int included patches add new patch number below this line 1880 1879 ,patch vim asan complains about adding zero to null problem vim asan complains about adding zero to null solution check for argument count first , patch problem when using a channel to be a bit a bit slow solution add a test for the test
3978,from tensorflow python keras import layers as layer module from tensorflow python keras engine import base layer from tensorflow python keras engine import training from tensorflow python keras utils import generic utils from tensorflow python util import nest from tensorflow python util tf export import keras export class widedeepmodel training model linear inputs dnn inputs inputs linear output self linear model linear inputs dnn output self dnn model dnn inputs output 5 linear output dnn output output nest map structure lambda x y 0 5 x y linear output dnn output if self activation return self activation output return nest map structure self activation output return output def get optimizers self ,let wide deep model handle nested output piperorigin revid , tf data optimizer to use the keras api piperorigin revid
3979,windowobject this char name return py buildvalue ll long pos lnum long pos col else if strcmp name height 0 return py buildvalue l long this win w height return pylong fromlong long this win w height ifdef feat vertsplit else if strcmp name width 0 return py buildvalue l long w width this win return pylong fromlong long w width this win endif else if strcmp name vars 0 return dictionarynew this win w vars ,updated for version problem using py buildvalue is inefficient sometimes solution use pylong zyx , fix a bug in the new version of the new code piperorigin revid change id icfcccdcbedbaacf
3980,the indices in argmax are flattened so that a maximum value at position b y x c becomes flattened index b height y width x channels c the indices returned are always in 0 height x 0 width before flattening even if padding is involved and the mathematically correct answer is outside either negative or too large this is a bug but fixing it is difficult to do in a safe backwards compatible way especially due to flattening ksize the size of the window for each dimension of the input tensor strides the stride of the sliding window for each dimension of the input tensor ,add a note to maxpoolwithargmax about indices and padding the mathematically correct argmax indices should sometimes be negative if padding is involved note that the op does not do the correct thing fixes piperorigin revid , fix a bug in the file file in the file
3981,static void gen random ipv6 address struct in6 addr v6 in addr t v4 random ipv4 address in addr t v4 switch rand 9 case 0 deprecated ipv4 style v4 v4 random ipv4 address v6 s6 addr32 0 0 v6 s6 addr32 1 0 v6 s6 addr32 2 0 static void gen random ipv6 address struct in6 addr v6 break case 1 v4 in v6 ffff 0 0 96 v4 random ipv4 address v6 s6 addr32 0 0 v6 s6 addr32 1 0 v6 s6 addr32 2 0xffffffff static void gen random ipv6 address struct in6 addr v6 case 4 2002 16 6to4 inet pton af inet6 2002 v6 v4 random ipv4 address v6 s6 addr32 3 htonl v4 break case 5 ,ipv only generate v addresses where necessary , fix a bug in the syscall page
3982,class test util tensorflowtestcase greater op outputs instrument graph internal ndarrays greater op self assertequal len greater op outputs 1 self assertallclose greater op outputs 0 false pow op outputs instrument graph internal ndarrays b cond pow this was needed for backwards compatibility with tf2 estimators which rely on variable names prefix b cond if context executing eagerly else b pow op outputs instrument graph internal ndarrays b prefix self assertequal len pow op outputs 1 self assertallclose pow op outputs 0 64 0 ,do not propagate parent name scope in v control flow when inside v graph since that would break existing tf estimator models piperorigin revid change id , fix a bug in the docstring of the test case piperorigin revid
3983,class distributedcollectiveallreducestrategytest num gpus num gpus use core strategy use core strategy todo b re enable after fixing this flaky test todo yuefengz update how we use num gpus and required gpus combinations generate combinations combine class distributedcollectiveallreducestrategytest required gpus 1 use dataset true false use core strategy true false def testmakeinputfniterator self num gpus use dataset use core strategy def disabled testmakeinputfniterator self num gpus use dataset use core strategy if context num gpus num gpus self skiptest 'not enough if use dataset ,disable flaky dist strat input tests with callable input piperorigin revid , tf data service support for tf data dataset piperorigin revid
3984,copyright 2018 the tensorflow authors all rights reserved copyright 2019 the tensorflow authors all rights reserved licensed under the apache license version 2 0 the license you may not use this file except in compliance with the license extern c void debuglog const char s static bool is initialized false if is initialized debug serial object begin wait for serial port to connect only needed for some models apparently while debug serial object is initialized true debug serial object println s ,create hello world example for tensorflow lite for microcontrollers piperorigin revid , fix a bug in the new module piperorigin revid
3985,limitations under the license include absl strings str cat h include tensorflow core lib core status h include tensorflow lite context util h include tensorflow lite core macros h include tensorflow lite delegates flex buffer map h include tensorflow lite delegates flex kernel h include tensorflow lite delegates flex util h limitations under the license namespace tflite corresponding weak declaration found in lite interpreter builder cc if defined win32 if tflite has attribute weak if weak symbol is not supported windows it can use tf acquireflexdelegate path instead acquireflexdelegate ,tflite refactor core macros h c c api h and c common h move tfl capi export to c common h to make them available for delegates create lite macros module to make core macros h available for delegates piperorigin revid change id , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3986,include syslog h include sys time h include sys types h include sys stat h include fcntl h include string h include syslog h include log h include pids h include shm h include post mortem h if 0 static void dump syscall rec int childno static void dump syscall rec int childno int fd struct syscallrecord rec static void dump syscall rec int childno static void dump syscall records void int fd unsigned int i fd open trinity post mortem log o wronly if fd 0 outputerr failed to write post mortem log s n errno return for each child i dump syscall rec i dump syscall rec i fd close fd endif ,pass an fd to the syscall record dumper , dtrace dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt dt
3987,static int verbose did open false need wait return to be set this is a hack to make ts work without an extra prompt lines left number of lines available for messages before the more prompt is to be given more prompt is to be given 1 when not set need wait return true when the hit return prompt is needed reset after giving the hit return prompt when the user has some other prompt msg end prompt cmdline row msg row msg col 0 msg clr eos lines left 1 endif ,updated for version problem after typing at a prompt the more message appears too soon solution reset lines left in msg end prompt , make the watchdog process to be a child process
3988,limitations under the license include tensorflow core common runtime eager attr builder h include tensorflow core common runtime device factory h include tensorflow core common runtime eager kernel and device h include tensorflow core common runtime rendezvous mgr h include tensorflow core framework allocator h include tensorflow core framework node def pb h ,move output dtype computation inside kernelanddevice init also fix some wrong dependencies and rename functionlibraryruntime member as flr and implies functionlibrarydefinition piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3989,limitations under the license refer to all protobuf apis if defined platform google include tensorflow core platform google build config protobuf h include tensorflow core platform google protobuf h else include tensorflow core platform default protobuf h endif ,fix build rearrange proto dependencies so the protobuf cc files are included once change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3990,job status job t job typval trettv intdummy invoke the exit callback invoke the exit callback make sure the refcount is 0 job jv refcount argv 0 v type var job argv 0 vval v job job argv 1 v type var number job status job t job call func job jv exit cb int strlen job jv exit cb rettv 2 argv 0l 0l dummy true null clear tv rettv job jv refcount if job jv status job ended job jv refcount 0 the job already was unreferenced now that it ended it can be the job was already unreferenced now that it ended it can be freed careful caller must not use job after this job free job ,patch problem when the job exit callback is invoked the job may be freed too soon yasuhiro matsumoto solution increase refcount , patch problem when using a terminal window is a bit slow solution add a test for the command line
3991,static const char kcpuplatformname cpu cpudevice cpudevice int id std unique ptr localdevicestate local device state device id std move local device state kcpuplatformname device id std move local device state kcpuplatformname device kind kcpuplatformname statusor std shared ptr pylocalclient getcpuclient bool asynchronous tf assign or return se platform platform ,xla python add a device kind attribute to device that uniquely names the kind of device e g gtx the intent is to use device kind as a compilation cache key to fix https github com google jax issues piperorigin revid change id , fix a bug in the parser test piperorigin revid
3992,limitations under the license include mlir pass passmanager h tf local config mlir include mlir transforms dialectconversion h tf local config mlir include mlir transforms passes h tf local config mlir include tensorflow compiler xla service mlir gpu transforms legalize to affine h include tensorflow compiler mlir xla transforms passes h include tensorflow compiler xla util h namespace xla status lowerlhlotogpu mlir moduleop module passmanager pm module getcontext transform element wise operations to affine pm addpass createlegalizeaffinepass pm addpass mlir xla lhlo transform affine to gpu launches todo b 137624192 this pass requires known dimensions generalization it pm addpass mlir 0 ,move legalization for lhlo to compiler mlir xla piperorigin revid , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3993,status transposegpuop dotranspose opkernelcontext ctx const tensor in typeconstraint t t hostmemory perm transposegpuop tf call number types register tf call pod types register undef register endif ,add bool transpose on gpu fixes change , fix a bug in the graph piperorigin revid
3994,bool model model operator conv base op operator stb op getopwithinput model post conv op outputs 0 getopwithinput model conv op outputs 0 bool has pad op false if pad op type operatortype kpad if pad op pad op type operatortype kpad has pad op true check eq pad op inputs size 2 check eq pad op outputs size 1 bool model model operator conv base op operator stb op if has pad op auto pre stb pad op getopwithoutput model stb op inputs 0 if it is a pad op then just the input of pad op with input of stb if pre stb pad op type operatortype kpad if pre stb pad op pre stb pad op type operatortype kpad stb op inputs 0 pre stb pad op inputs 0 has pad op true pad op pre stb pad op ,fix segmentation fault for conv d with dilation , fix a bug in the test case piperorigin revid
3995,void launchconv2dop gpudevice t operator const int64 out depths gettensordim output data format 'c' const int64 patch rows filter dim size 0 const int64 patch cols filter dim size 1 if padding eigen padding same if padding same total padding on rows and cols is pr r' 1 s kr r pc c' 1 s kc c ,fix wrong enum comparison piperorigin revid , fix a bug in the graph piperorigin revid
3996,class pruning object thresholds get thresholds for index mask in enumerate masks if not self exists in do not prune list mask name summary scalar mask name ' sparsity' nn impl zero fraction mask summary scalar mask op name ' sparsity' nn impl zero fraction mask summary scalar thresholds index op name ' threshold' thresholds index ,prevent redundant in summary names take identical approach as is done with thresholds using tf variable op name instead of tf variable name to prevent tensorflow saying summary names are illegal due to , fix a bug in the docstring of the documentation of the new api change
3997,limitations under the license include tensorflow core framework op kernel h namespace tensorflow namespace functor template typename device typename t struct void operator const device d typename ttypes t flat t t device d t constant t 0 namespace functor template typename device typename t class zeroinitializerop public opkernel class zeroinitializerop public opkernel op requires ok ctx ctx allocate persistent input dtype input shape out persistent out tensor attr auto out flat out tensor flat t out flat device ctx eigen device device out flat constant t 0 functor device t ctx eigen device device out tensor flat t ctx replace ref input 0 out tensor true we always return the input ref ctx forward ref input to ref output 0 0 ,compile eigen gpu code for variable ops under gpu srcs fixes undefined symbol issue when using config cuda on open source tensorflow change , xla python add a test for the cpu backend piperorigin revid change id idaddffdfdccebadaad
3998,import os import subprocess import sys import msan build def is32bit args def getcompilerargs args ' w' if ' fsanitize memory' not in args if msan flags weren't added for some reason add them here compiler args extend msan build injected args return compiler args ,msan builder inject msan flags in wrapper if they don't exist some packages build test binaries that don't use c xx flags and fail during linking , fix a bug in the test case piperorigin revid
3999,export interface state label by option selectedlabeloption string whether the state is a 3d view if false the state is a 2d view boolean ,consolidate the dimensionality of pca and t sne to one polymer variable and save it in the state object when bookmarking the world change , fix a bug in the docstring of the test case piperorigin revid
